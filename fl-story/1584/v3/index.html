<!DOCTYPE html><html><head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<base target="_blank">
		<link rel="stylesheet" type="text/css" href="static/style.css">
	<title>Flourish template: Scatter</title></head>
	<body class="template">
	

<script>window.Flourish = {"static_prefix":"static","environment":"live"};</script><script>var template=function(t){"use strict";var o;"function"!=typeof Object.values&&(Object.values=function(t){for(var e=Object.keys(t),n=e.length,r=new Array(n);n--;)r[n]=t[e[n]];return r}),Object.assign||(Object.assign=function(t){var e=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1;r<arguments.length;r++){var i=e[r];if(null!=i)for(var a in i)Object.hasOwnProperty.call(i,a)&&(n[a]=i[a])}return n});var e,a,s,l,c,u,f=Object.freeze({"stack-default":["header","controls","primary","footer"],"stack-2":["primary","header","controls","footer"],"stack-3":["header","primary","controls","footer"],"stack-4":["controls","primary","header","footer"]});e=document.createElement("canvas").getContext("2d");function d(t){return"string"==typeof t&&null!=t.match(/^(https?:\/\/|data:)/i)}function n(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function r(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function p(){}var h,g,m,_,i=1/.7,y="\\s*([+-]?\\d+)\\s*",b="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",v="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",x=/^#([0-9a-f]{3,8})$/,w=new RegExp("^rgb\\("+[y,y,y]+"\\)$"),M=new RegExp("^rgb\\("+[v,v,v]+"\\)$"),j=new RegExp("^rgba\\("+[y,y,y,b]+"\\)$"),k=new RegExp("^rgba\\("+[v,v,v,b]+"\\)$"),z=new RegExp("^hsl\\("+[b,v,v]+"\\)$"),N=new RegExp("^hsla\\("+[b,v,v,b]+"\\)$"),A={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function D(){return this.rgb().formatHex()}function T(){return this.rgb().formatRgb()}function I(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=x.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?L(e):3===n?new E(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?S(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?S(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=w.exec(t))?new E(e[1],e[2],e[3],1):(e=M.exec(t))?new E(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=j.exec(t))?S(e[1],e[2],e[3],e[4]):(e=k.exec(t))?S(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=z.exec(t))?Y(e[1],e[2]/100,e[3]/100,1):(e=N.exec(t))?Y(e[1],e[2]/100,e[3]/100,e[4]):A.hasOwnProperty(t)?L(A[t]):"transparent"===t?new E(NaN,NaN,NaN,0):null}function L(t){return new E(t>>16&255,t>>8&255,255&t,1)}function S(t,e,n,r){return r<=0&&(t=e=n=NaN),new E(t,e,n,r)}function E(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function C(){return"#"+P(this.r)+P(this.g)+P(this.b)}function O(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function P(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Y(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||1<=n?t=e=NaN:e<=0&&(t=NaN),new B(t,e,n,r)}function F(t){if(t instanceof B)return new B(t.h,t.s,t.l,t.opacity);if(t instanceof p||(t=I(t)),!t)return new B;if(t instanceof B)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=0<l&&l<1?0:o,new B(o,s,l,t.opacity)}function B(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function U(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}n(p,I,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:D,formatHex:D,formatHsl:function(){return F(this).formatHsl()},formatRgb:T,toString:T}),n(E,function(t,e,n,r){return 1===arguments.length?((i=t)instanceof p||(i=I(i)),i?new E((i=i.rgb()).r,i.g,i.b,i.opacity):new E):new E(t,e,n,null==r?1:r);var i},r(p,{brighter:function(t){return t=null==t?i:Math.pow(i,t),new E(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new E(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:C,formatHex:C,formatRgb:O,toString:O})),n(B,function(t,e,n,r){return 1===arguments.length?F(t):new B(t,e,n,null==r?1:r)},r(p,{brighter:function(t){return t=null==t?i:Math.pow(i,t),new B(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new B(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new E(U(240<=t?t-240:t+120,i,r),U(t,i,r),U(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var R=!1;function H(t){return 0!==t.indexOf("http://")&&0!==t.indexOf("https://")?"http://"+t:t}function Z(){var t;return(t=document.createElement("style")).type="text/css",t.innerHTML=".flourish-footer { margin: 0; } .flourish-footer p { margin: 0; display: inline; } .flourish-footer p:empty { height: 0; } .flourish-footer a { color: inherit; }",document.head.appendChild(t),(h=document.createElement("footer")).className="flourish-footer",(g=document.createElement("div")).className="flourish-footer-text",(_=document.createElement("a")).target="_blank",(m=document.createElement("img")).className="flourish-footer-logo",_.appendChild(m),h.appendChild(g),h.appendChild(_),h}function Q(){return K.background_color_enabled&&!function(t){if(t){var e=I(t);return 195<Math.round(299*e.r+587*e.g+114*e.b)/1e3}console.warn("No valid color",t)}(K.background_color)}function G(){var t=d(K.footer_logo_src)?K.footer_logo_src:"";return d(K.footer_logo_src_light)&&Q()&&(t=K.footer_logo_src_light),t}function q(){return K.footer_logo_enabled&&G()}function W(){!function(){var i="";["mobile_small","mobile_big","tablet","desktop","big_screen"].forEach(function(t,e){var n="@media(min-width: "+K["breakpoint_"+t]+"px) {\n",r="html { font-size:"+K["font_size_"+t]+"%; }";i+=(0==e?"":n)+r+(0==e?"":"\n}")+"\n\n"}),o.innerHTML=i;var t=[K.body_font,K.title_font,K.subtitle_font,K.footer_font];t.forEach(function(t){if(t){for(var e=!1,n=document.head.querySelectorAll("link.layout-font"),r=0;r<n.length;r++)n[r].href==t.url&&(e=!0);if(!e){var i=document.createElement("link");i.setAttribute("rel","stylesheet"),i.setAttribute("href",t.url),i.className="layout-font",document.head.appendChild(i)}}});for(var e=document.head.querySelectorAll("link.layout-font"),n=0;n<e.length;n++){var r=e[n],a=!1;t.forEach(function(t){t&&t.url==r.href&&(a=!0)}),a||r.parentElement.removeChild(r)}document.body.style.fontFamily=K.body_font.name}(),a.style.textAlign=K.header_align,a.style.margin=0,a.style.borderTop="top"==K.header_border?K.header_border_width+"px "+K.header_border_style+" "+K.header_border_color:null,a.style.borderBottom="bottom"==K.header_border?K.header_border_width+"px "+K.header_border_style+" "+K.header_border_color:null,a.style.paddingTop="top"==K.header_border?K.header_border_space+"rem":"",a.style.paddingBottom="bottom"==K.header_border?K.header_border_space+"rem":"",s.innerHTML=K.title?K.title:"",s.style.fontFamily=K.title_font?K.title_font.name:"inherit",s.style.fontSize=("custom"!=K.title_size?K.title_size:K.title_size_custom)+"rem",s.style.lineHeight=K.title_line_height,s.style.fontWeight=K.title_weight,s.style.color=K.title_color||K.font_color,s.style.margin=0,s.style.paddingTop=K.title?("custom"==K.title_space_above?K.title_space_above_custom:K.title_space_above)+"rem":0,l.innerHTML=K.subtitle?K.subtitle:"",l.style.fontFamily=K.subtitle_font?K.subtitle_font.name:"inherit",l.style.fontSize=("custom"!=K.subtitle_size?K.subtitle_size:K.subtitle_size_custom)+"rem",l.style.lineHeight=K.subtitle_line_height,l.style.fontWeight=K.subtitle_weight,l.style.color=K.subtitle_color||K.font_color,l.style.margin=0,l.style.paddingTop=K.subtitle?("custom"==K.subtitle_space_above?K.subtitle_space_above_custom:K.subtitle_space_above)+"rem":0,c.innerHTML=K.header_text?K.header_text:"",c.style.fontSize=("custom"!=K.header_text_size?K.header_text_size:K.header_text_size_custom)+"rem",c.style.lineHeight=K.header_text_line_height,c.style.fontWeight=K.header_text_weight,c.style.margin=0,c.style.color=K.header_text_color||K.font_color,c.style.paddingTop=K.header_text?("custom"==K.header_text_space_above?K.header_text_space_above_custom:K.header_text_space_above)+"rem":0,u.style.display=K.header_logo_enabled&&d(K.header_logo_src)?"":"none",u.style.position="inside"==K.header_logo_align?"":"fixed",u.style.height=K.header_logo_height+"rem",u.style.top="outside"==K.header_logo_align?0:"",u.style.left="outside"==K.header_logo_align&&"left"==K.header_logo_position_outside?0:"",u.style.right="outside"==K.header_logo_align&&"right"==K.header_logo_position_outside?0:"",u.style.marginTop=K.header_logo_margin_top+"rem",u.style.marginBottom=K.header_logo_margin_bottom+"rem",u.style.marginLeft=K.header_logo_margin_left+"rem",u.style.marginRight=K.header_logo_margin_right+"rem",u.style.float="top"==K.header_logo_position_inside||"outside"==K.header_logo_align?"":K.header_logo_position_inside,u.style.width="auto",u.src=d(K.header_logo_src)?K.header_logo_src:"",function(){var t=[{name:K.source_name,url:K.source_url},{name:K.multiple_sources?K.source_name_2:"",url:K.multiple_sources?K.source_url_2:""},{name:K.multiple_sources?K.source_name_3:"",url:K.multiple_sources?K.source_url_3:""}].filter(function(t){return t.name||t.url});R=0<t.length||K.footer_note||K.footer_note_secondary||q(),h.style.display="flex",h.style.height=R?null:0,h.style.width="100%",h.style.paddingTop="top"==K.footer_border?K.footer_border_space+"rem":"",h.style.paddingBottom="bottom"==K.footer_border?K.footer_border_space+"rem":"",h.style.borderTop="top"==K.footer_border?K.footer_border_width+"px "+K.footer_border_style+" "+K.footer_border_color:"",h.style.borderBottom="bottom"==K.footer_border?K.footer_border_width+"px "+K.footer_border_style+" "+K.footer_border_color:"",h.style.fontFamily=K.footer_font?K.footer_font.name:"inherit","justify"==K.footer_align?h.style.justifyContent="space-between":"left"==K.footer_align?h.style.justifyContent="flex-start":"right"==K.footer_align?h.style.justifyContent="flex-end":"center"==K.footer_align&&(h.style.justifyContent="center"),h.style.fontSize=K.footer_text_size+"rem",h.style.color=K.footer_text_color||K.font_color,h.style.alignItems=K.footer_align_vertical;var i=document.createElement("span");t.forEach(function(t,e){var n=document.createElement("p");if(0<e&&(n.innerText=", "),t.url){var r=document.createElement("a");r.innerText=t.name||t.url,r.href=H(t.url),r.target="_blank",n.appendChild(r)}else n.innerText+=t.name||t.url;i.innerHTML+=n.innerHTML}),g.style.order="left"==K.footer_logo_order?2:"",g.style.textAlign="justify"==K.footer_align?"":K.footer_align;var e="<p>";e+=""!==i.innerHTML?K.source_label+" "+i.innerHTML:"",e+=K.footer_note?(""!==i.innerHTML?" • ":"")+K.footer_note:"",e+="</p>",e+=K.footer_note_secondary?"<br /><p>"+K.footer_note_secondary+"</p>":"",g.innerHTML=e,m.src=G(),m.style.height=K.footer_logo_height+"rem",m.style.marginLeft="right"==K.footer_logo_order?K.footer_logo_margin+"rem":"",m.style.marginRight="left"==K.footer_logo_order?K.footer_logo_margin+"rem":"",m.style.verticalAlign=K.footer_align_vertical,m.style.display=q()?"":"none",_.href=""==K.footer_logo_link_url?"":H(K.footer_logo_link_url),_.style.cursor=""==K.footer_logo_link_url?"default":"pointer"}(),document.body.style.backgroundColor=K.background_color_enabled?K.background_color:"transparent",document.body.style.backgroundImage=K.background_image_enabled?"url("+K.background_image_src+")":"",document.body.style.backgroundSize=K.background_image_size,document.body.style.backgroundRepeat="no-repeat",document.body.style.backgroundPosition=K.background_image_position;var t=rt.wrapper.style;t.height="100vh",t.color=K.font_color,t.maxWidth="wrapper"==K.max_width_target?K.max_width+"px":"",t.marginLeft="wrapper"==K.max_width_target&&"left"!=K.max_width_align?"auto":"",t.marginRight="wrapper"==K.max_width_target&&"right"!=K.max_width_align?"auto":"",t.padding=K.margin_top+"rem "+K.margin_right+"rem "+K.margin_bottom+"rem "+K.margin_left+"rem",t.borderTop=K.border.enabled?K.border.top.width+"px "+K.border.top.style+" "+K.border.top.color:"",t.borderRight=K.border.enabled?K.border.right.width+"px "+K.border.right.style+" "+K.border.right.color:"",t.borderBottom=K.border.enabled?K.border.bottom.width+"px "+K.border.bottom.style+" "+K.border.bottom.color:"",t.borderLeft=K.border.enabled?K.border.left.width+"px "+K.border.left.style+" "+K.border.left.color:"";var e=rt.primary.outer.style,n=rt.legend.outer.style,r=parseFloat(e.order)>parseFloat(n.order)?"above":"below";f[K.layout_order].forEach(function(t,e){rt[t].outer.style.order=10*e}),e.flex="1 1 auto",e.height=null,vt(r),n.textAlign=K.header_align,rt.controls.outer.style.textAlign=K.header_align,rt.primary.outer.style.maxWidth="primary"==K.max_width_target?K.max_width+"px":"",rt.primary.outer.style.marginLeft="primary"==K.max_width_target&&"left"!=K.max_width_align?"auto":"",rt.primary.outer.style.marginRight="primary"==K.max_width_target&&"right"!=K.max_width_align?"auto":"";var i=("custom"==K.space_between_sections?K.space_between_sections_custom:K.space_between_sections)/2+"rem";nt.map(function(t){var e=rt[t],n=e.outer.style;return{name:t,height:at(e.inner),order:parseFloat(n.order),style:n}}).sort(function(t,e){return t.order-e.order}).filter(function(t){if(t.height)return!0;t.style.paddingBottom="",t.style.paddingTop=""}).forEach(function(t,e,n){t.style.paddingTop=e?i:"",t.style.paddingBottom=e<n.length-1?i:""})}var V=Object.freeze({body_font:{name:"Source Sans Pro",url:"https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700"},title_font:null,subtitle_font:null,footer_font:null,border:{enabled:!1,top:{width:1,color:"#dddddd",style:"solid"},right:{width:1,color:"#dddddd",style:"solid"},bottom:{width:1,color:"#dddddd",style:"solid"},left:{width:1,color:"#dddddd",style:"solid"}},layout_order:"stack-default",margin_top:.75,margin_right:.75,margin_bottom:.75,margin_left:.75,space_between_sections:1,space_between_sections_custom:1,background_color_enabled:!0,background_color:"#ffffff",background_image_enabled:!1,background_image_src:"",background_image_size:"cover",background_image_position:"center center",max_width:600,max_width_target:"none",max_width_align:"center",breakpoint_mobile_small:0,breakpoint_mobile_big:380,breakpoint_tablet:580,breakpoint_desktop:1080,breakpoint_big_screen:1280,font_color:"#333333",font_size_mobile_small:62.5,font_size_mobile_big:75,font_size_tablet:87.5,font_size_desktop:100,font_size_big_screen:120,header_align:"left",header_border:"none",header_border_width:1,header_border_color:"#dddddd",header_border_style:"solid",header_border_space:.5,header_logo_enabled:!1,header_logo_align:"inside",header_logo_src:"",header_logo_height:3,header_logo_position_inside:"left",header_logo_position_outside:"left",header_logo_margin_top:.25,header_logo_margin_right:.5,header_logo_margin_bottom:0,header_logo_margin_left:0,title:"",title_size:1.6,title_size_custom:1.6,title_line_height:1.2,title_color:null,title_weight:"bold",title_space_above:0,title_space_above_custom:1.5,title_styling:!1,subtitle:"",subtitle_size:1.6,subtitle_size_custom:1.6,subtitle_line_height:1.2,subtitle_color:null,subtitle_weight:"normal",subtitle_space_above:0,subtitle_space_above_custom:1.5,subtitle_styling:!1,header_text:"",header_text_size:1.2,header_text_size_custom:1.2,header_text_line_height:1.2,header_text_color:null,header_text_weight:"normal",header_text_space_above:.5,header_text_space_above_custom:1.5,source_label:"Source: ",source_name:"",source_url:"",source_name_2:"",source_url_2:"",source_name_3:"",source_url_3:"",footer_note:"",footer_note_secondary:"",footer_text_size:1,footer_text_color:null,footer_styling:!1,footer_align:"justify",footer_align_vertical:"center",footer_border:"none",footer_border_width:1,footer_border_color:"#dddddd",footer_border_style:"solid",footer_border_space:.5,footer_logo_enabled:!1,footer_logo_src:"",footer_logo_src_light:"",footer_logo_link_url:"",footer_logo_height:1.5,footer_logo_margin:.25,footer_logo_order:"right"});var X,J,K,$="Your web browser does not support the features used by this content. Consider updating to a modern browser.";function tt(t){return window.innerWidth!==X&&(X=window.innerWidth,J=parseFloat(getComputedStyle(document.documentElement).fontSize)),t*J}var et,nt=["header","controls","legend","primary","footer"],rt={};function it(t){return t.getBoundingClientRect().width}function at(t){return t.getBoundingClientRect().height}function ot(){return rt.wrapper}function st(){return rt.sidebar}function lt(t){return-1!==nt.indexOf(t)?rt[t].inner:null}function ct(t){return rt[t]||void 0===t?it("wrapper"==t||void 0===t?rt.wrapper:rt[t].outer):null}function ut(t){return rt[t]||void 0===t?"wrapper"==t||void 0===t?it(rt.wrapper)-_t("horizontal")-yt("horizontal"):it(rt[t].inner):null}function ft(t){return rt[t]||void 0===t?at("wrapper"==t||void 0===t?rt.wrapper:rt[t].outer):null}function dt(t){return rt[t]||void 0===t?"wrapper"==t||void 0===t?at(rt.wrapper)-_t("vertical")-yt("vertical"):at(rt[t].inner):null}function pt(){return at(rt.primary.outer)-gt(rt.primary.outer)}function ht(){return it(rt.primary.inner)}function gt(t){return(parseFloat(getComputedStyle(t).paddingTop)||0)+(parseFloat(getComputedStyle(t).paddingBottom)||0)}function mt(){return function(){if(Flourish.fixed_height)return window.innerHeight;var t=window.innerWidth;return 999<t?650:599<t?575:400}()-_t("vertical")-yt("vertical")-["header","controls","legend","footer"].reduce(function(t,e){return t+ft(e)},0)-gt(rt.primary.outer)}function _t(t){var e;return"left"==t?e=K.margin_left:"right"==t?e=K.margin_right:"top"==t?e=K.margin_top:"bottom"==t?e=K.margin_bottom:"horizontal"==t?e=K.margin_left+K.margin_right:"vertical"==t&&(e=K.margin_top+K.margin_bottom),tt(e)}function yt(t){return K.border.enabled?"vertical"==t?K.border.top.width+K.border.bottom.width:"horizontal"==t?K.border.left.width+K.border.right.width:null:0}function bt(t){if(!Flourish.fixed_height&&void 0!==Flourish.fixed_height){var e=null===t,n=rt.primary,r=e?mt():t;r+gt(rt.primary.outer)!==parseFloat(n.outer.style.height)&&(rt.wrapper.style.height="",n.outer.style.flex="",n.inner.style.height=r+"px",Flourish.setHeight(e?null:ft()))}}function vt(t){var e=parseFloat(rt.primary.outer.style.order);rt.legend.outer.style.order=e+1*("below"===t.trim().toLowerCase()?1:-1)}function xt(t){var e=et.querySelector(".fl-layout-overlay-message");if(t){et.style.display="block";var n="string"==typeof t?t:$;e.innerHTML=n}else e.textContent="",et.style.display="none"}function wt(){return et}var Mt="http://www.w3.org/1999/xhtml",jt={svg:"http://www.w3.org/2000/svg",xhtml:Mt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function kt(t){var e=t+="",n=e.indexOf(":");return 0<=n&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),jt.hasOwnProperty(e)?{space:jt[e],local:t}:t}function zt(t){var e=kt(t);return(e.local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(n){return function(){var t=this.ownerDocument,e=this.namespaceURI;return e===Mt&&t.documentElement.namespaceURI===Mt?t.createElement(n):t.createElementNS(e,n)}})(e)}function Nt(){}function At(t){return null==t?Nt:function(){return this.querySelector(t)}}function Dt(){return[]}function Tt(t){return null==t?Dt:function(){return this.querySelectorAll(t)}}function It(t){return function(){return this.matches(t)}}function Lt(t){return new Array(t.length)}function St(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}St.prototype={constructor:St,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var Et="$";function Ct(t,e,n,r,i,a){for(var o,s=0,l=e.length,c=a.length;s<c;++s)(o=e[s])?(o.__data__=a[s],r[s]=o):n[s]=new St(t,a[s]);for(;s<l;++s)(o=e[s])&&(i[s]=o)}function Ot(t,e,n,r,i,a,o){var s,l,c,u={},f=e.length,d=a.length,p=new Array(f);for(s=0;s<f;++s)(l=e[s])&&(p[s]=c=Et+o.call(l,l.__data__,s,e),c in u?i[s]=l:u[c]=l);for(s=0;s<d;++s)(l=u[c=Et+o.call(t,a[s],s,a)])?((r[s]=l).__data__=a[s],u[c]=null):n[s]=new St(t,a[s]);for(s=0;s<f;++s)(l=e[s])&&u[p[s]]===l&&(i[s]=l)}function Pt(t,e){return t<e?-1:e<t?1:e<=t?0:NaN}function Yt(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ft(t,e){return t.style.getPropertyValue(e)||Yt(t).getComputedStyle(t,null).getPropertyValue(e)}function Bt(t){return t.trim().split(/^|\s+/)}function Ut(t){return t.classList||new Rt(t)}function Rt(t){this._node=t,this._names=Bt(t.getAttribute("class")||"")}function Ht(t,e){for(var n=Ut(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Zt(t,e){for(var n=Ut(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Qt(){this.textContent=""}function Gt(){this.innerHTML=""}function qt(){this.nextSibling&&this.parentNode.appendChild(this)}function Wt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Vt(){return null}function Xt(){var t=this.parentNode;t&&t.removeChild(this)}function Jt(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Kt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}Rt.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);0<=e&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return 0<=this._names.indexOf(t)}};var $t={},te=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||($t={mouseenter:"mouseover",mouseleave:"mouseout"}));function ee(n,t,e){return n=ne(n,t,e),function(t){var e=t.relatedTarget;e&&(e===this||8&e.compareDocumentPosition(this))||n.call(this,t)}}function ne(n,r,i){return function(t){var e=te;te=t;try{n.call(this,this.__data__,r,i)}finally{te=e}}}function re(a){return function(){var t=this.__on;if(t){for(var e,n=0,r=-1,i=t.length;n<i;++n)e=t[n],a.type&&e.type!==a.type||e.name!==a.name?t[++r]=e:this.removeEventListener(e.type,e.listener,e.capture);++r?t.length=r:delete this.__on}}}function ie(l,c,u){var f=$t.hasOwnProperty(l.type)?ee:ne;return function(t,e,n){var r,i=this.__on,a=f(c,e,n);if(i)for(var o=0,s=i.length;o<s;++o)if((r=i[o]).type===l.type&&r.name===l.name)return this.removeEventListener(r.type,r.listener,r.capture),this.addEventListener(r.type,r.listener=a,r.capture=u),void(r.value=c);this.addEventListener(l.type,a,u),r={type:l.type,name:l.name,value:c,listener:a,capture:u},i?i.push(r):this.__on=[r]}}function ae(t,e,n){var r=Yt(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}var oe=[null];function se(t,e){this._groups=t,this._parents=e}function le(){return new se([[document.documentElement]],oe)}function ce(t){return"string"==typeof t?new se([[document.querySelector(t)]],[document.documentElement]):new se([[t]],oe)}function ue(t){var e=function(){for(var t,e=te;t=e.sourceEvent;)e=t;return e}();return e.changedTouches&&(e=e.changedTouches[0]),function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}(t,e)}function fe(t){if(t.appendChild(this._container.node()),!document.querySelector("#legend-styles")){var e=document.createElement("style");e.id="legend-styles",e.type="text/css",e.innerHTML=".fl-legend-container.interactive .fl-legend-item:hover { opacity: 0.75; cursor: pointer; }",document.head.appendChild(e)}return this}function de(t){return this._formatFunction=t,this}function pe(){return this._container}function he(t){return void 0===t?this._visible:(this._visible=t,this)}function ge(){var t=this;this._container.select(".fl-legend-title").text(this._state.title).style("display",function(){return t._state.title.trim()?void 0===t._state.orientation?"inline-block":"horizontal"==t._state.orientation?"inline-block":"block":"none"}).style("font-weight",this._state.title_weight).style("color",this._state.text_color).style("vertical-align","middle").style("font-size",this._state.text_size+"rem").style("line-height","1.25rem").style("margin-top",0).style("margin-bottom",0).style("margin-right",this._state.text_size+"rem")}se.prototype=le.prototype={constructor:se,select:function(t){"function"!=typeof t&&(t=At(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o,s=e[i],l=s.length,c=r[i]=new Array(l),u=0;u<l;++u)(a=s[u])&&(o=t.call(a,a.__data__,u,s))&&("__data__"in a&&(o.__data__=a.__data__),c[u]=o);return new se(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=Tt(t));for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o,s=e[a],l=s.length,c=0;c<l;++c)(o=s[c])&&(r.push(t.call(o,o.__data__,c,s)),i.push(o));return new se(r,i)},filter:function(t){"function"!=typeof t&&(t=It(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,l=r[i]=[],c=0;c<s;++c)(a=o[c])&&t.call(a,a.__data__,c,o)&&l.push(a);return new se(r,this._parents)},data:function(t,e){if(!t)return h=new Array(this.size()),u=-1,this.each(function(t){h[++u]=t}),h;var n,r=e?Ot:Ct,i=this._parents,a=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var o=a.length,s=new Array(o),l=new Array(o),c=new Array(o),u=0;u<o;++u){var f=i[u],d=a[u],p=d.length,h=t.call(f,f&&f.__data__,u,i),g=h.length,m=l[u]=new Array(g),_=s[u]=new Array(g);r(f,d,m,_,c[u]=new Array(p),h,e);for(var y,b,v=0,x=0;v<g;++v)if(y=m[v]){for(x<=v&&(x=v+1);!(b=_[x])&&++x<g;);y._next=b||null}}return(s=new se(s,i))._enter=l,s._exit=c,s},enter:function(){return new se(this._enter||this._groups.map(Lt),this._parents)},exit:function(){return new se(this._exit||this._groups.map(Lt),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,a=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=e&&(i=e(i)),null==n?a.remove():n(a),r&&i?r.merge(i).order():i},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var l,c=e[s],u=n[s],f=c.length,d=o[s]=new Array(f),p=0;p<f;++p)(l=c[p]||u[p])&&(d[p]=l);for(;s<r;++s)o[s]=e[s];return new se(o,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],a=i.length-1,o=i[a];0<=--a;)(r=i[a])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(n){function t(t,e){return t&&e?n(t.__data__,e.__data__):!t-!e}n||(n=Pt);for(var e=this._groups,r=e.length,i=new Array(r),a=0;a<r;++a){for(var o,s=e[a],l=s.length,c=i[a]=new Array(l),u=0;u<l;++u)(o=s[u])&&(c[u]=o);c.sort(t)}return new se(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){var t=0;return this.each(function(){++t}),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,a=e[n],o=0,s=a.length;o<s;++o)(i=a[o])&&t.call(i,i.__data__,o,a);return this},attr:function(t,e){var n=kt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof e?n.local?function(e,n){return function(){var t=n.apply(this,arguments);null==t?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}}:function(e,n){return function(){var t=n.apply(this,arguments);null==t?this.removeAttribute(e):this.setAttribute(e,t)}}:n.local?function(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}:function(t,e){return function(){this.setAttribute(t,e)}})(n,e))},style:function(t,e,n){return 1<arguments.length?this.each((null==e?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof e?function(e,n,r){return function(){var t=n.apply(this,arguments);null==t?this.style.removeProperty(e):this.style.setProperty(e,t,r)}}:function(t,e,n){return function(){this.style.setProperty(t,e,n)}})(t,e,null==n?"":n)):Ft(this.node(),t)},property:function(t,e){return 1<arguments.length?this.each((null==e?function(t){return function(){delete this[t]}}:"function"==typeof e?function(e,n){return function(){var t=n.apply(this,arguments);null==t?delete this[e]:this[e]=t}}:function(t,e){return function(){this[t]=e}})(t,e)):this.node()[t]},classed:function(t,e){var n=Bt(t+"");if(arguments.length<2){for(var r=Ut(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?function(t,e){return function(){(e.apply(this,arguments)?Ht:Zt)(this,t)}}:e?function(t){return function(){Ht(this,t)}}:function(t){return function(){Zt(this,t)}})(n,e))},text:function(t){return arguments.length?this.each(null==t?Qt:("function"==typeof t?function(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Gt:("function"==typeof t?function(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(qt)},lower:function(){return this.each(Wt)},append:function(t){var e="function"==typeof t?t:zt(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:zt(t),r=null==e?Vt:"function"==typeof e?e:At(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(Xt)},clone:function(t){return this.select(t?Kt:Jt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,a=(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return 0<=n&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}),o=a.length;if(!(arguments.length<2)){for(s=e?ie:re,null==n&&(n=!1),r=0;r<o;++r)this.each(s(a[r],e,n));return this}var s=this.node().__on;if(s)for(var l,c=0,u=s.length;c<u;++c)for(r=0,l=s[c];r<o;++r)if((i=a[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?function(t,e){return function(){return ae(this,t,e.apply(this,arguments))}}:function(t,e){return function(){return ae(this,t,e)}})(t,e))}};var me=0,_e=Object.freeze({show_legend:!0,title:"",title_weight:"bold",swatch_width:.75,swatch_height:1,swatch_radius:3,order_override:"",orientation:"horizontal",text_color:null,text_size:1});function ye(t){for(var e in this._state=t,_e)void 0===this._state[e]&&(this._state[e]=_e[e]);return this._colorFunction=void 0,this._formatFunction=void 0,this._legend_items=[],this._filtered_items=[],this._eventListeners=[],this._id="fl-legend-discrete-color-"+me,this._visible=!0,this._container=ce(document.createElement("div")).attr("class","fl-legend-container").attr("id",this._id),this._container.append("p").attr("class","fl-legend-title"),me++,this}function be(t,e){return t<e?-1:e<t?1:e<=t?0:NaN}function ve(a){var n;return 1===a.length&&(n=a,a=function(t,e){return be(n(t),e)}),{left:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var i=n+r>>>1;a(t[i],e)<0?n=i+1:r=i}return n},right:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var i=n+r>>>1;0<a(t[i],e)?r=i:n=i+1}return n}}}ye.prototype.appendTo=fe,ye.prototype.format=de,ye.prototype.getContainer=pe,ye.prototype.visible=he,ye.prototype._updateTitle=ge,ye.prototype.data=function(t,r){return this._colorFunction=r,t||r?(r?Array.isArray(t)?this._legend_items=t.slice().map(function(t,e){var n="object"==typeof t?t.label||"":t;return n?{label:n,color:r(n,e)}:null}).filter(function(t){return null!==t}):this._legend_items=[]:this._legend_items=Array.isArray(t)?t.slice():[],this):this._legend_items.slice()},ye.prototype.filtered=function(t){return t?(this._filtered_items=Array.isArray(t)?t.slice():[],this):this._filtered_items.slice()},ye.prototype.on=function(t,a){return this._container&&(this._eventListeners.indexOf(t)<0?this._eventListeners.push(t):a||this._eventListeners.splice(this._eventListeners.indexOf[t],1),this._container.classed("interactive",0<this._eventListeners.length),a?this._container.on(t,function(t,e){var n=te.target,r=n.parentNode,i=n.classList.contains("fl-legend-item")?n:r.classList.contains("fl-legend-item")?r:null;i&&a.call(i,i.__data__.label,e)}):this._container.on(t,"")),this},ye.prototype.update=function(){var t=this._state.show_legend&&this._visible&&0<this._legend_items.length;return this._container.style("display",t?"":"none"),t&&(this._updateTitle(),this._updateLegend()),this},ye.prototype._updateLegend=function(){var t,e=this,n=this._formatFunction;this._container.style("line-height","1.25rem").style("display","inline-flex").style("flex-wrap","wrap").style("align-items","horizontal"==this._state.orientation?"center":"start").style("flex-direction","horizontal"==this._state.orientation?null:"column"),t=this._state.order_override.trim()?function(t,e){for(var n={},r=e.split(/\s*\n\s*/),i=0;i<r.length;i++)n[r[i]]=i;for(var a=[],o=0;o<t.length;o++){var s=t[o],l=n[s.label];void 0!==l&&(a[l]=s)}return a.filter(function(t){return void 0!==t})}(this._legend_items,this._state.order_override):this._legend_items;var r=this._container.selectAll(".fl-legend-item").data(t),i=r.enter().append("div").attr("class","fl-legend-item");i.append("div").attr("class","fl-legend-swatch"),i.append("p").attr("class","fl-legend-label");var a=r.merge(i);return a.style("display","horizontal"==this._state.orientation?"inline-block":"block").style("opacity",function(t){return-1<e._filtered_items.indexOf(t.label)?.2:""}).style("line-height","0").style("vertical-align","middle").style("margin-right","horizontal"==this._state.orientation?.5*this._state.text_size+"rem":""),a.select(".fl-legend-swatch").style("height",this._state.swatch_height+"rem").style("width",this._state.swatch_width+"rem").style("margin-right",.25*this._state.text_size+"rem").style("border-radius",this._state.swatch_radius+"px").style("background-color",function(t){return t.color}).style("vertical-align","middle").style("display","inline-block"),a.select(".fl-legend-label").style("font-size",this._state.text_size+"rem").style("color",this._state.text_color).text(function(t){return n?n(t.label):t.label}).style("margin",0).style("vertical-align","middle").style("user-select","none").style("line-height","1.25rem").style("display","inline-block"),r.exit().remove(),this._legend_item_els=a,this};var xe=ve(be),we=xe.right,Me=xe.left;function je(t){return null===t?NaN:+t}function ke(t,e){var n,r,i=t.length,a=0,o=-1,s=0,l=0;if(null==e)for(;++o<i;)isNaN(n=je(t[o]))||(l+=(r=n-s)*(n-(s+=r/++a)));else for(;++o<i;)isNaN(n=je(e(t[o],o,t)))||(l+=(r=n-s)*(n-(s+=r/++a)));if(1<a)return l/(a-1)}function ze(t,e){var n,r,i,a=t.length,o=-1;if(null==e){for(;++o<a;)if(null!=(n=t[o])&&n<=n)for(r=i=n;++o<a;)null!=(n=t[o])&&(n<r&&(r=n),i<n&&(i=n))}else for(;++o<a;)if(null!=(n=e(t[o],o,t))&&n<=n)for(r=i=n;++o<a;)null!=(n=e(t[o],o,t))&&(n<r&&(r=n),i<n&&(i=n));return[r,i]}function Ne(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a}var Ae=Math.sqrt(50),De=Math.sqrt(10),Te=Math.sqrt(2);function Ie(t,e,n){var r,i,a,o,s=-1;if(n=+n,(t=+t)===(e=+e)&&0<n)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(o=Le(t,e,n))||!isFinite(o))return[];if(0<o)for(t=Math.ceil(t/o),e=Math.floor(e/o),a=new Array(i=Math.ceil(e-t+1));++s<i;)a[s]=(t+s)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),a=new Array(i=Math.ceil(t-e+1));++s<i;)a[s]=(t-s)/o;return r&&a.reverse(),a}function Le(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return 0<=i?(Ae<=a?10:De<=a?5:Te<=a?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(Ae<=a?10:De<=a?5:Te<=a?2:1)}function Se(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return Ae<=a?i*=10:De<=a?i*=5:Te<=a&&(i*=2),e<t?-i:i}function Ee(t,e,n){if(null==n&&(n=je),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(1<=e)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,a=Math.floor(i),o=+n(t[a],a,t);return o+(+n(t[a+1],a+1,t)-o)*(i-a)}}function Ce(t,e){var n,r,i=t.length,a=-1;if(null==e){for(;++a<i;)if(null!=(n=t[a])&&n<=n)for(r=n;++a<i;)null!=(n=t[a])&&r<n&&(r=n)}else for(;++a<i;)if(null!=(n=e(t[a],a,t))&&n<=n)for(r=n;++a<i;)null!=(n=e(t[a],a,t))&&r<n&&(r=n);return r}function Oe(t,e){var n,r,i=t.length,a=-1;if(null==e){for(;++a<i;)if(null!=(n=t[a])&&n<=n)for(r=n;++a<i;)null!=(n=t[a])&&n<r&&(r=n)}else for(;++a<i;)if(null!=(n=e(t[a],a,t))&&n<=n)for(r=n;++a<i;)null!=(n=e(t[a],a,t))&&n<r&&(r=n);return r}function Pe(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}var Ye="$";function Fe(){}function Be(t,e){var n=new Fe;if(t instanceof Fe)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var r,i=-1,a=t.length;if(null==e)for(;++i<a;)n.set(i,t[i]);else for(;++i<a;)n.set(e(r=t[i],i,t),r)}else if(t)for(var o in t)n.set(o,t[o]);return n}function Ue(){var d,p,e,h=[],o=[];function g(t,n,r,i){if(n>=h.length)return null!=d&&t.sort(d),null!=p?p(t):t;for(var e,a,o,s=-1,l=t.length,c=h[n++],u=Be(),f=r();++s<l;)(o=u.get(e=c(a=t[s])+""))?o.push(a):u.set(e,[a]);return u.each(function(t,e){i(f,e,g(t,n,r,i))}),f}return e={object:function(t){return g(t,0,Re,He)},map:function(t){return g(t,0,Ze,Qe)},entries:function(t){return function n(t,r){if(++r>h.length)return t;var i,a=o[r-1];return null!=p&&r>=h.length?i=t.entries():(i=[],t.each(function(t,e){i.push({key:e,values:n(t,r)})})),null!=a?i.sort(function(t,e){return a(t.key,e.key)}):i}(g(t,0,Ze,Qe),0)},key:function(t){return h.push(t),e},sortKeys:function(t){return o[h.length-1]=t,e},sortValues:function(t){return d=t,e},rollup:function(t){return p=t,e}}}function Re(){return{}}function He(t,e,n){t[e]=n}function Ze(){return Be()}function Qe(t,e,n){t.set(e,n)}function Ge(){}Fe.prototype=Be.prototype={constructor:Fe,has:function(t){return Ye+t in this},get:function(t){return this[Ye+t]},set:function(t,e){return this[Ye+t]=e,this},remove:function(t){var e=Ye+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===Ye&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===Ye&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===Ye&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===Ye&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===Ye&&++t;return t},empty:function(){for(var t in this)if(t[0]===Ye)return!1;return!0},each:function(t){for(var e in this)e[0]===Ye&&t(this[e],e.slice(1),this)}};var qe=Be.prototype;function We(t,e){var n=new Ge;if(t instanceof Ge)t.each(function(t){n.add(t)});else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}Ge.prototype=We.prototype={constructor:Ge,has:qe.has,add:function(t){return this[Ye+(t+="")]=t,this},remove:qe.remove,clear:qe.clear,values:qe.keys,size:qe.size,empty:qe.empty,each:qe.each};var Ve=Array.prototype,Xe=Ve.map,Je=Ve.slice,Ke={name:"implicit"};function $e(){var a=Be(),o=[],r=[],i=Ke;function s(t){var e=t+"",n=a.get(e);if(!n){if(i!==Ke)return i;a.set(e,n=o.push(t))}return r[(n-1)%r.length]}return s.domain=function(t){if(!arguments.length)return o.slice();o=[],a=Be();for(var e,n,r=-1,i=t.length;++r<i;)a.has(n=(e=t[r])+"")||a.set(n,o.push(e));return s},s.range=function(t){return arguments.length?(r=Je.call(t),s):r.slice()},s.unknown=function(t){return arguments.length?(i=t,s):i},s.copy=function(){return $e(o,r).unknown(i)},Pe.apply(s,arguments),s}function tn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function en(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function nn(){}var rn=1/.7,an="\\s*([+-]?\\d+)\\s*",on="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",sn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ln=/^#([0-9a-f]{3})$/,cn=/^#([0-9a-f]{6})$/,un=new RegExp("^rgb\\("+[an,an,an]+"\\)$"),fn=new RegExp("^rgb\\("+[sn,sn,sn]+"\\)$"),dn=new RegExp("^rgba\\("+[an,an,an,on]+"\\)$"),pn=new RegExp("^rgba\\("+[sn,sn,sn,on]+"\\)$"),hn=new RegExp("^hsl\\("+[on,sn,sn]+"\\)$"),gn=new RegExp("^hsla\\("+[on,sn,sn,on]+"\\)$"),mn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function _n(t){var e;return t=(t+"").trim().toLowerCase(),(e=ln.exec(t))?new wn((e=parseInt(e[1],16))>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):(e=cn.exec(t))?yn(parseInt(e[1],16)):(e=un.exec(t))?new wn(e[1],e[2],e[3],1):(e=fn.exec(t))?new wn(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=dn.exec(t))?bn(e[1],e[2],e[3],e[4]):(e=pn.exec(t))?bn(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=hn.exec(t))?jn(e[1],e[2]/100,e[3]/100,1):(e=gn.exec(t))?jn(e[1],e[2]/100,e[3]/100,e[4]):mn.hasOwnProperty(t)?yn(mn[t]):"transparent"===t?new wn(NaN,NaN,NaN,0):null}function yn(t){return new wn(t>>16&255,t>>8&255,255&t,1)}function bn(t,e,n,r){return r<=0&&(t=e=n=NaN),new wn(t,e,n,r)}function vn(t){return t instanceof nn||(t=_n(t)),t?new wn((t=t.rgb()).r,t.g,t.b,t.opacity):new wn}function xn(t,e,n,r){return 1===arguments.length?vn(t):new wn(t,e,n,null==r?1:r)}function wn(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Mn(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function jn(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||1<=n?t=e=NaN:e<=0&&(t=NaN),new zn(t,e,n,r)}function kn(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof zn)return new zn(t.h,t.s,t.l,t.opacity);if(t instanceof nn||(t=_n(t)),!t)return new zn;if(t instanceof zn)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=0<l&&l<1?0:o,new zn(o,s,l,t.opacity)}(t):new zn(t,e,n,null==r?1:r)}function zn(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Nn(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}tn(nn,_n,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),tn(wn,xn,en(nn,{brighter:function(t){return t=null==t?rn:Math.pow(rn,t),new wn(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new wn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:function(){return"#"+Mn(this.r)+Mn(this.g)+Mn(this.b)},toString:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),tn(zn,kn,en(nn,{brighter:function(t){return t=null==t?rn:Math.pow(rn,t),new zn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new zn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new wn(Nn(240<=t?t-240:t+120,i,r),Nn(t,i,r),Nn(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var An=Math.PI/180,Dn=180/Math.PI,Tn=.96422,In=1,Ln=.82521,Sn=4/29,En=6/29,Cn=3*En*En,On=En*En*En;function Pn(t){if(t instanceof Fn)return new Fn(t.l,t.a,t.b,t.opacity);if(t instanceof Qn)return Gn(t);t instanceof wn||(t=vn(t));var e,n,r=Hn(t.r),i=Hn(t.g),a=Hn(t.b),o=Bn((.2225045*r+.7168786*i+.0606169*a)/In);return r===i&&i===a?e=n=o:(e=Bn((.4360747*r+.3850649*i+.1430804*a)/Tn),n=Bn((.0139322*r+.0971045*i+.7141733*a)/Ln)),new Fn(116*o-16,500*(e-o),200*(o-n),t.opacity)}function Yn(t,e,n,r){return 1===arguments.length?Pn(t):new Fn(t,e,n,null==r?1:r)}function Fn(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function Bn(t){return On<t?Math.pow(t,1/3):t/Cn+Sn}function Un(t){return En<t?t*t*t:Cn*(t-Sn)}function Rn(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Hn(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Zn(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Qn)return new Qn(t.h,t.c,t.l,t.opacity);if(t instanceof Fn||(t=Pn(t)),0===t.a&&0===t.b)return new Qn(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Dn;return new Qn(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}(t):new Qn(t,e,n,null==r?1:r)}function Qn(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Gn(t){if(isNaN(t.h))return new Fn(t.l,0,0,t.opacity);var e=t.h*An;return new Fn(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}tn(Fn,Yn,en(nn,{brighter:function(t){return new Fn(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Fn(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new wn(Rn(3.1338561*(e=Tn*Un(e))-1.6168667*(t=In*Un(t))-.4906146*(n=Ln*Un(n))),Rn(-.9787684*e+1.9161415*t+.033454*n),Rn(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),tn(Qn,Zn,en(nn,{brighter:function(t){return new Qn(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new Qn(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return Gn(this).rgb()}}));var qn=1.78277,Wn=-.29227,Vn=-.90649,Xn=1.97294,Jn=Xn*Vn,Kn=Xn*qn,$n=qn*Wn- -.14861*Vn;function tr(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof er)return new er(t.h,t.s,t.l,t.opacity);t instanceof wn||(t=vn(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=($n*r+Jn*e-Kn*n)/($n+Jn-Kn),a=r-i,o=(Xn*(n-i)-Wn*a)/Vn,s=Math.sqrt(o*o+a*a)/(Xn*i*(1-i)),l=s?Math.atan2(o,a)*Dn-120:NaN;return new er(l<0?l+360:l,s,i,t.opacity)}(t):new er(t,e,n,null==r?1:r)}function er(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function nr(t){return function(){return t}}function rr(e,n){return function(t){return e+t*n}}function ir(t,e){var n=e-t;return n?rr(t,180<n||n<-180?n-360*Math.round(n/360):n):nr(isNaN(t)?e:t)}function ar(a){return 1==(a=+a)?or:function(t,e){return e-t?(n=t,r=e,i=a,n=Math.pow(n,i),r=Math.pow(r,i)-n,i=1/i,function(t){return Math.pow(n+t*r,i)}):nr(isNaN(t)?e:t);var n,r,i}}function or(t,e){var n=e-t;return n?rr(t,n):nr(isNaN(t)?e:t)}tn(er,tr,en(nn,{brighter:function(t){return t=null==t?rn:Math.pow(rn,t),new er(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new er(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*An,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new wn(255*(e+n*(-.14861*r+qn*i)),255*(e+n*(Wn*r+Vn*i)),255*(e+n*(Xn*r)),this.opacity)}}));var sr=function t(e){var o=ar(e);function n(e,t){var n=o((e=xn(e)).r,(t=xn(t)).r),r=o(e.g,t.g),i=o(e.b,t.b),a=or(e.opacity,t.opacity);return function(t){return e.r=n(t),e.g=r(t),e.b=i(t),e.opacity=a(t),e+""}}return n.gamma=t,n}(1);var lr,cr=(lr=function(c){var u=c.length-1;return function(t){var e,n,r,i=t<=0?t=0:1<=t?u-(t=1):Math.floor(t*u),a=c[i],o=c[i+1],s=0<i?c[i-1]:2*a-o,l=i<u-1?c[i+2]:2*o-a;return((1-3*(e=(t-i/u)*u)+3*(n=e*e)-(r=n*e))*s+(4-6*n+3*r)*a+(1+3*e+3*n-3*r)*o+r*l)/6}},function(t){var e,n,r=t.length,i=new Array(r),a=new Array(r),o=new Array(r);for(e=0;e<r;++e)n=xn(t[e]),i[e]=n.r||0,a[e]=n.g||0,o[e]=n.b||0;return i=lr(i),a=lr(a),o=lr(o),n.opacity=1,function(t){return n.r=i(t),n.g=a(t),n.b=o(t),n+""}});function ur(e,n){return e=+e,n=+n,function(t){return e*(1-t)+n*t}}var fr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,dr=new RegExp(fr.source,"g");function pr(t,r){var e,n,i,a,o,s=fr.lastIndex=dr.lastIndex=0,l=-1,c=[],u=[];for(t+="",r+="";(e=fr.exec(t))&&(n=dr.exec(r));)(i=n.index)>s&&(i=r.slice(s,i),c[l]?c[l]+=i:c[++l]=i),(e=e[0])===(n=n[0])?c[l]?c[l]+=n:c[++l]=n:(c[++l]=null,u.push({i:l,x:ur(e,n)})),s=dr.lastIndex;return s<r.length&&(i=r.slice(s),c[l]?c[l]+=i:c[++l]=i),c.length<2?u[0]?(o=u[0].x,function(t){return o(t)+""}):(a=r,function(){return a}):(r=u.length,function(t){for(var e,n=0;n<r;++n)c[(e=u[n]).i]=e.x(t);return c.join("")})}function hr(t,e){var n,r,i=typeof e;return null==e||"boolean"===i?nr(e):("number"===i?ur:"string"===i?(n=_n(e))?(e=n,sr):pr:e instanceof _n?sr:e instanceof Date?function(e,n){var r=new Date;return e=+e,n=+n,function(t){return r.setTime(e*(1-t)+n*t),r}}:(r=e,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(e)?function(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=hr(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?function(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=hr(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}:ur:function(e,n){n||(n=[]);var r,i=e?Math.min(n.length,e.length):0,a=n.slice();return function(t){for(r=0;r<i;++r)a[r]=e[r]*(1-t)+n[r]*t;return a}}))(t,e)}function gr(e,n){return e=+e,n=+n,function(t){return Math.round(e*(1-t)+n*t)}}var mr,_r,yr,br,vr=180/Math.PI,xr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function wr(t,e,n,r,i,a){var o,s,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),t*r<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*vr,skewX:Math.atan(l)*vr,scaleX:o,scaleY:s}}function Mr(d,p,h,g){function m(t){return t.length?t.pop()+" ":""}return function(t,e){var n,r,i,a,o,s,l,c,u=[],f=[];return t=d(t),e=d(e),function(t,e,n,r,i,a){if(t!==n||e!==r){var o=i.push("translate(",null,p,null,h);a.push({i:o-4,x:ur(t,n)},{i:o-2,x:ur(e,r)})}else(n||r)&&i.push("translate("+n+p+r+h)}(t.translateX,t.translateY,e.translateX,e.translateY,u,f),n=t.rotate,r=e.rotate,i=u,a=f,n!==r?(180<n-r?r+=360:180<r-n&&(n+=360),a.push({i:i.push(m(i)+"rotate(",null,g)-2,x:ur(n,r)})):r&&i.push(m(i)+"rotate("+r+g),o=t.skewX,s=e.skewX,l=u,c=f,o!==s?c.push({i:l.push(m(l)+"skewX(",null,g)-2,x:ur(o,s)}):s&&l.push(m(l)+"skewX("+s+g),function(t,e,n,r,i,a){if(t!==n||e!==r){var o=i.push(m(i)+"scale(",null,",",null,")");a.push({i:o-4,x:ur(t,n)},{i:o-2,x:ur(e,r)})}else 1===n&&1===r||i.push(m(i)+"scale("+n+","+r+")")}(t.scaleX,t.scaleY,e.scaleX,e.scaleY,u,f),t=e=null,function(t){for(var e,n=-1,r=f.length;++n<r;)u[(e=f[n]).i]=e.x(t);return u.join("")}}}var jr=Mr(function(t){return"none"===t?xr:(mr||(mr=document.createElement("DIV"),_r=document.documentElement,yr=document.defaultView),mr.style.transform=t,t=yr.getComputedStyle(_r.appendChild(mr),null).getPropertyValue("transform"),_r.removeChild(mr),wr(+(t=t.slice(7,-1).split(","))[0],+t[1],+t[2],+t[3],+t[4],+t[5]))},"px, ","px)","deg)"),kr=Mr(function(t){return null==t?xr:(br||(br=document.createElementNS("http://www.w3.org/2000/svg","g")),br.setAttribute("transform",t),(t=br.transform.baseVal.consolidate())?wr((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):xr)},", ",")",")");var zr,Nr=(zr=ir,function(e,t){var n=zr((e=kn(e)).h,(t=kn(t)).h),r=or(e.s,t.s),i=or(e.l,t.l),a=or(e.opacity,t.opacity);return function(t){return e.h=n(t),e.s=r(t),e.l=i(t),e.opacity=a(t),e+""}});function Ar(e,t){var n=or((e=Yn(e)).l,(t=Yn(t)).l),r=or(e.a,t.a),i=or(e.b,t.b),a=or(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=i(t),e.opacity=a(t),e+""}}var Dr,Tr=(Dr=ir,function(e,t){var n=Dr((e=Zn(e)).h,(t=Zn(t)).h),r=or(e.c,t.c),i=or(e.l,t.l),a=or(e.opacity,t.opacity);return function(t){return e.h=n(t),e.c=r(t),e.l=i(t),e.opacity=a(t),e+""}});function Ir(s){return function t(o){function e(e,t){var n=s((e=tr(e)).h,(t=tr(t)).h),r=or(e.s,t.s),i=or(e.l,t.l),a=or(e.opacity,t.opacity);return function(t){return e.h=n(t),e.s=r(t),e.l=i(Math.pow(t,o)),e.opacity=a(t),e+""}}return o=+o,e.gamma=t,e}(1)}Ir(ir);var Lr=Ir(or);function Sr(t){return+t}var Er=[0,1];function Cr(t){return t}function Or(e,n){return(n-=e=+e)?function(t){return(t-e)/n}:(t=isNaN(n)?NaN:.5,function(){return t});var t}function Pr(t){var e,n=t[0],r=t[t.length-1];return r<n&&(e=n,n=r,r=e),function(t){return Math.max(n,Math.min(r,t))}}function Yr(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return a=i<r?(r=Or(i,r),n(o,a)):(r=Or(r,i),n(a,o)),function(t){return a(r(t))}}function Fr(n,t,e){var r=Math.min(n.length,t.length)-1,i=new Array(r),a=new Array(r),o=-1;for(n[r]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=Or(n[o],n[o+1]),a[o]=e(t[o],t[o+1]);return function(t){var e=we(n,t,1,r)-1;return a[e](i[e](t))}}function Br(t,e){return function(){var n,r,e,i,a,o,s=Er,l=Er,c=hr,u=Cr;function f(){return i=2<Math.min(s.length,l.length)?Fr:Yr,a=o=null,d}function d(t){return isNaN(t=+t)?e:(a||(a=i(s.map(n),l,c)))(n(u(t)))}return d.invert=function(t){return u(r((o||(o=i(l,s.map(n),ur)))(t)))},d.domain=function(t){return arguments.length?(s=Xe.call(t,Sr),u===Cr||(u=Pr(s)),f()):s.slice()},d.range=function(t){return arguments.length?(l=Je.call(t),f()):l.slice()},d.rangeRound=function(t){return l=Je.call(t),c=gr,f()},d.clamp=function(t){return arguments.length?(u=t?Pr(s):Cr,d):u!==Cr},d.interpolate=function(t){return arguments.length?(c=t,f()):c},d.unknown=function(t){return arguments.length?(e=t,d):e},function(t,e){return n=t,r=e,f()}}()(t,e)}function Ur(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[1<r.length?r[0]+r.slice(2):r,+t.slice(n+1)]}function Rr(t){return(t=Ur(Math.abs(t)))?t[1]:NaN}var Hr,Zr=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Qr(t){if(!(e=Zr.exec(t)))throw new Error("invalid format: "+t);var e;return new Gr({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Gr(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function qr(t,e){var n=Ur(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Qr.prototype=Gr.prototype,Gr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Wr={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return qr(100*t,e)},r:qr,s:function(t,e){var n=Ur(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(Hr=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:o<a?r+new Array(a-o+1).join("0"):0<a?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+Ur(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function Vr(t){return t}var Xr,Jr,Kr,$r=Array.prototype.map,ti=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function ei(t){var e,s,l,w=void 0===t.grouping||void 0===t.thousands?Vr:(s=$r.call(t.grouping,Number),l=t.thousands+"",function(t,e){for(var n=t.length,r=[],i=0,a=s[0],o=0;0<n&&0<a&&(e<o+a+1&&(a=Math.max(1,e-o)),r.push(t.substring(n-=a,n+a)),!((o+=a+1)>e));)a=s[i=(i+1)%s.length];return r.reverse().join(l)}),r=void 0===t.currency?"":t.currency[0]+"",i=void 0===t.currency?"":t.currency[1]+"",M=void 0===t.decimal?".":t.decimal+"",j=void 0===t.numerals?Vr:(e=$r.call(t.numerals,String),function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}),a=void 0===t.percent?"%":t.percent+"",k=void 0===t.minus?"-":t.minus+"",z=void 0===t.nan?"NaN":t.nan+"";function o(t){var c=(t=Qr(t)).fill,u=t.align,f=t.sign,e=t.symbol,d=t.zero,p=t.width,h=t.comma,g=t.precision,m=t.trim,_=t.type;"n"===_?(h=!0,_="g"):Wr[_]||(void 0===g&&(g=12),m=!0,_="g"),(d||"0"===c&&"="===u)&&(d=!0,c="0",u="=");var y="$"===e?r:"#"===e&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",b="$"===e?i:/[%p]/.test(_)?a:"",v=Wr[_],x=/[defgprs%]/.test(_);function n(t){var e,n,r,i=y,a=b;if("c"===_)a=v(t)+a,t="";else{var o=(t=+t)<0||1/t<0;if(t=isNaN(t)?z:v(Math.abs(t),g),m&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;0<i&&(i=0)}return 0<i?t.slice(0,i)+t.slice(e+1):t}(t)),o&&0==+t&&"+"!==f&&(o=!1),i=(o?"("===f?f:k:"-"===f||"("===f?"":f)+i,a=("s"===_?ti[8+Hr/3]:"")+a+(o&&"("===f?")":""),x)for(e=-1,n=t.length;++e<n;)if((r=t.charCodeAt(e))<48||57<r){a=(46===r?M+t.slice(e+1):t.slice(e))+a,t=t.slice(0,e);break}}h&&!d&&(t=w(t,1/0));var s=i.length+t.length+a.length,l=s<p?new Array(p-s+1).join(c):"";switch(h&&d&&(t=w(l+t,l.length?p-a.length:1/0),l=""),u){case"<":t=i+t+a+l;break;case"=":t=i+l+t+a;break;case"^":t=l.slice(0,s=l.length>>1)+i+t+a+l.slice(s);break;default:t=l+i+t+a}return j(t)}return g=void 0===g?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),n.toString=function(){return t+""},n}return{format:o,formatPrefix:function(t,e){var n=o(((t=Qr(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Rr(e)/3))),i=Math.pow(10,-r),a=ti[8+r/3];return function(t){return n(i*t)+a}}}}function ni(t){return Math.max(0,-Rr(Math.abs(t)))}function ri(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Rr(e)/3)))-Rr(Math.abs(t)))}function ii(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Rr(e)-Rr(t))+1}function ai(s){var l=s.domain;return s.ticks=function(t){var e=l();return Ie(e[0],e[e.length-1],null==t?10:t)},s.tickFormat=function(t,e){var n=l();return function(t,e,n,r){var i,a=Se(t,e,n);switch((r=Qr(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=ri(a,o))||(r.precision=i),Kr(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=ii(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=ni(a))||(r.precision=i-2*("%"===r.type))}return Jr(r)}(n[0],n[n.length-1],null==t?10:t,e)},s.nice=function(t){null==t&&(t=10);var e,n=l(),r=0,i=n.length-1,a=n[r],o=n[i];return o<a&&(e=a,a=o,o=e,e=r,r=i,i=e),0<(e=Le(a,o,t))?e=Le(a=Math.floor(a/e)*e,o=Math.ceil(o/e)*e,t):e<0&&(e=Le(a=Math.ceil(a*e)/e,o=Math.floor(o*e)/e,t)),0<e?(n[r]=Math.floor(a/e)*e,n[i]=Math.ceil(o/e)*e,l(n)):e<0&&(n[r]=Math.ceil(a*e)/e,n[i]=Math.floor(o*e)/e,l(n)),s},s}function oi(){var e=Br(Cr,Cr);return e.copy=function(){return t=e,oi().domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown());var t},Pe.apply(e,arguments),ai(e)}function si(){var e,i=[],n=[],r=[];function a(){var t=0,e=Math.max(1,n.length);for(r=new Array(e-1);++t<e;)r[t-1]=Ee(i,t/e);return o}function o(t){return isNaN(t=+t)?e:n[we(r,t)]}return o.invertExtent=function(t){var e=n.indexOf(t);return e<0?[NaN,NaN]:[0<e?r[e-1]:i[0],e<r.length?r[e]:i[i.length-1]]},o.domain=function(t){if(!arguments.length)return i.slice();i=[];for(var e,n=0,r=t.length;n<r;++n)null==(e=t[n])||isNaN(e=+e)||i.push(e);return i.sort(be),a()},o.range=function(t){return arguments.length?(n=Je.call(t),a()):n.slice()},o.unknown=function(t){return arguments.length?(e=t,o):e},o.quantiles=function(){return r.slice()},o.copy=function(){return si().domain(i).range(n).unknown(e)},Pe.apply(o,arguments)}Xr=ei({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),Jr=Xr.format,Kr=Xr.formatPrefix;var li=new Date,ci=new Date;function ui(a,o,n,r){function s(t){return a(t=new Date(+t)),t}return(s.floor=s).ceil=function(t){return a(t=new Date(t-1)),o(t,1),a(t),t},s.round=function(t){var e=s(t),n=s.ceil(t);return t-e<n-t?e:n},s.offset=function(t,e){return o(t=new Date(+t),null==e?1:Math.floor(e)),t},s.range=function(t,e,n){var r,i=[];if(t=s.ceil(t),n=null==n?1:Math.floor(n),!(t<e&&0<n))return i;for(;i.push(r=new Date(+t)),o(t,n),a(t),r<t&&t<e;);return i},s.filter=function(n){return ui(function(t){if(t<=t)for(;a(t),!n(t);)t.setTime(t-1)},function(t,e){if(t<=t)if(e<0)for(;++e<=0;)for(;o(t,-1),!n(t););else for(;0<=--e;)for(;o(t,1),!n(t););})},n&&(s.count=function(t,e){return li.setTime(+t),ci.setTime(+e),a(li),a(ci),Math.floor(n(li,ci))},s.every=function(e){return e=Math.floor(e),isFinite(e)&&0<e?1<e?s.filter(r?function(t){return r(t)%e==0}:function(t){return s.count(0,t)%e==0}):s:null}),s}var fi=ui(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});fi.every=function(n){return n=Math.floor(n),isFinite(n)&&0<n?1<n?ui(function(t){t.setTime(Math.floor(t/n)*n)},function(t,e){t.setTime(+t+e*n)},function(t,e){return(e-t)/n}):fi:null};var di=ui(function(t){t.setTime(t-t.getMilliseconds())},function(t,e){t.setTime(+t+1e3*e)},function(t,e){return(e-t)/1e3},function(t){return t.getUTCSeconds()}),pi=ui(function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds())},function(t,e){t.setTime(+t+6e4*e)},function(t,e){return(e-t)/6e4},function(t){return t.getMinutes()}),hi=ui(function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-6e4*t.getMinutes())},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getHours()}),gi=ui(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5},function(t){return t.getDate()-1});function mi(e){return ui(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/6048e5})}var _i=mi(0),yi=mi(1),bi=(mi(2),mi(3),mi(4)),vi=(mi(5),mi(6),ui(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()})),xi=ui(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});xi.every=function(n){return isFinite(n=Math.floor(n))&&0<n?ui(function(t){t.setFullYear(Math.floor(t.getFullYear()/n)*n),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e*n)}):null};ui(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+6e4*e)},function(t,e){return(e-t)/6e4},function(t){return t.getUTCMinutes()}),ui(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getUTCHours()});var wi=ui(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/864e5},function(t){return t.getUTCDate()-1});function Mi(e){return ui(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/6048e5})}var ji=Mi(0),ki=Mi(1),zi=(Mi(2),Mi(3),Mi(4)),Ni=(Mi(5),Mi(6),ui(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()}),ui(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()}));function Ai(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Di(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Ti(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}Ni.every=function(n){return isFinite(n=Math.floor(n))&&0<n?ui(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/n)*n),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e*n)}):null};var Ii,Li,Si,Ei,Ci={"-":"",_:" ",0:"0"},Oi=/^\s*\d+/,Pi=/^%/,Yi=/[\\^$*+?|[\]().{}]/g;function Fi(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function Bi(t){return t.replace(Yi,"\\$&")}function Ui(t){return new RegExp("^(?:"+t.map(Bi).join("|")+")","i")}function Ri(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function Hi(t,e,n){var r=Oi.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Zi(t,e,n){var r=Oi.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Qi(t,e,n){var r=Oi.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Gi(t,e,n){var r=Oi.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function qi(t,e,n){var r=Oi.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Wi(t,e,n){var r=Oi.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Vi(t,e,n){var r=Oi.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(68<+r[0]?1900:2e3),n+r[0].length):-1}function Xi(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Ji(t,e,n){var r=Oi.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Ki(t,e,n){var r=Oi.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function $i(t,e,n){var r=Oi.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function ta(t,e,n){var r=Oi.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function ea(t,e,n){var r=Oi.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function na(t,e,n){var r=Oi.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function ra(t,e,n){var r=Oi.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function ia(t,e,n){var r=Oi.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function aa(t,e,n){var r=Pi.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function oa(t,e,n){var r=Oi.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function sa(t,e,n){var r=Oi.exec(e.slice(n));return r?(t.Q=1e3*+r[0],n+r[0].length):-1}function la(t,e){return Fi(t.getDate(),e,2)}function ca(t,e){return Fi(t.getHours(),e,2)}function ua(t,e){return Fi(t.getHours()%12||12,e,2)}function fa(t,e){return Fi(1+gi.count(xi(t),t),e,3)}function da(t,e){return Fi(t.getMilliseconds(),e,3)}function pa(t,e){return da(t,e)+"000"}function ha(t,e){return Fi(t.getMonth()+1,e,2)}function ga(t,e){return Fi(t.getMinutes(),e,2)}function ma(t,e){return Fi(t.getSeconds(),e,2)}function _a(t){var e=t.getDay();return 0===e?7:e}function ya(t,e){return Fi(_i.count(xi(t),t),e,2)}function ba(t,e){var n=t.getDay();return t=4<=n||0===n?bi(t):bi.ceil(t),Fi(bi.count(xi(t),t)+(4===xi(t).getDay()),e,2)}function va(t){return t.getDay()}function xa(t,e){return Fi(yi.count(xi(t),t),e,2)}function wa(t,e){return Fi(t.getFullYear()%100,e,2)}function Ma(t,e){return Fi(t.getFullYear()%1e4,e,4)}function ja(t){var e=t.getTimezoneOffset();return(0<e?"-":(e*=-1,"+"))+Fi(e/60|0,"0",2)+Fi(e%60,"0",2)}function ka(t,e){return Fi(t.getUTCDate(),e,2)}function za(t,e){return Fi(t.getUTCHours(),e,2)}function Na(t,e){return Fi(t.getUTCHours()%12||12,e,2)}function Aa(t,e){return Fi(1+wi.count(Ni(t),t),e,3)}function Da(t,e){return Fi(t.getUTCMilliseconds(),e,3)}function Ta(t,e){return Da(t,e)+"000"}function Ia(t,e){return Fi(t.getUTCMonth()+1,e,2)}function La(t,e){return Fi(t.getUTCMinutes(),e,2)}function Sa(t,e){return Fi(t.getUTCSeconds(),e,2)}function Ea(t){var e=t.getUTCDay();return 0===e?7:e}function Ca(t,e){return Fi(ji.count(Ni(t),t),e,2)}function Oa(t,e){var n=t.getUTCDay();return t=4<=n||0===n?zi(t):zi.ceil(t),Fi(zi.count(Ni(t),t)+(4===Ni(t).getUTCDay()),e,2)}function Pa(t){return t.getUTCDay()}function Ya(t,e){return Fi(ki.count(Ni(t),t),e,2)}function Fa(t,e){return Fi(t.getUTCFullYear()%100,e,2)}function Ba(t,e){return Fi(t.getUTCFullYear()%1e4,e,4)}function Ua(){return"+0000"}function Ra(){return"%"}function Ha(t){return+t}function Za(t){return Math.floor(+t/1e3)}Ii=function(t){var r=t.dateTime,i=t.date,a=t.time,e=t.periods,n=t.days,o=t.shortDays,s=t.months,l=t.shortMonths,c=Ui(e),u=Ri(e),f=Ui(n),d=Ri(n),p=Ui(o),h=Ri(o),g=Ui(s),m=Ri(s),_=Ui(l),y=Ri(l),b={a:function(t){return o[t.getDay()]},A:function(t){return n[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:la,e:la,f:pa,H:ca,I:ua,j:fa,L:da,m:ha,M:ga,p:function(t){return e[+(12<=t.getHours())]},Q:Ha,s:Za,S:ma,u:_a,U:ya,V:ba,w:va,W:xa,x:null,X:null,y:wa,Y:Ma,Z:ja,"%":Ra},v={a:function(t){return o[t.getUTCDay()]},A:function(t){return n[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:ka,e:ka,f:Ta,H:za,I:Na,j:Aa,L:Da,m:Ia,M:La,p:function(t){return e[+(12<=t.getUTCHours())]},Q:Ha,s:Za,S:Sa,u:Ea,U:Ca,V:Oa,w:Pa,W:Ya,x:null,X:null,y:Fa,Y:Ba,Z:Ua,"%":Ra},x={a:function(t,e,n){var r=p.exec(e.slice(n));return r?(t.w=h[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=d[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=_.exec(e.slice(n));return r?(t.m=y[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=m[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,e,n){return j(t,r,e,n)},d:Ki,e:Ki,f:ia,H:ta,I:ta,j:$i,L:ra,m:Ji,M:ea,p:function(t,e,n){var r=c.exec(e.slice(n));return r?(t.p=u[r[0].toLowerCase()],n+r[0].length):-1},Q:oa,s:sa,S:na,u:Zi,U:Qi,V:Gi,w:Hi,W:qi,x:function(t,e,n){return j(t,i,e,n)},X:function(t,e,n){return j(t,a,e,n)},y:Vi,Y:Wi,Z:Xi,"%":aa};function w(l,c){return function(t){var e,n,r,i=[],a=-1,o=0,s=l.length;for(t instanceof Date||(t=new Date(+t));++a<s;)37===l.charCodeAt(a)&&(i.push(l.slice(o,a)),null!=(n=Ci[e=l.charAt(++a)])?e=l.charAt(++a):n="e"===e?" ":"0",(r=c[e])&&(e=r(t,n)),i.push(e),o=a+1);return i.push(l.slice(o,a)),i.join("")}}function M(i,a){return function(t){var e,n,r=Ti(1900);if(j(r,i,t+="",0)!=t.length)return null;if("Q"in r)return new Date(r.Q);if("p"in r&&(r.H=r.H%12+12*r.p),"V"in r){if(r.V<1||53<r.V)return null;"w"in r||(r.w=1),r.d="Z"in r?(e=4<(n=(e=Di(Ti(r.y))).getUTCDay())||0===n?ki.ceil(e):ki(e),e=wi.offset(e,7*(r.V-1)),r.y=e.getUTCFullYear(),r.m=e.getUTCMonth(),e.getUTCDate()+(r.w+6)%7):(e=4<(n=(e=a(Ti(r.y))).getDay())||0===n?yi.ceil(e):yi(e),e=gi.offset(e,7*(r.V-1)),r.y=e.getFullYear(),r.m=e.getMonth(),e.getDate()+(r.w+6)%7)}else("W"in r||"U"in r)&&("w"in r||(r.w="u"in r?r.u%7:"W"in r?1:0),n="Z"in r?Di(Ti(r.y)).getUTCDay():a(Ti(r.y)).getDay(),r.m=0,r.d="W"in r?(r.w+6)%7+7*r.W-(n+5)%7:r.w+7*r.U-(n+6)%7);return"Z"in r?(r.H+=r.Z/100|0,r.M+=r.Z%100,Di(r)):a(r)}}function j(t,e,n,r){for(var i,a,o=0,s=e.length,l=n.length;o<s;){if(l<=r)return-1;if(37===(i=e.charCodeAt(o++))){if(i=e.charAt(o++),!(a=x[i in Ci?e.charAt(o++):i])||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=w(i,b),b.X=w(a,b),b.c=w(r,b),v.x=w(i,v),v.X=w(a,v),v.c=w(r,v),{format:function(t){var e=w(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=M(t+="",Ai);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+="",v);return e.toString=function(){return t},e},utcParse:function(t){var e=M(t,Di);return e.toString=function(){return t},e}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),Ii.format,Li=Ii.parse,Si=Ii.utcFormat,Ei=Ii.utcParse;var Qa="%Y-%m-%dT%H:%M:%S.%LZ";Date.prototype.toISOString||Si(Qa);+new Date("2000-01-01T00:00:00.000Z")||Ei(Qa);function Ga(){var e=ai(function(){var e,n,r,i,a,o=0,s=1,l=Cr,c=!1;function u(t){return isNaN(t=+t)?a:l(0===r?.5:(t=(i(t)-e)*r,c?Math.max(0,Math.min(1,t)):t))}return u.domain=function(t){return arguments.length?(e=i(o=+t[0]),n=i(s=+t[1]),r=e===n?0:1/(n-e),u):[o,s]},u.clamp=function(t){return arguments.length?(c=!!t,u):c},u.interpolator=function(t){return arguments.length?(l=t,u):l},u.unknown=function(t){return arguments.length?(a=t,u):a},function(t){return e=(i=t)(o),n=t(s),r=e===n?0:1/(n-e),u}}()(Cr));return e.copy=function(){return t=e,Ga().domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown());var t},function(t,e){switch(arguments.length){case 0:break;case 1:this.interpolator(t);break;default:this.interpolator(e).domain(t)}return this}.apply(e,arguments)}function qa(t){return t*parseFloat(getComputedStyle(document.documentElement).fontSize)}var Wa=0,Va=Object.freeze({show_legend:!0,title:"",title_weight:"bold",color_band_width:8,color_band_height:1,color_band_radius:3,text_color:null,text_size:1,binned_label_mode:"thresholds",binned_label_custom:""});function Xa(t){for(var e in this._state=t,Va)void 0===this._state[e]&&(this._state[e]=Va[e]);return this._colorFunction=void 0,this._formatFunction=void 0,this._legend_domain=[],this._id="fl-legend-continuous-color-"+Wa,this._visible=!0,this._container=ce(document.createElement("div")).attr("class","fl-legend-container").attr("id",this._id).style("display","none"),this._container.append("p").classed("fl-legend-title",!0),this._container.append("div").classed("min label",!0),this._container.append("div").classed("color-range-container",!0),this._container.select(".color-range-container").append("canvas").classed("color-range",!0),this._container.select(".color-range-container").append("canvas").classed("color-range-labels",!0),this._container.append("div").classed("max label",!0),Wa++,this}function Ja(e){return function(t){return t>=e[0]&&t<=e[1]}}Xa.prototype.appendTo=fe,Xa.prototype.format=de,Xa.prototype.getContainer=pe,Xa.prototype.visible=he,Xa.prototype._updateTitle=ge,Xa.prototype.data=function(t,e){return t||e?(this._legend_domain=Array.isArray(t)?t.slice():[],this._colorFunction=e,this):this._legend_domain.slice()},Xa.prototype.update=function(){var t=this._state.show_legend&&this._visible&&0<this._legend_domain.length;return this._container.style("display",t?"":"none"),t&&(this._updateTitle(),this._updateLegend()),this},Xa.prototype._updateLegend=function(){this._scale_type="continuous",this._colorFunction.midpoint?this._scale_type="diverging":this._colorFunction.thresholds&&(this._scale_type="binned");var t=this._legend_domain,e=this._state,n=window.devicePixelRatio||1,r="continuous"==this._scale_type?0:qa(e.text_size),i=qa(e.color_band_width),a=qa(e.color_band_height),o=Math.ceil(.95*qa(e.text_size)),s=i+2*r;this._container.style("display","inline-flex").style("align-items","center"),this._container.select(".color-range-container").style("display","inline-block");var l=this._container.select(".color-range").attr("width",i*n).attr("height",a*n).style("margin","0 "+r+"px").style("border-radius",e.color_band_radius+"px").style("width",i+"px").style("height",a+"px").style("display","block");this._container.select(".color-range-labels").attr("width",s*n).attr("height",o*n).style("width",s+"px").style("height",o+"px").style("display","continuous"==this._scale_type?"none":"block").style("margin-top",.25*e.text_size+"rem").node().getContext("2d").scale(n,n);var c,u=l.node().getContext("2d");u.scale(n,n);for(var f=0;f<i;f++)u.fillStyle=this._colorFunction((c=f,t[0]+c/i*(t[1]-t[0]))),u.fillRect(f,0,1,a);this._updateLegendLabels()},Xa.prototype._updateLegendLabels=function(){var t=this._container.select(".color-range-labels"),u=this._formatFunction,f=this._legend_domain,d=this._state;this._container.select(".min.label").style("display","continuous"==this._scale_type?"inline-block":"none").style("vertical-align","middle").style("user-select","none").style("margin-right",.5*d.text_size+"rem").style("font-size",d.text_size+"rem").style("line-height","1.25rem").style("color",d.text_color).text(function(){return u?u(f[0]):f[0]}),this._container.select(".max.label").style("display","continuous"==this._scale_type?"inline-block":"none").style("vertical-align","middle").style("user-select","none").style("margin-left",.5*d.text_size+"rem").style("font-size",d.text_size+"rem").style("line-height","1.25rem").style("color",d.text_color).text(function(){return u?u(f[1]):f[1]});var p,h,g,e=[];if("diverging"===this._scale_type?e=this._getDivergingLabels():"binned"===this._scale_type&&(e=this._getBinnedLabels()),e.length){var n=window.template||void 0,r=n?n.state.layout:void 0,i=r?r.body_font.name:window.getComputedStyle(document.body).fontFamily,a=d.text_color||n&&r&&r.font_color||"#333333",m=t.node().getContext("2d");m.textAlign="center",m.textBaseline="top",m.fillStyle=a,m.font=qa(d.text_size)+"px "+i;var o=(p=[],h=qa(d.text_size),g=Ja([0,t.node().width]),function(t){var e=oi().domain(f).range([h,qa(d.color_band_width)+h])(t);if(g(e)){var n=u?u(t):t,r=m.measureText(n).width/2+1,i=e-r,a=e+r;if(g(i)&&g(a)){for(var o=0,s=p.length,l=0;l<s&&e>p[l].center;l++)o++;var c=o===s;if((0===o||!(p[o-1].right>i))&&(c||!(p[o].left<a)))return p.splice(o,0,{left:i,center:e,right:a}),{text:n,position:e}}}});e.forEach(function(t){var e=o(t);e&&m.fillText(e.text,e.position,0)})}},Xa.prototype._getDivergingLabels=function(){var t=this._legend_domain,e=Ja(t),n=[];e(this._colorFunction.midpoint)&&n.push(this._colorFunction.midpoint);var r=this._colorFunction.domain;return e(r[0])&&n.push(r[0]),e(r[1])&&n.push(r[1]),t[0]!==r[0]&&n.push(t[0]),t[1]!==r[1]&&n.push(t[1]),n},Xa.prototype._getBinnedLabels=function(){var t,e=this._state,n=this._legend_domain,r=Ja(n);if("thresholds"===e.binned_label_mode)t=this._colorFunction.thresholds.slice().filter(r),n[0]<t[0]&&t.push(n[0]),n[1]>t[t.length-1]&&t.push(n[1]);else if("centers"===e.binned_label_mode)if((t=this._colorFunction.centers.slice().filter(r)).length){var i=this._colorFunction.thresholds,a=i[0],o=i[i.length-1];a>n[0]&&t.push((n[0]+a)/2),o<n[1]&&t.push((o+n[1])/2)}else t.push((n[0]+n[1])/2);else t=e.binned_label_custom.split(";").map(parseFloat);return t};Object.freeze({show_legend:!0,title:"",title_weight:"bold",clip_height:1,small_circle_size:.5,text_color:null,text_size:1,shape_fill:"#eeeeee",shape_stroke:"#555555"});var Ka=Object.freeze({input_decimal_separator:".",output_separators:",."});var $a=Object.freeze({transform_labels:!1,transform:"multiply",multiply_divide_constant:1,exponentiate_constant:0,multiplier:1,prefix:"",n_dec:2,suffix:"",strip_zeros:!0,strip_separator:!0,negative_sign:"-$nk"});function to(o,t){var e,n,s=0<=o.n_dec?Math.floor(o.n_dec):Math.ceil(o.n_dec),l=t(",."+(0<s?s:"0")+"f"),r=t.decimal,c=t.thousands,u=o.strip_zeros&&0<s?new RegExp("\\"+r+"?0+$"):null,f=o.strip_separator&&c,d=o.negative_sign,p=(n=1,(e=o).transform_labels&&(n="multiply"===e.transform?e.multiply_divide_constant:"divide"===e.transform?1/e.multiply_divide_constant:Math.pow(10,e.exponentiate_constant)),function(t){return t*n});return function(t){var e=0<=s?p(t):function(t,e){if(!(e=0<e?Math.floor(e):Math.ceil(e)))return Math.round(t);var n=Math.pow(10,Math.abs(e));return 0<e?Math.round(t*n)/n:Math.round(t/n)*n}(p(t),s),n=e<0,r=Math.abs(e),i=f&&c&&1e3<=r&&r<1e4,a=l(r);return u&&(a=a.replace(u,"")),i&&(a=a.replace(c,"")),n&&"none"!==d?"-$nk"===d?"-"+o.prefix+a+o.suffix:"$-nk"===d?o.prefix+"-"+a+o.suffix:"($nk)"===d?"("+o.prefix+a+o.suffix+")":o.prefix+"("+a+")"+o.suffix:o.prefix+a+o.suffix}}function eo(e){for(var t in $a)void 0===e[t]&&(e[t]=$a[t]);return function(t){return to(e,t)}}function no(e,n){return Object.keys(n).forEach(function(t){void 0===e[t]&&(e[t]=n[t])}),e}var ro=Object.freeze({axis_position:"bottom",y_axis_position:"",numeric_scale_type:"linear",linear_min:null,linear_max:null,log_min:null,log_max:null,datetime_min:"",datetime_max:"",line_visible:!0,line_and_tick_color:"#eeeeee",line_and_tick_width:.1,tick_side:"out",tick_mode:"auto",tick_number:5,tick_custom:"",tick_length:.5,tick_padding:.25,tick_label_position:"default",tick_label_size:.9,tick_label_color:"#aaaaaa",tick_label_angle:"45",tick_label_weight:"normal",tick_label_space_mode:"auto",tick_label_space:10,gridlines_visible:!1,gridline_color:"#eeeeee",gridline_width:.1,gridline_style:"solid",title_mode:"auto",title:"",title_color:"#aaaaaa",title_size:1.1,title_weight:"normal",title_padding:.6}),io=Object.freeze({axis_visible:!0,numeric_scale_type:"linear",linear_min:null,linear_max:null,log_min:null,log_max:null,datetime_min:"",datetime_max:"",line_visible:!0,line_and_tick_color:"#eeeeee",line_and_tick_width:.1,tick_side:"out",tick_mode:"auto",tick_number:5,tick_custom:"",tick_length:.5,tick_padding:.25,tick_label_position:"default",tick_label_size:.9,tick_label_color:"#aaaaaa",tick_label_angle:"0",tick_label_weight:"normal",tick_label_space_mode:"auto",tick_label_space:10,gridlines_visible:!0,gridline_color:"#eeeeee",gridline_width:.1,gridline_style:"solid",title_mode:"auto",title:"",title_color:"#aaaaaa",title_size:1.1,title_weight:"normal",title_padding:.6}),ao=Object.freeze(no({axis_visible:!1},io)),oo=Object.freeze({background_color_enabled:!1,background_color:"#f5f5f5",background_image_enabled:!1,background_image_src:"",background_image_size:"stretch",background_image_position:"xMidYMid"});function so(t){var e=function(t,e,n){t[e]||(t[e]={}),no(t[e],n)}.bind(null,t=t||{});return e("x",ro),e("y",io),e("y2",ao),e("background",oo),t}function lo(t){return"svg"===t.tagName.toLowerCase()}var co=0;var uo=Object.freeze({left:!0,top:!0,right:!0,bottom:!0}),fo=Object.freeze({left:!1,top:!1,right:!1,bottom:!1});var po={value:function(){}};function ho(){for(var t,e=arguments,n=0,r=arguments.length,i={};n<r;++n){if(!(t=e[n]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new go(i)}function go(t){this._=t}function mo(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function _o(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=po,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}go.prototype=ho.prototype={constructor:go,on:function(t,e){var n,r,i=this._,a=(r=i,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(0<=n&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),o=-1,s=a.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=a[o]).type)i[n]=_o(i[n],t.name,e);else if(null==e)for(n in i)i[n]=_o(i[n],t.name,null);return this}for(;++o<s;)if((n=(t=a[o]).type)&&(n=mo(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new go(t)},call:function(t,e){var n=arguments;if(0<(r=arguments.length-2))for(var r,i,a=new Array(r),o=0;o<r;++o)a[o]=n[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,r=(i=this._[t]).length;o<r;++o)i[o].value.apply(e,a)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};var yo,bo,vo=0,xo=0,wo=0,Mo=1e3,jo=0,ko=0,zo=0,No="object"==typeof performance&&performance.now?performance:Date,Ao="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Do(){return ko||(Ao(To),ko=No.now()+zo)}function To(){ko=0}function Io(){this._call=this._time=this._next=null}function Lo(t,e,n){var r=new Io;return r.restart(t,e,n),r}function So(){ko=(jo=No.now())+zo,vo=xo=0;try{!function(){Do(),++vo;for(var t,e=yo;e;)0<=(t=ko-e._time)&&e._call.call(null,t),e=e._next;--vo}()}finally{vo=0,function(){var t,e,n=yo,r=1/0;for(;n;)n=n._call?(r>n._time&&(r=n._time),(t=n)._next):(e=n._next,n._next=null,t?t._next=e:yo=e);bo=t,Co(r)}(),ko=0}}function Eo(){var t=No.now(),e=t-jo;Mo<e&&(zo-=e,jo=t)}function Co(t){vo||(xo&&(xo=clearTimeout(xo)),24<t-ko?(t<1/0&&(xo=setTimeout(So,t-No.now()-zo)),wo&&(wo=clearInterval(wo))):(wo||(jo=No.now(),wo=setInterval(Eo,Mo)),vo=1,Ao(So)))}function Oo(e,n,t){var r=new Io;return n=null==n?0:+n,r.restart(function(t){r.stop(),e(t+n)},n,t),r}Io.prototype=Lo.prototype={constructor:Io,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Do():+n)+(null==e?0:+e),this._next||bo===this||(bo?bo._next=this:yo=this,bo=this),this._call=t,this._time=n,Co()},stop:function(){this._call&&(this._call=null,this._time=1/0,Co())}};var Po=ho("start","end","cancel","interrupt"),Yo=[],Fo=0,Bo=1,Uo=2,Ro=3,Ho=4,Zo=5,Qo=6;function Go(t,e,n,r,i,a){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(a,o,s){var l,c=a.__transition;function u(t){var e,n,r,i;if(s.state!==Bo)return d();for(e in c)if((i=c[e]).name===s.name){if(i.state===Ro)return Oo(u);i.state===Ho?(i.state=Qo,i.timer.stop(),i.on.call("interrupt",a,a.__data__,i.index,i.group),delete c[e]):+e<o&&(i.state=Qo,i.timer.stop(),i.on.call("cancel",a,a.__data__,i.index,i.group),delete c[e])}if(Oo(function(){s.state===Ro&&(s.state=Ho,s.timer.restart(f,s.delay,s.time),f(t))}),s.state=Uo,s.on.call("start",a,a.__data__,s.index,s.group),s.state===Uo){for(s.state=Ro,l=new Array(r=s.tween.length),e=0,n=-1;e<r;++e)(i=s.tween[e].value.call(a,a.__data__,s.index,s.group))&&(l[++n]=i);l.length=n+1}}function f(t){for(var e=t<s.duration?s.ease.call(null,t/s.duration):(s.timer.restart(d),s.state=Zo,1),n=-1,r=l.length;++n<r;)l[n].call(a,e);s.state===Zo&&(s.on.call("end",a,a.__data__,s.index,s.group),d())}function d(){for(var t in s.state=Qo,s.timer.stop(),delete c[o],c)return;delete a.__transition}(c[o]=s).timer=Lo(function(t){s.state=Bo,s.timer.restart(u,s.delay,s.time),s.delay<=t&&u(t-s.delay)},0,s.time)}(t,n,{name:e,index:r,group:i,on:Po,tween:Yo,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:Fo})}function qo(t,e){var n=Vo(t,e);if(n.state>Fo)throw new Error("too late; already scheduled");return n}function Wo(t,e){var n=Vo(t,e);if(n.state>Ro)throw new Error("too late; already running");return n}function Vo(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Xo(t,e,n){var r=t._id;return t.each(function(){var t=Wo(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return Vo(t,r).value[e]}}function Jo(t,e){var n;return("number"==typeof e?ur:e instanceof _n?sr:(n=_n(e))?(e=n,sr):pr)(t,e)}var Ko=le.prototype.constructor;function $o(t){return function(){this.style.removeProperty(t)}}var ts=0;function es(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function ns(){return++ts}var rs=le.prototype;es.prototype=function(t){return le().transition(t)}.prototype={constructor:es,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=At(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var s,l,c=r[o],u=c.length,f=a[o]=new Array(u),d=0;d<u;++d)(s=c[d])&&(l=t.call(s,s.__data__,d,c))&&("__data__"in s&&(l.__data__=s.__data__),f[d]=l,Go(f[d],e,n,d,f,Vo(s,n)));return new es(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Tt(t));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var l,c=r[s],u=c.length,f=0;f<u;++f)if(l=c[f]){for(var d,p=t.call(l,l.__data__,f,c),h=Vo(l,n),g=0,m=p.length;g<m;++g)(d=p[g])&&Go(d,e,n,g,p,h);a.push(p),o.push(l)}return new es(a,o,e,n)},filter:function(t){"function"!=typeof t&&(t=It(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,l=r[i]=[],c=0;c<s;++c)(a=o[c])&&t.call(a,a.__data__,c,o)&&l.push(a);return new es(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var l,c=e[s],u=n[s],f=c.length,d=o[s]=new Array(f),p=0;p<f;++p)(l=c[p]||u[p])&&(d[p]=l);for(;s<r;++s)o[s]=e[s];return new es(o,this._parents,this._name,this._id)},selection:function(){return new Ko(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=ns(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],l=s.length,c=0;c<l;++c)if(o=s[c]){var u=Vo(o,e);Go(o,t,n,c,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new es(r,this._parents,t,n)},call:rs.call,nodes:rs.nodes,node:rs.node,size:rs.size,empty:rs.empty,each:rs.each,on:function(t,e){var n,r,i,a,o,s,l=this._id;return arguments.length<2?Vo(this.node(),l).on.on(t):this.each((n=l,i=e,s=((r=t)+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return 0<=e&&(t=t.slice(0,e)),!t||"start"===t})?qo:Wo,function(){var t=s(this,n),e=t.on;e!==a&&(o=(a=e).copy()).on(r,i),t.on=o}))},attr:function(t,e){var n=kt(t),r="transform"===n?kr:Jo;return this.attrTween(t,"function"==typeof e?(n.local?function(r,i,a){var o,s,l;return function(){var t,e,n=a(this);if(null!=n)return(t=this.getAttributeNS(r.space,r.local))===(e=n+"")?null:t===o&&e===s?l:(s=e,l=i(o=t,n));this.removeAttributeNS(r.space,r.local)}}:function(r,i,a){var o,s,l;return function(){var t,e,n=a(this);if(null!=n)return(t=this.getAttribute(r))===(e=n+"")?null:t===o&&e===s?l:(s=e,l=i(o=t,n));this.removeAttribute(r)}})(n,r,Xo(this,"attr."+t,e)):null==e?(n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}})(n):(n.local?function(e,n,r){var i,a,o=r+"";return function(){var t=this.getAttributeNS(e.space,e.local);return t===o?null:t===i?a:a=n(i=t,r)}}:function(e,n,r){var i,a,o=r+"";return function(){var t=this.getAttribute(e);return t===o?null:t===i?a:a=n(i=t,r)}})(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=kt(t);return this.tween(n,(r.local?function(r,i){var a,o;function t(){var e,n,t=i.apply(this,arguments);return t!==o&&(a=(o=t)&&(e=r,n=t,function(t){this.setAttributeNS(e.space,e.local,n.call(this,t))})),a}return t._value=i,t}:function(r,i){var a,o;function t(){var e,n,t=i.apply(this,arguments);return t!==o&&(a=(o=t)&&(e=r,n=t,function(t){this.setAttribute(e,n.call(this,t))})),a}return t._value=i,t})(r,e))},style:function(t,e,n){var r,i,a,o,s,l,c,u,f,d,p,h,g,m,_,y,b,v,x,w,M,j,k,z,N,A="transform"==(t+="")?jr:Jo;return null==e?this.styleTween(t,(M=t,j=A,function(){var t=Ft(this,M),e=(this.style.removeProperty(M),Ft(this,M));return t===e?null:t===k&&e===z?N:N=j(k=t,z=e)})).on("end.style."+t,$o(t)):"function"==typeof e?this.styleTween(t,(_=t,y=A,b=Xo(this,"style."+t,e),function(){var t=Ft(this,_),e=b(this),n=e+"";return null==e&&(this.style.removeProperty(_),n=e=Ft(this,_)),t===n?null:t===v&&n===x?w:(x=n,w=y(v=t,e))})).each((c=this._id,m="end."+(g="style."+(u=t)),function(){var t=Wo(this,c),e=t.on,n=null==t.value[g]?h||(h=$o(u)):void 0;e===f&&p===n||(d=(f=e).copy()).on(m,p=n),t.on=d})):this.styleTween(t,(r=t,i=A,a=e,l=a+"",function(){var t=Ft(this,r);return t===l?null:t===o?s:s=i(o=t,a)}),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,function(i,a,o){var s,l;function t(){var e,n,r,t=a.apply(this,arguments);return t!==l&&(s=(l=t)&&(e=i,n=t,r=o,function(t){this.style.setProperty(e,n.call(this,t),r)})),s}return t._value=a,t}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?(n=Xo(this,"text",t),function(){var t=n(this);this.textContent=null==t?"":t}):(e=null==t?"":t+"",function(){this.textContent=e}));var e,n},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(n){var r,i;function t(){var e,t=n.apply(this,arguments);return t!==i&&(r=(i=t)&&(e=t,function(t){this.textContent=e.call(this,t)})),r}return t._value=n,t}(t))},remove:function(){return this.on("end.remove",(n=this._id,function(){var t=this.parentNode;for(var e in this.__transition)if(+e!==n)return;t&&t.removeChild(this)}));var n},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=Vo(this.node(),n).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===t)return r.value;return null}return this.each((null==e?function(i,a){var o,s;return function(){var t=Wo(this,i),e=t.tween;if(e!==o)for(var n=0,r=(s=o=e).length;n<r;++n)if(s[n].name===a){(s=s.slice()).splice(n,1);break}t.tween=s}}:function(a,o,s){var l,c;if("function"!=typeof s)throw new Error;return function(){var t=Wo(this,a),e=t.tween;if(e!==l){c=(l=e).slice();for(var n={name:o,value:s},r=0,i=c.length;r<i;++r)if(c[r].name===o){c[r]=n;break}r===i&&c.push(n)}t.tween=c}})(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){qo(this,t).delay=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){qo(this,t).delay=e}})(e,t)):Vo(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){Wo(this,t).duration=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){Wo(this,t).duration=e}})(e,t)):Vo(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){Wo(this,t).ease=e}}(e,t)):Vo(this.node(),e).ease},end:function(){var i,a,o=this,s=o._id,l=o.size();return new Promise(function(t,e){var n={value:e},r={value:function(){0==--l&&t()}};o.each(function(){var t=Wo(this,s),e=t.on;e!==i&&((a=(i=e).copy())._.cancel.push(n),a._.interrupt.push(n),a._.end.push(r)),t.on=a})})}};var is={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function as(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return is.time=Do(),is;return n}function os(t){return""+t}function ss(e){var n=os;return function(t){return void 0===t?n||os:(n=t,e)}}function ls(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function cs(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function us(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}le.prototype.interrupt=function(t){return this.each(function(){!function(t,e){var n,r,i,a=t.__transition,o=!0;if(a){for(i in e=null==e?null:e+"",a)(n=a[i]).name===e?(r=n.state>Uo&&n.state<Zo,n.state=Qo,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete a[i]):o=!1;o&&delete t.__transition}}(this,t)})},le.prototype.transition=function(t){var e,n;t=t instanceof es?(e=t._id,t._name):(e=ns(),(n=is).time=Do(),null==t?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],l=s.length,c=0;c<l;++c)(o=s[c])&&Go(o,t,e,c,s,n||as(o,e));return new es(r,this._parents,t,e)};var fs,ds,ps,hs={"-":"",_:" ",0:"0"},gs=/^\s*\d+/,ms=/^%/,_s=/[\\^$*+?|[\]().{}]/g;function ys(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function bs(t){return t.replace(_s,"\\$&")}function vs(t){return new RegExp("^(?:"+t.map(bs).join("|")+")","i")}function xs(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function ws(t,e,n){var r=gs.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Ms(t,e,n){var r=gs.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function js(t,e,n){var r=gs.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function ks(t,e,n){var r=gs.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function zs(t,e,n){var r=gs.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Ns(t,e,n){var r=gs.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function As(t,e,n){var r=gs.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(68<+r[0]?1900:2e3),n+r[0].length):-1}function Ds(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Ts(t,e,n){var r=gs.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function Is(t,e,n){var r=gs.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Ls(t,e,n){var r=gs.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Ss(t,e,n){var r=gs.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Es(t,e,n){var r=gs.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Cs(t,e,n){var r=gs.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Os(t,e,n){var r=gs.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Ps(t,e,n){var r=gs.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Ys(t,e,n){var r=gs.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Fs(t,e,n){var r=ms.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Bs(t,e,n){var r=gs.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Us(t,e,n){var r=gs.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function Rs(t,e){return ys(t.getDate(),e,2)}function Hs(t,e){return ys(t.getHours(),e,2)}function Zs(t,e){return ys(t.getHours()%12||12,e,2)}function Qs(t,e){return ys(1+gi.count(xi(t),t),e,3)}function Gs(t,e){return ys(t.getMilliseconds(),e,3)}function qs(t,e){return Gs(t,e)+"000"}function Ws(t,e){return ys(t.getMonth()+1,e,2)}function Vs(t,e){return ys(t.getMinutes(),e,2)}function Xs(t,e){return ys(t.getSeconds(),e,2)}function Js(t){var e=t.getDay();return 0===e?7:e}function Ks(t,e){return ys(_i.count(xi(t)-1,t),e,2)}function $s(t,e){var n=t.getDay();return t=4<=n||0===n?bi(t):bi.ceil(t),ys(bi.count(xi(t),t)+(4===xi(t).getDay()),e,2)}function tl(t){return t.getDay()}function el(t,e){return ys(yi.count(xi(t)-1,t),e,2)}function nl(t,e){return ys(t.getFullYear()%100,e,2)}function rl(t,e){return ys(t.getFullYear()%1e4,e,4)}function il(t){var e=t.getTimezoneOffset();return(0<e?"-":(e*=-1,"+"))+ys(e/60|0,"0",2)+ys(e%60,"0",2)}function al(t,e){return ys(t.getUTCDate(),e,2)}function ol(t,e){return ys(t.getUTCHours(),e,2)}function sl(t,e){return ys(t.getUTCHours()%12||12,e,2)}function ll(t,e){return ys(1+wi.count(Ni(t),t),e,3)}function cl(t,e){return ys(t.getUTCMilliseconds(),e,3)}function ul(t,e){return cl(t,e)+"000"}function fl(t,e){return ys(t.getUTCMonth()+1,e,2)}function dl(t,e){return ys(t.getUTCMinutes(),e,2)}function pl(t,e){return ys(t.getUTCSeconds(),e,2)}function hl(t){var e=t.getUTCDay();return 0===e?7:e}function gl(t,e){return ys(ji.count(Ni(t)-1,t),e,2)}function ml(t,e){var n=t.getUTCDay();return t=4<=n||0===n?zi(t):zi.ceil(t),ys(zi.count(Ni(t),t)+(4===Ni(t).getUTCDay()),e,2)}function _l(t){return t.getUTCDay()}function yl(t,e){return ys(ki.count(Ni(t)-1,t),e,2)}function bl(t,e){return ys(t.getUTCFullYear()%100,e,2)}function vl(t,e){return ys(t.getUTCFullYear()%1e4,e,4)}function xl(){return"+0000"}function wl(){return"%"}function Ml(t){return+t}function jl(t){return Math.floor(+t/1e3)}fs=function(t){var r=t.dateTime,i=t.date,a=t.time,e=t.periods,n=t.days,o=t.shortDays,s=t.months,l=t.shortMonths,c=vs(e),u=xs(e),f=vs(n),d=xs(n),p=vs(o),h=xs(o),g=vs(s),m=xs(s),_=vs(l),y=xs(l),b={a:function(t){return o[t.getDay()]},A:function(t){return n[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:Rs,e:Rs,f:qs,H:Hs,I:Zs,j:Qs,L:Gs,m:Ws,M:Vs,p:function(t){return e[+(12<=t.getHours())]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Ml,s:jl,S:Xs,u:Js,U:Ks,V:$s,w:tl,W:el,x:null,X:null,y:nl,Y:rl,Z:il,"%":wl},v={a:function(t){return o[t.getUTCDay()]},A:function(t){return n[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:al,e:al,f:ul,H:ol,I:sl,j:ll,L:cl,m:fl,M:dl,p:function(t){return e[+(12<=t.getUTCHours())]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Ml,s:jl,S:pl,u:hl,U:gl,V:ml,w:_l,W:yl,x:null,X:null,y:bl,Y:vl,Z:xl,"%":wl},x={a:function(t,e,n){var r=p.exec(e.slice(n));return r?(t.w=h[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=d[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=_.exec(e.slice(n));return r?(t.m=y[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=m[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,e,n){return j(t,r,e,n)},d:Ls,e:Ls,f:Ys,H:Es,I:Es,j:Ss,L:Ps,m:Is,M:Cs,p:function(t,e,n){var r=c.exec(e.slice(n));return r?(t.p=u[r[0].toLowerCase()],n+r[0].length):-1},q:Ts,Q:Bs,s:Us,S:Os,u:Ms,U:js,V:ks,w:ws,W:zs,x:function(t,e,n){return j(t,i,e,n)},X:function(t,e,n){return j(t,a,e,n)},y:As,Y:Ns,Z:Ds,"%":Fs};function w(l,c){return function(t){var e,n,r,i=[],a=-1,o=0,s=l.length;for(t instanceof Date||(t=new Date(+t));++a<s;)37===l.charCodeAt(a)&&(i.push(l.slice(o,a)),null!=(n=hs[e=l.charAt(++a)])?e=l.charAt(++a):n="e"===e?" ":"0",(r=c[e])&&(e=r(t,n)),i.push(e),o=a+1);return i.push(l.slice(o,a)),i.join("")}}function M(i,a){return function(t){var e,n,r=us(1900,void 0,1);if(j(r,i,t+="",0)!=t.length)return null;if("Q"in r)return new Date(r.Q);if("s"in r)return new Date(1e3*r.s+("L"in r?r.L:0));if(!a||"Z"in r||(r.Z=0),"p"in r&&(r.H=r.H%12+12*r.p),void 0===r.m&&(r.m="q"in r?r.q:0),"V"in r){if(r.V<1||53<r.V)return null;"w"in r||(r.w=1),r.d="Z"in r?(e=4<(n=(e=cs(us(r.y,0,1))).getUTCDay())||0===n?ki.ceil(e):ki(e),e=wi.offset(e,7*(r.V-1)),r.y=e.getUTCFullYear(),r.m=e.getUTCMonth(),e.getUTCDate()+(r.w+6)%7):(e=4<(n=(e=ls(us(r.y,0,1))).getDay())||0===n?yi.ceil(e):yi(e),e=gi.offset(e,7*(r.V-1)),r.y=e.getFullYear(),r.m=e.getMonth(),e.getDate()+(r.w+6)%7)}else("W"in r||"U"in r)&&("w"in r||(r.w="u"in r?r.u%7:"W"in r?1:0),n="Z"in r?cs(us(r.y,0,1)).getUTCDay():ls(us(r.y,0,1)).getDay(),r.m=0,r.d="W"in r?(r.w+6)%7+7*r.W-(n+5)%7:r.w+7*r.U-(n+6)%7);return"Z"in r?(r.H+=r.Z/100|0,r.M+=r.Z%100,cs(r)):ls(r)}}function j(t,e,n,r){for(var i,a,o=0,s=e.length,l=n.length;o<s;){if(l<=r)return-1;if(37===(i=e.charCodeAt(o++))){if(i=e.charAt(o++),!(a=x[i in hs?e.charAt(o++):i])||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=w(i,b),b.X=w(a,b),b.c=w(r,b),v.x=w(i,v),v.X=w(a,v),v.c=w(r,v),{format:function(t){var e=w(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=M(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+="",v);return e.toString=function(){return t},e},utcParse:function(t){var e=M(t+="",!0);return e.toString=function(){return t},e}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),ds=fs.format,ps=fs.parse,fs.utcFormat,fs.utcParse;var kl=parseFloat,zl=ps("%Y-%m-%d");function Nl(e){var n=kl;return function(t){return void 0===t?n||kl:(n=t,e)}}function Al(e){var n=zl;return function(t){return void 0===t?n||zl:(n=t,e)}}function Dl(t){var e=[],n=[];return t.forEach(function(t){n[t]||(e.push(t),n[t]=!0)}),e}var Tl=Array.isArray;function Il(t){return t}function Ll(n){return{prop:function(t,e){Object.defineProperty(n,t,{value:e,enumerable:!0})},getter:function(t,e){Object.defineProperty(n,t,{get:e,enumerable:!0})},method:function(t,e){Object.defineProperty(n,t,{value:e})}}}function Sl(t,e){var n=1;return t[e?"reduce":"reduceRight"](function(t,e){return t[e]||(t[e]=n),n+=1,t},{})}function El(t,e){var n=1;return t[e?"reduce":"reduceRight"](function(t,e){return t[e]=n++,t},{})}function Cl(t,e,n,r){var i,a,o,s,l,c;i="dense"===r?(c=1,e[n?"reduce":"reduceRight"](function(t,e){return t[e]||(t[e]=c++),t},{})):"fractional"===r?(s=Sl(a=e,o=n),l=El(a,o),Object.keys(s).reduce(function(t,e){return t[e]=(s[e]+l[e])/2,t},{})):"worst"===r?El(e,n):Sl(e,n);var u=function(t){return i[t]};return"ordinal"===r&&(u=function(t){return i[t]++}),t.map(u)}function Ol(r){return r=r||Math.random,function(t,e){var n=e-t+1;return Math.floor(r()*n)+t}}function Pl(t,e){return t[Ol(e)(0,t.length-1)]}function Yl(t,e,n,r){var i,a=t.length;if(n=void 0!==e&&n,e=void 0!==e?Math.floor(e):a,!a||e<1)return[];var o=Ol(r);if(n||1===e){i=[];for(var s=0;s<e;s++)i.push(t[o(0,a-1)]);return i}i=t.slice();var l=Math.min(a,e);for(s=0;s<l;s++){var c=o(s,a-1);if(c!==s){var u=i[c],f=i[s];i[s]=u,i[c]=f}}return i.length=l,i}function Fl(t,n,r){if(!n.length)return t.slice();for(var i=0,e=t.reduce(function(t,e){for(;t.length===n[i];)t.push(r),i++;return t.push(e),t},[]);n[i++];)e.push(r);return e}function Bl(e,t){return Tl(t)?t.map(function(t){return Ee(e,t)}):Ee(e,t)}var Ul,Rl,Hl,Zl,Ql,Gl=(Ql=Ll(Zl={}),(Ul=Ql).method("unsorted",function(){return this.values.slice()}),Ul.method("ascending",function(){return this.sorted_values.slice()}),Ul.method("descending",function(){return this.sorted_values.slice().reverse()}),Ul.method("unique",function(){return Dl(this.values)}),Ul.method("uniqueAscending",function(){return Dl(this.sorted_values)}),Ul.method("uniqueDescending",function(){return Dl(this.sorted_values).reverse()}),(Rl=Ql).getter("variance",function(){return ke(this.values)}),Rl.getter("sd",function(){return Math.sqrt(this.variance)}),Rl.getter("median",function(){return Bl(this.sorted_values,.5)}),Rl.getter("iqr",function(){var t=Bl(this.sorted_values,[.25,.75]);return t[1]-t[0]}),Rl.method("quantiles",function(t){return Bl(this.sorted_values,t)}),Rl.method("quartiles",function(){return Bl(this.sorted_values,[.25,.5,.75])}),(Hl=Ql).method("random",function(t){return Pl(this.values,t)}),Hl.method("sample",function(t,e,n){return Yl(this.values,t,e,n)}),Ql.method("rank",function(t,e){return Cl(this.values,this.sorted_values,t,e)}),Ql.method("unclean",function(t){if(t&&t.length<this.values.length)throw new RangeError("dataset is too short");if(t&&t.length>this.values.length)throw new RangeError("dataset is too long");return Fl(t=t||this.values,this.dropped_indexes,NaN)}),Zl);function ql(t,e){var n=Object.create(Gl);return function(t,e,i){i=i||Il;var a=1/0,o=-1/0,r=null,s=0,l=[],c=Object.freeze(e.reduce(function(t,e,n){var r=i(e);return"number"!=typeof r||isNaN(r)?l.push(n):(t.push(r),a=Math.min(a,r),o=Math.max(o,r),s+=r),t},[])),n=Ll(t);n.prop("enhanced_array",!0),n.prop("numeric_array",!0),n.prop("values",c),n.prop("min",c.length?a:null),n.prop("max",c.length?o:null),n.prop("sum",s),n.prop("mean",c.length?s/c.length:null),n.prop("range",c.length?o-a:null),n.prop("length",c.length),n.prop("dropped_indexes",Object.freeze(l)),n.method("extent",function(){return[this.min,this.max]}),n.getter("sorted_values",function(){var e,n;return r||(n=-1/0,c.every(function(t){if(n<=t)return n=t,!0})&&(r=c),e=1/0,r=c.every(function(t){if(t<=e)return e=t,!0})?Object.freeze(c.slice().reverse()):Object.freeze(c.slice().sort(be))),r})}(n,t,e),n}var Wl=Object.freeze(["min","max","mean"]),Vl=Object.freeze(["extent","random","sample","unsorted","ascending","descending","unique","uniqueAscending","uniqueDescending","quartiles","quantiles","unclean"]);function Xl(t){return"number"!=typeof t?null:new Date(t)}function Jl(t,e,r){r=r||Il;var n=ql(e.map(function(t){var e,n=r(t);return e=n,"[object Date]"!==Object.prototype.toString.call(e)||isNaN(e.getTime())?null:n.getTime()})),i=Ll(t);i.prop("enhanced_array",!0),i.prop("datetime_array",!0),i.getter("values",function(){return Object.freeze(n.values.map(Xl))}),i.getter("sorted_values",function(){return Object.freeze(n.sorted_values.map(Xl))}),i.getter("median",function(){return Xl(n.median)}),i.prop("length",n.values.length),i.prop("dropped_indexes",n.dropped_indexes),i.method("rank",function(){return n.rank(arguments)});var a=function(e,n){return function(){var t=e[n].apply(e,arguments);return Array.isArray(t)?t.map(Xl):Xl(t)}}.bind(null,n);return Wl.forEach(function(t){i.prop(t,Xl(n[t]))}),Vl.forEach(function(t){i.method(t,a(t))}),t}var Kl,$l,tc,ec,nc=(ec=Ll(tc={}),(Kl=ec).method("unsorted",function(){return this.values.slice()}),Kl.method("ascending",function(){return this.sorted_values.slice()}),Kl.method("descending",function(){return this.sorted_values.slice().reverse()}),Kl.method("unique",function(){return Dl(this.values)}),Kl.method("uniqueAscending",function(){return Dl(this.sorted_values)}),Kl.method("uniqueDescending",function(){return Dl(this.sorted_values).reverse()}),($l=ec).method("random",function(t){return Pl(this.values,t)}),$l.method("sample",function(t,e,n){return Yl(this.values,t,e,n)}),ec.method("rank",function(t,e){return Cl(this.values,this.sorted_values,t,e)}),ec.method("unclean",function(t){if(t&&t.length<this.values.length)throw new RangeError("dataset is too short");if(t&&t.length>this.values.length)throw new RangeError("dataset is too long");return Fl(t=t||this.values,this.dropped_indexes)}),tc);function rc(t,e){var n=Object.create(nc);return function(t,e,i){i=i||Il;for(var n=null,a=[],o=0,s=null,r=0;null===s&&r<e.length;){var l=i(e[r++]);"string"==typeof l&&(s=l)}var c=s,u=Object.freeze(e.reduce(function(t,e,n){var r=i(e);return"string"==typeof r?(t.push(r),s=r<s?r:s,c=c<r?r:c,r||o++):a.push(n),t},[])),f=Ll(t);f.prop("enhanced_array",!0),f.prop("string_array",!0),f.prop("values",u),f.prop("min",s),f.prop("max",c),f.prop("length",u.length),f.prop("dropped_indexes",Object.freeze(a)),f.prop("n_empty",o),f.method("extent",function(){return[this.min,this.max]}),f.getter("sorted_values",function(){return n||(function(t){if(t.length<2)return!0;var e=t[0];return t.every(function(t){if(e<=t)return e=t,!0})}(u)&&(n=u),n=function(t){if(t.length<2)return!0;var e=t[0];return t.every(function(t){if(t<=e)return e=t,!0})}(u)?Object.freeze(u.slice().reverse()):Object.freeze(u.slice().sort())),n})}(n,t,e),n}var ic,ac="Input data must be an array or Flourish array";function oc(t,e){if(!t)throw new TypeError(ac);if(t.enhanced_array)return t;if(!Array.isArray(t))throw new TypeError(ac);var n,r=e||function(t){return t},i=t.length?typeof r(t[0]):"number";if("number"===i)return ql(t,e);if("string"===i)return rc(t,e);if("object"===i)return Jl(n={},t,e),n;throw new TypeError("Unsupported variable type")}function sc(n){var r=oc([]);return function(t,e){return void 0===t?r:(r=oc(t,e),n)}}function lc(t,e,n){var r=getComputedStyle(t.node()).fontFamily;return(n?n+" ":"")+(ic(e)+"px ")+r}function cc(t,e){return"translate("+t+","+e+")"}function uc(t,e,n){return"rotate("+t+","+(e=e||0)+","+(n=n||0)+")"}var fc=Math.log10||function(t){return Math.log(t)*Math.LOG10E};function dc(t){return Math.floor(fc(Math.abs(t)))}function pc(t){if(0===t)return 0;for(var e=Math.abs(String(t).replace(".",""));0!==e&&e%10==0;)e/=10;return dc(e)+1}function hc(t,e){var n=t[0][0],r=t[1][0],i=e[0][0],a=e[1][0],o=t[0][1],s=t[1][1],l=e[0][1],c=e[1][1],u=(n-r)*(l-c)-(i-a)*(o-s);if(!u)return!(n<i&&n<a&&r<i&&r<a||i<n&&a<n&&i<r&&a<r||o<l&&o<c&&s<l&&s<c||l<o&&c<o&&l<s&&c<s);var f=((n-i)*(l-c)-(o-l)*(i-a))/u;if(f<0||1<f)return!1;var d=-((n-r)*(o-l)-(o-s)*(n-i))/u;return!(d<0||1<d)}function gc(t){return t&&"number"==typeof t?0<t?1:-1:0}function mc(a){var o=a.type;(a=a.copy()).type=o;var n=function(t){var e=a(t);if(isNaN(e)||Math.abs(e)===1/0){var n,r=a.range();if("numeric"!==o)n=r[0]>r[1];else{var i=a.domain();n=gc(i[1]-i[0])!==gc(r[1]-r[0])}e=-1e6*(n?-1:1)}return e};return["domain","range"].forEach(function(e){n[e]=function(){var t=a[e].apply(a,arguments);return t===a?n:t}}),n.copy=function(){return mc(a)},n.type=a.type,n}function _c(t){return"[object Date]"===Object.prototype.toString.call(t)&&!isNaN(t.getTime())}function yc(t){return t.split("\n").filter(function(t){return t}).map(function(t){return t.trim()})}var bc="Testing";function vc(t){return t*(Math.PI/180)}function xc(t,n){var r;return t.filter(function(t){var e=n(t);if(e!==r)return r=e,!0})}function wc(t){var e=void 0!==t.max_space?t.max_space:100,n=void 0!==t.text_height?t.text_height:ic(1),r=t.angle||0,i=document.createElement("canvas").getContext("2d");i.font=t.font;var a=e;if(90===r)a=1/0;else if(r){var o=vc(r);a=(e-n*Math.sin(o))/Math.cos(o)}return function(t){for(var e,n,r=0;e=r?t.substring(0,t.length-r)+"…":t,n=i.measureText(e).width,a<n&&++r<t.length;);return{text:e,text_width:n}}}function Mc(i,a){var o=["px","rem","fraction"];a=a||"width";var s=.3,l="fraction";return function(t,e){return void 0===t?(n=i[a](),{px:r="px"===l?s:"rem"===l?ic(s):s*n,rem:"rem"===l?s:r/ic(1),fraction:"fraction"===l?s:r/n,unit:l}):(s=Math.max(t,0),l=-1!==o.indexOf(e)?e:"px",i);var n,r}}function jc(r,t,e){var i=t[e],a=e+"Data",o=e+"Format",s=e+"Ticks",l=Object.freeze([]),c=r.chart.select(".fl-y-axes"),n=function(){return l};return n._update=function(t){var m,_=r[a]().string_array?"string":"numeric",e=lc(ce(".fl-y-axes"),i.tick_label_size,i.tick_label_weight),y="default"===i.tick_label_position?+i.tick_label_angle:0,b=0,v=r[o]();c.append("text").style("opacity",0).style("font",e).each(function(){var t=ce(this).text(bc).node().getBoundingClientRect();m=t.height}).remove(),"object"==typeof t[0]&&xc(t,v);var n=ic(i.tick_label_space);"auto"===i.tick_label_space_mode&&(n=r[s].autoLabelSpace().px);var x=wc({text_height:m,max_space:n,font:e,angle:y});return(l=t.map(function(t,e){var n,r,i,a,o,s,l=x(v(t)),c=l.text,u=l.text_width;if(0===y||90===y)a=i=n=y?m:u,o=s=(r=y?u+ic(.5):m)/2;else{var f=vc(y),d=Math.sin(f),p=Math.cos(f);n=(i=m*d)+(a=u*p),r=(o=m*p)+(s=u*d)}b=Math.max(b,n);var h="numeric"===_?pc(t):null,g="numeric"===_?dc(t):null;return Object.freeze({index:e,value:t,text:c,type:_,significant_digits:h,exponent:g,text_width:u,text_height:m,box_width:n,box_height:r,box_width_above:i,box_width_below:a,box_height_above:o,box_height_below:s})})).type=_,l.max_box_width="fixed"===i.tick_label_space_mode?ic(i.tick_label_space):b,Object.freeze(l),r},n.autoLabelSpace=Mc(r),n}function kc(e){var n="";return function(t){return void 0===t?n:(n=t,e)}}function zc(t,e){var n=e.x,r=n.axis_position;if("off"===r)return 0;var i=0,a=0,o=0;if("top"===r||"bottom"==r){var s=t.xTicks();i=s.length&&"out"===n.tick_side&&"default"===n.tick_label_position?ic(n.tick_length):0,o=s.max_box_height||0,a=s.length?ic(n.tick_padding):0}return i+a+o+function(t,e){var n=e.x,r=t.xTitle();if("off"===n.axis_visible||!r)return 0;var i=t.chart.select(".fl-x-axis .fl-axis-title"),a=lc(i,n.title_size,n.title_weight),o=i.append("text").text(r).style("opacity",0).style("font",a),s=o.node().getBoundingClientRect().height;return o.remove(),s+2*ic(n.title_padding)}(t,e)}function Nc(t,e){var n=e.y,r=t.yHide()?[]:t.yTicks(),i=(r.length&&"out"===n.tick_side&&"default"===n.tick_label_position?ic(n.tick_length):0)+(r.length?ic(n.tick_padding):0)+(r.max_box_width||0)+(t.yHide()?0:function(t,e){var n=e.y,r=t.yTitle();if(!n.axis_visible||!r)return 0;var i=t.chart.select(".fl-left-axis .fl-axis-title"),a=lc(i,n.title_size,n.title_weight),o=i.append("text").text(r).style("opacity",0).style("font",a),s=o.node().getBoundingClientRect().height;return o.remove(),s+2*ic(n.title_padding)}(t,e)),a=ic(.25),o=0,s=t.xHide()?[]:t.xTicks();if(s.length){var l=s[0];"default"==e.x.tick_label_position?o=.9*l.box_width_left:"left"==e.x.tick_label_position&&(o=l.box_width),a=Math.max(a,o)}return Math.max(i,a)}function Ac(t,e){var n=e.y2,r=t.y2Hide()?[]:t.y2Ticks(),i=(r.length&&"out"===n.tick_side&&"default"===n.tick_label_position?ic(n.tick_length):0)+(r.length?ic(n.tick_padding):0)+(r.max_box_width||0)+(t.y2Hide()?0:function(t,e){var n=e.y2,r=t.y2Title();if(!n.axis_visible||!r)return 0;var i=t.chart.select(".fl-right-axis .fl-axis-title"),a=lc(i,n.title_size,n.title_weight),o=i.append("text").text(r).style("opacity",0).style("font",a),s=o.node().getBoundingClientRect().height;return o.remove(),s+2*ic(n.title_padding)}(t,e)),a=ic(.25),o=0,s=t.xHide()?[]:t.xTicks();if(s.length){var l=s[s.length-1];"default"==e.x.tick_label_position?o=.9*l.box_width_right:"right"==e.x.tick_label_position&&(o=l.box_width),a=Math.max(a,o)}return Math.max(i,a)}function Dc(e,n){var r,i,a,o,t=function(){return{top:r,right:i,bottom:a,left:o}};return t._update=function(t){r=void 0!==(t=t||{}).top?t.top:function(t,e){var n=e.x,r=0;t.xHide()||-1===["top","float-above"].indexOf(n.axis_position)||(r=zc(t,e));var i=0,a=0,o=t.yHide()?[]:t.yTicks();if(o.length){var s=o[o.length-1];"default"==e.y.tick_label_position?i=.9*s.box_height_above:"above"==e.y.tick_label_position&&(i+=s.box_height)}var l=t.y2Hide()?[]:t.y2Ticks();if(l.length){var c=l[l.length-1];"default"==e.y2.tick_label_position?a=.9*c.box_height_above:"above"==e.y2.tick_label_position&&(a+=c.box_height)}var u=Math.max(ic(.25),i,a);return Math.max(r,u)}(e,n),i=void 0!==t.right?t.right:Ac(e,n),a=void 0!==t.bottom?t.bottom:function(t,e){var n=e.x,r=0;t.xHide()||-1===["bottom","float-below"].indexOf(n.axis_position)||(r=zc(t,e));var i=0,a=0,o=t.yHide()?[]:t.yTicks();if(o.length){var s=o[0];"default"==e.y.tick_label_position?i=.9*s.box_height_below:"below"==e.y.tick_label_position&&(i+=s.box_height)}var l=t.y2Hide()?[]:t.y2Ticks();if(l.length){var c=l[0];"default"==e.y2.tick_label_position?a=.9*c.box_height_below:"below"==e.y2.tick_label_position&&(a+=c.box_height)}var u=Math.max(ic(.25),i,a);return Math.max(r,u)}(e,n),o=void 0!==t.left?t.left:Nc(e,n)},Object.defineProperty(t,"top",{get:function(){return r}}),Object.defineProperty(t,"right",{get:function(){return i}}),Object.defineProperty(t,"bottom",{get:function(){return a}}),Object.defineProperty(t,"left",{get:function(){return o}}),t}var Tc=Array.prototype,Ic=Tc.map,Lc=Tc.slice,Sc={name:"implicit"};function Ec(){var a,o,t=function t(r){var a=Be(),o=[],i=Sc;function s(t){var e=t+"",n=a.get(e);if(!n){if(i!==Sc)return i;a.set(e,n=o.push(t))}return r[(n-1)%r.length]}return r=null==r?[]:Lc.call(r),s.domain=function(t){if(!arguments.length)return o.slice();o=[],a=Be();for(var e,n,r=-1,i=t.length;++r<i;)a.has(n=(e=t[r])+"")||a.set(n,o.push(e));return s},s.range=function(t){return arguments.length?(r=Lc.call(t),s):r.slice()},s.unknown=function(t){return arguments.length?(i=t,s):i},s.copy=function(){return t().domain(o).range(r).unknown(i)},s}().unknown(void 0),s=t.domain,l=t.range,c=[0,1],u=!1,f=0,d=0,p=.5;function e(){var t=s().length,e=c[1]<c[0],n=c[e-0],r=c[1-e];a=(r-n)/Math.max(1,t-f+2*d),u&&(a=Math.floor(a)),n+=(r-n-a*(t-f))*p,o=a*(1-f),u&&(n=Math.round(n),o=Math.round(o));var i=Ne(t).map(function(t){return n+a*t});return l(e?i.reverse():i)}return delete t.unknown,t.domain=function(t){return arguments.length?(s(t),e()):s()},t.range=function(t){return arguments.length?(c=[+t[0],+t[1]],e()):c.slice()},t.rangeRound=function(t){return c=[+t[0],+t[1]],u=!0,e()},t.bandwidth=function(){return o},t.step=function(){return a},t.round=function(t){return arguments.length?(u=!!t,e()):u},t.padding=function(t){return arguments.length?(f=d=Math.max(0,Math.min(1,t)),e()):f},t.paddingInner=function(t){return arguments.length?(f=Math.max(0,Math.min(1,t)),e()):f},t.paddingOuter=function(t){return arguments.length?(d=Math.max(0,Math.min(1,t)),e()):d},t.align=function(t){return arguments.length?(p=Math.max(0,Math.min(1,t)),e()):p},t.copy=function(){return Ec().domain(s()).range(c).round(u).paddingInner(f).paddingOuter(d).align(p)},e()}function Cc(){return function t(e){var n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return t(n())},e}(Ec().paddingInner(1))}function Oc(t){return function(){return t}}function Pc(t){return+t}var Yc=[0,1];function Fc(e,n){return(n-=e=+e)?function(t){return(t-e)/n}:Oc(n)}function Bc(t,e,n,r){var i=t[0],a=t[1],o=e[0],s=e[1];return o=a<i?(i=n(a,i),r(s,o)):(i=n(i,a),r(o,s)),function(t){return o(i(t))}}function Uc(n,t,e,r){var i=Math.min(n.length,t.length)-1,a=new Array(i),o=new Array(i),s=-1;for(n[i]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++s<i;)a[s]=e(n[s],n[s+1]),o[s]=r(t[s],t[s+1]);return function(t){var e=we(n,t,1,i)-1;return o[e](a[e](t))}}function Rc(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp())}function Hc(e,n){var r,a,o,s=Yc,l=Yc,c=hr,u=!1;function i(){return r=2<Math.min(s.length,l.length)?Uc:Bc,a=o=null,t}function t(t){return(a||(a=r(s,l,u?(i=e,function(e,n){var r=i(e=+e,n=+n);return function(t){return t<=e?0:n<=t?1:r(t)}}):e,c)))(+t);var i}return t.invert=function(t){return(o||(o=r(l,s,Fc,u?(i=n,function(e,n){var r=i(e=+e,n=+n);return function(t){return t<=0?e:1<=t?n:r(t)}}):n)))(+t);var i},t.domain=function(t){return arguments.length?(s=Ic.call(t,Pc),i()):s.slice()},t.range=function(t){return arguments.length?(l=Lc.call(t),i()):l.slice()},t.rangeRound=function(t){return l=Lc.call(t),c=gr,i()},t.clamp=function(t){return arguments.length?(u=!!t,i()):u},t.interpolate=function(t){return arguments.length?(c=t,i()):c},i()}function Zc(s){var l=s.domain;return s.ticks=function(t){var e=l();return Ie(e[0],e[e.length-1],null==t?10:t)},s.tickFormat=function(t,e){return function(t,e,n){var r,i=t[0],a=t[t.length-1],o=Se(i,a,null==e?10:e);switch((n=Qr(null==n?",f":n)).type){case"s":var s=Math.max(Math.abs(i),Math.abs(a));return null!=n.precision||isNaN(r=ri(o,s))||(n.precision=r),Kr(n,s);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(r=ii(o,Math.max(Math.abs(i),Math.abs(a))))||(n.precision=r-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(r=ni(o))||(n.precision=r-2*("%"===n.type))}return Jr(n)}(l(),t,e)},s.nice=function(t){null==t&&(t=10);var e,n=l(),r=0,i=n.length-1,a=n[r],o=n[i];return o<a&&(e=a,a=o,o=e,e=r,r=i,i=e),0<(e=Le(a,o,t))?e=Le(a=Math.floor(a/e)*e,o=Math.ceil(o/e)*e,t):e<0&&(e=Le(a=Math.ceil(a*e)/e,o=Math.floor(o*e)/e,t)),0<e?(n[r]=Math.floor(a/e)*e,n[i]=Math.ceil(o/e)*e,l(n)):e<0&&(n[r]=Math.ceil(a*e)/e,n[i]=Math.floor(o*e)/e,l(n)),s},s}function Qc(){var t=Hc(Fc,ur);return t.copy=function(){return Rc(t,Qc())},Zc(t)}function Gc(t,e){var n,r=0,i=(t=t.slice()).length-1,a=t[r],o=t[i];return o<a&&(n=r,r=i,i=n,n=a,a=o,o=n),t[r]=e.floor(a),t[i]=e.ceil(o),t}function qc(e,n){return(n=Math.log(n/e))?function(t){return Math.log(t/e)/n}:Oc(n)}function Wc(e,n){return e<0?function(t){return-Math.pow(-n,t)*Math.pow(-e,1-t)}:function(t){return Math.pow(n,t)*Math.pow(e,1-t)}}function Vc(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Xc(e){return 10===e?Vc:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function Jc(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function Kc(e){return function(t){return-e(-t)}}var $c=1e3,tu=60*$c,eu=60*tu,nu=24*eu,ru=7*nu,iu=30*nu,au=365*nu;function ou(t){return new Date(t)}function su(t){return t instanceof Date?+t:+new Date(+t)}function lu(){return function t(o,e,n,r,i,a,s,l,c){var u=Hc(Fc,ur),f=u.invert,d=u.domain,p=c(".%L"),h=c(":%S"),g=c("%I:%M"),m=c("%I %p"),_=c("%a %d"),y=c("%b %d"),b=c("%B"),v=c("%Y"),x=[[s,1,$c],[s,5,5*$c],[s,15,15*$c],[s,30,30*$c],[a,1,tu],[a,5,5*tu],[a,15,15*tu],[a,30,30*tu],[i,1,eu],[i,3,3*eu],[i,6,6*eu],[i,12,12*eu],[r,1,nu],[r,2,2*nu],[n,1,ru],[e,1,iu],[e,3,3*iu],[o,1,au]];function w(t){return(s(t)<t?p:a(t)<t?h:i(t)<t?g:r(t)<t?m:e(t)<t?n(t)<t?_:y:o(t)<t?b:v)(t)}function M(t,e,n,r){if(null==t&&(t=10),"number"==typeof t){var i=Math.abs(n-e)/t,a=ve(function(t){return t[2]}).right(x,i);t=a===x.length?(r=Se(e/au,n/au,t),o):a?(r=(a=x[i/x[a-1][2]<x[a][2]/i?a-1:a])[1],a[0]):(r=Math.max(Se(e,n,t),1),l)}return null==r?t:t.every(r)}return u.invert=function(t){return new Date(f(t))},u.domain=function(t){return arguments.length?d(Ic.call(t,su)):d().map(ou)},u.ticks=function(t,e){var n,r=d(),i=r[0],a=r[r.length-1],o=a<i;return o&&(n=i,i=a,a=n),n=(n=M(t,i,a,e))?n.range(i,a+1):[],o?n.reverse():n},u.tickFormat=function(t,e){return null==e?w:c(e)},u.nice=function(t,e){var n=d();return(t=M(t,n[0],n[n.length-1],e))?d(Gc(n,t)):u},u.copy=function(){return Rc(u,t(o,e,n,r,i,a,s,l,c))},u}(xi,vi,_i,gi,hi,pi,di,fi,ds).domain([new Date(2e3,0,1),new Date(2e3,0,2)])}var cu=1e3;function uu(t){var e=Cc().domain(t.unique()).padding(.5);return e.type="ordinal",e}function fu(t,e,n,r){var i=function(t,e,n,r){var i;if(e===n&&(e=n=null),null!==e&&null!==n)return[e,n];if(t.range)i=Qc().domain(t.extent()).nice().domain(),r&&(0<=i[0]?i[0]=0:i[1]<0&&(i[1]=0));else if(t.length){var a=t.min;i=0<a?[0,2*a]:a<0?[2*a,0]:[-50,50]}else i=[0,100];return null!==e?(i[0]=e,i[0]===i[1]&&(i[1]=e+(t.range||100))):null!==n&&(i[1]=n,i[0]===i[1]&&(i[0]=n-(t.range||100))),i}(t,e,n,r),a=Qc().domain(i);return a.type="numeric",a}function du(t,e,n){var r=t.extent();r[0]<=0&&(0<r[1]?r[0]=Math.min(1,r[1]/cu):r[0]=1),r[1]<=r[0]&&(r[1]=cu*r[0]);var i=function t(){var e=Hc(qc,Wc).domain([1,10]),d=e.domain,p=10,h=Jc(10),g=Xc(10);function n(){return h=Jc(p),g=Xc(p),d()[0]<0&&(h=Kc(h),g=Kc(g)),e}return e.base=function(t){return arguments.length?(p=+t,n()):p},e.domain=function(t){return arguments.length?(d(t),n()):d()},e.ticks=function(t){var e,n=d(),r=n[0],i=n[n.length-1];(e=i<r)&&(l=r,r=i,i=l);var a,o,s,l=h(r),c=h(i),u=null==t?10:+t,f=[];if(!(p%1)&&c-l<u){if(l=Math.round(l)-1,c=Math.round(c)+1,0<r){for(;l<c;++l)for(o=1,a=g(l);o<p;++o)if(!((s=a*o)<r)){if(i<s)break;f.push(s)}}else for(;l<c;++l)for(o=p-1,a=g(l);1<=o;--o)if(!((s=a*o)<r)){if(i<s)break;f.push(s)}}else f=Ie(l,c,Math.min(c-l,u)).map(g);return e?f.reverse():f},e.tickFormat=function(t,n){if(null==n&&(n=10===p?".0e":","),"function"!=typeof n&&(n=Jr(n)),t===1/0)return n;null==t&&(t=10);var r=Math.max(1,p*t/e.ticks().length);return function(t){var e=t/g(Math.round(h(t)));return e*p<p-.5&&(e*=p),e<=r?n(t):""}},e.nice=function(){return d(Gc(d(),{floor:function(t){return g(Math.floor(h(t)))},ceil:function(t){return g(Math.ceil(h(t)))}}))},e.copy=function(){return Rc(e,t().base(p))},e}().domain(r).nice(),a=i.domain();return e===n&&(e=n=null),0<e&&(a[0]=e),0<n&&(a[1]=n),i.domain(a),i.type="numeric",i}function pu(t,e,n,r){var i=t.extent(),a=lu().domain(i).nice();r&&a.tickFormat(null,r);var o=a.domain();return e===n&&(e=n=null),e&&(o[0]=r(e)),n&&(o[1]=r(n)),a.domain(o),a.type="datetime",a}function hu(e){var n=!1;return function(t){return void 0===t?n:(n=!!t,e)}}function gu(e){var n=!1,r=!1;return function(t){return void 0===t?!!n&&{keep_gridlines:r}:(n=!!t,r=!(!t||"object"!=typeof t||!t.keep_gridlines),e)}}function mu(t,e){var n=t.significant_digits-e.significant_digits;return n||((n=e.exponent-t.exponent)?n:(n=Math.abs(e.value)-Math.abs(t.value))?n:n=e.value-t.value)}function _u(t){t.style("user-select","none").style("-moz-user-select","none").style("-webkit-user-select","none").style("-ms-user-select","none").style("cursor","default")}function yu(x,w){var M,j,k,z,N,A,D,T,I,L,S,E,C,s,O,P,Y,F=w.x;var t,B,U,R,e,v,H,Z,n=(t=x.chart.select("g.fl-bottom-axis"),B=t.select("g.fl-axis-line"),U=t.select("g.fl-axis-ticks"),R=t.select("g.fl-axis-title"),function(){var l=F.axis_position,t=!x.xHide()&&-1!==["bottom","float-below"].indexOf(l),e=t?x.xTicks():[],n=j.range()[0],r=(Y||j).range()[0],i=n+ic(F.title_padding);function a(t,e){return void 0===t||isNaN(t)?e:t}"bottom"===l&&(i+=L+e.max_box_height);var o=r,s=n;"float-below"===l&&(o=a((Y||j)(F.y_axis_position),r),s=a(j(F.y_axis_position),n));var c=B.selectAll("line").data(t&&F.line_visible?[M.domain()]:[]);c.exit().style("stroke",N).style("stroke-width",A).transition().duration(k).attr("x1",z).attr("x2",z).remove();var u=c.enter().append("line").style("shape-rendering","crispEdges").style("stroke-linecap","square").style("stroke-width",A).attr("x1",O.range()[0]).attr("x2",O.range()[0]).attr("y1",o).attr("y2",o);c.merge(u).style("stroke",N).style("stroke-width",A).transition().duration(k).attr("x1",M.range()[0]).attr("x2",M.range()[1]).attr("y1",s).attr("y2",s);var f=t?e:[];"numeric"===e.type&&"custom"!==F.tick_mode&&(f=e.slice().sort(mu));var d=function(t){var e="default"==F.tick_label_position?-F.tick_label_angle:-90,n=uc(e,0,0);if("default"===F.tick_label_position)return 0===e?cc(t.text_width/2,L+.66*I):-90===e?cc(0,L)+" "+n+" "+cc(0,.33*I):cc(0,L)+" "+n+" "+cc(0,.66*I);var r="left"===F.tick_label_position?-.3:1;return cc(0,L)+" "+n+" "+cc(0,I*r)},p=U.selectAll("g").data(f,function(t){return t.type+"-"+t.value}),h=p.exit();h.transition().duration(k).attr("transform",function(t){return cc(P(t.value),s)}).style("opacity",0).remove(),h.each(function(){var t=ce(this);t.select("line").style("stroke",N).style("stroke-width",A).transition().duration(k).attr("y2",T),t.select("text").text(function(t){return t.text}).style("fill",D).style("font-size",I+"px").style("font-weight",F.tick_label_weight).attr("transform",d).transition().duration(k)});var g=p.enter().append("g");g.attr("transform",function(t){return cc(O(t.value),o)}),g.each(function(){var t=ce(this);t.append("line").attr("y2",T),t.append("text").attr("text-anchor","middle").attr("transform",d).call(_u)});var m=p.merge(g);m.transition().duration(k).attr("transform",function(t){return cc(M(t.value),s)});var _,y,b=(_=[],y=s+L,function(t){var e=M(t.value);if("float-below"===l){var n=M.range();if(w.y.axis_visible&&e-t.box_width_left<n[0])return 0;if(w.y2.axis_visible&&e+t.box_width_right>n[1])return 0}for(var r=[e,y],i=[r,[e+t.box_width_right,y+t.box_height_right]],a=[r,[e-t.box_width_left,y+t.box_height_left]],o=0;o<_.length;o++){var s=_[o];if(e<=s.x_anchor){if(hc(i,s.q))return 0}else if(hc(s.p,a))return 0}return _.push({x_anchor:e,p:i,q:a}),1});m.each(function(){var t=ce(this);t.select("line").style("stroke",N).style("stroke-width",A).transition().duration(k).attr("y2",T),t.select("text").text(function(t){return t.text}).attr("text-anchor","end").style("fill",D).style("font-size",I+"px").style("font-weight",F.tick_label_weight).transition().duration(k).style("opacity",b).attr("transform",d)});var v=R.selectAll("text").data(t&&E?[E]:[]);v.exit().remove(),v.enter().append("text").attr("text-anchor","middle").style("font-size",S+"px").style("fill",F.title_color).style("font-weight",F.title_weight).call(_u).transition().duration(0).delay(k).text(function(t){return t}).attr("x",C).attr("y",i).attr("dy",S),v.text(function(t){return t}).style("fill",F.title_color).style("font-size",S+"px").style("font-weight",F.title_weight).transition().duration(k).attr("x",C).attr("y",i).attr("dy",S)}),r=(e=x.chart.select("g.fl-top-axis"),v=e.select("g.fl-axis-line"),H=e.select("g.fl-axis-ticks"),Z=e.select("g.fl-axis-title"),function(){var l=F.axis_position,t=!x.xHide()&&-1!==["top","float-above"].indexOf(l),e=t?x.xTicks():[],n=j.range()[1],r=(Y||j).range()[1],i=n-ic(F.title_padding);"top"===l&&(i-=L+e.max_box_height);var a="float-above"===l?(Y||j)(F.y_axis_position):r,o="float-above"===l?j(F.y_axis_position):n,s=v.selectAll("line").data(t&&F.line_visible?[M.domain()]:[]);s.exit().style("stroke",N).style("stroke-width",A).transition().duration(k).attr("x1",z).attr("x2",z).remove();var c=s.enter().append("line").style("shape-rendering","crispEdges").style("stroke-linecap","square").style("stroke-width",A).attr("x1",O.range()[0]).attr("x2",O.range()[0]).attr("y1",a).attr("y2",a);s.merge(c).style("stroke",N).style("stroke-width",A).transition().duration(k).attr("x1",M.range()[0]).attr("x2",M.range()[1]).attr("y1",o).attr("y2",o);var u=[];t&&(u="numeric"===e.type?e.slice().sort(mu):e);var f=function(t){var e="default"==F.tick_label_position?-F.tick_label_angle:-90,n=uc(e,0,0);if("default"===F.tick_label_position)return 0===e?cc(-t.text_width/2,-(L+.33*I)):-90===e?cc(0,-L)+" "+n+" "+cc(0,.33*I):cc(0,-L)+" "+n;var r="left"===F.tick_label_position?-.3:1;return cc(0,-L)+" "+n+" "+cc(0,I*r)},d=H.selectAll("g").data(u,function(t){return t.type+"-"+t.value}),p=d.exit();p.transition().duration(k).attr("transform",function(t){return cc(P(t.value),o)}).style("opacity",0).remove(),p.each(function(){var t=ce(this);t.select("line").style("stroke",N).style("stroke-width",A).transition().duration(k).attr("y2",-T),t.select("text").text(function(t){return t.text}).style("fill",D).style("font-size",I+"px").style("font-weight",F.tick_label_weight).attr("transform",f).transition().duration(k)});var h=d.enter().append("g");h.attr("transform",function(t){return cc(O(t.value),a)}),h.each(function(){var t=ce(this);t.append("line").attr("y2",-T),t.append("text").attr("text-anchor","middle").attr("transform",f).call(_u)});var g=d.merge(h);g.transition().duration(k).attr("transform",function(t){return cc(M(t.value),o)});var m,_,y=(m=[],_=o+L,function(t){var e=M(t.value);if("float-above"===l){var n=M.range();if(w.y.axis_visible&&e-t.box_width_left<n[0])return 0;if(w.y2.axis_visible&&e+t.box_width_right>n[1])return 0}for(var r=[e,_],i=[r,[e-t.box_width_left,_-t.box_height_left]],a=[r,[e+t.box_width_right,_-t.box_height_right]],o=0;o<m.length;o++){var s=m[o];if(e<=s.x_anchor){if(hc(a,s.p))return 0}else if(hc(i,s.q))return 0}return m.push({x_anchor:e,p:i,q:a}),1});g.each(function(){var t=ce(this);t.select("line").style("stroke",N).style("stroke-width",A).transition().duration(k).attr("y2",-T),t.select("text").text(function(t){return t.text}).attr("text-anchor","start").style("fill",D).style("font-size",I+"px").style("font-weight",F.tick_label_weight).transition().duration(k).style("opacity",y).attr("transform",f)});var b=Z.selectAll("text").data(t&&E?[E]:[]);b.exit().remove(),b.enter().append("text").attr("text-anchor","middle").style("font-size",S+"px").style("fill",F.title_color).style("font-weight",F.title_weight).call(_u).transition().duration(0).delay(k).text(function(t){return t}).attr("x",C).attr("y",i).attr("dy",-.33*S),b.text(function(t){return t}).style("fill",F.title_color).style("font-size",S+"px").style("font-weight",F.title_weight).transition().duration(k).attr("x",C).attr("y",i).attr("dy",-.33*S)});return function(){!function(){M=mc(x.xScale()),j=mc(x.yScale()),k=s?x.animationDuration():0;var t=M.range(),e=t[0];C=(e+t[1])/2,s||(s=M),O=s.type===M.type?s:M.copy().range([e,e]),P=s.type===M.type?M:s.copy().range([e,e]),N=F.line_and_tick_color,A=ic(F.line_and_tick_width,!0),D=F.tick_label_color;var n="default"===F.tick_label_position,r=x.xTicks(),i=r.max_box_height,a=r.length?ic(F.tick_padding):0;"top"!=F.axis_position&&"bottom"!=F.axis_position||(i+=a);var o="out"===F.tick_side;T=n?ic(F.tick_length)*(o?1:-1):i,I=ic(F.tick_label_size),L=(o&&n?T:0)+a,S=ic(F.title_size),E=x.xTitle()}(),n(),r(),s=M,Y=j}}function bu(t,e){var Y,n,F,B,r,U,R,H,Z,Q,i,G,q,a,W,V,X,J,o=yu(t,e),s=(n=e,r=(Y=t).chart.select("g.fl-left-axis"),U=r.select("g.fl-axis-line"),R=r.select("g.fl-axis-ticks"),H=r.select("g.fl-axis-title"),Z=n.y,function(){var t=Z.axis_visible&&!Y.yHide(),e=mc(Y.xScale()),s=mc(Y.yScale()),r=t?Y.yTicks():[],n=F?Y.animationDuration():0;F||(F=e),B||(B=s);var i=e.range()[0],a=s.range()[0],o=(F||e).range()[0],l=B.type===s.type?B:s.copy().range([a,a]),c=B.type===s.type?s:B.copy().range([a,a]),u=Z.line_and_tick_color,f=ic(Z.line_and_tick_width,!0),d=Z.tick_label_color,p="default"===Z.tick_label_position,h="out"===Z.tick_side,g=ic(Z.tick_padding),m=Y.yTicks().max_box_width+g,_=p?ic(Z.tick_length)*(h?1:-1):m,y=ic(Z.tick_label_size),b=(h&&p?_:0)+g,v=Y.yTitle(),x=ic(Z.title_size),w=b+r.max_box_width+ic(Z.title_padding)+.33*x,M=s.range(),j=(M[0]+M[1])/2,k=U.selectAll("line").data(t&&Z.line_visible?[s.domain()]:[]);k.exit().style("stroke",u).style("stroke-width",f).transition().duration(n).attr("y1",a).attr("y2",a).remove();var z=k.enter().append("line").style("stroke",u).style("shape-rendering","crispEdges").style("stroke-linecap","square").style("stroke-width",f).attr("y1",l.range()[0]).attr("y2",l.range()[0]).attr("x1",o).attr("x2",o);k.merge(z).style("stroke",u).style("stroke-width",f).transition().duration(n).attr("y1",s.range()[1]).attr("y2",s.range()[0]).attr("x1",i).attr("x2",i);var N=t?r:[];function A(t){if("default"!==Z.tick_label_position)return cc(-b-(r.max_box_width-t.box_width),("above"===Z.tick_label_position?-.3:1)*y);var e=-Z.tick_label_angle;if(0===e)return cc(-b,.33*y);var n=cc(-b,0)+" "+uc(e);return-90===e&&(n+=" "+cc(t.text_width/2,0)),n}"numeric"===r.type&&"custom"!==Z.tick_mode&&(N=r.slice().sort(mu));var D=R.selectAll("g").data(N,function(t){return t.type+"-"+t.value}),T=D.exit();T.transition().duration(n).attr("transform",function(t){return cc(i,c(t.value))}).style("opacity",0).remove(),T.each(function(){var t=ce(this);t.select("line").style("stroke",u).style("stroke-width",f).transition().duration(n).attr("x2",-_),t.select("text").text(function(t){return t.text}).style("fill",d).style("font-size",y+"px").style("font-weight",Z.tick_label_weight).attr("transform",A).transition().duration(n)});var I=D.enter().append("g");I.attr("transform",function(t){return cc(o,l(t.value))}),I.each(function(){var t=ce(this);t.append("line").attr("x2",-_),t.append("text").attr("text-anchor","end").attr("transform",A).call(_u)});var L=D.merge(I);L.transition().duration(n).attr("transform",function(t){return cc(i,s(t.value))});var S,E,C=(S=[],E=i-b,function(t){for(var e=s(t.value),n=[E,e],r=[n,[E-t.box_width_above,e-t.box_height_above]],i=[n,[E-t.box_width_below,e+t.box_height_below]],a=0;a<S.length;a++){var o=S[a];if(e>=o.y_anchor){if(hc(r,o.q))return 0}else if(hc(o.p,i))return 0}return S.push({y_anchor:e,p:r,q:i}),1});L.each(function(){var t=ce(this);t.select("line").style("stroke",u).style("stroke-width",f).transition().duration(n).attr("x2",-_),t.select("text").text(function(t){return t.text}).style("fill",d).style("font-size",y+"px").style("font-weight",Z.tick_label_weight).transition().duration(n).style("opacity",C).attr("transform",A)});var O=H.selectAll("text").data(t&&v?[v]:[]);O.exit().remove();var P=function(){return cc(i,j)+" "+uc(-90)+" "+cc(0,-w)};O.enter().append("text").attr("text-anchor","middle").style("font-size",x+"px").style("fill",Z.title_color).style("font-weight",Z.title_weight).call(_u).transition().duration(0).delay(n).text(function(t){return t}).attr("x",0).attr("y",0).attr("transform",P),O.text(function(t){return t}).style("fill",Z.title_color).style("font-size",x+"px").style("font-weight",Z.title_weight).transition().duration(n).attr("x",0).attr("y",0).attr("transform",P),F=e,B=s}),l=(i=e,a=(Q=t).chart.select("g.fl-right-axis"),W=a.select("g.fl-axis-line"),V=a.select("g.fl-axis-ticks"),X=a.select("g.fl-axis-title"),J=i.y2,function(){var t=J.axis_visible&&!Q.y2Hide(),e=mc(Q.xScale()),s=mc(Q.y2Scale()),r=t?Q.y2Ticks():[],n=G?Q.animationDuration():0;G||(G=e),q||(q=s);var i=e.range()[1],a=s.range()[0],o=(G||e).range()[1],l=q.type===s.type?q:s.copy().range([a,a]),c=q.type===s.type?s:q.copy().range([a,a]),u=J.line_and_tick_color,f=ic(J.line_and_tick_width,!0),d=J.tick_label_color,p="default"===J.tick_label_position,h="out"===J.tick_side,g=ic(J.tick_padding),m=Q.y2Ticks().max_box_width+g,_=p?ic(J.tick_length)*(h?1:-1):m,y=ic(J.tick_label_size),b=(h&&p?_:0)+g,v=Q.y2Title(),x=ic(J.title_size),w=b+r.max_box_width+ic(J.title_padding)+.85*x,M=s.range(),j=(M[0]+M[1])/2,k=W.selectAll("line").data(t&&J.line_visible?[s.domain()]:[]);k.exit().style("stroke",u).style("stroke-width",f).transition().duration(n).attr("y1",a).attr("y2",a).remove();var z=k.enter().append("line").style("stroke",u).style("shape-rendering","crispEdges").style("stroke-linecap","square").style("stroke-width",f).attr("y1",l.range()[0]).attr("y2",l.range()[0]).attr("x1",o).attr("x2",o);k.merge(z).style("stroke",u).style("stroke-width",f).transition().duration(n).attr("y1",s.range()[1]).attr("y2",s.range()[0]).attr("x1",i).attr("x2",i);var N="numeric"===r.type?r.slice().sort(mu):r;function A(t){if("default"!==J.tick_label_position)return cc(b+(r.max_box_width-t.box_width),("above"===J.tick_label_position?-.3:1)*y);var e=-J.tick_label_angle;if(0===e)return cc(b,.33*y);var n=cc(b,0)+" "+uc(e);return-90===e&&(n+=" "+cc(t.text_width/2,0)),n}var D=V.selectAll("g").data(N,function(t){return t.type+"-"+t.value}),T=D.exit();T.transition().duration(n).attr("transform",function(t){return cc(i,c(t.value))}).style("opacity",0).remove(),T.each(function(){var t=ce(this);t.select("line").style("stroke",u).style("stroke-width",f).transition().duration(n).attr("x2",-_),t.select("text").text(function(t){return t.text}).style("fill",d).style("font-size",y+"px").style("font-weight",J.tick_label_weight).attr("transform",A).transition().duration(n)});var I=D.enter().append("g");I.attr("transform",function(t){return cc(o,l(t.value))}),I.each(function(){var t=ce(this);t.append("line").attr("x2",_),t.append("text").attr("text-anchor","start").attr("transform",A).call(_u)});var L=D.merge(I);L.transition().duration(n).attr("transform",function(t){return cc(i,s(t.value))});var S,E,C=(S=[],E=i+b,function(t){for(var e=s(t.value),n=[E,e],r=[n,[E-t.box_width_above,e-t.box_height_above]],i=[n,[E-t.box_width_below,e+t.box_height_below]],a=0;a<S.length;a++){var o=S[a];if(e>=o.y_anchor){if(hc(r,o.q))return 0}else if(hc(o.p,i))return 0}return S.push({y_anchor:e,p:r,q:i}),1});L.each(function(){var t=ce(this);t.select("line").style("stroke",u).style("stroke-width",f).transition().duration(n).attr("x2",_),t.select("text").text(function(t){return t.text}).style("fill",d).style("font-size",y+"px").style("font-weight",J.tick_label_weight).transition().duration(n).style("opacity",C).attr("transform",A)});var O=X.selectAll("text").data(t&&v?[v]:[]);O.exit().remove();var P=function(){return cc(i,j)+" "+uc(-90)+" "+cc(0,w)};O.enter().append("text").attr("text-anchor","middle").style("font-size",x+"px").style("fill",J.title_color).style("font-weight",J.title_weight).call(_u).transition().duration(0).delay(n).text(function(t){return t}).attr("x",0).attr("y",0).attr("transform",P),O.text(function(t){return t}).style("fill",J.title_color).style("font-size",x+"px").style("font-weight",J.title_weight).transition().duration(n).attr("x",0).attr("y",0).attr("transform",P),G=e,q=s});return function(){o(),s(),l()}}var vu={solid:null,dash:[4,1],dot:[1,1],dot_dash:[4,1,1,1]};function xu(t){if("solid"===t)return null;var e=ic(1)/4;return vu[t].map(function(t){return t*e}).join(" ")}function wu(l,c){var u,f,d,p,h,o,s,g,m,_,y,b,v,x,w,M,j,k,z,N,a=(f=(u=l).chart.select("clipPath.fl-data-clip-path"),d=f.select("rect"),p=u.chart.select(".fl-data-background"),h=u.chart.select(".fl-data-foreground"),function(){var t=u.identifier()+"-clip-path",e="url(#"+t+")";f.attr("id",t),p.attr("clip-path",e),h.attr("clip-path",e);var n=u.xScale().range(),r=u.yScale().range(),i=u.clip(),a=i.left?n[0]:0,o=i.top?r[1]:0,s=(i.right?n[1]:u.width())-a,l=(i.bottom?r[0]:u.height())-o;d.attr("x",a).attr("y",o).attr("width",s).attr("height",l)}),A=(o=l,s=c.background,g=o.chart.select("rect.fl-chart-fill"),m=o.chart.select("image.fl-chart-image"),_=o.chart.select("rect.fl-chart-interaction"),function(){var t=o.xScale().range(),e=o.yScale().range(),n=t[0],r=e[1],i=o.plot_width,a=o.plot_height;g.attr("x",n).attr("y",r).attr("width",i).attr("height",a).attr("fill",s.background_color_enabled?s.background_color:"none"),m.attr("x",n).attr("y",r).attr("width",i).attr("height",a).attr("xlink:href",s.background_image_enabled?s.background_image_src:null).attr("preserveAspectRatio",function(){return"stretch"==s.background_image_size?"none":s.background_image_position+" "+s.background_image_size}),_.attr("x",n).attr("y",r).attr("width",i).attr("height",a)}),D=bu(l,c),T=(y=l,M=(b=c).x,j=b.y,k=b.y2,z=y.chart.select("g.fl-gridlines-vertical"),N=y.chart.select("g.fl-gridlines-horizontal"),function(){var e=mc(y.xScale()),n=mc(y.yScale()),r=mc(y.y2Scale());x=x||n,w=w||r;var t=(v=v||e)?y.animationDuration():0,i=-1!==["top","float-above"].indexOf(M.axis_position),a=function(t){if(!b[t].gridlines_visible)return[];var e=y[t+"Hide"]();return e&&!e.keep_gridlines?[]:y[t+"Ticks"]()},o=a("x"),s=a("y"),l=a("y2"),c=o.map(function(t){return{type:t.type,value:t.value,dasharray:xu(M.gridline_style),stroke:M.gridline_color,width:ic(M.gridline_width,!0),y_exit:i?n.range()[1]:n.range()[0],x_enter:v(t.value),y_enter:i?x.range()[1]:x.range()[0],x:e(t.value),y1:n.range()[0],y2:n.range()[1]}}),u=s.map(function(t){return{axis:"y",type:t.type,value:t.value,dasharray:xu(j.gridline_style),stroke:j.gridline_color,width:ic(j.gridline_width,!0),x_exit:e.range()[0],x_enter:v.range()[0],y_enter:x(t.value),x1:e.range()[0],x2:e.range()[1],y:n(t.value)}}).concat(l.map(function(t){return{axis:"y2",type:t.type,value:t.value,dasharray:xu(k.gridline_style),stroke:k.gridline_color,width:ic(k.gridline_width),x_exit:e.range()[1],x_enter:v.range()[1],y_enter:w(t.value),x1:e.range()[0],x2:e.range()[1],y:r(t.value)}})),f=z.selectAll("line").data(c,function(t){return t.type+"-"+t.value});f.exit().attr("stroke-dasharray",function(t){return t.dasharray}).style("stroke",function(t){return t.stroke}).style("stroke-width",function(t){return t.width}).transition().duration(t).attr("y1",function(t){return t.y_exit}).attr("y2",function(t){return t.y_exit}).remove();var d=f.enter().append("line").style("shape-rendering","crispEdges").attr("x1",function(t){return t.x_enter}).attr("x2",function(t){return t.x_enter}).attr("y1",function(t){return t.y_enter}).attr("y2",function(t){return t.y_enter});f.merge(d).attr("stroke-dasharray",function(t){return t.dasharray}).style("stroke",function(t){return t.stroke}).style("stroke-width",function(t){return t.width}).transition().duration(t).attr("x1",function(t){return t.x}).attr("x2",function(t){return t.x}).attr("y1",function(t){return t.y1}).attr("y2",function(t){return t.y2});var p=N.selectAll("line").data(u,function(t){return t.axis+"-"+t.type+"-"+t.value});p.exit().attr("stroke-dasharray",function(t){return t.dasharray}).style("stroke",function(t){return t.stroke}).style("stroke-width",function(t){return t.width}).transition().duration(t).attr("x1",function(t){return t.x_exit}).attr("x2",function(t){return t.x_exit}).remove();var h=p.enter().append("line").style("shape-rendering","crispEdges").attr("x1",function(t){return t.x_enter}).attr("x2",function(t){return t.x_enter}).attr("y1",function(t){return t.y_enter}).attr("y2",function(t){return t.y_enter});p.merge(h).attr("stroke-dasharray",function(t){return t.dasharray}).style("stroke",function(t){return t.stroke}).style("stroke-width",function(t){return t.width}).transition().duration(t).attr("x1",function(t){return t.x1}).attr("x2",function(t){return t.x2}).attr("y1",function(t){return t.y}).attr("y2",function(t){return t.y}),v=e,x=n,w=r});return function(t){var n,r,e,i;return t=t||{},n=parseFloat(getComputedStyle(document.documentElement).fontSize),r=window.devicePixelRatio,ic=function(t,e){return t?e?Math.max(Math.round(t*n*r),1)/r:t*n:0},e=null,(l.offsetLeft()||l.offsetTop())&&(e="translate("+l.offsetLeft()+","+l.offsetTop()+")"),l.chart.attr("transform",e),function(){var t,e=l.xScale({domain_only:!0}),n=l.xData();if(n.string_array)t=e.domain();else if("number"===c.x.tick_mode)t=e.ticks(c.x.tick_number);else if("custom"===c.x.tick_mode){var r=yc(c.x.tick_custom),i=e.domain(),a=i[0]<i[1]?i[0]:i[1],o=i[0]>i[1]?i[0]:i[1];if(n.datetime_array){var s=l.xDatetimeParse();t=r.map(function(t){return s(t)}).filter(function(t){return _c(t)&&a<=t&&t<=o})}else s=l.xNumberParse(),t=r.map(function(t){return s(t)}).filter(function(t){return!isNaN(t)&&a<=t&&t<=o})}else t=e.ticks();l.xTicks._update(t)}(),function(){var t,e=l.yScale({domain_only:!0}),n=l.yData();if(n.string_array)t=e.domain();else if("number"===c.y.tick_mode)t=e.ticks(c.y.tick_number);else if("custom"===c.y.tick_mode){var r=yc(c.y.tick_custom),i=e.domain(),a=i[0]<i[1]?i[0]:i[1],o=i[0]>i[1]?i[0]:i[1];if(n.datetime_array){var s=l.yDatetimeParse();t=r.map(function(t){return s(t)}).filter(function(t){return _c(t)&&a<=t&&t<=o})}else s=l.yNumberParse(),t=r.map(function(t){return s(t)}).filter(function(t){return!isNaN(t)&&a<=t&&t<=o})}else t=e.ticks();l.yTicks._update(t)}(),function(){var t,e=l.y2Scale({domain_only:!0}),n=l.y2Data();if(n.string_array)t=e.domain();else if("number"===c.y2.tick_mode)t=e.ticks(c.y2.tick_number);else if("custom"===c.y2.tick_mode){var r=yc(c.y2.tick_custom),i=e.domain(),a=i[0]<i[1]?i[0]:i[1],o=i[0]>i[1]?i[0]:i[1];if(n.datetime_array){var s=l.y2DatetimeParse();t=r.map(function(t){return s(t)}).filter(function(t){return _c(t)&&a<=t&&t<=o})}else s=l.y2NumberParse(),t=r.map(function(t){return s(t)}).filter(function(t){return!isNaN(t)&&a<=t&&t<=o})}else t=e.ticks();l.y2Ticks._update(t)}(),i=t.margins,l.margins._update(i),t.skip_rendering||(a(),A(),D(),T()),l}}function Mu(t,e){e=so(e);var n,r,i,a,o,s,l,c,u,f={},d=function(t){var e,n=(e=t&&t.select&&t.selectAll?ce(t.node()):ce(t)).node();if(!n)throw new Error("Chart layout instance must have a target");var r=lo(n);return{container:e,getSvg:function(){if(r)return e;for(var t=n.parentElement;t&&!lo(t);)t=t.parentElement;if(!lo(t))throw new Error("target must be an SVG or a descendant of an SVG");return ce(t)}}}(t);Object.defineProperty(f,"svg",{get:d.getSvg}),f.container=d.container,f.chart=((i=f.container.append("g").attr("class","fl-chart")).append("clipPath").attr("class","fl-data-clip-path").append("rect"),(n=i.append("g").attr("class","fl-chart-background")).append("rect").attr("class","fl-chart-fill"),n.append("image").attr("class","fl-chart-image"),n.append("rect").attr("class","fl-chart-interaction").style("opacity",0),i.append("g").attr("class","fl-data-background"),(r=i.append("g").attr("class","fl-gridlines").style("pointer-events","none")).append("g").attr("class","fl-gridlines-vertical"),r.append("g").attr("class","fl-gridlines-horizontal"),function(t){var e=t.append("g").attr("class","fl-axes"),n=e.append("g").attr("class","fl-x-axes"),r=e.append("g").attr("class","fl-y-axes"),i=n.append("g").attr("class","fl-axis fl-x-axis fl-bottom-axis");i.append("g").attr("class","fl-axis-line"),i.append("g").attr("class","fl-axis-ticks"),i.append("g").attr("class","fl-axis-title");var a=n.append("g").attr("class","fl-axis fl-x-axis fl-top-axis");a.append("g").attr("class","fl-axis-line"),a.append("g").attr("class","fl-axis-ticks"),a.append("g").attr("class","fl-axis-title");var o=r.append("g").attr("class","fl-axis fl-y-axis fl-left-axis");o.append("g").attr("class","fl-axis-line"),o.append("g").attr("class","fl-axis-ticks"),o.append("g").attr("class","fl-axis-title");var s=r.append("g").attr("class","fl-axis fl-y-axis fl-right-axis");s.append("g").attr("class","fl-axis-line"),s.append("g").attr("class","fl-axis-ticks"),s.append("g").attr("class","fl-axis-title")}(i),i.append("g").attr("class","fl-data-foreground"),i),f.data_background=f.chart.select("g.fl-data-background"),f.data_foreground=f.chart.select("g.fl-data-foreground"),f.identifier=(a=f,o="fl-chart-layout-"+co++,function(t){return void 0===t?o:(o=t,a)}),f.clip=(s=f,l=uo,function(t){return void 0===t?l:(l=t?"object"!=typeof t?uo:Object.freeze({left:!!t.left,top:!!t.top,right:!!t.right,bottom:!!t.bottom}):fo,s)}),f.animationDuration=(c=f,u=0,function(t){return void 0===t?u:(u=t,c)});var p,h,g,m,_,y,b,v,x,w,M,j,k,z,N,A,D,T,I,L,S,E,C,O,P,Y,F=(p=f,_=m=g=null,(h={}).width=function(t){return void 0===t?null!==g?g:p.svg.node().getBoundingClientRect().width:(g=t,p)},h.height=function(t){return void 0===t?null!==m?m:null!==_?h.plotHeight()+p.margins.top+p.margins.bottom:null!==m?m:p.svg.node().getBoundingClientRect().height:(m=t,_=null,p)},h.plotAspect=function(t){return void 0===t?null!==_?_:h.plotWidth()/h.plotHeight():(m=null,_=t,p)},h.plotWidth=function(){return p.width()-(p.margins.right+p.margins.left)},h.plotHeight=function(){return null===_?h.height()-(p.margins.top+p.margins.bottom):h.plotWidth()/_},h);return f.width=F.width,f.height=F.height,f.plotAspect=F.plotAspect,Object.defineProperty(f,"plot_width",{get:F.plotWidth}),Object.defineProperty(f,"plot_height",{get:F.plotHeight}),f.offsetLeft=(y=f,b=0,function(t){return void 0===t?b:(b=t,y)}),f.offsetTop=(v=f,x=0,function(t){return void 0===t?x:(x=t,v)}),f.margins=Dc(f,e),f.xData=sc(f),f.yData=sc(f),f.y2Data=sc(f),f.xFormat=ss(f),f.yFormat=ss(f),f.y2Format=ss(f),f.xNumberParse=Nl(f),f.yNumberParse=Nl(f),f.y2NumberParse=Nl(f),f.xDatetimeParse=Al(f),f.yDatetimeParse=Al(f),f.y2DatetimeParse=Al(f),f.xTitle=(M=e,(w=f).xAutoTitle=kc(w),w.xAutoTitle("X"),function(){return("auto"===M.x.title_mode?w.xAutoTitle():M.x.title).trim()}),f.yTitle=(k=e,(j=f).yAutoTitle=kc(j),j.yAutoTitle("Y"),function(){return("auto"===k.y.title_mode?j.yAutoTitle():k.y.title).trim()}),f.y2Title=(N=e,(z=f).y2AutoTitle=kc(z),z.y2AutoTitle("Y2"),function(){return("auto"===N.y2.title_mode?z.y2AutoTitle():N.y2.title).trim()}),f.xTicks=(A=f,D=e.x,T=Object.freeze([]),I=A.chart.select(".fl-x-axes"),(L=function(){return T})._update=function(t){var _,y=A.xData().string_array?"string":"numeric",e=lc(ce(".fl-x-axes"),D.tick_label_size,D.tick_label_weight),b="default"===D.tick_label_position?+D.tick_label_angle:90,v=0,x=A.xFormat();I.append("text").style("opacity",0).style("font",e).each(function(){var t=ce(this).text(bc).node().getBoundingClientRect();_=t.height}).remove(),"object"==typeof t[0]&&xc(t,x);var n=ic(D.tick_label_space);"auto"===D.tick_label_space_mode&&(n=A.xTicks.autoLabelSpace().px);var w=wc({text_height:_,max_space:n,font:e,angle:90-b});return(T=t.map(function(t,e){var n,r,i,a,o,s,l=w(x(t)),c=l.text,u=l.text_width;if(0===b||90===b)i=a=(n=0===b?u+ic(.5):_)/2,s=o=r=0===b?_:u;else{var f=vc(b),d=Math.sin(f),p=Math.cos(f);n=(i=u*p)+(a=_*d),r=(o=u*d)+(s=_*p)}if("top"===D.axis_position||"float-above"===D.axis_position){var h=i;i=a,a=h,h=o,o=s,s=h}v=Math.max(v,r);var g="numeric"===y?pc(t):null,m="numeric"===y?dc(t):null;return Object.freeze({index:e,value:t,text:c,significant_digits:g,exponent:m,text_width:u,text_height:_,box_width:n,box_height:r,box_width_left:i,box_width_right:a,box_height_left:o,box_height_right:s})})).type=y,T.max_box_height="fixed"===D.tick_label_space_mode?ic(D.tick_label_space):v,Object.freeze(T),A},L.autoLabelSpace=Mc(A,"height"),L),f.yTicks=jc(f,e,"y"),f.y2Ticks=jc(f,e,"y2"),f.xScale=(S=f,E=e,function(t){var e;t=t||{};var n=S.xData();if(e=n.string_array?uu(n):n.datetime_array?pu(n,E.x.datetime_min,E.x.datetime_max,S.xDatetimeParse()):"log"===E.x.numeric_scale_type?du(n,E.x.log_min,E.x.log_max):fu(n,E.x.linear_min,E.x.linear_max,S.xZeroAxis()),t.domain_only)return e;var r=S.plot_width,i=S.margins.left,a=[i,i+r],o=t.global&&S.offsetLeft();return o&&(a=a.map(function(t){return t+o})),e.range(a)}),f.yScale=(C=f,O=e.y,function(t){var e;t=t||{};var n=C.yData();if(e=n.string_array?uu(n):n.datetime_array?pu(n,O.datetime_min,O.datetime_max,C.yDatetimeParse()):"log"===O.numeric_scale_type?du(n,O.log_min,O.log_max):fu(n,O.linear_min,O.linear_max,C.yZeroAxis()),t.domain_only)return e;var r=C.plot_height,i=C.margins.top,a=[i,i+r],o=t.global&&C.offsetTop();return o&&(a=a.map(function(t){return t+o})),e.range(a.reverse())}),f.y2Scale=(P=f,Y=e.y2,function(t){var e;t=t||{};var n=P.y2Data();if(e=n.string_array?uu(n):n.datetime_array?pu(n,Y.datetime_min,Y.datetime_max,P.y2DatetimeParse()):"log"===Y.numeric_scale_type?du(n,Y.log_min,Y.log_max):fu(n,Y.linear_min,Y.linear_max,P.y2ZeroAxis()),t.domain_only)return e;var r=P.plot_height,i=P.margins.top,a=[i,i+r],o=t.global&&P.offsetTop();return o&&(a=a.map(function(t){return t+o})),e.range(a.reverse())}),f.xZeroAxis=hu(f),f.yZeroAxis=hu(f),f.y2ZeroAxis=hu(f),f.xHide=gu(f),f.yHide=gu(f),f.y2Hide=gu(f),f.update=wu(f,e),f}var ju={render_mode:"svg",height_mode:"auto",facet_aspect:62,beeswarm_plot:!1,box_plot:!1,box_line_width:1,box_line_color:"#333333",box_opacity:.7,box_color:"#ffffff",box_whisker_type:"tukey",box_whisker_multiplier:1.5,violin_plot:!1,violin_bandwidth:null,violin_color:"#DADADA",violin_opacity:.8,violin_sizing:"area",violin_samples:50,facet_min_w:150,facet_min_h:100,facet_fixed_cols:!1,facet_cols:2,facet_gutter_w:1,facet_gutter_h:1,facet_header_color:"#888888",facet_header_font_size:1.25,facet_title_align:"auto",popup:{},popup_color_headings:!0,popup_sticky:!0,highlighted:null,popup_parse_numbers:!0,color_type:"auto",color:{},spectrum:"interpolateCool",legend_position:"above",legend_filtering_mode:"filter_out",text_legend:"off",text_legend_title:!0,text_legend_subtitle:!0,text_legend_bold:!0,legend_filter:[],categorical_legend:{swatch_width:1,swatch_radius:10},continuous_legend:{},lines_show:!0,line_width_responsive:!0,line_width:1,line_width_min:.75,line_width_max:1.25,line_opacity:1,line_curve:"curveLinear",line_color_mode:"by_dot",line_color:"#000000",line_animate_on_load:!0,line_arrows:!1,line_arrow_size:5,line_arrow_color_mode:"auto",line_arrow_color:"#000000",show_dots:!0,data_point_default_size:50,data_point_min_size:5,data_point_max_size:500,fill_opacity:.8,stroke_opacity:0,stroke_width:1,default_color:"#1D6996",default_shape:"symbolCircle",responsive_dots:!0,stroke_mode:"auto",stroke_color:"#1D6996",labels_show:!1,labels_selective:!1,labels_selected:[],label_color:null,label_color_type:"auto",label_font_size:12,labels_responsive:!0,label_font_size_min:9,label_font_size_max:12,label_bg_size:20,label_align:"auto",animation_duration:1,animation_stagger:0,margin_top:1,margin_right:0,margin_bottom:0,margin_left:0,x:{},x_type:"auto",x_matching:!0,x_single_row:!0,y:{},y_type:"auto",y_matching:!0,y_single_col:!0,chart_bg:{},filter:{type:"categorical",sort:!1},filter_updates_axes:!0,filter_show_all:!0,filter_show_all_text:"All",slider:{control:"slider",type:"temporal",sort:!0},slider_updates_axes:!1,fit_type:"none",fit_force_origin:!1,fit_line_color:"#999999",fit_line_width:1,fit_line_dash:0,annotations:{},anno_x_enabled:!1,anno_x_lines:"",anno_x_line_color:"#333333",anno_x_line_width:2,anno_x_line_dash:"2",anno_x_areas:"",anno_x_fill_color:"#555555",anno_x_fill_opacity:.1,anno_x_label_align:"right",anno_x_label_color:"#888888",anno_x_label_font_size:.75,anno_y_enabled:!1,anno_y_lines:"",anno_y_line_color:"#333333",anno_y_line_width:2,anno_y_line_dash:"2",anno_y_areas:"",anno_y_fill_color:"#555555",anno_y_fill_opacity:.1,anno_y_label_align:"right",anno_y_label_color:"#888888",anno_y_label_font_size:.75,time_label_show:!0,time_label_font_size:100,time_label_color:"#333333",time_label_opacity:.1,sort_categories:"spreadsheet",layout:{margin:10},localization:{},x_formatting:{},y_formatting:{},color_formatting:{}};function ku(t){return Mu(t,{x:ju.x,y:ju.y,background:ju.chart_bg})}var zu=".controls-container {\tdisplay: inline-block;}.controls-container, .controls-container * {\tbox-sizing: border-box;\ttext-align: left;\tvertical-align: bottom;}.button-container .button, .dropdown .current {\toverflow: hidden;\ttext-overflow: ellipsis;\theight: 100%;\twhite-space: nowrap;\ttext-align: left;\tfont-size: 12px;\tline-height: 21px;}.button-container .button, .dropdown .current, .dropdown .list .list-item {\twhite-space: nowrap;}.slider, .slider-play {\tpointer-events: all;\tvertical-align: bottom;\tdisplay: inline-block;}.button {\tdisplay: inline-block;\tcursor: pointer}.button:hover {\topacity: .5}.button.selected, .button.selected:hover {\tcolor: #fff;\tcursor: default;\topacity: 1;\tbackground-image: linear-gradient(transparent, rgba(0, 0, 0, .05) 40%, rgba(0, 0, 0, .1))}.button-container {\tpointer-events: all;\twidth: auto;\tline-height: 0;\tmargin-bottom: 18px;\twidth: 100%;\ttext-align: center;}.button-container.button-group {\tdisplay: table;\tborder: 1px solid #ccc;\twidth: 100%;\ttable-layout: fixed;\tborder-radius: 3px;\tmargin-bottom: 20px;\toverflow: hidden;}.button-container .button {\tfont-size: 12px;\tborder: 1px solid #ccc;\tbackground: #fff;\tpadding: 0.1em 0.6em 0;\tcolor: #333;\tfont-weight: 400;\ttext-align: center;\theight: 24px;\tborder-radius: 3px;\tmargin: 0 1px 2px;}.button-container.button-group .button {\tborder: none;\tborder-left: 1px solid #ccc;\tborder-radius: 0;\tdisplay: table-cell;\ttext-align: center;\tvertical-align: middle;\tmargin: 0;\theight: 22px;}.button-container .button:hover {\tbackground: #eee;\topacity: .8}.button-container.button-group .button:first-child {\tborder: none}.button-container .button.selected, .button-container .button.selected:hover {\topacity: 1;\tbackground: #ececec;\tcolor: #333}.dropdown {\tpointer-events: all;\tdisplay: inline-table;\tcolor: #333;\tfont-weight: 400;\tfont-size: 16px;\tposition: relative}.dropdown .heading {\tmargin-bottom: .4em;\tfont-weight: 300}.dropdown .main {\tbackground: #fff;\tpadding: 0 20px 0 6px;\tcursor: pointer;\tposition: relative;\tborder: 1px solid #ccc;\tborder-radius: 3px;\theight: 24px;\tline-height: 26px}.dropdown .list, .dropdown .symbol {\tposition: absolute}.dropdown .current {\theight: 100%;\twidth: 100%;\tdisplay: inline-block;\tvertical-align: top;\tpadding: 0.1em 0 0;}.dropdown .symbol {\twidth: 30px;\theight: 100%;\tright: 0;\ttop: 0;\tbackground: 80% 40% no-repeat;\tbackground-size: auto 50%;\tdisplay: inline-block}.dropdown .list {\tleft: 2px;\tmin-width: calc(100% - 4px);\tbackground: rgba(255, 255, 255, 1);\tpadding: 0 2px;\ttext-align: left;\tdisplay: none;\tline-height: 1.4em;\tmax-height: 160px;\toverflow-y: scroll;\tcolor: #333;\tbox-shadow: 0 1px 2px rgba(0, 0, 0, .2);}.dropdown .list .list-item {\tfont-size: 12px;\theight: 24px;\tpadding: 0 5px}.dropdown .list .list-item:hover {\tcursor: pointer;\tbackground: #eee}.dropdown.open .list {\tdisplay: block;\tz-index: 1}.dropdown .list .list-item.selected, .dropdown .list .list-item.selected:hover {\tcolor: #57c1fc;\tcursor: default;\topacity: 1}.dropdown .list .list-item.header, .dropdown .list .list-item.header:hover {\tfont-size: .66em;\tletter-spacing: 1px;\ttext-transform: uppercase;\tcolor: #888;\topacity: 1;\tcursor: default;\tfont-weight: 300;\tmargin-top: .5em}.dropdown .list .list-item.header:first-child {\tmargin-top: 0}.controls-container .dropdown {\tmargin: 0 0 20px;}.controls-container .dropdown .heading {\tcolor: #333}.slider-holder {\tmargin-bottom: 20px}.slider-play {\twidth: 24px;\theight: 24px;\tbackground-repeat: no-repeat;\tbackground-size: 100% 100%;\tbackground-position: center;\tcursor: pointer;\tpadding-right: 2px}.slider, .slider-holder.animatable .slider-play {\tdisplay: inline-block}.slider-play:hover {\topacity: .7}.slider {\theight: 46px;\twidth: 100%;\tbottom: 0}.slider-holder.animatable .slider {\twidth: calc(100% - 37px)}.slider .tick line {\tstroke: #333}.slider text {\tfill: #333}.slider .slider-end-labels {\tfont-size: 11px;\tfill: #9e9e9e}@media(min-width:520px) {\t.dropdown .main {\t\theight: 30px;\t}\t.slider-play {\t\twidth: 30px;\t\theight: 30px\t}\t.button-container .button, .dropdown .current {\t\tfont-size: 14px;\t\tline-height: 26px;\t\theight: 30px;\t}\t.button-container.button-group .button {\t\theight: 28px;\t}\t.dropdown .list .list-item {\t\theight: 30px;\t\tfont-size: 14px;\t\tline-height: 27px;\t}}";function Nu(t){return"url('data:image/svg+xml;base64,"+window.btoa(t)+"')"}var Au=!1;function Du(){return parseFloat}function Tu(){return function(t){return t.toString()}}function Iu(t){return t.toLowerCase()}function Lu(n,r,t){var e,i={},a=ce(t).append("div").attr("class","dropdown"),o=a.node(),s=a.append("div").attr("class","main"),l=s.append("span").attr("class","current"),c=s.append("span").attr("class","symbol"),u=a.append("div").attr("class","list"),f=function(){a.classed("open",!1)},d=function(){a.classed("open")?f():(a.classed("open",!0),u.style("top","100%"),u.style("bottom",null),u.node().getBoundingClientRect().bottom>window.innerHeight&&(u.style("top",null),u.style("bottom","100%")))},p=function(){e!==r.dropdown_icon_color&&(e=r.dropdown_icon_color,c.style("background-image",Nu('<svg width="6px" height="12px" viewBox="0 0 6 12" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g transform="translate(-442.000000, -44.000000)" fill="'+e+'"> <g id="Group" transform="translate(442.000000, 44.000000)"> <polygon id="Triangle-2" points="3 0 6 5 0 5"></polygon> <polygon id="Triangle-2-Copy" points="3 12 0 7 6 7"></polygon> </g> </g> </svg>')))};s.on("click",function(){d()});var h=function(){if(a.classed("open")){for(var t=event.target,e=t.parentElement;e;){if(t===o)return;e=(t=e).parentElement}f()}},g=function(){a.style("width",r.width+"px").style("display","inline-table"),a.select(".main").style("width",r.width+"px")},m=function(){f(),a.style("display","none")};return i.appendedToDOM=function(){return document.querySelector("body").addEventListener("click",h,!1),i},i.removedFromDOM=function(){return document.querySelector("body").removeEventListener("click",h),i},i.show=g,i.hide=m,i.update=function(t){if(u.text(""),!n.n_options||"dropdown"!==r.control&&"auto"!==r.control)return m(),i;u.text("").selectAll(".list-item").data(t).enter().append("div").attr("class","list-item").text(function(t){return t.display}).on("click",function(t){f();var e=t.options_index;e!==n.index()&&(n.index(e),l.text(t.display).attr("title",t.display),n.trigger("change"))});var e=t[n.getSortedIndex()].display;return l.text(e).attr("title",e),p(),g(),i},i}var Su=Array.prototype.slice;function Eu(t){return t}var Cu=1,Ou=2,Pu=3,Yu=4,Fu=1e-6;function Bu(t){return"translate("+(t+.5)+",0)"}function Uu(t){return"translate(0,"+(t+.5)+")"}function Ru(){return!this.__axis}function Hu(g,m){var _=[],y=null,b=null,v=6,x=6,w=3,M=g===Cu||g===Yu?-1:1,j=g===Yu||g===Ou?"x":"y",k=g===Cu||g===Pu?Bu:Uu;function e(t){var e=null==y?m.ticks?m.ticks.apply(m,_):m.domain():y,n=null==b?m.tickFormat?m.tickFormat.apply(m,_):Eu:b,r=Math.max(v,0)+w,i=m.range(),a=+i[0]+.5,o=+i[i.length-1]+.5,s=(m.bandwidth?function(e){var n=Math.max(0,e.bandwidth()-1)/2;return e.round()&&(n=Math.round(n)),function(t){return+e(t)+n}}:function(e){return function(t){return+e(t)}})(m.copy()),l=t.selection?t.selection():t,c=l.selectAll(".domain").data([null]),u=l.selectAll(".tick").data(e,m).order(),f=u.exit(),d=u.enter().append("g").attr("class","tick"),p=u.select("line"),h=u.select("text");c=c.merge(c.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),u=u.merge(d),p=p.merge(d.append("line").attr("stroke","currentColor").attr(j+"2",M*v)),h=h.merge(d.append("text").attr("fill","currentColor").attr(j,M*r).attr("dy",g===Cu?"0em":g===Pu?"0.71em":"0.32em")),t!==l&&(c=c.transition(t),u=u.transition(t),p=p.transition(t),h=h.transition(t),f=f.transition(t).attr("opacity",Fu).attr("transform",function(t){return isFinite(t=s(t))?k(t):this.getAttribute("transform")}),d.attr("opacity",Fu).attr("transform",function(t){var e=this.parentNode.__axis;return k(e&&isFinite(e=e(t))?e:s(t))})),f.remove(),c.attr("d",g===Yu||g==Ou?x?"M"+M*x+","+a+"H0.5V"+o+"H"+M*x:"M0.5,"+a+"V"+o:x?"M"+a+","+M*x+"V0.5H"+o+"V"+M*x:"M"+a+",0.5H"+o),u.attr("opacity",1).attr("transform",function(t){return k(s(t))}),p.attr(j+"2",M*v),h.attr(j,M*r).text(n),l.filter(Ru).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",g===Ou?"start":g===Yu?"end":"middle"),l.each(function(){this.__axis=s})}return e.scale=function(t){return arguments.length?(m=t,e):m},e.ticks=function(){return _=Su.call(arguments),e},e.tickArguments=function(t){return arguments.length?(_=null==t?[]:Su.call(t),e):_.slice()},e.tickValues=function(t){return arguments.length?(y=null==t?null:Su.call(t),e):y&&y.slice()},e.tickFormat=function(t){return arguments.length?(b=t,e):b},e.tickSize=function(t){return arguments.length?(v=x=+t,e):v},e.tickSizeInner=function(t){return arguments.length?(v=+t,e):v},e.tickSizeOuter=function(t){return arguments.length?(x=+t,e):x},e.tickPadding=function(t){return arguments.length?(w=+t,e):w},e}var Zu=Array.prototype,Qu=Zu.map,Gu=Zu.slice;function qu(t){return+t}var Wu=[0,1];function Vu(e,n){return(n-=e=+e)?function(t){return(t-e)/n}:(t=n,function(){return t});var t}function Xu(t,e,n,r){var i=t[0],a=t[1],o=e[0],s=e[1];return o=a<i?(i=n(a,i),r(s,o)):(i=n(i,a),r(o,s)),function(t){return o(i(t))}}function Ju(n,t,e,r){var i=Math.min(n.length,t.length)-1,a=new Array(i),o=new Array(i),s=-1;for(n[i]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++s<i;)a[s]=e(n[s],n[s+1]),o[s]=r(t[s],t[s+1]);return function(t){var e=we(n,t,1,i)-1;return o[e](a[e](t))}}function Ku(s){var l=s.domain;return s.ticks=function(t){var e=l();return Ie(e[0],e[e.length-1],null==t?10:t)},s.tickFormat=function(t,e){return function(t,e,n){var r,i=t[0],a=t[t.length-1],o=Se(i,a,null==e?10:e);switch((n=Qr(null==n?",f":n)).type){case"s":var s=Math.max(Math.abs(i),Math.abs(a));return null!=n.precision||isNaN(r=ri(o,s))||(n.precision=r),Kr(n,s);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(r=ii(o,Math.max(Math.abs(i),Math.abs(a))))||(n.precision=r-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(r=ni(o))||(n.precision=r-2*("%"===n.type))}return Jr(n)}(l(),t,e)},s.nice=function(t){null==t&&(t=10);var e,n=l(),r=0,i=n.length-1,a=n[r],o=n[i];return o<a&&(e=a,a=o,o=e,e=r,r=i,i=e),0<(e=Le(a,o,t))?e=Le(a=Math.floor(a/e)*e,o=Math.ceil(o/e)*e,t):e<0&&(e=Le(a=Math.ceil(a*e)/e,o=Math.floor(o*e)/e,t)),0<e?(n[r]=Math.floor(a/e)*e,n[i]=Math.ceil(o/e)*e,l(n)):e<0&&(n[r]=Math.ceil(a*e)/e,n[i]=Math.floor(o*e)/e,l(n)),s},s}function $u(){var e=function(e,n){var r,a,o,s=Wu,l=Wu,c=hr,u=!1;function i(){return r=2<Math.min(s.length,l.length)?Ju:Xu,a=o=null,t}function t(t){return(a||(a=r(s,l,u?(i=e,function(e,n){var r=i(e=+e,n=+n);return function(t){return t<=e?0:n<=t?1:r(t)}}):e,c)))(+t);var i}return t.invert=function(t){return(o||(o=r(l,s,Vu,u?(i=n,function(e,n){var r=i(e=+e,n=+n);return function(t){return t<=0?e:1<=t?n:r(t)}}):n)))(+t);var i},t.domain=function(t){return arguments.length?(s=Qu.call(t,qu),i()):s.slice()},t.range=function(t){return arguments.length?(l=Gu.call(t),i()):l.slice()},t.rangeRound=function(t){return l=Gu.call(t),c=gr,i()},t.clamp=function(t){return arguments.length?(u=!!t,i()):u},t.interpolate=function(t){return arguments.length?(c=t,i()):c},i()}(Vu,ur);return e.copy=function(){return t=e,$u().domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp());var t},Ku(e)}function tf(t){this.container=ce(t),this._width=null,this._height=null,this._handleRadius=15,this._channelHeight=5,this._channelRadius=null,this._handleFill="black",this._channelFill="#eee",this._margin={top:null,left:null,right:null},this._domain=[0,1],this._value=null,this._snap=!1,this._scale=null,this._axis=!1,this._ticks=null,this._tickFormat=null,this._tickSize=null,this._label=null,this._labelSize=18,this._startLabel=null,this._startLabelBelow=!1,this._endLabel=null,this._endLabelBelow=!1,this._startEndLabelSize=16,this.handlers={change:[]}}function ef(e){0<e.length&&"_"==e.charAt(0)&&(tf.prototype[e.substr(1)]=function(t){return void 0===t?this[e]:(this[e]=t,this)})}var nf=new tf;for(var rf in nf)ef(rf);function af(t,e){return"boolean"==typeof t?t?Math.round(e):e:function t(e,n,r,i){if(void 0===r&&(r=0),void 0===i&&(i=e.length),i-r==0)return n;if(i-r==1)return e[r];if(i-r==2)return Math.abs(e[r]-n)<=Math.abs(e[r+1]-n)?e[r]:e[r+1];var a=r+Math.floor((i-r)/2),o=e[a],s=e[a-1];return s<=n&&n<=o?Math.abs(s-n)<=Math.abs(o-n)?s:o:o<=n?t(e,n,a,i):t(e,n,r,a)}(t,e)}function of(t){return new tf(t)}function sf(a,o,t){var e,n,r,s,l,c,u,f={},i=ce(t).append("div").attr("class","slider-holder animatable"),d=i.append("div").attr("class","slider-play"),p=i.append("div").attr("class","slider"),h=null,g=function(){clearTimeout(h),h=null},m=function(t){var e=s[t];e.options_index!==a.index()&&(a.index(e.options_index),a.trigger("change"))},_=of(p.node()).channelHeight(6).snap(!0).on("change",function(t){var e=null!==h;e&&g(),m(t),e&&b()}),y=function(){g(),i.classed("playing",!1),d.style("background-image",e),a._isPlaying_(!1),u=!1},b=function(){var t=a.getSortedIndex(),e=l[t],n=a.n_options-1,r=t<n?t+1:0;h=setTimeout(function(){m(r),o.loop||r<n?b():y()},e)},v=function(){i.classed("playing",!0),d.style("background-image",n),b(),a._isPlaying_(!0),u=!0};d.on("click",function(){null===h?v():y()});var x=function(){o.play_button?i.classed("animatable",!0):(y(),i.classed("animatable",!1)),r!==o.slider_handle_color&&(_.update(),r=o.slider_handle_color,i.select(".slider-handle").style("fill",r),e=Nu('<svg width="25px" height="30px" viewBox="0 0 25 30" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <polygon id="Triangle" fill="'+r+'" stroke="none" points="25 15 0 30 0 0"></polygon> </svg>'),n=Nu('<svg width="26px" height="30px" viewBox="0 0 26 30" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g stroke="none" stroke-width="1" fill="'+r+'"><rect x="2" y="2" width="9" height="26"></rect> <rect x="15" y="2" width="9" height="26"></rect> </g> </svg>'),d.style("background-image",h?n:e))},w=function(){return i.style("display","inline-block"),function(){i.style("width",o.width+"px"),d.style("display",o.play_button?null:"none");var t=i.node().getBoundingClientRect().width,e=d.node().getBoundingClientRect().width;p.style("width",Math.max(t-e,1)+"px");var n=window.innerWidth,r=n<520?12:15;_.labelSize(n<520?12:14).handleRadius(r).margin({left:r+5,right:r,top:n<520?33:31})}(),x(),f},M=function(){return y(),i.style("display","none"),f};return f.show=w,f.hide=M,f.update=function(t){if(s=t,!a.n_options||"slider"!==o.control)return M(),f;w();var n=a.n_options,r=o.loop;l=s.map(function(t,e){return 1e3*(o.step_time+(r&&e===n-1?o.restart_pause:0))});var e=a.getSortedIndex(),i=s[e];return _.domain([0,n-1]).value(e).label(i.display).channelFill(o.slider_track_color).update(),(c=c||p.select("text.slider-label")).style("fill",o.slider_track_color),a._isPlaying_()&&!u?v():!a._isPlaying_()&&u&&y(),f},f}tf.prototype.margin=function(t){if(!t)return this._margin;for(rf in t){if(!(rf in this._margin))throw"Slider.margin: unrecognised option "+rf;this._margin[rf]=t[rf]}return this},tf.prototype.on=function(t,e){if(!(t in this.handlers))throw"Slider.on: No such event: "+t;return this.handlers[t].push(e),this},tf.prototype.fire=function(t,e){if(!(t in this.handlers))throw"Slider.fire: No such event: "+t;for(var n=this.handlers[t],r=0;r<n.length;r++)n[r].call(this,e);return this},tf.prototype.update=tf.prototype.draw=function(){var i=this,t=this._width,e=this._height,n=this.container.node();if(!t){var r=n.getBoundingClientRect();if(!r||0==r.width)return this;t=r.width,e=r.height}var a,o=null==this._channelRadius?this._channelHeight/2:this._channelRadius,s=null==this._margin.left?Math.max(this._handleRadius,o):this._margin.left,l=null==this._margin.right?Math.max(this._handleRadius,o):this._margin.right,c=null==this._margin.top?Math.max(this._handleRadius,this._channelHeight/2):this._margin.top,u=t-s-l,f=u+2*o,d=1.5*this._labelSize;null!=this._label&&null==this._margin.top&&(c+=d),"http://www.w3.org/2000/svg"==n.namespaceURI?a=this.container:((a=this.container.selectAll("svg").data([{width:t,height:e}])).exit().remove(),(a=a.enter().append("svg").merge(a)).attr("width",function(t){return t.width}).attr("height",function(t){return t.height}));var p=a.selectAll("g.slider-container").data([{left:s,top:c,id:this._id}]);p.exit().remove(),(p=p.enter().append("g").attr("class","slider-container").merge(p)).attr("transform",function(t){return"translate("+t.left+","+t.top+")"}).attr("id",function(t){return t.id}),this.scale=(this._scale?this._scale():$u()).domain(this._domain).range([0,u]),null==this._value||this._value<this._domain[0]?this._value=this._domain[0]:this._value>this._domain[1]&&(this._value=this._domain[1]),this._snap&&(this._value=af(this._snap,this._value));var h,g,m=[];this._axis&&(h="boolean"!=typeof this._axis?this._axis(this.scale):Hu(Pu,g).scale(this.scale).tickPadding(6),this._ticks&&h.ticks(this._ticks),this._tickFormat&&h.tickFormat(this._tickFormat),this._tickSize?h.tickSize(this._tickSize):h.tickSize(Math.max(5,this._handleRadius-this._channelHeight-2)),m.push(h));var _,y,b,v,x=p.selectAll(".slider-axis").data(m).enter();function w(){document.removeEventListener("mouseup",w,!1),document.removeEventListener("mousemove",M,!1)}function M(t){z(t.clientX-b)}function j(){document.removeEventListener("touchend",j,!1),document.removeEventListener("touchmove",k,!1)}function k(t){1==t.touches.length&&z(t.touches[0].clientX-b)}function z(t){var e=v+t,n=Math.max(0,Math.min(u,e)),r=i.scale.invert(n);i._snap&&(r=af(i._snap,r)),y.attr("cx",i.scale(r)),r!=i._value&&(i._value=r,i.fire("change",i._value))}x.append("g").attr("class","slider-axis").attr("transform","translate(0,"+this._channelHeight/2+")").each(function(t){t(ce(this))}),x.select(".domain").attr("fill","none"),x.selectAll(".tick line").attr("stroke","black"),x.exit().remove(),(_=p.selectAll(".slider-channel").data([{width:f,height:this._channelHeight,channel_r:o}])).exit().remove(),(_=_.enter().append("rect").attr("class","slider-channel").attr("cursor","pointer").on("click",function(){var t=Math.max(0,Math.min(u,ue(this)[0]));i._value=i.scale.invert(t),i._snap&&(i._value=af(i._snap,i._value)),y.attr("cx",i.scale(i._value)),i.fire("change",i._value)}).merge(_)).attr("width",function(t){return t.width}).attr("fill",this._channelFill).attr("height",function(t){return t.height}).attr("y",function(t){return-t.height/2}).attr("x",function(t){return-t.channel_r}).attr("rx",function(t){return t.channel_r}),(y=(y=p.selectAll(".slider-handle").data([{v:this._value,x:this.scale(this._value)}])).enter().append("circle").attr("class","slider-handle").attr("cursor","col-resize").merge(y)).attr("cx",function(t){return t.x}).attr("r",this._handleRadius).attr("fill",this._handleFill).on("mousedown",function(){var t;te.preventDefault(),t=te,document.addEventListener("mouseup",w,!1),document.addEventListener("mousemove",M,!1),b=t.clientX,v=i.scale(i._value)}).on("touchstart",function(){var t;te.preventDefault(),1==(t=te).touches.length&&(document.addEventListener("touchend",j,!1),document.addEventListener("touchmove",k,!1),b=t.touches[0].clientX,v=i.scale(i._value))});var N=[];this._label&&N.push({label:this._label,x:u/2,y:-d,font_size:this._labelSize});var A=p.selectAll(".slider-label").data(N);A.exit().remove(),(A=A.enter().append("text").attr("class","slider-label").attr("text-anchor","middle").attr("cursor","default").merge(A)).text(function(t){return t.label}).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("font-size",this._labelSize);var D=[];this._startLabel&&D.push({label:this._startLabel,x:this._startLabelBelow?0:-(o+5+Math.max(0,this._handleRadius-o)),y:this._startLabelBelow?o+15:this._startEndLabelSize/1.75-o/2,anchor:this._startLabelBelow?"middle":"end",font_size:this._startEndLabelSize}),this._endLabel&&D.push({label:this._endLabel,x:this._endLabelBelow?u:u+(o+Math.max(0,this._handleRadius-o)+5),y:this._startLabelBelow?o+15:this._startEndLabelSize/1.75-o/2,anchor:this._endLabelBelow?"middle":"start",font_size:this._startEndLabelSize});var T=p.selectAll(".slider-end-labels").data(D);return T.exit().remove(),(T=T.enter().append("text").attr("class","slider-end-labels").attr("pointer-events","none").merge(T)).text(function(t){return t.label}).attr("font-size",function(t){return t.font_size}).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("text-anchor",function(t){return t.anchor}),this},of.version="1.3.2";var lf=Object.freeze({type:"categorical",temporal_format:"%Y",sort:!0,control:"auto",width:200,play_button:!0,step_time:2,loop:!0,restart_pause:0,icon_color:"#5671AD",buttons_type:"grouped",dropdown_icon_color:"#000000",slider_handle_color:"#000000",slider_track_color:"#444444",_index_:null,_is_playing_:!1});function cf(i,e,n){var r={};e=e||Du,n=n||Tu;var a=[],o=[],s=[],l=document.createElement("div");l.setAttribute("class","controls-container");var c,u,f,d,p,h,g=Lu(r,i,l),m=(c=r,u=i,f={},d=ce(l).append("div").attr("class","button-container"),p=function(){var t="floating-buttons"!==u.control;d.style("width",t?u.width+"px":null).style("display",t?"table":"inline-block").classed("button-group",t)},h=function(){d.style("display","none")},f.show=p,f.hide=h,f.update=function(t){if(d.text(""),!c.n_options||-1===["grouped-buttons","floating-buttons","auto"].indexOf(u.control))return h(),f;var e=c.index(),n=d.selectAll(".button").data(t).enter().append("div");n.attr("class","button").classed("selected",function(t){return t.options_index===e}).text(function(t){return t.display}).attr("title",function(t){return t.display}).on("click",function(t){var e=t.options_index;e!==c.index()&&(c.index(e),n.classed("selected",function(t){return t.options_index===e}),c.trigger("change"))}),p()},f.checkFit=function(){if(d.classed("button-group")){p();var t=d.selectAll(".button").nodes().every(function(t){return t.offsetWidth>=t.scrollWidth});return t||h(),t}},f),_=sf(r,i,l);for(var t in lf)void 0===i[t]&&(i[t]=lf[t]);var y=i._index_,b=function(){"auto"===i.control&&(m.checkFit()?g.hide():g.show())};r.appendTo=function(t){return function(){if(!Au&&"undefined"!=typeof document){var t=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style");e.type="text/css",t.appendChild(e),e.styleSheet?e.styleSheet.cssText=zu:e.appendChild(document.createTextNode(zu)),Au=!0}}(),ce(t).node().appendChild(l),g.appendedToDOM(),window.addEventListener("resize",b),b(),r};r.remove=function(){return l.parentElement&&l.parentElement.removeChild(l),g.removedFromDOM(),window.removeEventListener("resize",b),r},r.options=function(t){if(void 0===t)return a.slice();if(!Array.isArray(t))return r;var e=(a=t.slice()).length,n=v();return e?(null===n||e<=n)&&v(0):v(null),r},Object.defineProperty(r,"n_options",{get:function(){return a.length}});var v=function(t){return void 0===t?(i._is_playing_||(y=i._index_),y):(null===t||(e=t,a.length&&0<=e&&e<a.length)?(y=t,i._is_playing_||(i._index_=y)):console.warn("Invalid index, ignoring update call"),r);var e};r.index=v,r.getSortedIndex=function(){var n,r=v();return i.sort?(o.some(function(t,e){if(t.options_index===r)return n=e,!0}),n):r},r.value=function(t){if(void 0===t)return a[v()];var e=a.indexOf(t);return-1!==e&&v(e),r},r.on=function(t,e){return"change"===t&&s.push(e.bind(r)),r},r.update=function(){var t;return o=function(t,e,n,r){var i="numeric"===e.type,a="temporal"===e.type,o=Iu;i?o=n:a&&(o=Li(e.temporal_format));var s=t.map(function(t,e){var n=o(t);return{value:t,options_index:e,parsed:n,display:i&&!isNaN(n)?r(n):t}});return e.sort?s.sort(function(t,e){return n=t.parsed,r=e.parsed,n<r?-1:r<n?1:r<=n?0:NaN;var n,r}):s}(a,i,e(),n()),t=o,l.style.display=1<t.length&&"none"!==i.control?null:"none",l.style.width=i.width+"px",_.update(t),g.update(t),m.update(t),b(),r},r.trigger=function(t){var e,n;return"change"===t&&(e=v(),n=a[e],s.forEach(function(t){t(n,e)})),r};return r._isPlaying_=function(t){if(void 0===t)return i._is_playing_;i._is_playing_=!!t,t||v(y)},r}var uf,ff,df={},pf="$-&^:*%";function hf(t){if(""!==t)return t.match(/[/:]/)?"string":t.match(/\d\s*-/)?"string":isFinite(ff(t))?"number":"string"}function gf(t){for(var e=We(t).values(),n=0,r=Math.min(e.length,30),i=.25*r,a=0;a<r;a++)if("string"===hf(e[a])&&i<++n)return"discrete";return"number"}function mf(t,e){for(var n=0,r=0,i=0;i<30&&t.length!=i;i++)if(""!=t[i][e]){var a=ff(t[i][e]);isNaN(a)?r++:n++}return r<=n?"number":"discrete"}function _f(t,e,n){return("x"==e||"y"==e)&&"slider"in df.data.column_names&&ju.slider_updates_axes&&(t=t.filter(bf)),("x"==e||"y"==e)&&"filter"in df.data.column_names&&ju.filter_updates_axes&&(t=t.filter(yf)),"number"==n?ze(t,function(t){return t[e]}):We(t.map(function(t){return t[e]}).filter(function(t){return null!=t})).values()}function yf(t){var e=Fb.value();return(null==e||e==t.filter||ju.filter_show_all&&e==ju.filter_show_all_text)&&("off"==ju.legend_filtering_mode||-1==ju.legend_filter.indexOf(t.color))}function bf(t){var e=Bb.value();return null==e||e==t.slider}var vf,xf,wf,Mf,jf,kf,zf,Nf,Af,Df,Tf,If,Lf=[];function Sf(d){if(!df.data.processed||xf!=Bb.value()||vf!=Fb.value()||Mf!=ju.box_plot||jf!=ju.violin_plot||wf!=ju.beeswarm_plot||kf!=ju.box_whisker_multiplier||zf!=ju.color_type||Nf!=ju.x_type||Af!=ju.y_type||Df!==ju.localization.input_decimal_separator||Lf!==ju.legend_filter.join(pf)||Tf!==ju.legend_filtering_mode||If!==ju.popup_parse_numbers){ff=nv.getParser();var o=!("x"in df.data.column_names),s=!("y"in df.data.column_names),p=df.data.map(function(t,e){var n,r,i=(n=t,r={},Object.keys(n).forEach(function(t){Array.isArray(n[t])?r[t]=n[t].map(function(t){return t}):r[t]=n[t]}),r);if(i.row=e,o&&(i.x=""),s&&(i.y=""),i.name.length){i.id="";for(var a=0;a<i.name.length;a++)i.id+=i.name[a]+(a<i.name.length-1?", ":"")}return i});p.column_names=df.data.column_names;for(var e=0;e<d.length;e++){var t=d[e];if(void 0!==p.column_names[t]){var n;if("number"==(n="x"===t&&"auto"!==ju.x_type?ju.x_type:"y"===t&&"auto"!==ju.y_type?ju.y_type:"color"===t&&"auto"!==ju.color_type?ju.color_type:mf(p,t)))for(var r=0;r<p.length;r++)p[r][t]=ff(p[r][t]);p[t+"_type"]=n,p[t+"_domain"]=_f(p,t,n)}}o&&(p.x_type="discrete",p.x_domain=[""]),s&&(p.y_type="discrete",p.y_domain=[""]);var i=p.column_names.metadata||[];if(ju.popup_parse_numbers)for(e=0;e<i.length;e++){if("number"==gf(p.slice(0,30).map(function(t){return t.metadata[e]})))for(r=0;r<p.length;r++)p[r].metadata[e]=ff(p[r].metadata[e])}if("number"===p.x_type||"number"===p.y_type){e=0;for(var a=0;e<p.length;e++){var l=p[e],c="number"===l.x_type&&isNaN(l.x),u="number"===l.y_type&&isNaN(l.y);c||u||(p[a++]=l)}p.length=a}var h=null,g=null,m="discrete"==p.x_type&&"number"==p.y_type||"number"==p.x_type&&"discrete"==p.y_type,_=ju.box_plot||ju.violin_plot||ju.beeswarm_plot;_&m&&("discrete"==p.x_type?(h="x",g="y"):"number"==p.x_type&&(h="y",g="x"));var f=p.filter(yf);for(e=0;e<f.length;e++)f[e].row_filtered=e;for(var y in p)("string"==typeof p[y]||Array.isArray(p[y])||"column_names"==y)&&(f[y]=p[y]);var b=Ue().key(function(t){return t.facet||""}).sortKeys(function(t,e){return be(p.facet_domain.indexOf(t),p.facet_domain.indexOf(e))}).entries(f),v={},x=[],w=[];for(var M in b.forEach(function(t,e){t.name=t.key;for(var n=0;n<d.length;n++){var r=d[n];t[r+"_domain"]=_f(t.values,r,p[r+"_type"])}if(_&m){var i={};for(n=0;n<t.values.length;n++){var a=t.values[n];a[h]in i||(i[a[h]]=[]),i[a[h]].push(a)}for(var o in i){var s={};s.data_points=i[o];var l=i[o].map(function(t){return t[g]}).filter(function(t){return!isNaN(t)}).sort(be);if(!(l.length<2)){s.facet_index=e,s.values=l,s.category=o,s.category_col=h,s.value_col=g,s.bottom=Ee(l,.25),s.mid=Ee(l,.5),s.top=Ee(l,.75),s.whisker_bottom=l[0],s.whisker_top=l[l.length-1];var c=s.top-s.bottom;s.whisker_tukey_bottom=Math.min(l[we(l,s.bottom-ju.box_whisker_multiplier*c)],s.bottom),s.whisker_tukey_top=Math.max(l[Me(l,s.top+ju.box_whisker_multiplier*c)-1],s.top),isNaN(s.whisker_tukey_bottom)&&(s.whisker_tukey_bottom=s.mid),isNaN(s.whisker_tukey_top)&&(s.whisker_tukey_top=s.mid),w.push(s)}}}for(n=0;n<t.values.length;n++){var u=t.values[n];if(u.facet_index=e,u.facet=t,"series"in p.column_names){var f=("line-"+u.series+"-facet-"+e).replace(/\s/g,"-");""!=u.series&&(f in v||(v[f]=[]),"number"==typeof u.x&&isNaN(u.x)||"number"==typeof u.y&&isNaN(u.y)||v[f].push(u),v[f].id=f,v[f].facet_index=e)}}}),v)1<v[M].length&&x.push(v[M]);_&&(w.category_col=h,w.value_col=g);var j=[];for(e=0;e<b.length;e++)0<b[e].values.length&&j.push(b[e]);(uf={facets:j,data_points:f,boxes:w,lines:x}).discrete_vs_numerical=m,uf.has_facet_binding="facet"in df.data.column_names,vf=Fb.value(),xf=Bb.value(),wf=ju.beeswarm_plot,Mf=ju.box_plot,jf=ju.violin_plot,zf=ju.color_type,Nf=ju.x_type,Af=ju.y_type,kf=ju.box_whisker_multiplier,Df=ju.localization.input_decimal_separator,Lf=ju.legend_filter.join(pf),Tf=ju.legend_filtering_mode,If=ju.popup_parse_numbers,df.data.processed=!0}}function Ef(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function Cf(t){return cr(t[t.length-1])}var Of=Cf(new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Ef)),Pf=Cf(new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Ef)),Yf=Cf(new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Ef)),Ff=Cf(new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Ef)),Bf=Cf(new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Ef)),Uf=Cf(new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Ef)),Rf=Cf(new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Ef)),Hf=Cf(new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Ef)),Zf=Cf(new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Ef)),Qf=Cf(new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Ef)),Gf=Cf(new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Ef)),qf=Cf(new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Ef)),Wf=Cf(new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Ef)),Vf=Cf(new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Ef)),Xf=Cf(new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Ef)),Jf=Cf(new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Ef)),Kf=Cf(new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Ef)),$f=Cf(new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Ef)),td=Cf(new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Ef)),ed=Cf(new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Ef)),nd=Cf(new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Ef)),rd=Cf(new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Ef)),id=Cf(new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Ef)),ad=Cf(new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Ef)),od=Cf(new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Ef)),sd=Cf(new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Ef)),ld=Cf(new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Ef)),cd=Lr(tr(300,.5,0),tr(-240,.5,1)),ud=Lr(tr(-100,.75,.35),tr(80,1.5,.8)),fd=Lr(tr(260,.75,.35),tr(80,1.5,.8));tr();function dd(e){var n=e.length;return function(t){return e[Math.max(0,Math.min(n-1,Math.floor(t*n)))]}}var pd=dd(Ef("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),hd=dd(Ef("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),gd=dd(Ef("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),md=dd(Ef("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),_d=Object.freeze({scale_type:"categorical",categorical_type:"palette",categorical_palette:["#1D6996","#EDAD08","#73AF48","#94346E","#38A6A5","#E17C05","#5F4690","#0F8554","#6F4070","#CC503E","#994E95","#666666"],categorical_extend:!0,categorical_seed_color:"#af5f68",categorical_rotation_angle:222.49,categorical_color_space:"hcl",categorical_custom_palette:"",sequential_palette:"Blues",sequential_custom_min:"#FFFFFF",sequential_custom_max:"#000000",sequential_color_space:"rgb",sequential_reverse:!1,diverging_palette:"RdBu",diverging_custom_min:"#67001f",diverging_custom_mid:"#f7f7f7",diverging_custom_max:"#053061",diverging_color_space:"rgb",diverging_reverse:!1,binning:!1,bin_count:4,bin_mode:"fixed",bin_thresholds:""}),yd=360/((1+Math.sqrt(5))/2),bd="#FF0000";function vd(c,u,f){return function(t,e){Array.isArray(t)||(t=t?[t]:[bd]),e=void 0!==e?e:yd;var n=t.map(function(t){return c(t)}).filter(function(t){return!isNaN(t[u])&&!isNaN(t[f])});n.length||(n=[c(bd)]);for(var r,i=n.length,a=n.reduce(function(t,e){return t+e[u]},0)/i,o=n.reduce(function(t,e){return t+e[f]},0)/i,s=i;r=n[--s].h,isNaN(r)&&0<s;);var l=0;return function(){var t=++l*e;return _n(c((r+t)%360,a,o)).hex()}}}var xd={hcl:vd(Zn,"c","l"),hsl:vd(kn,"s","l")};function wd(t,e,n,r){var i,a,o=[];"custom"==t.bin_mode?a=(i=t.bin_thresholds.split(";").map(parseFloat).filter(function(t){return!isNaN(t)}).sort(Md)).length+1:(a=Math.floor(t.bin_count),i=[]);var s,l=function(t,e,n){for(var r=1/e,i=[],a=0;a<e;a++)i.push(a/e+r/2);var o=i.map(t);n&&o.reverse();return{positions:i,colors:o}}(r,a,t.sequential_reverse);(s="fixed"==t.bin_mode?function t(){var e,n=0,r=1,i=1,a=[.5],o=[0,1];function s(t){return t<=t?o[we(a,t,0,i)]:e}function l(){var t=-1;for(a=new Array(i);++t<i;)a[t]=((t+1)*r-(t-i)*n)/(i+1);return s}return s.domain=function(t){return arguments.length?(n=+t[0],r=+t[1],l()):[n,r]},s.range=function(t){return arguments.length?(i=(o=Je.call(t)).length-1,l()):o.slice()},s.invertExtent=function(t){var e=o.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,a[0]]:i<=e?[a[i-1],r]:[a[e-1],a[e]]},s.unknown=function(t){return arguments.length&&(e=t),s},s.thresholds=function(){return a.slice()},s.copy=function(){return t().domain([n,r]).range(o).unknown(e)},Pe.apply(ai(s),arguments)}().domain(e):"quantile"==t.bin_mode?si().domain(n):function t(){var e,n=[.5],r=[0,1],i=1;function a(t){return t<=t?r[we(n,t,0,i)]:e}return a.domain=function(t){return arguments.length?(n=Je.call(t),i=Math.min(n.length,r.length-1),a):n.slice()},a.range=function(t){return arguments.length?(r=Je.call(t),i=Math.min(n.length,r.length-1),a):r.slice()},a.invertExtent=function(t){var e=r.indexOf(t);return[n[e-1],n[e]]},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return t().domain(n).range(r).unknown(e)},Pe.apply(a,arguments)}().domain(i)).range(l.colors),i.length||l.colors.forEach(function(t,e){e&&i.push(s.invertExtent(t)[0])}),i.forEach(function(t,e){e<i.length-1&&o.push((i[e+1]+t)/2)});var c=function(t){return isNaN(t)?null:s(t)};return c.domain=Object.freeze(e),c.thresholds=Object.freeze(i),c.centers=Object.freeze(o),c}function Md(t,e){return t-e}function jd(t){return Array.isArray(t)?ze(t):[0,1]}var kd=Object.freeze(["#efeca4","#e9e28f","#dccf64","#e3b23c","#e49547","#e37746","#dc5b36","#cb4144","#bb2244","#972545","#6a2c4f"]),zd=Object.freeze({Blues:rd,BuGn:Qf,BuPu:Gf,Carrots:cr(kd),Cool:fd,CubehelixDefault:cd,GnBu:qf,Greens:id,Greys:ad,Inferno:gd,Magma:hd,Oranges:ld,OrRd:Wf,Plasma:md,PuBu:Xf,PuBuGn:Vf,PuRd:Jf,Purples:od,RdPu:Kf,Reds:sd,Viridis:pd,Warm:ud,YlGn:td,YlGnBu:$f,YlOrBr:ed,YlOrRd:nd}),Nd={hcl:Tr,hsl:Nr,lab:Ar,rgb:sr};function Ad(t,e){var n,r,i,a,o=jd(e),s=zd[t.sequential_palette]||(r=(n=t).sequential_color_space,i=n.sequential_custom_min,a=n.sequential_custom_max,Nd[r](i,a));return t.binning?wd(t,o,e,s):Ga(s).domain(t.sequential_reverse?o.reverse():o)}var Dd=Object.freeze({BrBG:Of,PiYG:Yf,PRGn:Pf,PuOr:Ff,RdBu:Bf,RdGy:Uf,RdYlBu:Rf,RdYlGn:Hf,Spectral:Zf}),Td={hcl:Tr,hsl:Nr,lab:Ar,rgb:sr};function Id(t){var e=t.diverging_color_space,n=t.diverging_custom_min,r=t.diverging_custom_mid,i=t.diverging_custom_max;return function(t,e){for(var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);n<r;)a[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return a[e](t-e)}}(Td[e],[n,r,i])}var Ld,Sd,Ed={interpolateViridis:pd,interpolateInferno:gd,interpolateMagma:hd,interpolatePlasma:md,interpolateWarm:ud,interpolateCool:fd,interpolateBrBG:Of,interpolatePRGn:Pf,interpolatePiYG:Yf,interpolatePuOr:Ff,interpolateRdBu:Bf,interpolateRdGy:Uf,interpolateRdYlBu:Rf,interpolateRdYlGn:Hf,interpolateSpectral:Zf,interpolateBuGn:Qf,interpolateBuPu:Gf,interpolateGnBu:qf,interpolateOrRd:Wf,interpolatePuBuGn:Vf,interpolatePuBu:Xf,interpolatePuRd:Jf,interpolateRdPu:Kf,interpolateYlGnBu:$f,interpolateYlGn:td,interpolateYlOrBr:ed,interpolateYlOrRd:nd,interpolateBlues:rd,interpolateGreens:id,interpolateGreys:ad,interpolatePurples:od,interpolateReds:sd,interpolateOranges:ld},Cd=function(s){var l=null;for(var t in _d)void 0===s[t]&&(s[t]=_d[t]);var e=null,c=function(t){return l&&l(t)||e};return{getColor:c,updateColorScale:function(t){var e,n,r,i,a,o;return l="categorical"===s.scale_type?function(t,e){var i={},n=We(e).values(),r="palette"===t.categorical_type?t.categorical_palette:[t.categorical_seed_color],a=r.length;if(t.categorical_extend||"generated"===t.categorical_type){var o="palette"===t.categorical_type?_d.rotation_angle:t.categorical_rotation_angle,s="generated"===t.categorical_type?t.categorical_color_space:"hcl",l=xd[s](r,o);n.forEach(function(t,e){i[t]=e<a?r[e]:l()})}else n.forEach(function(t,e){i[t]=r[e%a]});t.categorical_custom_palette.split("\n").filter(function(t){return t}).forEach(function(t){var e=t.lastIndexOf(":");if(-1!==e){var n=t.slice(0,e).trim(),r=t.slice(e+1).trim();n&&r&&(i[n]=r)}});var c=function(t){return i[t]};return c.domain=n.slice(),c.colors=n.map(function(t){return i[t]}),c.items=n.map(function(t){return{label:t,color:i[t]}}),c}(s,t):"sequential"===s.scale_type?Ad(s,t):(e=s,r=jd(n=t),i=Dd[e.diverging_palette]||Id(e),a=Ga(i).domain(e.diverging_reverse?r.reverse():r),(o=function(t){return isNaN(t)?null:a(t)}).domain=Object.freeze(r),o.midpoint=(r[0]+r[1])/2,e.binning?wd(e,r,n,i):o),c.thresholds=l.thresholds,c.centers=l.centers,c.midpoint=l.midpoint,c.domain=l.domain,c.colors=l.colors,c.items=l.items,this},fallback:function(t){return void 0===t?e:(e="default"===t?null:t,this)}}}(ju.color);function Od(t,e){if(e||(Ld=function(){return ju.default_color}),"number"==(Sd=t)){var n=Ga(Ed[ju.spectrum]),r=oi().domain(e).range([0,1]);Ld=function(t){return n(r(t))}}"discrete"==t&&Cd.updateColorScale(df.data.map(function(t){return t.color}))}function Pd(t,e){return"number"==Sd&&isNaN(t)?e||ju.default_color:"discrete"==Sd?Cd.getColor(t):Ld(t)}var Yd=Math.PI,Fd=2*Yd,Bd=1e-6,Ud=Fd-Bd;function Rd(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Hd(){return new Rd}function Zd(t){return function(){return t}}Rd.prototype=Hd.prototype={constructor:Rd,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-t,l=r-e,c=a-t,u=o-e,f=c*c+u*u;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(Bd<f)if(Math.abs(u*s-l*c)>Bd&&i){var d=n-a,p=r-o,h=s*s+l*l,g=d*d+p*p,m=Math.sqrt(h),_=Math.sqrt(f),y=i*Math.tan((Yd-Math.acos((h+f-g)/(2*m*_)))/2),b=y/_,v=y/m;Math.abs(b-1)>Bd&&(this._+="L"+(t+b*c)+","+(e+b*u)),this._+="A"+i+","+i+",0,0,"+ +(c*p<u*d)+","+(this._x1=t+v*s)+","+(this._y1=e+v*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,a){t=+t,e=+e,a=!!a;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),l=t+o,c=e+s,u=1^a,f=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>Bd||Math.abs(this._y1-c)>Bd)&&(this._+="L"+l+","+c),n&&(f<0&&(f=f%Fd+Fd),Ud<f?this._+="A"+n+","+n+",0,1,"+u+","+(t-o)+","+(e-s)+"A"+n+","+n+",0,1,"+u+","+(this._x1=l)+","+(this._y1=c):Bd<f&&(this._+="A"+n+","+n+",0,"+ +(Yd<=f)+","+u+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var Qd=Math.PI,Gd=2*Qd;function qd(t){this._context=t}function Wd(t){return new qd(t)}function Vd(t){return t[0]}function Xd(t){return t[1]}function Jd(){var o=Vd,s=Xd,l=Zd(!0),c=null,u=Wd,f=null;function e(t){var e,n,r,i=t.length,a=!1;for(null==c&&(f=u(r=Hd())),e=0;e<=i;++e)!(e<i&&l(n=t[e],e,t))===a&&((a=!a)?f.lineStart():f.lineEnd()),a&&f.point(+o(n,e,t),+s(n,e,t));if(r)return f=null,r+""||null}return e.x=function(t){return arguments.length?(o="function"==typeof t?t:Zd(+t),e):o},e.y=function(t){return arguments.length?(s="function"==typeof t?t:Zd(+t),e):s},e.defined=function(t){return arguments.length?(l="function"==typeof t?t:Zd(!!t),e):l},e.curve=function(t){return arguments.length?(u=t,null!=c&&(f=u(c)),e):u},e.context=function(t){return arguments.length?(null==t?c=f=null:f=u(c=t),e):c},e}function Kd(){var u=Vd,f=null,d=Zd(0),p=Xd,h=Zd(!0),g=null,m=Wd,_=null;function e(t){var e,n,r,i,a,o=t.length,s=!1,l=new Array(o),c=new Array(o);for(null==g&&(_=m(a=Hd())),e=0;e<=o;++e){if(!(e<o&&h(i=t[e],e,t))===s)if(s=!s)n=e,_.areaStart(),_.lineStart();else{for(_.lineEnd(),_.lineStart(),r=e-1;n<=r;--r)_.point(l[r],c[r]);_.lineEnd(),_.areaEnd()}s&&(l[e]=+u(i,e,t),c[e]=+d(i,e,t),_.point(f?+f(i,e,t):l[e],p?+p(i,e,t):c[e]))}if(a)return _=null,a+""||null}function t(){return Jd().defined(h).curve(m).context(g)}return e.x=function(t){return arguments.length?(u="function"==typeof t?t:Zd(+t),f=null,e):u},e.x0=function(t){return arguments.length?(u="function"==typeof t?t:Zd(+t),e):u},e.x1=function(t){return arguments.length?(f=null==t?null:"function"==typeof t?t:Zd(+t),e):f},e.y=function(t){return arguments.length?(d="function"==typeof t?t:Zd(+t),p=null,e):d},e.y0=function(t){return arguments.length?(d="function"==typeof t?t:Zd(+t),e):d},e.y1=function(t){return arguments.length?(p=null==t?null:"function"==typeof t?t:Zd(+t),e):p},e.lineX0=e.lineY0=function(){return t().x(u).y(d)},e.lineY1=function(){return t().x(u).y(p)},e.lineX1=function(){return t().x(f).y(d)},e.defined=function(t){return arguments.length?(h="function"==typeof t?t:Zd(!!t),e):h},e.curve=function(t){return arguments.length?(m=t,null!=g&&(_=m(g)),e):m},e.context=function(t){return arguments.length?(null==t?g=_=null:_=m(g=t),e):g},e}qd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var $d={draw:function(t,e){var n=Math.sqrt(e/Qd);t.moveTo(n,0),t.arc(0,0,n,0,Gd)}},tp={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},ep=Math.sqrt(1/3),np=2*ep,rp={draw:function(t,e){var n=Math.sqrt(e/np),r=n*ep;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},ip=Math.sin(Qd/10)/Math.sin(7*Qd/10),ap=Math.sin(Gd/10)*ip,op=-Math.cos(Gd/10)*ip,sp={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),r=ap*n,i=op*n;t.moveTo(0,-n),t.lineTo(r,i);for(var a=1;a<5;++a){var o=Gd*a/5,s=Math.cos(o),l=Math.sin(o);t.lineTo(l*n,-s*n),t.lineTo(s*r-l*i,l*r+s*i)}t.closePath()}},lp={draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},cp=Math.sqrt(3),up={draw:function(t,e){var n=-Math.sqrt(e/(3*cp));t.moveTo(0,2*n),t.lineTo(-cp*n,-n),t.lineTo(cp*n,-n),t.closePath()}},fp=-.5,dp=Math.sqrt(3)/2,pp=1/Math.sqrt(12),hp=3*(pp/2+1),gp={draw:function(t,e){var n=Math.sqrt(e/hp),r=n/2,i=n*pp,a=r,o=n*pp+n,s=-a,l=o;t.moveTo(r,i),t.lineTo(a,o),t.lineTo(s,l),t.lineTo(fp*r-dp*i,dp*r+fp*i),t.lineTo(fp*a-dp*o,dp*a+fp*o),t.lineTo(fp*s-dp*l,dp*s+fp*l),t.lineTo(fp*r+dp*i,fp*i-dp*r),t.lineTo(fp*a+dp*o,fp*o-dp*a),t.lineTo(fp*s+dp*l,fp*l-dp*s),t.closePath()}};function mp(t){this._context=t}function _p(t){var e,n,r=t.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(a[i[0]=0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/a[r-1],e=r-2;0<=e;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function yp(t){return new mp(t)}mp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=_p(t),i=_p(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var bp,vp,xp={symbolCircle:$d,symbolCross:tp,symbolDiamond:rp,symbolWye:gp,symbolTriangle:up,symbolStar:sp,symbolSquare:lp},wp=Object.keys(xp);function Mp(t){var e=uf.discrete_vs_numerical&&ju.beeswarm_plot;return""==t.size||e?ju.data_point_default_size:Math.max(ju.data_point_min_size,vp(t.size||null))}function jp(t){var e=""==t.shape?xp[ju.default_shape]:xp[bp(t.shape||null)],n=Mp(t);return function(){var e=Zd($d),n=Zd(64),r=null;function i(){var t;if(r||(r=t=Hd()),e.apply(this,arguments).draw(r,+n.apply(this,arguments)),t)return r=null,t+""||null}return i.type=function(t){return arguments.length?(e="function"==typeof t?t:Zd(t),i):e},i.size=function(t){return arguments.length?(n="function"==typeof t?t:Zd(+t),i):n},i.context=function(t){return arguments.length?(r=null==t?null:t,i):r},i}().type(e).size(n)()}function kp(t){return Math.sqrt(Mp(t))}var zp="A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",Np="fl-spanner",Ap=Np+"-";function Dp(e){("string"==typeof e||e instanceof HTMLElement)&&(e=ce(e));var o={data:[],element:null,ignore_case:!0,text:function(t){return t},class:Np},n=function(t,e){var n=o.text(t,e);if(!n||"string"!=typeof n)return null;var r=n.trim();return r?{original:n,trimmed:r,length:r.length,d:t,i:e}:null},r=function(){var t=e.node(),a=e.text(),l=o.element;return l||(l=t instanceof SVGElement||"svg"===t.nodeName.toLowerCase()?"tspan":"span"),o.data.map(n).filter(function(t){return t}).sort(function(t,e){return e.length-t.length||t.i-e.i}).forEach(function(s){var t,e,n,r,i=(t=l,e=s.trimmed.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),n="<"+t+".*?<\\/"+t+">|(?:(^|[^"+zp+"])("+e+")($|[^"+zp+"]))",r=o.ignore_case?"gi":"g",new RegExp(n,r));a=a.replace(i,function(t,e,n,r){return n?e+(i=l,a=n,o=s.i,"<"+i+" class='"+Ap+o+"'>"+a+"</"+i+">")+r:t;var i,a,o})}),e.html(a),e.selectAll(l).each(function(){var t=o.data[this.getAttribute("class").slice(Ap.length)];ce(this).datum(t).attr("class",o.class)})};return r.data=function(t){return void 0===t?o.data:(o.data=Array.isArray(t)?t:[t],r)},r.element=function(t){return void 0===t?o.element:(o.element=t,r)},r.ignoreCase=function(t){return void 0===t?o.ignore_case:(o.ignore_case=!!t,r)},r.text=function(t){return void 0===t?o.text:(o.text=t,r)},r.class=function(t){return void 0===t?o.class:(o.class=t,r)},r}function Tp(t,e,n,r){var i=Xb(e);Dp(t).data(e)().style("color",function(t){return n(t)}).style("opacity",function(t){return"off"!=ju.legend_filtering_mode&&-1!==ju.legend_filter.indexOf(t)?.3:1}).style("cursor","off"!=ju.legend_filtering_mode?"pointer":null).style("font-weight",r).on("click",i)}var Ip="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Lp(t,e){return t(e={exports:{}},e.exports),e.exports}var Sp=Lp(function(t,e){t.exports=function(){var K=function(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array||t instanceof Uint8ClampedArray},$=function(t,e){for(var n=Object.keys(e),r=0;r<n.length;++r)t[n[r]]=e[n[r]];return t};function r(t){var e=new Error("(regl) "+t);throw console.error(e),e}function h(t,e){t||r(e)}function i(t){return t?": "+t:""}function a(t,e,n){e.indexOf(t)<0&&r("invalid value"+i(n)+". must be one of: "+e)}var e=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function f(t,e){for(t+="";t.length<e;)t=" "+t;return t}function d(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function p(t,e){this.number=t,this.line=e,this.errors=[]}function g(t,e,n){this.file=t,this.line=e,this.message=n}function m(){var t=new Error,e=(t.stack||t).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(e);if(n)return n[1];var r=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(e);return r?r[1]:"unknown"}function o(){var t=new Error,e=(t.stack||t).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(e);if(n)return n[1];var r=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(e);return r?r[1]:"unknown"}function _(t,e){var n,r=t.split("\n"),i=1,a=0,o={unknown:new d,0:new d};o.unknown.name=o[0].name=e||m(),o.unknown.lines.push(new p(0,""));for(var s=0;s<r.length;++s){var l=r[s],c=/^\s*\#\s*(\w+)\s+(.+)\s*$/.exec(l);if(c)switch(c[1]){case"line":var u=/(\d+)(\s+\d+)?/.exec(c[2]);u&&(i=0|u[1],u[2]&&((a=0|u[2])in o||(o[a]=new d)));break;case"define":var f=/SHADER_NAME(_B64)?\s+(.*)$/.exec(c[2]);f&&(o[a].name=f[1]?(n=f[2],"undefined"!=typeof atob?atob(n):"base64:"+n):f[2])}o[a].lines.push(new p(i++,l))}return Object.keys(o).forEach(function(t){var e=o[t];e.lines.forEach(function(t){e.index[t.number]=t})}),o}function l(t){t._commandRef=m()}function s(t,e){var n=o();r(t+" in command "+(e||m())+("unknown"===n?"":" called from "+n))}function y(t,e,n,r){typeof t!==e&&s("invalid parameter type"+i(n)+". expected "+e+", got "+typeof t,r||m())}var n=32819,c=32820,u=33635,b=34042,v={};function x(t,e){return t===c||t===n||t===u?2:t===b?4:v[t]*e}function w(t){return!(t&t-1||!t)}v[5120]=v[5121]=1,v[5122]=v[5123]=v[36193]=v[u]=v[n]=v[c]=2,v[5124]=v[5125]=v[5126]=v[b]=4;var tt=$(h,{optional:function(t){t()},raise:r,commandRaise:s,command:function(t,e,n){t||s(e,n||m())},parameter:function(t,e,n){t in e||r("unknown parameter ("+t+")"+i(n)+". possible values: "+Object.keys(e).join())},commandParameter:function(t,e,n,r){t in e||s("unknown parameter ("+t+")"+i(n)+". possible values: "+Object.keys(e).join(),r||m())},constructor:function(t){Object.keys(t).forEach(function(t){e.indexOf(t)<0&&r('invalid regl constructor argument "'+t+'". must be one of '+e)})},type:function(t,e,n){typeof t!==e&&r("invalid parameter type"+i(n)+". expected "+e+", got "+typeof t)},commandType:y,isTypedArray:function(t,e){K(t)||r("invalid parameter type"+i(e)+". must be a typed array")},nni:function(t,e){0<=t&&(0|t)===t||r("invalid parameter type, ("+t+")"+i(e)+". must be a nonnegative integer")},oneOf:a,shaderError:function(t,e,n,r,i){if(!t.getShaderParameter(e,t.COMPILE_STATUS)){var a=t.getShaderInfoLog(e),o=r===t.FRAGMENT_SHADER?"fragment":"vertex";y(n,"string",o+" shader source must be a string",i);var s=_(n,i),l=(u=[],a.split("\n").forEach(function(t){if(!(t.length<5)){var e=/^ERROR\:\s+(\d+)\:(\d+)\:\s*(.*)$/.exec(t);e?u.push(new g(0|e[1],0|e[2],e[3].trim())):0<t.length&&u.push(new g("unknown",0,t))}}),u);c=s,l.forEach(function(t){var e=c[t.file];if(e){var n=e.index[t.line];if(n)return n.errors.push(t),void(e.hasErrors=!0)}c.unknown.hasErrors=!0,c.unknown.lines[0].errors.push(t)}),Object.keys(s).forEach(function(t){var e=s[t];if(e.hasErrors){var n=[""],r=[""];o("file number "+t+": "+e.name+"\n","color:red;text-decoration:underline;font-weight:bold"),e.lines.forEach(function(i){if(0<i.errors.length){o(f(i.number,4)+"|  ","background-color:yellow; font-weight:bold"),o(i.line+"\n","color:red; background-color:yellow; font-weight:bold");var a=0;i.errors.forEach(function(t){var e=t.message,n=/^\s*\'(.*)\'\s*\:\s*(.*)$/.exec(e);if(n){var r=n[1];switch(e=n[2],r){case"assign":r="="}a=Math.max(i.line.indexOf(r,a),0)}else a=0;o(f("| ",6)),o(f("^^^",a+3)+"\n","font-weight:bold"),o(f("| ",6)),o(e+"\n","font-weight:bold")}),o(f("| ",6)+"\n")}else o(f(i.number,4)+"|  "),o(i.line+"\n","color:red")}),"undefined"==typeof document||window.chrome?console.log(n.join("")):(r[0]=n.join("%c"),console.log.apply(console,r))}function o(t,e){n.push(t),r.push(e||"")}}),h.raise("Error compiling "+o+" shader, "+s[0].name)}var c,u},linkError:function(t,e,n,r,i){if(!t.getProgramParameter(e,t.LINK_STATUS)){var a=t.getProgramInfoLog(e),o=_(n,i),s=_(r,i),l='Error linking program with vertex shader, "'+s[0].name+'", and fragment shader "'+o[0].name+'"';"undefined"!=typeof document?console.log("%c"+l+"\n%c"+a,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(l+"\n"+a),h.raise(l)}},callSite:o,saveCommandRef:l,saveDrawInfo:function(t,e,n,r){function i(t){return t?r.id(t):0}function a(e,t){Object.keys(t).forEach(function(t){e[r.id(t)]=!0})}l(t),t._fragId=i(t.static.frag),t._vertId=i(t.static.vert);var o=t._uniformSet={};a(o,e.static),a(o,e.dynamic);var s=t._attributeSet={};a(s,n.static),a(s,n.dynamic),t._hasCount="count"in t.static||"count"in t.dynamic||"elements"in t.static||"elements"in t.dynamic},framebufferFormat:function(t,e,n){t.texture?a(t.texture._texture.internalformat,e,"unsupported texture format for attachment"):a(t.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")},guessCommand:m,texture2D:function(t,e,n){var r,i=e.width,a=e.height,o=e.channels;h(0<i&&i<=n.maxTextureSize&&0<a&&a<=n.maxTextureSize,"invalid texture shape"),(33071!==t.wrapS||33071!==t.wrapT)&&h(w(i)&&w(a),"incompatible wrap mode for texture, both width and height must be power of 2"),1===e.mipmask?1!==i&&1!==a&&h(9984!==t.minFilter&&9986!==t.minFilter&&9985!==t.minFilter&&9987!==t.minFilter,"min filter requires mipmap"):(h(w(i)&&w(a),"texture must be a square power of 2 to support mipmapping"),h(e.mipmask===(i<<1)-1,"missing or incomplete mipmap data")),5126===e.type&&(n.extensions.indexOf("oes_texture_float_linear")<0&&h(9728===t.minFilter&&9728===t.magFilter,"filter not supported, must enable oes_texture_float_linear"),h(!t.genMipmaps,"mipmap generation not supported with float textures"));var s=e.images;for(r=0;r<16;++r)if(s[r]){var l=i>>r,c=a>>r;h(e.mipmask&1<<r,"missing mipmap data");var u=s[r];if(h(u.width===l&&u.height===c,"invalid shape for mip images"),h(u.format===e.format&&u.internalformat===e.internalformat&&u.type===e.type,"incompatible type for mip image"),u.compressed);else if(u.data){var f=Math.ceil(x(u.type,o)*l/u.unpackAlignment)*u.unpackAlignment;h(u.data.byteLength===f*c,"invalid data for image, buffer size is inconsistent with image format")}else u.element||u.copy}else t.genMipmaps||h(0==(e.mipmask&1<<r),"extra mipmap data");e.compressed&&h(!t.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(t,e,n,r){var i=t.width,a=t.height,o=t.channels;h(0<i&&i<=r.maxTextureSize&&0<a&&a<=r.maxTextureSize,"invalid texture shape"),h(i===a,"cube map must be square"),h(33071===e.wrapS&&33071===e.wrapT,"wrap mode not supported by cube map");for(var s=0;s<n.length;++s){var l=n[s];h(l.width===i&&l.height===a,"inconsistent cube map face shape"),e.genMipmaps&&(h(!l.compressed,"can not generate mipmap for compressed textures"),h(1===l.mipmask,"can not specify mipmaps and generate mipmaps"));for(var c=l.images,u=0;u<16;++u){var f=c[u];if(f){var d=i>>u,p=a>>u;h(l.mipmask&1<<u,"missing mipmap data"),h(f.width===d&&f.height===p,"invalid shape for mip images"),h(f.format===t.format&&f.internalformat===t.internalformat&&f.type===t.type,"incompatible type for mip image"),f.compressed||(f.data?h(f.data.byteLength===d*p*Math.max(x(f.type,o),f.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):f.element||f.copy)}}}}}),M=0;function j(t,e){this.id=M++,this.type=t,this.data=e}function k(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function z(t){return"["+function t(e){if(0===e.length)return[];var n=e.charAt(0),r=e.charAt(e.length-1);if(1<e.length&&n===r&&('"'===n||"'"===n))return['"'+k(e.substr(1,e.length-2))+'"'];var i=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e);if(i)return t(e.substr(0,i.index)).concat(t(i[1])).concat(t(e.substr(i.index+i[0].length)));var a=e.split(".");if(1===a.length)return['"'+k(e)+'"'];for(var o=[],s=0;s<a.length;++s)o=o.concat(t(a[s]));return o}(t).join("][")+"]"}var et={DynamicVariable:j,define:function(t,e){return new j(t,z(e+""))},isDynamic:function(t){return"function"==typeof t&&!t._reglType||t instanceof j},unbox:function(t,e){return"function"!=typeof t?t:new j(0,t)},accessor:z},nt={next:"function"==typeof requestAnimationFrame?function(t){return requestAnimationFrame(t)}:function(t){return setTimeout(t,16)},cancel:"function"==typeof cancelAnimationFrame?function(t){return cancelAnimationFrame(t)}:clearTimeout},rt="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function N(t){return"string"==typeof t?t.split():(tt(Array.isArray(t),"invalid extension array"),t)}function A(t){return"string"==typeof t?(tt("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(t)):t}function it(t){var e,n,r,i,a,o,s=t||{},l={},c=[],u=[],f="undefined"==typeof window?1:window.devicePixelRatio,d=!1,p=function(t){t&&tt.raise(t)},h=function(){};if("string"==typeof s?(tt("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),e=document.querySelector(s),tt(e,"invalid query string for element")):"object"==typeof s?"string"==typeof(o=s).nodeName&&"function"==typeof o.appendChild&&"function"==typeof o.getBoundingClientRect?e=s:"function"==typeof(a=s).drawArrays||"function"==typeof a.drawElements?r=(i=s).canvas:(tt.constructor(s),"gl"in s?i=s.gl:"canvas"in s?r=A(s.canvas):"container"in s&&(n=A(s.container)),"attributes"in s&&(l=s.attributes,tt.type(l,"object","invalid context attributes")),"extensions"in s&&(c=N(s.extensions)),"optionalExtensions"in s&&(u=N(s.optionalExtensions)),"onDone"in s&&(tt.type(s.onDone,"function","invalid or missing onDone callback"),p=s.onDone),"profile"in s&&(d=!!s.profile),"pixelRatio"in s&&(f=+s.pixelRatio,tt(0<f,"invalid pixel ratio"))):tt.raise("invalid arguments to regl"),e&&("canvas"===e.nodeName.toLowerCase()?r=e:n=e),!i){if(!r){tt("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var g=function(r,t,i){var a=document.createElement("canvas");function e(){var t=window.innerWidth,e=window.innerHeight;if(r!==document.body){var n=r.getBoundingClientRect();t=n.right-n.left,e=n.bottom-n.top}a.width=i*t,a.height=i*e,$(a.style,{width:t+"px",height:e+"px"})}function n(){window.removeEventListener("resize",e),r.removeChild(a)}return $(a.style,{border:0,margin:0,padding:0,top:0,left:0}),r.appendChild(a),r===document.body&&(a.style.position="absolute",$(r.style,{margin:0,padding:0})),window.addEventListener("resize",e,!1),e(),{canvas:a,onDestroy:n}}(n||document.body,0,f);if(!g)return null;r=g.canvas,h=g.onDestroy}i=function(e,n){function t(t){try{return e.getContext(t,n)}catch(t){return null}}return t("webgl")||t("experimental-webgl")||t("webgl-experimental")}(r,l)}return i?{gl:i,canvas:r,container:n,extensions:c,optionalExtensions:u,pixelRatio:f,profile:d,onDone:p,onDestroy:h}:(h(),p("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function at(r,t){var i={};function e(t){tt.type(t,"string","extension name must be string");var e,n=t.toLowerCase();try{e=i[n]=r.getExtension(n)}catch(t){}return!!e}for(var n=0;n<t.extensions.length;++n){var a=t.extensions[n];if(!e(a))return t.onDestroy(),t.onDone('"'+a+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(e),{extensions:i,restore:function(){Object.keys(i).forEach(function(t){if(i[t]&&!e(t))throw new Error("(regl): error restoring extension "+t)})}}}function V(t,e){for(var n=Array(t),r=0;r<t;++r)n[r]=e(r);return n}function D(t){var e,n;return e=(65535<t)<<4,e|=n=(255<(t>>>=e))<<3,e|=n=(15<(t>>>=n))<<2,(e|=n=(3<(t>>>=n))<<1)|(t>>>=n)>>1}function t(){var r=V(8,function(){return[]});function i(t){var e=function(t){for(var e=16;e<=1<<28;e*=16)if(t<=e)return e;return 0}(t),n=r[D(e)>>2];return 0<n.length?n.pop():new ArrayBuffer(e)}function e(t){r[D(t.byteLength)>>2].push(t)}return{alloc:i,free:e,allocType:function(t,e){var n=null;switch(t){case 5120:n=new Int8Array(i(e),0,e);break;case 5121:n=new Uint8Array(i(e),0,e);break;case 5122:n=new Int16Array(i(2*e),0,e);break;case 5123:n=new Uint16Array(i(2*e),0,e);break;case 5124:n=new Int32Array(i(4*e),0,e);break;case 5125:n=new Uint32Array(i(4*e),0,e);break;case 5126:n=new Float32Array(i(4*e),0,e);break;default:return null}return n.length===e?n:n.subarray(0,e)},freeType:function(t){e(t.buffer)}}}var ot=t();ot.zero=t();var st=function(t,e){var n=1;e.ext_texture_filter_anisotropic&&(n=t.getParameter(34047));var r=1,i=1;e.webgl_draw_buffers&&(r=t.getParameter(34852),i=t.getParameter(36063));var a=!!e.oes_texture_float;if(a){var o=t.createTexture();t.bindTexture(3553,o),t.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var s=t.createFramebuffer();if(t.bindFramebuffer(36160,s),t.framebufferTexture2D(36160,36064,3553,o,0),t.bindTexture(3553,null),36053!==t.checkFramebufferStatus(36160))a=!1;else{t.viewport(0,0,1,1),t.clearColor(1,0,0,1),t.clear(16384);var l=ot.allocType(5126,4);t.readPixels(0,0,1,1,6408,5126,l),a=!t.getError()&&(t.deleteFramebuffer(s),t.deleteTexture(o),1===l[0]),ot.freeType(l)}}var c="undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),u=!0;if(!c){var f=t.createTexture(),d=ot.allocType(5121,36);t.activeTexture(33984),t.bindTexture(34067,f),t.texImage2D(34069,0,6408,3,3,0,6408,5121,d),ot.freeType(d),t.bindTexture(34067,null),t.deleteTexture(f),u=!t.getError()}return{colorBits:[t.getParameter(3410),t.getParameter(3411),t.getParameter(3412),t.getParameter(3413)],depthBits:t.getParameter(3414),stencilBits:t.getParameter(3415),subpixelBits:t.getParameter(3408),extensions:Object.keys(e).filter(function(t){return!!e[t]}),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:t.getParameter(33901),lineWidthDims:t.getParameter(33902),maxViewportDims:t.getParameter(3386),maxCombinedTextureUnits:t.getParameter(35661),maxCubeMapSize:t.getParameter(34076),maxRenderbufferSize:t.getParameter(34024),maxTextureUnits:t.getParameter(34930),maxTextureSize:t.getParameter(3379),maxAttributes:t.getParameter(34921),maxVertexUniforms:t.getParameter(36347),maxVertexTextureUnits:t.getParameter(35660),maxVaryingVectors:t.getParameter(36348),maxFragmentUniforms:t.getParameter(36349),glsl:t.getParameter(35724),renderer:t.getParameter(7937),vendor:t.getParameter(7936),version:t.getParameter(7938),readFloat:a,npotTextureCube:u}};function lt(t){return!!t&&"object"==typeof t&&Array.isArray(t.shape)&&Array.isArray(t.stride)&&"number"==typeof t.offset&&t.shape.length===t.stride.length&&(Array.isArray(t.data)||K(t.data))}var ct=function(e){return Object.keys(e).map(function(t){return e[t]})},ut={shape:function(t){for(var e=[],n=t;n.length;n=n[0])e.push(n.length);return e},flatten:function(t,e,n,r){var i=1;if(e.length)for(var a=0;a<e.length;++a)i*=e[a];else i=0;var o=r||ot.allocType(n,i);switch(e.length){case 0:break;case 1:!function(t,e,n){for(var r=0;r<e;++r)n[r]=t[r]}(t,e[0],o);break;case 2:!function(t,e,n,r){for(var i=0,a=0;a<e;++a)for(var o=t[a],s=0;s<n;++s)r[i++]=o[s]}(t,e[0],e[1],o);break;case 3:T(t,e[0],e[1],e[2],o,0);break;default:!function t(e,n,r,i,a){for(var o=1,s=r+1;s<n.length;++s)o*=n[s];var l=n[r];if(n.length-r==4){var c=n[r+1],u=n[r+2],f=n[r+3];for(s=0;s<l;++s)T(e[s],c,u,f,i,a),a+=o}else for(s=0;s<l;++s)t(e[s],n,r+1,i,a),a+=o}(t,e,0,o,0)}return o}};function T(t,e,n,r,i,a){for(var o=a,s=0;s<e;++s)for(var l=t[s],c=0;c<n;++c)for(var u=l[c],f=0;f<r;++f)i[o++]=u[f]}var I={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},X={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},L={dynamic:35048,stream:35040,static:35044},S=ut.flatten,E=ut.shape,C=35044,O=35040,P=5121,Y=5126,F=[];function B(t){return 0|I[Object.prototype.toString.call(t)]}function U(t,e){for(var n=0;n<e.length;++n)t[n]=e[n]}function R(t,e,n,r,i,a,o){for(var s=0,l=0;l<n;++l)for(var c=0;c<r;++c)t[s++]=e[i*l+a*c+o]}function ft(s,i,l,a){var e=0,c={};function u(t){this.id=e++,this.buffer=s.createBuffer(),this.type=t,this.usage=C,this.byteLength=0,this.dimension=1,this.dtype=P,this.persistentData=null,l.profile&&(this.stats={size:0})}u.prototype.bind=function(){s.bindBuffer(this.type,this.buffer)},u.prototype.destroy=function(){d(this)};var r=[];function y(t,e,n){t.byteLength=e.byteLength,s.bufferData(t.type,e,n)}function f(t,e,n,r,i,a){var o,s;if(t.usage=n,Array.isArray(e)){if(t.dtype=r||Y,0<e.length)if(Array.isArray(e[0])){o=E(e);for(var l=1,c=1;c<o.length;++c)l*=o[c];t.dimension=l,s=S(e,o,t.dtype),y(t,s,n),a?t.persistentData=s:ot.freeType(s)}else if("number"==typeof e[0]){t.dimension=i;var u=ot.allocType(t.dtype,e.length);U(u,e),y(t,u,n),a?t.persistentData=u:ot.freeType(u)}else K(e[0])?(t.dimension=e[0].length,t.dtype=r||B(e[0])||Y,s=S(e,[e.length,e[0].length],t.dtype),y(t,s,n),a?t.persistentData=s:ot.freeType(s)):tt.raise("invalid buffer data")}else if(K(e))t.dtype=r||B(e),t.dimension=i,y(t,e,n),a&&(t.persistentData=new Uint8Array(new Uint8Array(e.buffer)));else if(lt(e)){o=e.shape;var f=e.stride,d=e.offset,p=0,h=0,g=0,m=0;1===o.length?(p=o[0],h=1,g=f[0],m=0):2===o.length?(p=o[0],h=o[1],g=f[0],m=f[1]):tt.raise("invalid shape"),t.dtype=r||B(e.data)||Y,t.dimension=h;var _=ot.allocType(t.dtype,p*h);R(_,e.data,p,h,g,m,d),y(t,_,n),a?t.persistentData=_:ot.freeType(_)}else tt.raise("invalid buffer data")}function d(t){i.bufferCount--;for(var e=0;e<a.state.length;++e){var n=a.state[e];n.buffer===t&&(s.disableVertexAttribArray(e),n.buffer=null)}var r=t.buffer;tt(r,"buffer must not be deleted already"),s.deleteBuffer(r),t.buffer=null,delete c[t.id]}return l.profile&&(i.getTotalBufferSize=function(){var e=0;return Object.keys(c).forEach(function(t){e+=c[t].stats.size}),e}),{create:function(t,e,n,o){i.bufferCount++;var p=new u(e);function h(t){var e=C,n=null,r=0,i=0,a=1;return Array.isArray(t)||K(t)||lt(t)?n=t:"number"==typeof t?r=0|t:t&&(tt.type(t,"object","buffer arguments must be an object, a number or an array"),"data"in t&&(tt(null===n||Array.isArray(n)||K(n)||lt(n),"invalid data for buffer"),n=t.data),"usage"in t&&(tt.parameter(t.usage,L,"invalid buffer usage"),e=L[t.usage]),"type"in t&&(tt.parameter(t.type,X,"invalid buffer type"),i=X[t.type]),"dimension"in t&&(tt.type(t.dimension,"number","invalid dimension"),a=0|t.dimension),"length"in t&&(tt.nni(r,"buffer length must be a nonnegative integer"),r=0|t.length)),p.bind(),n?f(p,n,e,i,a,o):(r&&s.bufferData(p.type,r,e),p.dtype=i||P,p.usage=e,p.dimension=a,p.byteLength=r),l.profile&&(p.stats.size=p.byteLength*F[p.dtype]),h}function g(t,e){tt(e+t.byteLength<=p.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+t.byteLength+" starting from offset "+e+" to a buffer of size "+p.byteLength),s.bufferSubData(p.type,e,t)}function r(t,e){var n,r=0|(e||0);if(p.bind(),K(t))g(t,r);else if(Array.isArray(t)){if(0<t.length)if("number"==typeof t[0]){var i=ot.allocType(p.dtype,t.length);U(i,t),g(i,r),ot.freeType(i)}else if(Array.isArray(t[0])||K(t[0])){n=E(t);var a=S(t,n,p.dtype);g(a,r),ot.freeType(a)}else tt.raise("invalid buffer data")}else if(lt(t)){n=t.shape;var o=t.stride,s=0,l=0,c=0,u=0;1===n.length?(s=n[0],l=1,c=o[0],u=0):2===n.length?(s=n[0],l=n[1],c=o[0],u=o[1]):tt.raise("invalid shape");var f=Array.isArray(t.data)?p.dtype:B(t.data),d=ot.allocType(f,s*l);R(d,t.data,s,l,c,u,t.offset),g(d,r),ot.freeType(d)}else tt.raise("invalid data for buffer subdata");return h}return c[p.id]=p,n||h(t),h._reglType="buffer",h._buffer=p,h.subdata=r,l.profile&&(h.stats=p.stats),h.destroy=function(){d(p)},h},createStream:function(t,e){var n=r.pop();return n||(n=new u(t)),n.bind(),f(n,e,O,0,1,!1),n},destroyStream:function(t){r.push(t)},clear:function(){ct(c).forEach(d),r.forEach(d)},getBuffer:function(t){return t&&t._buffer instanceof u?t._buffer:null},restore:function(){ct(c).forEach(function(t){t.buffer=s.createBuffer(),s.bindBuffer(t.type,t.buffer),s.bufferData(t.type,t.persistentData||t.byteLength,t.usage)})},_initBuffer:f}}F[5120]=1,F[5122]=2,F[5124]=4,F[5121]=1,F[5123]=2,F[5125]=4;var J={points:0,point:0,lines:1,line:1,triangles:F[5126]=4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},H=0,Z=1,Q=4,G=5120,q=5121,W=5122,dt=5123,pt=5124,ht=5125,gt=34963,mt=35040,_t=35044;function yt(d,p,h,n){var e={},r=0,u={uint8:q,uint16:dt};function i(t){this.id=r++,(e[this.id]=this).buffer=t,this.primType=Q,this.vertCount=0,this.type=0}p.oes_element_index_uint&&(u.uint32=ht),i.prototype.bind=function(){this.buffer.bind()};var a=[];function f(t,e,n,r,i,a,o){if(t.buffer.bind(),e){var s=o;o||K(e)&&(!lt(e)||K(e.data))||(s=p.oes_element_index_uint?ht:dt),h._initBuffer(t.buffer,e,n,s,3)}else d.bufferData(gt,a,n),t.buffer.dtype=l||q,t.buffer.usage=n,t.buffer.dimension=3,t.buffer.byteLength=a;var l=o;if(!o){switch(t.buffer.dtype){case q:case G:l=q;break;case dt:case W:l=dt;break;case ht:case pt:l=ht;break;default:tt.raise("unsupported type for element array")}t.buffer.dtype=l}t.type=l,tt(l!==ht||!!p.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var c=i;c<0&&(c=t.buffer.byteLength,l===dt?c>>=1:l===ht&&(c>>=2)),t.vertCount=c;var u=r;if(r<0){u=Q;var f=t.buffer.dimension;1===f&&(u=H),2===f&&(u=Z),3===f&&(u=Q)}t.primType=u}function o(t){n.elementsCount--,tt(null!==t.buffer,"must not double destroy elements"),delete e[t.id],t.buffer.destroy(),t.buffer=null}return{create:function(t,e){var s=h.create(null,gt,!0),l=new i(s._buffer);function c(t){if(t)if("number"==typeof t)s(t),l.primType=Q,l.vertCount=0|t,l.type=q;else{var e=null,n=_t,r=-1,i=-1,a=0,o=0;Array.isArray(t)||K(t)||lt(t)?e=t:(tt.type(t,"object","invalid arguments for elements"),"data"in t&&(e=t.data,tt(Array.isArray(e)||K(e)||lt(e),"invalid data for element buffer")),"usage"in t&&(tt.parameter(t.usage,L,"invalid element buffer usage"),n=L[t.usage]),"primitive"in t&&(tt.parameter(t.primitive,J,"invalid element buffer primitive"),r=J[t.primitive]),"count"in t&&(tt("number"==typeof t.count&&0<=t.count,"invalid vertex count for elements"),i=0|t.count),"type"in t&&(tt.parameter(t.type,u,"invalid buffer type"),o=u[t.type]),"length"in t?a=0|t.length:(a=i,o===dt||o===W?a*=2:o!==ht&&o!==pt||(a*=4))),f(l,e,n,r,i,a,o)}else s(),l.primType=Q,l.vertCount=0,l.type=q;return c}return n.elementsCount++,c(t),c._reglType="elements",c._elements=l,c.subdata=function(t,e){return s.subdata(t,e),c},c.destroy=function(){o(l)},c},createStream:function(t){var e=a.pop();return e||(e=new i(h.create(null,gt,!0,!1)._buffer)),f(e,t,mt,-1,-1,0,0),e},destroyStream:function(t){a.push(t)},getElements:function(t){return"function"==typeof t&&t._elements instanceof i?t._elements:null},clear:function(){ct(e).forEach(o)}}}var bt=new Float32Array(1),vt=new Uint32Array(bt.buffer),xt=5123;function wt(t){for(var e=ot.allocType(xt,t.length),n=0;n<t.length;++n)if(isNaN(t[n]))e[n]=65535;else if(t[n]===1/0)e[n]=31744;else if(t[n]===-1/0)e[n]=64512;else{bt[0]=t[n];var r=vt[0],i=r>>>31<<15,a=(r<<1>>>24)-127,o=r>>13&1023;if(a<-24)e[n]=i;else if(a<-14){var s=-14-a;e[n]=i+(o+1024>>s)}else e[n]=15<a?i+31744:i+(a+15<<10)+o}return e}function Mt(t){return Array.isArray(t)||K(t)}var jt=function(t){return!(t&t-1||!t)},kt=34467,zt=3553,Nt=34067,At=34069,Dt=6408,Tt=6406,It=6407,Lt=6409,St=6410,Et=32854,Ct=32855,Ot=36194,Pt=32819,Yt=32820,Ft=33635,Bt=34042,Ut=6402,Rt=34041,Ht=35904,Zt=35906,Qt=36193,Gt=33776,qt=33777,Wt=33778,Vt=33779,Xt=35986,Jt=35987,Kt=34798,$t=35840,te=35841,ee=35842,ne=35843,re=36196,ie=5121,ae=5123,oe=5125,se=5126,le=10242,ce=10243,ue=10497,fe=33071,de=33648,pe=10240,he=10241,ge=9728,me=9729,_e=9984,ye=9985,be=9986,ve=9987,xe=33170,we=4352,Me=4353,je=4354,ke=34046,ze=3317,Ne=37440,Ae=37441,De=37443,Te=37444,Ie=33984,Le=[_e,be,ye,ve],Se=[0,Lt,St,It,Dt],Ee={};function Ce(t){return"[object "+t+"]"}Ee[Lt]=Ee[Tt]=Ee[Ut]=1,Ee[Rt]=Ee[St]=2,Ee[It]=Ee[Ht]=3,Ee[Dt]=Ee[Zt]=4;var Oe=Ce("HTMLCanvasElement"),Pe=Ce("CanvasRenderingContext2D"),Ye=Ce("ImageBitmap"),Fe=Ce("HTMLImageElement"),Be=Ce("HTMLVideoElement"),Ue=Object.keys(I).concat([Oe,Pe,Ye,Fe,Be]),Re=[];Re[ie]=1,Re[se]=4,Re[Qt]=2,Re[ae]=2,Re[oe]=4;var He=[];function Ze(t){return Array.isArray(t)&&(0===t.length||"number"==typeof t[0])}function Qe(t){if(!Array.isArray(t))return!1;var e=t.length;return!(0===e||!Mt(t[0]))}function Ge(t){return Object.prototype.toString.call(t)}function qe(t){return Ge(t)===Oe}function We(t){if(!t)return!1;var e=Ge(t);return 0<=Ue.indexOf(e)||Ze(t)||Qe(t)||lt(t)}function Ve(t){return 0|I[Object.prototype.toString.call(t)]}function Xe(t,e){return ot.allocType(t.type===Qt?se:t.type,e)}function Je(t,e){t.type===Qt?(t.data=wt(e),ot.freeType(e)):t.data=e}function Ke(t,e,n,r,i,a){var o;if(o=void 0!==He[t]?He[t]:Ee[t]*Re[e],a&&(o*=6),i){for(var s=0,l=n;1<=l;)s+=o*l*l,l/=2;return s}return o*n*r}function $e(p,u,x,d,w,l,h){var f={"don't care":we,"dont care":we,nice:je,fast:Me},g={repeat:ue,clamp:fe,mirror:de},m={nearest:ge,linear:me},_=$({mipmap:ve,"nearest mipmap nearest":_e,"linear mipmap nearest":ye,"nearest mipmap linear":be,"linear mipmap linear":ve},m),y={none:0,browser:Te},b={uint8:ie,rgba4:Pt,rgb565:Ft,"rgb5 a1":Yt},v={alpha:Tt,luminance:Lt,"luminance alpha":St,rgb:It,rgba:Dt,rgba4:Et,"rgb5 a1":Ct,rgb565:Ot},M={};u.ext_srgb&&(v.srgb=Ht,v.srgba=Zt),u.oes_texture_float&&(b.float32=b.float=se),u.oes_texture_half_float&&(b.float16=b["half float"]=Qt),u.webgl_depth_texture&&($(v,{depth:Ut,"depth stencil":Rt}),$(b,{uint16:ae,uint32:oe,"depth stencil":Bt})),u.webgl_compressed_texture_s3tc&&$(M,{"rgb s3tc dxt1":Gt,"rgba s3tc dxt1":qt,"rgba s3tc dxt3":Wt,"rgba s3tc dxt5":Vt}),u.webgl_compressed_texture_atc&&$(M,{"rgb atc":Xt,"rgba atc explicit alpha":Jt,"rgba atc interpolated alpha":Kt}),u.webgl_compressed_texture_pvrtc&&$(M,{"rgb pvrtc 4bppv1":$t,"rgb pvrtc 2bppv1":te,"rgba pvrtc 4bppv1":ee,"rgba pvrtc 2bppv1":ne}),u.webgl_compressed_texture_etc1&&(M["rgb etc1"]=re);var n=Array.prototype.slice.call(p.getParameter(kt));Object.keys(M).forEach(function(t){var e=M[t];0<=n.indexOf(e)&&(v[t]=e)});var t=Object.keys(v);x.textureFormats=t;var j=[];Object.keys(v).forEach(function(t){var e=v[t];j[e]=t});var k=[];Object.keys(b).forEach(function(t){var e=b[t];k[e]=t});var z=[];Object.keys(m).forEach(function(t){var e=m[t];z[e]=t});var N=[];Object.keys(_).forEach(function(t){var e=_[t];N[e]=t});var A=[];Object.keys(g).forEach(function(t){var e=g[t];A[e]=t});var D=t.reduce(function(t,e){var n=v[e];return n===Lt||n===Tt||n===Lt||n===St||n===Ut||n===Rt?t[n]=n:n===Ct||0<=e.indexOf("rgba")?t[n]=Dt:t[n]=It,t},{});function r(){this.internalformat=Dt,this.format=Dt,this.type=ie,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Te,this.width=0,this.height=0,this.channels=0}function T(t,e){t.internalformat=e.internalformat,t.format=e.format,t.type=e.type,t.compressed=e.compressed,t.premultiplyAlpha=e.premultiplyAlpha,t.flipY=e.flipY,t.unpackAlignment=e.unpackAlignment,t.colorSpace=e.colorSpace,t.width=e.width,t.height=e.height,t.channels=e.channels}function I(t,e){if("object"==typeof e&&e){if("premultiplyAlpha"in e&&(tt.type(e.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),t.premultiplyAlpha=e.premultiplyAlpha),"flipY"in e&&(tt.type(e.flipY,"boolean","invalid texture flip"),t.flipY=e.flipY),"alignment"in e&&(tt.oneOf(e.alignment,[1,2,4,8],"invalid texture unpack alignment"),t.unpackAlignment=e.alignment),"colorSpace"in e&&(tt.parameter(e.colorSpace,y,"invalid colorSpace"),t.colorSpace=y[e.colorSpace]),"type"in e){var n=e.type;tt(u.oes_texture_float||!("float"===n||"float32"===n),"you must enable the OES_texture_float extension in order to use floating point textures."),tt(u.oes_texture_half_float||!("half float"===n||"float16"===n),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),tt(u.webgl_depth_texture||!("uint16"===n||"uint32"===n||"depth stencil"===n),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),tt.parameter(n,b,"invalid texture type"),t.type=b[n]}var r=t.width,i=t.height,a=t.channels,o=!1;"shape"in e?(tt(Array.isArray(e.shape)&&2<=e.shape.length,"shape must be an array"),r=e.shape[0],i=e.shape[1],3===e.shape.length&&(a=e.shape[2],tt(0<a&&a<=4,"invalid number of channels"),o=!0),tt(0<=r&&r<=x.maxTextureSize,"invalid width"),tt(0<=i&&i<=x.maxTextureSize,"invalid height")):("radius"in e&&(r=i=e.radius,tt(0<=r&&r<=x.maxTextureSize,"invalid radius")),"width"in e&&(r=e.width,tt(0<=r&&r<=x.maxTextureSize,"invalid width")),"height"in e&&(i=e.height,tt(0<=i&&i<=x.maxTextureSize,"invalid height")),"channels"in e&&(a=e.channels,tt(0<a&&a<=4,"invalid number of channels"),o=!0)),t.width=0|r,t.height=0|i,t.channels=0|a;var s=!1;if("format"in e){var l=e.format;tt(u.webgl_depth_texture||!("depth"===l||"depth stencil"===l),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),tt.parameter(l,v,"invalid texture format");var c=t.internalformat=v[l];t.format=D[c],l in b&&("type"in e||(t.type=b[l])),l in M&&(t.compressed=!0),s=!0}!o&&s?t.channels=Ee[t.format]:o&&!s?t.channels!==Se[t.format]&&(t.format=t.internalformat=Se[t.channels]):s&&o&&tt(t.channels===Ee[t.format],"number of channels inconsistent with specified format")}}function L(t){p.pixelStorei(Ne,t.flipY),p.pixelStorei(Ae,t.premultiplyAlpha),p.pixelStorei(De,t.colorSpace),p.pixelStorei(ze,t.unpackAlignment)}function e(){r.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function c(t,e){var n=null;if(We(e)?n=e:e&&(tt.type(e,"object","invalid pixel data type"),I(t,e),"x"in e&&(t.xOffset=0|e.x),"y"in e&&(t.yOffset=0|e.y),We(e.data)&&(n=e.data)),tt(!t.compressed||n instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),e.copy){tt(!n,"can not specify copy and data field for the same texture");var r=w.viewportWidth,i=w.viewportHeight;t.width=t.width||r-t.xOffset,t.height=t.height||i-t.yOffset,t.needsCopy=!0,tt(0<=t.xOffset&&t.xOffset<r&&0<=t.yOffset&&t.yOffset<i&&0<t.width&&t.width<=r&&0<t.height&&t.height<=i,"copy texture read out of bounds")}else if(n){if(K(n))t.channels=t.channels||4,t.data=n,"type"in e||t.type!==ie||(t.type=Ve(n));else if(Ze(n))t.channels=t.channels||4,function(t,e){var n=e.length;switch(t.type){case ie:case ae:case oe:case se:var r=ot.allocType(t.type,n);r.set(e),t.data=r;break;case Qt:t.data=wt(e);break;default:tt.raise("unsupported texture type, must specify a typed array")}}(t,n),t.alignment=1,t.needsFree=!0;else if(lt(n)){var a=n.data;Array.isArray(a)||t.type!==ie||(t.type=Ve(a));var o,s,l,c,u,f,d=n.shape,p=n.stride;f=3===d.length?(l=d[2],p[2]):(tt(2===d.length,"invalid ndarray pixel data, must be 2 or 3D"),l=1),o=d[0],s=d[1],c=p[0],u=p[1],t.alignment=1,t.width=o,t.height=s,t.channels=l,t.format=t.internalformat=Se[l],t.needsFree=!0,function(t,e,n,r,i,a){for(var o=t.width,s=t.height,l=t.channels,c=Xe(t,o*s*l),u=0,f=0;f<s;++f)for(var d=0;d<o;++d)for(var p=0;p<l;++p)c[u++]=e[n*d+r*f+i*p+a];Je(t,c)}(t,a,c,u,f,n.offset)}else if(qe(n)||Ge(n)===Pe)qe(n)?t.element=n:t.element=n.canvas,t.width=t.element.width,t.height=t.element.height,t.channels=4;else if(Ge(n)===Ye)t.element=n,t.width=n.width,t.height=n.height,t.channels=4;else if(Ge(n)===Fe)t.element=n,t.width=n.naturalWidth,t.height=n.naturalHeight,t.channels=4;else if(Ge(n)===Be)t.element=n,t.width=n.videoWidth,t.height=n.videoHeight,t.channels=4;else if(Qe(n)){var h=t.width||n[0].length,g=t.height||n.length,m=t.channels;m=Mt(n[0][0])?m||n[0][0].length:m||1;for(var _=ut.shape(n),y=1,b=0;b<_.length;++b)y*=_[b];var v=Xe(t,y);ut.flatten(n,_,"",v),Je(t,v),t.alignment=1,t.width=h,t.height=g,t.channels=m,t.format=t.internalformat=Se[m],t.needsFree=!0}}else t.width=t.width||1,t.height=t.height||1,t.channels=t.channels||4;t.type===se?tt(0<=x.extensions.indexOf("oes_texture_float"),"oes_texture_float extension not enabled"):t.type===Qt&&tt(0<=x.extensions.indexOf("oes_texture_half_float"),"oes_texture_half_float extension not enabled")}function i(t,e,n){var r=t.element,i=t.data,a=t.internalformat,o=t.format,s=t.type,l=t.width,c=t.height,u=t.channels;if(L(t),r)p.texImage2D(e,n,o,o,s,r);else if(t.compressed)p.compressedTexImage2D(e,n,a,l,c,0,i);else if(t.needsCopy)d(),p.copyTexImage2D(e,n,o,t.xOffset,t.yOffset,l,c,0);else{var f=!i;f&&(i=ot.zero.allocType(s,l*c*u)),p.texImage2D(e,n,o,l,c,0,o,s,i),f&&i&&ot.zero.freeType(i)}}function S(t,e,n,r,i){var a=t.element,o=t.data,s=t.internalformat,l=t.format,c=t.type,u=t.width,f=t.height;L(t),a?p.texSubImage2D(e,i,n,r,l,c,a):t.compressed?p.compressedTexSubImage2D(e,i,n,r,s,u,f,o):t.needsCopy?(d(),p.copyTexSubImage2D(e,i,n,r,t.xOffset,t.yOffset,u,f)):p.texSubImage2D(e,i,n,r,u,f,l,c,o)}var a=[];function E(){return a.pop()||new e}function C(t){t.needsFree&&ot.freeType(t.data),e.call(t),a.push(t)}function o(){r.call(this),this.genMipmaps=!1,this.mipmapHint=we,this.mipmask=0,this.images=Array(16)}function O(t,e,n){var r=t.images[0]=E();t.mipmask=1,r.width=t.width=e,r.height=t.height=n,r.channels=t.channels=4}function P(t,e){var n=null;if(We(e))T(n=t.images[0]=E(),t),c(n,e),t.mipmask=1;else if(I(t,e),Array.isArray(e.mipmap))for(var r=e.mipmap,i=0;i<r.length;++i)T(n=t.images[i]=E(),t),n.width>>=i,n.height>>=i,c(n,r[i]),t.mipmask|=1<<i;else T(n=t.images[0]=E(),t),c(n,e),t.mipmask=1;T(t,t.images[0]),(t.compressed&&t.internalformat===Gt||t.internalformat===qt||t.internalformat===Wt||t.internalformat===Vt)&&tt(t.width%4==0&&t.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Y(t,e){for(var n=t.images,r=0;r<n.length;++r){if(!n[r])return;i(n[r],e,r)}}var s=[];function F(){var t=s.pop()||new o;r.call(t);for(var e=t.mipmask=0;e<16;++e)t.images[e]=null;return t}function B(t){for(var e=t.images,n=0;n<e.length;++n)e[n]&&C(e[n]),e[n]=null;s.push(t)}function U(){this.minFilter=ge,this.magFilter=ge,this.wrapS=fe,this.wrapT=fe,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=we}function R(t,e){if("min"in e){var n=e.min;tt.parameter(n,_),t.minFilter=_[n],0<=Le.indexOf(t.minFilter)&&!("faces"in e)&&(t.genMipmaps=!0)}if("mag"in e){var r=e.mag;tt.parameter(r,m),t.magFilter=m[r]}var i=t.wrapS,a=t.wrapT;if("wrap"in e){var o=e.wrap;"string"==typeof o?(tt.parameter(o,g),i=a=g[o]):Array.isArray(o)&&(tt.parameter(o[0],g),tt.parameter(o[1],g),i=g[o[0]],a=g[o[1]])}else{if("wrapS"in e){var s=e.wrapS;tt.parameter(s,g),i=g[s]}if("wrapT"in e){var l=e.wrapT;tt.parameter(l,g),a=g[l]}}if(t.wrapS=i,t.wrapT=a,"anisotropic"in e){var c=e.anisotropic;tt("number"==typeof c&&1<=c&&c<=x.maxAnisotropic,"aniso samples must be between 1 and "),t.anisotropic=e.anisotropic}if("mipmap"in e){var u=!1;switch(typeof e.mipmap){case"string":tt.parameter(e.mipmap,f,"invalid mipmap hint"),t.mipmapHint=f[e.mipmap],t.genMipmaps=!0,u=!0;break;case"boolean":u=t.genMipmaps=e.mipmap;break;case"object":tt(Array.isArray(e.mipmap),"invalid mipmap type"),t.genMipmaps=!1,u=!0;break;default:tt.raise("invalid mipmap type")}!u||"min"in e||(t.minFilter=_e)}}function H(t,e){p.texParameteri(e,he,t.minFilter),p.texParameteri(e,pe,t.magFilter),p.texParameteri(e,le,t.wrapS),p.texParameteri(e,ce,t.wrapT),u.ext_texture_filter_anisotropic&&p.texParameteri(e,ke,t.anisotropic),t.genMipmaps&&(p.hint(xe,t.mipmapHint),p.generateMipmap(e))}var Z=0,Q={},G=x.maxTextureUnits,q=Array(G).map(function(){return null});function W(t){r.call(this),this.mipmask=0,this.internalformat=Dt,this.id=Z++,this.refCount=1,this.target=t,this.texture=p.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new U,h.profile&&(this.stats={size:0})}function V(t){p.activeTexture(Ie),p.bindTexture(t.target,t.texture)}function X(){var t=q[0];t?p.bindTexture(t.target,t.texture):p.bindTexture(zt,null)}function J(t){var e=t.texture;tt(e,"must not double destroy texture");var n=t.unit,r=t.target;0<=n&&(p.activeTexture(Ie+n),p.bindTexture(r,null),q[n]=null),p.deleteTexture(e),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete Q[t.id],l.textureCount--}return $(W.prototype,{bind:function(){this.bindCount+=1;var t=this.unit;if(t<0){for(var e=0;e<G;++e){var n=q[e];if(n){if(0<n.bindCount)continue;n.unit=-1}q[e]=this,t=e;break}G<=t&&tt.raise("insufficient number of texture units"),h.profile&&l.maxTextureUnits<t+1&&(l.maxTextureUnits=t+1),this.unit=t,p.activeTexture(Ie+t),p.bindTexture(this.target,this.texture)}return t},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&J(this)}}),h.profile&&(l.getTotalTextureSize=function(){var e=0;return Object.keys(Q).forEach(function(t){e+=Q[t].stats.size}),e}),{create2D:function(t,e){var u=new W(zt);function f(t,e){var n=u.texInfo;U.call(n);var r=F();return"number"==typeof t?O(r,0|t,"number"==typeof e?0|e:0|t):t?(tt.type(t,"object","invalid arguments to regl.texture"),R(n,t),P(r,t)):O(r,1,1),n.genMipmaps&&(r.mipmask=(r.width<<1)-1),u.mipmask=r.mipmask,T(u,r),tt.texture2D(n,r,x),u.internalformat=r.internalformat,f.width=r.width,f.height=r.height,V(u),Y(r,zt),H(n,zt),X(),B(r),h.profile&&(u.stats.size=Ke(u.internalformat,u.type,r.width,r.height,n.genMipmaps,!1)),f.format=j[u.internalformat],f.type=k[u.type],f.mag=z[n.magFilter],f.min=N[n.minFilter],f.wrapS=A[n.wrapS],f.wrapT=A[n.wrapT],f}function n(t,e,n,r){tt(!!t,"must specify image data");var i=0|e,a=0|n,o=0|r,s=E();return T(s,u),s.width=0,s.height=0,c(s,t),s.width=s.width||(u.width>>o)-i,s.height=s.height||(u.height>>o)-a,tt(u.type===s.type&&u.format===s.format&&u.internalformat===s.internalformat,"incompatible format for texture.subimage"),tt(0<=i&&0<=a&&i+s.width<=u.width&&a+s.height<=u.height,"texture.subimage write out of bounds"),tt(u.mipmask&1<<o,"missing mipmap data"),tt(s.data||s.element||s.needsCopy,"missing image data"),V(u),S(s,zt,i,a,o),X(),C(s),f}function r(t,e){var n,r=0|t,i=0|e||r;if(r===u.width&&i===u.height)return f;f.width=u.width=r,f.height=u.height=i,V(u);for(var a=u.channels,o=u.type,s=0;u.mipmask>>s;++s){var l=r>>s,c=i>>s;if(!l||!c)break;n=ot.zero.allocType(o,l*c*a),p.texImage2D(zt,s,u.format,l,c,0,u.format,u.type,n),n&&ot.zero.freeType(n)}return X(),h.profile&&(u.stats.size=Ke(u.internalformat,u.type,r,i,!1,!1)),f}return Q[u.id]=u,l.textureCount++,f(t,e),f.subimage=n,f.resize=r,f._reglType="texture2d",f._texture=u,h.profile&&(f.stats=u.stats),f.destroy=function(){u.decRef()},f},createCube:function(t,e,n,r,i,a){var u=new W(Nt);Q[u.id]=u,l.cubeCount++;var f=new Array(6);function d(t,e,n,r,i,a){var o,s=u.texInfo;for(U.call(s),o=0;o<6;++o)f[o]=F();if("number"!=typeof t&&t)if("object"==typeof t)if(e)P(f[0],t),P(f[1],e),P(f[2],n),P(f[3],r),P(f[4],i),P(f[5],a);else if(R(s,t),I(u,t),"faces"in t){var l=t.faces;for(tt(Array.isArray(l)&&6===l.length,"cube faces must be a length 6 array"),o=0;o<6;++o)tt("object"==typeof l[o]&&!!l[o],"invalid input for cube map face"),T(f[o],u),P(f[o],l[o])}else for(o=0;o<6;++o)P(f[o],t);else tt.raise("invalid arguments to cube map");else{var c=0|t||1;for(o=0;o<6;++o)O(f[o],c,c)}for(T(u,f[0]),x.npotTextureCube||tt(jt(u.width)&&jt(u.height),"your browser does not support non power or two texture dimensions"),s.genMipmaps?u.mipmask=(f[0].width<<1)-1:u.mipmask=f[0].mipmask,tt.textureCube(u,s,f,x),u.internalformat=f[0].internalformat,d.width=f[0].width,d.height=f[0].height,V(u),o=0;o<6;++o)Y(f[o],At+o);for(H(s,Nt),X(),h.profile&&(u.stats.size=Ke(u.internalformat,u.type,d.width,d.height,s.genMipmaps,!0)),d.format=j[u.internalformat],d.type=k[u.type],d.mag=z[s.magFilter],d.min=N[s.minFilter],d.wrapS=A[s.wrapS],d.wrapT=A[s.wrapT],o=0;o<6;++o)B(f[o]);return d}function o(t,e,n,r,i){tt(!!e,"must specify image data"),tt("number"==typeof t&&t===(0|t)&&0<=t&&t<6,"invalid face");var a=0|n,o=0|r,s=0|i,l=E();return T(l,u),l.width=0,l.height=0,c(l,e),l.width=l.width||(u.width>>s)-a,l.height=l.height||(u.height>>s)-o,tt(u.type===l.type&&u.format===l.format&&u.internalformat===l.internalformat,"incompatible format for texture.subimage"),tt(0<=a&&0<=o&&a+l.width<=u.width&&o+l.height<=u.height,"texture.subimage write out of bounds"),tt(u.mipmask&1<<s,"missing mipmap data"),tt(l.data||l.element||l.needsCopy,"missing image data"),V(u),S(l,At+t,a,o,s),X(),C(l),d}function s(t){var e=0|t;if(e!==u.width){d.width=u.width=e,d.height=u.height=e,V(u);for(var n=0;n<6;++n)for(var r=0;u.mipmask>>r;++r)p.texImage2D(At+n,r,u.format,e>>r,e>>r,0,u.format,u.type,null);return X(),h.profile&&(u.stats.size=Ke(u.internalformat,u.type,d.width,d.height,!1,!0)),d}}return d(t,e,n,r,i,a),d.subimage=o,d.resize=s,d._reglType="textureCube",d._texture=u,h.profile&&(d.stats=u.stats),d.destroy=function(){u.decRef()},d},clear:function(){for(var t=0;t<G;++t)p.activeTexture(Ie+t),p.bindTexture(zt,null),q[t]=null;ct(Q).forEach(J),l.cubeCount=0,l.textureCount=0},getTexture:function(t){return null},restore:function(){for(var t=0;t<G;++t){var e=q[t];e&&(e.bindCount=0,e.unit=-1,q[t]=null)}ct(Q).forEach(function(t){t.texture=p.createTexture(),p.bindTexture(t.target,t.texture);for(var e=0;e<32;++e)if(0!=(t.mipmask&1<<e))if(t.target===zt)p.texImage2D(zt,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);else for(var n=0;n<6;++n)p.texImage2D(At+n,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);H(t.texInfo,t.target)})}}}He[Et]=2,He[Ct]=2,He[Ot]=2,He[Rt]=4,He[Gt]=.5,He[qt]=.5,He[Wt]=1,He[Vt]=1,He[Xt]=.5,He[Jt]=1,He[Kt]=1,He[$t]=.5,He[te]=.25,He[ee]=.5,He[ne]=.25,He[re]=.5;var tn=36161,en=[];function nn(t,e,n){return en[t]*e*n}en[32854]=2,en[32855]=2,en[36194]=2,en[33189]=2,en[36168]=1,en[34041]=4,en[35907]=4,en[34836]=16,en[34842]=8,en[34843]=6;var rn=function(c,t,u,r,f){var d={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};t.ext_srgb&&(d.srgba=35907),t.ext_color_buffer_half_float&&(d.rgba16f=34842,d.rgb16f=34843),t.webgl_color_buffer_float&&(d.rgba32f=34836);var p=[];Object.keys(d).forEach(function(t){var e=d[t];p[e]=t});var e=0,i={};function a(t){this.id=e++,this.refCount=1,this.renderbuffer=t,this.format=32854,this.width=0,this.height=0,f.profile&&(this.stats={size:0})}function n(t){var e=t.renderbuffer;tt(e,"must not double destroy renderbuffer"),c.bindRenderbuffer(tn,null),c.deleteRenderbuffer(e),t.renderbuffer=null,t.refCount=0,delete i[t.id],r.renderbufferCount--}return a.prototype.decRef=function(){--this.refCount<=0&&n(this)},f.profile&&(r.getTotalRenderbufferSize=function(){var e=0;return Object.keys(i).forEach(function(t){e+=i[t].stats.size}),e}),{create:function(t,e){var s=new a(c.createRenderbuffer());function l(t,e){var n=0,r=0,i=32854;if("object"==typeof t&&t){var a=t;if("shape"in a){var o=a.shape;tt(Array.isArray(o)&&2<=o.length,"invalid renderbuffer shape"),n=0|o[0],r=0|o[1]}else"radius"in a&&(n=r=0|a.radius),"width"in a&&(n=0|a.width),"height"in a&&(r=0|a.height);"format"in a&&(tt.parameter(a.format,d,"invalid renderbuffer format"),i=d[a.format])}else"number"==typeof t?(n=0|t,r="number"==typeof e?0|e:n):t?tt.raise("invalid arguments to renderbuffer constructor"):n=r=1;if(tt(0<n&&0<r&&n<=u.maxRenderbufferSize&&r<=u.maxRenderbufferSize,"invalid renderbuffer size"),n!==s.width||r!==s.height||i!==s.format)return l.width=s.width=n,l.height=s.height=r,s.format=i,c.bindRenderbuffer(tn,s.renderbuffer),c.renderbufferStorage(tn,i,n,r),tt(0===c.getError(),"invalid render buffer format"),f.profile&&(s.stats.size=nn(s.format,s.width,s.height)),l.format=p[s.format],l}function n(t,e){var n=0|t,r=0|e||n;return n===s.width&&r===s.height||(tt(0<n&&0<r&&n<=u.maxRenderbufferSize&&r<=u.maxRenderbufferSize,"invalid renderbuffer size"),l.width=s.width=n,l.height=s.height=r,c.bindRenderbuffer(tn,s.renderbuffer),c.renderbufferStorage(tn,s.format,n,r),tt(0===c.getError(),"invalid render buffer format"),f.profile&&(s.stats.size=nn(s.format,s.width,s.height))),l}return i[s.id]=s,r.renderbufferCount++,l(t,e),l.resize=n,l._reglType="renderbuffer",l._renderbuffer=s,f.profile&&(l.stats=s.stats),l.destroy=function(){s.decRef()},l},clear:function(){ct(i).forEach(n)},restore:function(){ct(i).forEach(function(t){t.renderbuffer=c.createRenderbuffer(),c.bindRenderbuffer(tn,t.renderbuffer),c.renderbufferStorage(tn,t.format,t.width,t.height)}),c.bindRenderbuffer(tn,null)}}},an=36160,on=36161,sn=3553,ln=34069,cn=36064,un=36096,fn=36128,dn=33306,pn=36053,hn=6402,gn=[6407,6408],mn=[];mn[6408]=4,mn[6407]=3;var _n=[];_n[5121]=1,_n[5126]=4,_n[36193]=2;var yn=33189,bn=36168,vn=34041,xn=[32854,32855,36194,35907,34842,34843,34836],wn={};function Mn(i,z,N,m,s,n){var A={cur:null,next:null,dirty:!1,setFBO:null},D=["rgba"],T=["rgba4","rgb565","rgb5 a1"];z.ext_srgb&&T.push("srgba"),z.ext_color_buffer_half_float&&T.push("rgba16f","rgb16f"),z.webgl_color_buffer_float&&T.push("rgba32f");var I=["uint8"];function l(t,e,n){this.target=t,this.texture=e,this.renderbuffer=n;var r=0,i=0;e?(r=e.width,i=e.height):n&&(r=n.width,i=n.height),this.width=r,this.height=i}function e(t){t&&(t.texture&&t.texture._texture.decRef(),t.renderbuffer&&t.renderbuffer._renderbuffer.decRef())}function L(t,e,n){if(t)if(t.texture){var r=t.texture._texture,i=Math.max(1,r.width),a=Math.max(1,r.height);tt(i===e&&a===n,"inconsistent width/height for supplied texture"),r.refCount+=1}else{var o=t.renderbuffer._renderbuffer;tt(o.width===e&&o.height===n,"inconsistent width/height for renderbuffer"),o.refCount+=1}}function a(t,e){e&&(e.texture?i.framebufferTexture2D(an,t,e.target,e.texture._texture.texture,0):i.framebufferRenderbuffer(an,t,on,e.renderbuffer._renderbuffer.renderbuffer))}function S(t){var e=sn,n=null,r=null,i=t;"object"==typeof t&&(i=t.data,"target"in t&&(e=0|t.target)),tt.type(i,"function","invalid attachment data");var a=i._reglType;return"texture2d"===a?(n=i,tt(e===sn)):"textureCube"===a?(n=i,tt(ln<=e&&e<ln+6,"invalid cube map target")):"renderbuffer"===a?(r=i,e=on):tt.raise("invalid regl object for attachment"),new l(e,n,r)}function E(t,e,n,r,i){if(n){var a=m.create2D({width:t,height:e,format:r,type:i});return a._texture.refCount=0,new l(sn,a,null)}var o=s.create({width:t,height:e,format:r});return o._renderbuffer.refCount=0,new l(on,null,o)}function C(t){return t&&(t.texture||t.renderbuffer)}function o(t,e,n){t&&(t.texture?t.texture.resize(e,n):t.renderbuffer&&t.renderbuffer.resize(e,n),t.width=e,t.height=n)}z.oes_texture_half_float&&I.push("half float","float16"),z.oes_texture_float&&I.push("float","float32");var t=0,r={};function c(){this.id=t++,(r[this.id]=this).framebuffer=i.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function O(t){t.colorAttachments.forEach(e),e(t.depthAttachment),e(t.stencilAttachment),e(t.depthStencilAttachment)}function u(t){var e=t.framebuffer;tt(e,"must not double destroy framebuffer"),i.deleteFramebuffer(e),t.framebuffer=null,n.framebufferCount--,delete r[t.id]}function P(t){var e;i.bindFramebuffer(an,t.framebuffer);var n=t.colorAttachments;for(e=0;e<n.length;++e)a(cn+e,n[e]);for(e=n.length;e<N.maxColorAttachments;++e)i.framebufferTexture2D(an,cn+e,sn,null,0);i.framebufferTexture2D(an,dn,sn,null,0),i.framebufferTexture2D(an,un,sn,null,0),i.framebufferTexture2D(an,fn,sn,null,0),a(un,t.depthAttachment),a(fn,t.stencilAttachment),a(dn,t.depthStencilAttachment);var r=i.checkFramebufferStatus(an);i.isContextLost()||r===pn||tt.raise("framebuffer configuration not supported, status = "+wn[r]),i.bindFramebuffer(an,A.next?A.next.framebuffer:null),A.cur=A.next,i.getError()}function _(t,e){var j=new c;function k(t,e){var n;tt(A.next!==j,"can not update framebuffer which is currently in use");var r=0,i=0,a=!0,o=!0,s=null,l=!0,c="rgba",u="uint8",f=1,d=null,p=null,h=null,g=!1;if("number"==typeof t)r=0|t,i=0|e||r;else if(t){tt.type(t,"object","invalid arguments for framebuffer");var m=t;if("shape"in m){var _=m.shape;tt(Array.isArray(_)&&2<=_.length,"invalid shape for framebuffer"),r=_[0],i=_[1]}else"radius"in m&&(r=i=m.radius),"width"in m&&(r=m.width),"height"in m&&(i=m.height);("color"in m||"colors"in m)&&(s=m.color||m.colors,Array.isArray(s)&&tt(1===s.length||z.webgl_draw_buffers,"multiple render targets not supported")),s||("colorCount"in m&&(f=0|m.colorCount,tt(0<f,"invalid color buffer count")),"colorTexture"in m&&(l=!!m.colorTexture,c="rgba4"),"colorType"in m&&(u=m.colorType,l?(tt(z.oes_texture_float||!("float"===u||"float32"===u),"you must enable OES_texture_float in order to use floating point framebuffer objects"),tt(z.oes_texture_half_float||!("half float"===u||"float16"===u),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===u||"float16"===u?(tt(z.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),c="rgba16f"):"float"!==u&&"float32"!==u||(tt(z.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),c="rgba32f"),tt.oneOf(u,I,"invalid color type")),"colorFormat"in m&&(c=m.colorFormat,0<=D.indexOf(c)?l=!0:0<=T.indexOf(c)?l=!1:l?tt.oneOf(m.colorFormat,D,"invalid color format for texture"):tt.oneOf(m.colorFormat,T,"invalid color format for renderbuffer"))),("depthTexture"in m||"depthStencilTexture"in m)&&(g=!(!m.depthTexture&&!m.depthStencilTexture),tt(!g||z.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in m&&("boolean"==typeof m.depth?a=m.depth:(d=m.depth,o=!1)),"stencil"in m&&("boolean"==typeof m.stencil?o=m.stencil:(p=m.stencil,a=!1)),"depthStencil"in m&&("boolean"==typeof m.depthStencil?a=o=m.depthStencil:(h=m.depthStencil,o=a=!1))}else r=i=1;var y=null,b=null,v=null,x=null;if(Array.isArray(s))y=s.map(S);else if(s)y=[S(s)];else for(y=new Array(f),n=0;n<f;++n)y[n]=E(r,i,l,c,u);tt(z.webgl_draw_buffers||y.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),tt(y.length<=N.maxColorAttachments,"too many color attachments, not supported"),r=r||y[0].width,i=i||y[0].height,d?b=S(d):a&&!o&&(b=E(r,i,g,"depth","uint32")),p?v=S(p):o&&!a&&(v=E(r,i,!1,"stencil","uint8")),h?x=S(h):!d&&!p&&o&&a&&(x=E(r,i,g,"depth stencil","depth stencil")),tt(!!d+!!p+!!h<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var w=null;for(n=0;n<y.length;++n)if(L(y[n],r,i),tt(!y[n]||y[n].texture&&0<=gn.indexOf(y[n].texture._texture.format)||y[n].renderbuffer&&0<=xn.indexOf(y[n].renderbuffer._renderbuffer.format),"framebuffer color attachment "+n+" is invalid"),y[n]&&y[n].texture){var M=mn[y[n].texture._texture.format]*_n[y[n].texture._texture.type];null===w?w=M:tt(w===M,"all color attachments much have the same number of bits per pixel.")}return L(b,r,i),tt(!b||b.texture&&b.texture._texture.format===hn||b.renderbuffer&&b.renderbuffer._renderbuffer.format===yn,"invalid depth attachment for framebuffer object"),L(v,r,i),tt(!v||v.renderbuffer&&v.renderbuffer._renderbuffer.format===bn,"invalid stencil attachment for framebuffer object"),L(x,r,i),tt(!x||x.texture&&x.texture._texture.format===vn||x.renderbuffer&&x.renderbuffer._renderbuffer.format===vn,"invalid depth-stencil attachment for framebuffer object"),O(j),j.width=r,j.height=i,j.colorAttachments=y,j.depthAttachment=b,j.stencilAttachment=v,j.depthStencilAttachment=x,k.color=y.map(C),k.depth=C(b),k.stencil=C(v),k.depthStencil=C(x),k.width=j.width,k.height=j.height,P(j),k}return n.framebufferCount++,k(t,e),$(k,{resize:function(t,e){tt(A.next!==j,"can not resize a framebuffer which is currently in use");var n=Math.max(0|t,1),r=Math.max(0|e||n,1);if(n===j.width&&r===j.height)return k;for(var i=j.colorAttachments,a=0;a<i.length;++a)o(i[a],n,r);return o(j.depthAttachment,n,r),o(j.stencilAttachment,n,r),o(j.depthStencilAttachment,n,r),j.width=k.width=n,j.height=k.height=r,P(j),k},_reglType:"framebuffer",_framebuffer:j,destroy:function(){u(j),O(j)},use:function(t){A.setFBO({framebuffer:k},t)}})}return $(A,{getFramebuffer:function(t){if("function"==typeof t&&"framebuffer"===t._reglType){var e=t._framebuffer;if(e instanceof c)return e}return null},create:_,createCube:function(t){var h=Array(6);function g(t){var e;tt(h.indexOf(A.next)<0,"can not update framebuffer which is currently in use");var n,r={color:null},i=0,a=null,o="rgba",s="uint8",l=1;if("number"==typeof t)i=0|t;else if(t){tt.type(t,"object","invalid arguments for framebuffer");var c=t;if("shape"in c){var u=c.shape;tt(Array.isArray(u)&&2<=u.length,"invalid shape for framebuffer"),tt(u[0]===u[1],"cube framebuffer must be square"),i=u[0]}else"radius"in c&&(i=0|c.radius),"width"in c?(i=0|c.width,"height"in c&&tt(c.height===i,"must be square")):"height"in c&&(i=0|c.height);("color"in c||"colors"in c)&&(a=c.color||c.colors,Array.isArray(a)&&tt(1===a.length||z.webgl_draw_buffers,"multiple render targets not supported")),a||("colorCount"in c&&(l=0|c.colorCount,tt(0<l,"invalid color buffer count")),"colorType"in c&&(tt.oneOf(c.colorType,I,"invalid color type"),s=c.colorType),"colorFormat"in c&&(o=c.colorFormat,tt.oneOf(c.colorFormat,D,"invalid color format for texture"))),"depth"in c&&(r.depth=c.depth),"stencil"in c&&(r.stencil=c.stencil),"depthStencil"in c&&(r.depthStencil=c.depthStencil)}else i=1;if(a)if(Array.isArray(a))for(n=[],e=0;e<a.length;++e)n[e]=a[e];else n=[a];else{n=Array(l);var f={radius:i,format:o,type:s};for(e=0;e<l;++e)n[e]=m.createCube(f)}for(r.color=Array(n.length),e=0;e<n.length;++e){var d=n[e];tt("function"==typeof d&&"textureCube"===d._reglType,"invalid cube map"),i=i||d.width,tt(d.width===i&&d.height===i,"invalid cube map shape"),r.color[e]={target:ln,data:n[e]}}for(e=0;e<6;++e){for(var p=0;p<n.length;++p)r.color[p].target=ln+e;0<e&&(r.depth=h[0].depth,r.stencil=h[0].stencil,r.depthStencil=h[0].depthStencil),h[e]?h[e](r):h[e]=_(r)}return $(g,{width:i,height:i,color:n})}function e(t){var e,n=0|t;if(tt(0<n&&n<=N.maxCubeMapSize,"invalid radius for cube fbo"),n===g.width)return g;var r=g.color;for(e=0;e<r.length;++e)r[e].resize(n);for(e=0;e<6;++e)h[e].resize(n);return g.width=g.height=n,g}return g(t),$(g,{faces:h,resize:e,_reglType:"framebufferCube",destroy:function(){h.forEach(function(t){t.destroy()})}})},clear:function(){ct(r).forEach(u)},restore:function(){A.cur=null,A.next=null,A.dirty=!0,ct(r).forEach(function(t){t.framebuffer=i.createFramebuffer(),P(t)})}})}wn[pn]="complete",wn[36054]="incomplete attachment",wn[36057]="incomplete dimensions",wn[36055]="incomplete, missing attachment",wn[36061]="unsupported";var jn=5126;function kn(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=jn,this.offset=0,this.stride=0,this.divisor=0}function zn(t,e,n,r){for(var i=n.maxAttributes,a=new Array(i),o=0;o<i;++o)a[o]=new kn;return{Record:kn,scope:{},state:a}}var Nn=35632,An=35633,Dn=35718,Tn=35721;function In(p,h,a,g){var o={},s={};function m(t,e,n,r){this.name=t,this.id=e,this.location=n,this.info=r}function _(t,e){for(var n=0;n<t.length;++n)if(t[n].id===e.id)return void(t[n].location=e.location);t.push(e)}function y(t,e,n){var r=t===Nn?o:s,i=r[e];if(!i){var a=h.str(e);i=p.createShader(t),p.shaderSource(i,a),p.compileShader(i),tt.shaderError(p,i,a,t,n),r[e]=i}return i}var l={},c=[],n=0;function u(t,e){this.id=n++,this.fragId=t,this.vertId=e,this.program=null,this.uniforms=[],this.attributes=[],g.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function f(t,e){var n,r,i=y(Nn,t.fragId),a=y(An,t.vertId),o=t.program=p.createProgram();p.attachShader(o,i),p.attachShader(o,a),p.linkProgram(o),tt.linkError(p,o,h.str(t.fragId),h.str(t.vertId),e);var s=p.getProgramParameter(o,Dn);g.profile&&(t.stats.uniformsCount=s);var l=t.uniforms;for(n=0;n<s;++n)if(r=p.getActiveUniform(o,n))if(1<r.size)for(var c=0;c<r.size;++c){var u=r.name.replace("[0]","["+c+"]");_(l,new m(u,h.id(u),p.getUniformLocation(o,u),r))}else _(l,new m(r.name,h.id(r.name),p.getUniformLocation(o,r.name),r));var f=p.getProgramParameter(o,Tn);g.profile&&(t.stats.attributesCount=f);var d=t.attributes;for(n=0;n<f;++n)(r=p.getActiveAttrib(o,n))&&_(d,new m(r.name,h.id(r.name),p.getAttribLocation(o,r.name),r))}return g.profile&&(a.getMaxUniformsCount=function(){var e=0;return c.forEach(function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)}),e},a.getMaxAttributesCount=function(){var e=0;return c.forEach(function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)}),e}),{clear:function(){var t=p.deleteShader.bind(p);ct(o).forEach(t),o={},ct(s).forEach(t),s={},c.forEach(function(t){p.deleteProgram(t.program)}),c.length=0,l={},a.shaderCount=0},program:function(t,e,n){tt.command(0<=t,"missing vertex shader",n),tt.command(0<=e,"missing fragment shader",n);var r=l[e];r||(r=l[e]={});var i=r[t];return i||(i=new u(e,t),a.shaderCount++,f(i,n),r[t]=i,c.push(i)),i},restore:function(){o={},s={};for(var t=0;t<c.length;++t)f(c[t])},shader:y,frag:-1,vert:-1}}var Ln=6408,Sn=5121,En=3333,Cn=5126;function On(l,c,u,f,d,p,h){function r(t){var e;null===c.next?(tt(d.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),e=Sn):(tt(null!==c.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),e=c.next.colorAttachments[0].texture._texture.type,p.oes_texture_float?(tt(e===Sn||e===Cn,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),e===Cn&&tt(h.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):tt(e===Sn,"Reading from a framebuffer is only allowed for the type 'uint8'"));var n=0,r=0,i=f.framebufferWidth,a=f.framebufferHeight,o=null;K(t)?o=t:t&&(tt.type(t,"object","invalid arguments to regl.read()"),n=0|t.x,r=0|t.y,tt(0<=n&&n<f.framebufferWidth,"invalid x offset for regl.read"),tt(0<=r&&r<f.framebufferHeight,"invalid y offset for regl.read"),i=0|(t.width||f.framebufferWidth-n),a=0|(t.height||f.framebufferHeight-r),o=t.data||null),o&&(e===Sn?tt(o instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):e===Cn&&tt(o instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),tt(0<i&&i+n<=f.framebufferWidth,"invalid width for read pixels"),tt(0<a&&a+r<=f.framebufferHeight,"invalid height for read pixels"),u();var s=i*a*4;return o||(e===Sn?o=new Uint8Array(s):e===Cn&&(o=o||new Float32Array(s))),tt.isTypedArray(o,"data buffer for regl.read() must be a typedarray"),tt(o.byteLength>=s,"data buffer for regl.read() too small"),l.pixelStorei(En,4),l.readPixels(n,r,i,a,Ln,e,o),o}return function(t){return t&&"framebuffer"in t?(e=t,c.setFBO({framebuffer:e.framebuffer},function(){n=r(e)}),n):r(t);var e,n}}function Pn(t){return Array.prototype.slice.call(t)}function Yn(t){return Pn(t).join("")}var Fn="xyzw".split(""),Bn=5121,Un=1,Rn=2,Hn=0,Zn=1,Qn=2,Gn=3,qn=4,Wn="dither",Vn="blend.enable",Xn="blend.color",Jn="blend.equation",Kn="blend.func",$n="depth.enable",tr="depth.func",er="depth.range",nr="depth.mask",rr="colorMask",ir="cull.enable",ar="cull.face",or="frontFace",sr="lineWidth",lr="polygonOffset.enable",cr="polygonOffset.offset",ur="sample.alpha",fr="sample.enable",dr="sample.coverage",pr="stencil.enable",hr="stencil.mask",gr="stencil.func",mr="stencil.opFront",_r="stencil.opBack",yr="scissor.enable",br="scissor.box",vr="viewport",xr="profile",wr="framebuffer",Mr="vert",jr="frag",kr="elements",zr="primitive",Nr="count",Ar="offset",Dr="instances",Tr="Height",Ir=wr+"Width",Lr=wr+Tr,Sr=vr+"Width",Er=vr+Tr,Cr="drawingBuffer",Or=Cr+"Width",Pr=Cr+Tr,Yr=[Kn,Jn,gr,mr,_r,dr,vr,br,cr],Fr=34962,Br=34963,Ur=3553,Rr=34067,Hr=2884,Zr=3042,Qr=3024,Gr=2960,qr=2929,Wr=3089,Vr=32823,Xr=32926,Jr=32928,Kr=5126,$r=35664,ti=35665,ei=35666,ni=5124,ri=35667,ii=35668,ai=35669,oi=35670,si=35671,li=35672,ci=35673,ui=35674,fi=35675,di=35676,pi=35678,hi=35680,gi=4,mi=1028,_i=1029,yi=2304,bi=2305,vi=32775,xi=32776,wi=519,Mi=7680,ji=0,ki=1,zi=32774,Ni=513,Ai=36160,Di=36064,Ti={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Ii=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Li={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Si={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Ei={frag:35632,vert:35633},Ci={cw:yi,ccw:bi};function Oi(t){return Array.isArray(t)||K(t)||lt(t)}function Pi(t){return t.sort(function(t,e){return t===vr?-1:e===vr?1:t<e?-1:1})}function Yi(t,e,n,r){this.thisDep=t,this.contextDep=e,this.propDep=n,this.append=r}function Fi(t){return t&&!(t.thisDep||t.contextDep||t.propDep)}function Bi(t){return new Yi(!1,!1,!1,t)}function Ui(t,e){var n=t.type;if(n===Hn){var r=t.data.length;return new Yi(!0,1<=r,2<=r,e)}if(n!==qn)return new Yi(n===Gn,n===Qn,n===Zn,e);var i=t.data;return new Yi(i.thisDep,i.contextDep,i.propDep,e)}var Ri=new Yi(!1,!1,!1,function(){});function Hi(t,E,e,C,O,P,n,Y,r,u,F,i,a,b,o){var B=u.Record,U={add:32774,subtract:32778,"reverse subtract":32779};e.ext_blend_minmax&&(U.min=vi,U.max=xi);var R=e.angle_instanced_arrays,d=e.webgl_draw_buffers,h={dirty:!0,profile:o.profile},s={},H=[],g={},m={};function Z(t){return t.replace(".","_")}function l(t,e,n){var r=Z(t);H.push(t),s[r]=h[r]=!!n,g[r]=e}function c(t,e,n){var r=Z(t);H.push(t),Array.isArray(n)?(h[r]=n.slice(),s[r]=n.slice()):h[r]=s[r]=n,m[r]=e}l(Wn,Qr),l(Vn,Zr),c(Xn,"blendColor",[0,0,0,0]),c(Jn,"blendEquationSeparate",[zi,zi]),c(Kn,"blendFuncSeparate",[ki,ji,ki,ji]),l($n,qr,!0),c(tr,"depthFunc",Ni),c(er,"depthRange",[0,1]),c(nr,"depthMask",!0),c(rr,rr,[!0,!0,!0,!0]),l(ir,Hr),c(ar,"cullFace",_i),c(or,or,bi),c(sr,sr,1),l(lr,Vr),c(cr,"polygonOffset",[0,0]),l(ur,Xr),l(fr,Jr),c(dr,"sampleCoverage",[1,!1]),l(pr,Gr),c(hr,"stencilMask",-1),c(gr,"stencilFunc",[wi,0,-1]),c(mr,"stencilOpSeparate",[mi,Mi,Mi,Mi]),c(_r,"stencilOpSeparate",[_i,Mi,Mi,Mi]),l(yr,Wr),c(br,"scissor",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]),c(vr,vr,[0,0,t.drawingBufferWidth,t.drawingBufferHeight]);var f={gl:t,context:a,strings:E,next:s,current:h,draw:i,elements:P,buffer:O,shader:F,attributes:u.state,uniforms:r,framebuffer:Y,extensions:e,timer:b,isBufferArgs:Oi},p={primTypes:J,compareFuncs:Li,blendFuncs:Ti,blendEquations:U,stencilOps:Si,glTypes:X,orientationType:Ci};tt.optional(function(){f.isArrayLike=Mt}),d&&(p.backBuffer=[_i],p.drawBuffer=V(C.maxDrawbuffers,function(t){return 0===t?[0]:V(t,function(t){return Di+t})}));var _=0;function y(){var r=function(){var i=0,r=[],a=[];function t(t){for(var e=0;e<a.length;++e)if(a[e]===t)return r[e];var n="g"+i++;return r.push(n),a.push(t),n}function o(){var e=[];function t(){e.push.apply(e,Pn(arguments))}var n=[];function r(){var t="v"+i++;return n.push(t),0<arguments.length&&(e.push(t,"="),e.push.apply(e,Pn(arguments)),e.push(";")),t}return $(t,{def:r,toString:function(){return Yn([0<n.length?"var "+n+";":"",Yn(e)])}})}function s(){var r=o(),n=o(),t=r.toString,e=n.toString;function i(t,e){n(t,e,"=",r.def(t,e),";")}return $(function(){r.apply(r,Pn(arguments))},{def:r.def,entry:r,exit:n,save:i,set:function(t,e,n){i(t,e),r(t,e,"=",n,";")},toString:function(){return t()+e()}})}function e(){var e=Yn(arguments),t=s(),n=s(),r=t.toString,i=n.toString;return $(t,{then:function(){return t.apply(t,Pn(arguments)),this},else:function(){return n.apply(n,Pn(arguments)),this},toString:function(){var t=i();return t&&(t="else{"+t+"}"),Yn(["if(",e,"){",r(),"}",t])}})}var n=o(),l={};function c(t,e){var n=[];function r(){var t="a"+n.length;return n.push(t),t}e=e||0;for(var i=0;i<e;++i)r();var a=s(),o=a.toString;return l[t]=$(a,{arg:r,toString:function(){return Yn(["function(",n.join(),"){",o(),"}"])}})}function u(){var e=['"use strict";',n,"return {"];Object.keys(l).forEach(function(t){e.push('"',t,'":',l[t].toString(),",")}),e.push("}");var t=Yn(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,r.concat(t)).apply(null,a)}return{global:n,link:t,block:o,proc:c,scope:s,cond:e,compile:u}}(),i=r.link,e=r.global;r.id=_++,r.batchId="0";var n=i(f),a=r.shared={props:"a0"};Object.keys(f).forEach(function(t){a[t]=e.def(n,".",t)}),tt.optional(function(){r.CHECK=i(tt),r.commandStr=tt.guessCommand(),r.command=i(r.commandStr),r.assert=function(t,e,n){t("if(!(",e,"))",this.CHECK,".commandRaise(",i(n),",",this.command,");")},p.invalidBlendCombinations=Ii});var o=r.next={},s=r.current={};Object.keys(m).forEach(function(t){Array.isArray(h[t])&&(o[t]=e.def(a.next,".",t),s[t]=e.def(a.current,".",t))});var l=r.constants={};Object.keys(p).forEach(function(t){l[t]=e.def(JSON.stringify(p[t]))}),r.invoke=function(t,e){switch(e.type){case Hn:var n=["this",a.context,a.props,r.batchId];return t.def(i(e.data),".call(",n.slice(0,Math.max(e.data.length+1,4)),")");case Zn:return t.def(a.props,e.data);case Qn:return t.def(a.context,e.data);case Gn:return t.def("this",e.data);case qn:return e.data.append(r,t),e.data.ref}},r.attribCache={};var c={};return r.scopeAttrib=function(t){var e=E.id(t);if(e in c)return c[e];var n=u.scope[e];n||(n=u.scope[e]=new B);var r=c[e]=i(n);return r},r}function v(t,e,n,r,i){var a=t.static,o=t.dynamic;tt.optional(function(){var e=[wr,Mr,jr,kr,zr,Ar,Nr,Dr,xr].concat(H);function t(t){Object.keys(t).forEach(function(t){tt.command(0<=e.indexOf(t),'unknown parameter "'+t+'"',i.commandStr)})}t(a),t(o)});var s,l,u,f,d,c=function(t,e){var n=t.static,r=t.dynamic;if(wr in n){var a=n[wr];return a?(a=Y.getFramebuffer(a),tt.command(a,"invalid framebuffer object"),Bi(function(t,e){var n=t.link(a),r=t.shared;e.set(r.framebuffer,".next",n);var i=r.context;return e.set(i,"."+Ir,n+".width"),e.set(i,"."+Lr,n+".height"),n})):Bi(function(t,e){var n=t.shared;e.set(n.framebuffer,".next","null");var r=n.context;return e.set(r,"."+Ir,r+"."+Or),e.set(r,"."+Lr,r+"."+Pr),"null"})}if(wr in r){var s=r[wr];return Ui(s,function(t,e){var n=t.invoke(e,s),r=t.shared,i=r.framebuffer,a=e.def(i,".getFramebuffer(",n,")");tt.optional(function(){t.assert(e,"!"+n+"||"+a,"invalid framebuffer object")}),e.set(i,".next",a);var o=r.context;return e.set(o,"."+Ir,a+"?"+a+".width:"+o+"."+Or),e.set(o,"."+Lr,a+"?"+a+".height:"+o+"."+Pr),a})}return null}(t),p=function(t,n,r){var i=t.static,d=t.dynamic;function e(l){if(l in i){var a=i[l];tt.commandType(a,"object","invalid "+l,r.commandStr);var o,s,t=!0,c=0|a.x,u=0|a.y;return"width"in a?(o=0|a.width,tt.command(0<=o,"invalid "+l,r.commandStr)):t=!1,"height"in a?(s=0|a.height,tt.command(0<=s,"invalid "+l,r.commandStr)):t=!1,new Yi(!t&&n&&n.thisDep,!t&&n&&n.contextDep,!t&&n&&n.propDep,function(t,e){var n=t.shared.context,r=o;"width"in a||(r=e.def(n,".",Ir,"-",c));var i=s;return"height"in a||(i=e.def(n,".",Lr,"-",u)),[c,u,r,i]})}if(l in d){var f=d[l],e=Ui(f,function(t,e){var n=t.invoke(e,f);tt.optional(function(){t.assert(e,n+"&&typeof "+n+'==="object"',"invalid "+l)});var r=t.shared.context,i=e.def(n,".x|0"),a=e.def(n,".y|0"),o=e.def('"width" in ',n,"?",n,".width|0:","(",r,".",Ir,"-",i,")"),s=e.def('"height" in ',n,"?",n,".height|0:","(",r,".",Lr,"-",a,")");return tt.optional(function(){t.assert(e,o+">=0&&"+s+">=0","invalid "+l)}),[i,a,o,s]});return n&&(e.thisDep=e.thisDep||n.thisDep,e.contextDep=e.contextDep||n.contextDep,e.propDep=e.propDep||n.propDep),e}return n?new Yi(n.thisDep,n.contextDep,n.propDep,function(t,e){var n=t.shared.context;return[0,0,e.def(n,".",Ir),e.def(n,".",Lr)]}):null}var a=e(vr);if(a){var o=a;a=new Yi(a.thisDep,a.contextDep,a.propDep,function(t,e){var n=o.append(t,e),r=t.shared.context;return e.set(r,"."+Sr,n[2]),e.set(r,"."+Er,n[3]),n})}return{viewport:a,scissor_box:e(br)}}(t,c,i),h=function(t,o){var s=t.static,l=t.dynamic;function e(){if(kr in s){var r=s[kr];Oi(r)?r=P.getElements(P.create(r,!0)):r&&(r=P.getElements(r),tt.command(r,"invalid elements",o.commandStr));var t=Bi(function(t,e){if(r){var n=t.link(r);return t.ELEMENTS=n}return t.ELEMENTS=null});return t.value=r,t}if(kr in l){var c=l[kr];return Ui(c,function(t,e){var n=t.shared,r=n.isBufferArgs,i=n.elements,a=t.invoke(e,c),o=e.def("null"),s=e.def(r,"(",a,")"),l=t.cond(s).then(o,"=",i,".createStream(",a,");").else(o,"=",i,".getElements(",a,");");return tt.optional(function(){t.assert(l.else,"!"+a+"||"+o,"invalid elements")}),e.entry(l),e.exit(t.cond(s).then(i,".destroyStream(",o,");")),t.ELEMENTS=o})}return null}var c=e();function n(){if(zr in s){var n=s[zr];return tt.commandParameter(n,J,"invalid primitve",o.commandStr),Bi(function(t,e){return J[n]})}if(zr in l){var i=l[zr];return Ui(i,function(t,e){var n=t.constants.primTypes,r=t.invoke(e,i);return tt.optional(function(){t.assert(e,r+" in "+n,"invalid primitive, must be one of "+Object.keys(J))}),e.def(n,"[",r,"]")})}return c?Fi(c)?c.value?Bi(function(t,e){return e.def(t.ELEMENTS,".primType")}):Bi(function(){return gi}):new Yi(c.thisDep,c.contextDep,c.propDep,function(t,e){var n=t.ELEMENTS;return e.def(n,"?",n,".primType:",gi)}):null}function r(r,i){if(r in s){var n=0|s[r];return tt.command(!i||0<=n,"invalid "+r,o.commandStr),Bi(function(t,e){return i&&(t.OFFSET=n),n})}if(r in l){var a=l[r];return Ui(a,function(t,e){var n=t.invoke(e,a);return i&&(t.OFFSET=n,tt.optional(function(){t.assert(e,n+">=0","invalid "+r)})),n})}return i&&c?Bi(function(t,e){return t.OFFSET="0",0}):null}var i=r(Ar,!0);function a(){if(Nr in s){var t=0|s[Nr];return tt.command("number"==typeof t&&0<=t,"invalid vertex count",o.commandStr),Bi(function(){return t})}if(Nr in l){var r=l[Nr];return Ui(r,function(t,e){var n=t.invoke(e,r);return tt.optional(function(){t.assert(e,"typeof "+n+'==="number"&&'+n+">=0&&"+n+"===("+n+"|0)","invalid vertex count")}),n})}if(c){if(Fi(c)){if(c)return i?new Yi(i.thisDep,i.contextDep,i.propDep,function(t,e){var n=e.def(t.ELEMENTS,".vertCount-",t.OFFSET);return tt.optional(function(){t.assert(e,n+">=0","invalid vertex offset/element buffer too small")}),n}):Bi(function(t,e){return e.def(t.ELEMENTS,".vertCount")});var e=Bi(function(){return-1});return tt.optional(function(){e.MISSING=!0}),e}var n=new Yi(c.thisDep||i.thisDep,c.contextDep||i.contextDep,c.propDep||i.propDep,function(t,e){var n=t.ELEMENTS;return t.OFFSET?e.def(n,"?",n,".vertCount-",t.OFFSET,":-1"):e.def(n,"?",n,".vertCount:-1")});return tt.optional(function(){n.DYNAMIC=!0}),n}return null}return{elements:c,primitive:n(),count:a(),instances:r(Dr,!1),offset:i}}(t,i),g=(l=i,u=(s=t).static,f=s.dynamic,d={},H.forEach(function(c){var a=Z(c);function t(t,n){if(c in u){var e=t(u[c]);d[a]=Bi(function(){return e})}else if(c in f){var r=f[c];d[a]=Ui(r,function(t,e){return n(t,e,t.invoke(e,r))})}}switch(c){case ir:case Vn:case Wn:case pr:case $n:case yr:case lr:case ur:case fr:case nr:return t(function(t){return tt.commandType(t,"boolean",c,l.commandStr),t},function(t,e,n){return tt.optional(function(){t.assert(e,"typeof "+n+'==="boolean"',"invalid flag "+c,t.commandStr)}),n});case tr:return t(function(t){return tt.commandParameter(t,Li,"invalid "+c,l.commandStr),Li[t]},function(t,e,n){var r=t.constants.compareFuncs;return tt.optional(function(){t.assert(e,n+" in "+r,"invalid "+c+", must be one of "+Object.keys(Li))}),e.def(r,"[",n,"]")});case er:return t(function(t){return tt.command(Mt(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&t[0]<=t[1],"depth range is 2d array",l.commandStr),t},function(t,e,n){return tt.optional(function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")}),[e.def("+",n,"[0]"),e.def("+",n,"[1]")]});case Kn:return t(function(t){tt.commandType(t,"object","blend.func",l.commandStr);var e="srcRGB"in t?t.srcRGB:t.src,n="srcAlpha"in t?t.srcAlpha:t.src,r="dstRGB"in t?t.dstRGB:t.dst,i="dstAlpha"in t?t.dstAlpha:t.dst;return tt.commandParameter(e,Ti,a+".srcRGB",l.commandStr),tt.commandParameter(n,Ti,a+".srcAlpha",l.commandStr),tt.commandParameter(r,Ti,a+".dstRGB",l.commandStr),tt.commandParameter(i,Ti,a+".dstAlpha",l.commandStr),tt.command(-1===Ii.indexOf(e+", "+r),"unallowed blending combination (srcRGB, dstRGB) = ("+e+", "+r+")",l.commandStr),[Ti[e],Ti[r],Ti[n],Ti[i]]},function(r,i,a){var o=r.constants.blendFuncs;function t(t,e){var n=i.def('"',t,e,'" in ',a,"?",a,".",t,e,":",a,".",t);return tt.optional(function(){r.assert(i,n+" in "+o,"invalid "+c+"."+t+e+", must be one of "+Object.keys(Ti))}),n}tt.optional(function(){r.assert(i,a+"&&typeof "+a+'==="object"',"invalid blend func, must be an object")});var e=t("src","RGB"),n=t("dst","RGB");tt.optional(function(){var t=r.constants.invalidBlendCombinations;r.assert(i,t+".indexOf("+e+'+", "+'+n+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var s=i.def(o,"[",e,"]"),l=i.def(o,"[",t("src","Alpha"),"]");return[s,i.def(o,"[",n,"]"),l,i.def(o,"[",t("dst","Alpha"),"]")]});case Jn:return t(function(t){return"string"==typeof t?(tt.commandParameter(t,U,"invalid "+c,l.commandStr),[U[t],U[t]]):"object"==typeof t?(tt.commandParameter(t.rgb,U,c+".rgb",l.commandStr),tt.commandParameter(t.alpha,U,c+".alpha",l.commandStr),[U[t.rgb],U[t.alpha]]):void tt.commandRaise("invalid blend.equation",l.commandStr)},function(r,t,e){var i=r.constants.blendEquations,n=t.def(),a=t.def(),o=r.cond("typeof ",e,'==="string"');return tt.optional(function(){function t(t,e,n){r.assert(t,n+" in "+i,"invalid "+e+", must be one of "+Object.keys(U))}t(o.then,c,e),r.assert(o.else,e+"&&typeof "+e+'==="object"',"invalid "+c),t(o.else,c+".rgb",e+".rgb"),t(o.else,c+".alpha",e+".alpha")}),o.then(n,"=",a,"=",i,"[",e,"];"),o.else(n,"=",i,"[",e,".rgb];",a,"=",i,"[",e,".alpha];"),t(o),[n,a]});case Xn:return t(function(e){return tt.command(Mt(e)&&4===e.length,"blend.color must be a 4d array",l.commandStr),V(4,function(t){return+e[t]})},function(t,e,n){return tt.optional(function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")}),V(4,function(t){return e.def("+",n,"[",t,"]")})});case hr:return t(function(t){return tt.commandType(t,"number",a,l.commandStr),0|t},function(t,e,n){return tt.optional(function(){t.assert(e,"typeof "+n+'==="number"',"invalid stencil.mask")}),e.def(n,"|0")});case gr:return t(function(t){tt.commandType(t,"object",a,l.commandStr);var e=t.cmp||"keep",n=t.ref||0,r="mask"in t?t.mask:-1;return tt.commandParameter(e,Li,c+".cmp",l.commandStr),tt.commandType(n,"number",c+".ref",l.commandStr),tt.commandType(r,"number",c+".mask",l.commandStr),[Li[e],n,r]},function(e,n,r){var i=e.constants.compareFuncs;return tt.optional(function(){function t(){e.assert(n,Array.prototype.join.call(arguments,""),"invalid stencil.func")}t(r+"&&typeof ",r,'==="object"'),t('!("cmp" in ',r,")||(",r,".cmp in ",i,")")}),[n.def('"cmp" in ',r,"?",i,"[",r,".cmp]",":",Mi),n.def(r,".ref|0"),n.def('"mask" in ',r,"?",r,".mask|0:-1")]});case mr:case _r:return t(function(t){tt.commandType(t,"object",a,l.commandStr);var e=t.fail||"keep",n=t.zfail||"keep",r=t.zpass||"keep";return tt.commandParameter(e,Si,c+".fail",l.commandStr),tt.commandParameter(n,Si,c+".zfail",l.commandStr),tt.commandParameter(r,Si,c+".zpass",l.commandStr),[c===_r?_i:mi,Si[e],Si[n],Si[r]]},function(e,n,r){var i=e.constants.stencilOps;function t(t){return tt.optional(function(){e.assert(n,'!("'+t+'" in '+r+")||("+r+"."+t+" in "+i+")","invalid "+c+"."+t+", must be one of "+Object.keys(Si))}),n.def('"',t,'" in ',r,"?",i,"[",r,".",t,"]:",Mi)}return tt.optional(function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+c)}),[c===_r?_i:mi,t("fail"),t("zfail"),t("zpass")]});case cr:return t(function(t){tt.commandType(t,"object",a,l.commandStr);var e=0|t.factor,n=0|t.units;return tt.commandType(e,"number",a+".factor",l.commandStr),tt.commandType(n,"number",a+".units",l.commandStr),[e,n]},function(t,e,n){return tt.optional(function(){t.assert(e,n+"&&typeof "+n+'==="object"',"invalid "+c)}),[e.def(n,".factor|0"),e.def(n,".units|0")]});case ar:return t(function(t){var e=0;return"front"===t?e=mi:"back"===t&&(e=_i),tt.command(!!e,a,l.commandStr),e},function(t,e,n){return tt.optional(function(){t.assert(e,n+'==="front"||'+n+'==="back"',"invalid cull.face")}),e.def(n,'==="front"?',mi,":",_i)});case sr:return t(function(t){return tt.command("number"==typeof t&&t>=C.lineWidthDims[0]&&t<=C.lineWidthDims[1],"invalid line width, must be a positive number between "+C.lineWidthDims[0]+" and "+C.lineWidthDims[1],l.commandStr),t},function(t,e,n){return tt.optional(function(){t.assert(e,"typeof "+n+'==="number"&&'+n+">="+C.lineWidthDims[0]+"&&"+n+"<="+C.lineWidthDims[1],"invalid line width")}),n});case or:return t(function(t){return tt.commandParameter(t,Ci,a,l.commandStr),Ci[t]},function(t,e,n){return tt.optional(function(){t.assert(e,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),e.def(n+'==="cw"?'+yi+":"+bi)});case rr:return t(function(t){return tt.command(Mt(t)&&4===t.length,"color.mask must be length 4 array",l.commandStr),t.map(function(t){return!!t})},function(t,e,n){return tt.optional(function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")}),V(4,function(t){return"!!"+n+"["+t+"]"})});case dr:return t(function(t){tt.command("object"==typeof t&&t,a,l.commandStr);var e="value"in t?t.value:1,n=!!t.invert;return tt.command("number"==typeof e&&0<=e&&e<=1,"sample.coverage.value must be a number between 0 and 1",l.commandStr),[e,n]},function(t,e,n){return tt.optional(function(){t.assert(e,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")}),[e.def('"value" in ',n,"?+",n,".value:1"),e.def("!!",n,".invert")]})}}),d),m=function(t){var n=t.static,r=t.dynamic;function e(i){if(i in n){var t=E.id(n[i]);tt.optional(function(){F.shader(Ei[i],t,tt.guessCommand())});var e=Bi(function(){return t});return e.id=t,e}if(i in r){var a=r[i];return Ui(a,function(t,e){var n=t.invoke(e,a),r=e.def(t.shared.strings,".id(",n,")");return tt.optional(function(){e(t.shared.shader,".shader(",Ei[i],",",r,",",t.command,");")}),r})}return null}var i,o=e(jr),s=e(Mr),a=null;return i=Fi(o)&&Fi(s)?(a=F.program(s.id,o.id),Bi(function(t,e){return t.link(a)})):new Yi(o&&o.thisDep||s&&s.thisDep,o&&o.contextDep||s&&s.contextDep,o&&o.propDep||s&&s.propDep,function(t,e){var n,r,i=t.shared.shader;n=o?o.append(t,e):e.def(i,".",jr),r=s?s.append(t,e):e.def(i,".",Mr);var a=i+".program("+r+","+n;return tt.optional(function(){a+=","+t.command}),e.def(a+")")}),{frag:o,vert:s,progVar:i,program:a}}(t);function _(t){var e=p[t];e&&(g[t]=e)}_(vr),_(Z(br));var y,b,v,x,w,M,j,k,z,N,A,D,T,I,L=0<Object.keys(g).length,S={framebuffer:c,draw:h,shader:m,state:g,dirty:L};return S.profile=function(t){var e,n=t.static,r=t.dynamic;if(xr in n){var i=!!n[xr];(e=Bi(function(t,e){return i})).enable=i}else if(xr in r){var a=r[xr];e=Ui(a,function(t,e){return t.invoke(e,a)})}return e}(t),S.uniforms=(b=i,v=(y=n).static,x=y.dynamic,w={},Object.keys(v).forEach(function(n){var t,r=v[n];if("number"==typeof r||"boolean"==typeof r)t=Bi(function(){return r});else if("function"==typeof r){var e=r._reglType;"texture2d"===e||"textureCube"===e?t=Bi(function(t){return t.link(r)}):"framebuffer"===e||"framebufferCube"===e?(tt.command(0<r.color.length,'missing color attachment for framebuffer sent to uniform "'+n+'"',b.commandStr),t=Bi(function(t){return t.link(r.color[0])})):tt.commandRaise('invalid data for uniform "'+n+'"',b.commandStr)}else Mt(r)?t=Bi(function(e){return e.global.def("[",V(r.length,function(t){return tt.command("number"==typeof r[t]||"boolean"==typeof r[t],"invalid uniform "+n,e.commandStr),r[t]}),"]")}):tt.commandRaise('invalid or missing data for uniform "'+n+'"',b.commandStr);t.value=r,w[n]=t}),Object.keys(x).forEach(function(t){var n=x[t];w[t]=Ui(n,function(t,e){return t.invoke(e,n)})}),w),S.attributes=(j=i,k=(M=e).static,z=M.dynamic,N={},Object.keys(k).forEach(function(r){var t=k[r],i=E.id(r),a=new B;if(Oi(t))a.state=Un,a.buffer=O.getBuffer(O.create(t,Fr,!1,!0)),a.type=0;else{var e=O.getBuffer(t);if(e)a.state=Un,a.buffer=e,a.type=0;else if(tt.command("object"==typeof t&&t,"invalid data for attribute "+r,j.commandStr),"constant"in t){var n=t.constant;a.buffer="null",a.state=Rn,"number"==typeof n?a.x=n:(tt.command(Mt(n)&&0<n.length&&n.length<=4,"invalid constant for attribute "+r,j.commandStr),Fn.forEach(function(t,e){e<n.length&&(a[t]=n[e])}))}else{e=Oi(t.buffer)?O.getBuffer(O.create(t.buffer,Fr,!1,!0)):O.getBuffer(t.buffer),tt.command(!!e,'missing buffer for attribute "'+r+'"',j.commandStr);var o=0|t.offset;tt.command(0<=o,'invalid offset for attribute "'+r+'"',j.commandStr);var s=0|t.stride;tt.command(0<=s&&s<256,'invalid stride for attribute "'+r+'", must be integer betweeen [0, 255]',j.commandStr);var l=0|t.size;tt.command(!("size"in t)||0<l&&l<=4,'invalid size for attribute "'+r+'", must be 1,2,3,4',j.commandStr);var c=!!t.normalized,u=0;"type"in t&&(tt.commandParameter(t.type,X,"invalid type for attribute "+r,j.commandStr),u=X[t.type]);var f=0|t.divisor;"divisor"in t&&(tt.command(0===f||R,'cannot specify divisor for attribute "'+r+'", instancing not supported',j.commandStr),tt.command(0<=f,'invalid divisor for attribute "'+r+'"',j.commandStr)),tt.optional(function(){var e=j.commandStr,n=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(t).forEach(function(t){tt.command(0<=n.indexOf(t),'unknown parameter "'+t+'" for attribute pointer "'+r+'" (valid parameters are '+n+")",e)})}),a.buffer=e,a.state=Un,a.size=l,a.normalized=c,a.type=u||e.dtype,a.offset=o,a.stride=s,a.divisor=f}}N[r]=Bi(function(t,e){var n=t.attribCache;if(i in n)return n[i];var r={isStream:!1};return Object.keys(a).forEach(function(t){r[t]=a[t]}),a.buffer&&(r.buffer=t.link(a.buffer),r.type=r.type||r.buffer+".dtype"),n[i]=r})}),Object.keys(z).forEach(function(f){var d=z[f];function t(t,e){var n=t.invoke(e,d),r=t.shared,i=r.isBufferArgs,a=r.buffer;tt.optional(function(){t.assert(e,n+"&&(typeof "+n+'==="object"||typeof '+n+'==="function")&&('+i+"("+n+")||"+a+".getBuffer("+n+")||"+a+".getBuffer("+n+".buffer)||"+i+"("+n+'.buffer)||("constant" in '+n+"&&(typeof "+n+'.constant==="number"||'+r.isArrayLike+"("+n+".constant))))",'invalid dynamic attribute "'+f+'"')});var o={isStream:e.def(!1)},s=new B;s.state=Un,Object.keys(s).forEach(function(t){o[t]=e.def(""+s[t])});var l=o.buffer,c=o.type;function u(t){e(o[t],"=",n,".",t,"|0;")}return e("if(",i,"(",n,")){",o.isStream,"=true;",l,"=",a,".createStream(",Fr,",",n,");",c,"=",l,".dtype;","}else{",l,"=",a,".getBuffer(",n,");","if(",l,"){",c,"=",l,".dtype;",'}else if("constant" in ',n,"){",o.state,"=",Rn,";","if(typeof "+n+'.constant === "number"){',o[Fn[0]],"=",n,".constant;",Fn.slice(1).map(function(t){return o[t]}).join("="),"=0;","}else{",Fn.map(function(t,e){return o[t]+"="+n+".constant.length>"+e+"?"+n+".constant["+e+"]:0;"}).join(""),"}}else{","if(",i,"(",n,".buffer)){",l,"=",a,".createStream(",Fr,",",n,".buffer);","}else{",l,"=",a,".getBuffer(",n,".buffer);","}",c,'="type" in ',n,"?",r.glTypes,"[",n,".type]:",l,".dtype;",o.normalized,"=!!",n,".normalized;"),u("size"),u("offset"),u("stride"),u("divisor"),e("}}"),e.exit("if(",o.isStream,"){",a,".destroyStream(",l,");","}"),o}N[f]=Ui(d,t)}),N),S.context=(D=(A=r).static,T=A.dynamic,I={},Object.keys(D).forEach(function(t){var n=D[t];I[t]=Bi(function(t,e){return"number"==typeof n||"boolean"==typeof n?""+n:t.link(n)})}),Object.keys(T).forEach(function(t){var n=T[t];I[t]=Ui(n,function(t,e){return t.invoke(e,n)})}),I),S}function x(n,r,i){var t=n.shared,a=t.context,o=n.scope();Object.keys(i).forEach(function(t){r.save(a,"."+t);var e=i[t];o(a,".",t,"=",e.append(n,r),";")}),r(o)}function w(t,e,n,r){var i,a=t.shared,o=a.gl,s=a.framebuffer;d&&(i=e.def(a.extensions,".webgl_draw_buffers"));var l,c=t.constants,u=c.drawBuffer,f=c.backBuffer;l=n?n.append(t,e):e.def(s,".next"),r||e("if(",l,"!==",s,".cur){"),e("if(",l,"){",o,".bindFramebuffer(",Ai,",",l,".framebuffer);"),d&&e(i,".drawBuffersWEBGL(",u,"[",l,".colorAttachments.length]);"),e("}else{",o,".bindFramebuffer(",Ai,",null);"),d&&e(i,".drawBuffersWEBGL(",f,");"),e("}",s,".cur=",l,";"),r||e("}")}function M(o,t,s){var e=o.shared,l=e.gl,c=o.current,u=o.next,f=e.current,d=e.next,p=o.cond(f,".dirty");H.forEach(function(t){var e,n,r=Z(t);if(!(r in s.state))if(r in u){e=u[r],n=c[r];var i=V(h[r].length,function(t){return p.def(e,"[",t,"]")});p(o.cond(i.map(function(t,e){return t+"!=="+n+"["+e+"]"}).join("||")).then(l,".",m[r],"(",i,");",i.map(function(t,e){return n+"["+e+"]="+t}).join(";"),";"))}else{e=p.def(d,".",r);var a=o.cond(e,"!==",f,".",r);p(a),r in g?a(o.cond(e).then(l,".enable(",g[r],");").else(l,".disable(",g[r],");"),f,".",r,"=",e,";"):a(l,".",m[r],"(",e,");",f,".",r,"=",e,";")}}),0===Object.keys(s.state).length&&p(f,".dirty=false;"),t(p)}function j(a,o,s,l){var t=a.shared,c=a.current,u=t.current,f=t.gl;Pi(Object.keys(s)).forEach(function(t){var e=s[t];if(!l||l(e)){var n=e.append(a,o);if(g[t]){var r=g[t];Fi(e)?o(f,n?".enable(":".disable(",r,");"):o(a.cond(n).then(f,".enable(",r,");").else(f,".disable(",r,");")),o(u,".",t,"=",n,";")}else if(Mt(n)){var i=c[t];o(f,".",m[t],"(",n,");",n.map(function(t,e){return i+"["+e+"]="+t}).join(";"),";")}else o(f,".",m[t],"(",n,");",u,".",t,"=",n,";")}})}function k(t,e){R&&(t.instancing=e.def(t.shared.extensions,".angle_instanced_arrays"))}function z(t,n,e,r,i){var a,o,s,l=t.shared,c=t.stats,u=l.current,f=l.timer,d=e.profile;function p(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function h(t){a=n.def(),t(a,"=",p(),";"),"string"==typeof i?t(c,".count+=",i,";"):t(c,".count++;"),b&&(r?(o=n.def(),t(o,"=",f,".getNumPendingQueries();")):t(f,".beginQuery(",c,");"))}function g(t){t(c,".cpuTime+=",p(),"-",a,";"),b&&(r?t(f,".pushScopeStats(",o,",",f,".getNumPendingQueries(),",c,");"):t(f,".endQuery();"))}function m(t){var e=n.def(u,".profile");n(u,".profile=",t,";"),n.exit(u,".profile=",e,";")}if(d){if(Fi(d))return void(d.enable?(h(n),g(n.exit),m("true")):m("false"));m(s=d.append(t,n))}else s=n.def(u,".profile");var _=t.block();h(_),n("if(",s,"){",_,"}");var y=t.block();g(y),n.exit("if(",s,"){",y,"}")}function N(d,p,a,t,o){var h=d.shared;t.forEach(function(t){var e,n=t.name,r=a.attributes[n];if(r){if(!o(r))return;e=r.append(d,p)}else{if(!o(Ri))return;var i=d.scopeAttrib(n);tt.optional(function(){d.assert(p,i+".state","missing attribute "+n)}),e={},Object.keys(new B).forEach(function(t){e[t]=p.def(i,".",t)})}!function(t,r,i){var a=h.gl,o=p.def(t,".location"),s=p.def(h.attributes,"[",o,"]"),e=i.state,l=i.buffer,n=[i.x,i.y,i.z,i.w],c=["buffer","normalized","offset","stride"];function u(){p("if(!",s,".buffer){",a,".enableVertexAttribArray(",o,");}");var t,e=i.type;if(t=i.size?p.def(i.size,"||",r):r,p("if(",s,".type!==",e,"||",s,".size!==",t,"||",c.map(function(t){return s+"."+t+"!=="+i[t]}).join("||"),"){",a,".bindBuffer(",Fr,",",l,".buffer);",a,".vertexAttribPointer(",[o,t,e,i.normalized,i.stride,i.offset],");",s,".type=",e,";",s,".size=",t,";",c.map(function(t){return s+"."+t+"="+i[t]+";"}).join(""),"}"),R){var n=i.divisor;p("if(",s,".divisor!==",n,"){",d.instancing,".vertexAttribDivisorANGLE(",[o,n],");",s,".divisor=",n,";}")}}function f(){p("if(",s,".buffer){",a,".disableVertexAttribArray(",o,");","}if(",Fn.map(function(t,e){return s+"."+t+"!=="+n[e]}).join("||"),"){",a,".vertexAttrib4f(",o,",",n,");",Fn.map(function(t,e){return s+"."+t+"="+n[e]+";"}).join(""),"}")}e===Un?u():e===Rn?f():(p("if(",e,"===",Un,"){"),u(),p("}else{"),f(),p("}"))}(d.link(t),function(t){switch(t){case $r:case ri:case si:return 2;case ti:case ii:case li:return 3;case ei:case ai:case ci:return 4;default:return 1}}(t.info.type),e)})}function A(i,a,t,e,n){for(var r,o=i.shared,s=o.gl,l=0;l<e.length;++l){var c,u=e[l],f=u.name,d=u.info.type,p=t.uniforms[f],h=i.link(u),g=h+".location";if(p){if(!n(p))continue;if(Fi(p)){var m=p.value;if(tt.command(null!=m,'missing uniform "'+f+'"',i.commandStr),d===pi||d===hi){tt.command("function"==typeof m&&(d===pi&&("texture2d"===m._reglType||"framebuffer"===m._reglType)||d===hi&&("textureCube"===m._reglType||"framebufferCube"===m._reglType)),"invalid texture for uniform "+f,i.commandStr);var _=i.link(m._texture||m.color[0]._texture);a(s,".uniform1i(",g,",",_+".bind());"),a.exit(_,".unbind();")}else if(d===ui||d===fi||d===di){tt.optional(function(){tt.command(Mt(m),"invalid matrix for uniform "+f,i.commandStr),tt.command(d===ui&&4===m.length||d===fi&&9===m.length||d===di&&16===m.length,"invalid length for matrix uniform "+f,i.commandStr)});var y=i.global.def("new Float32Array(["+Array.prototype.slice.call(m)+"])"),b=2;d===fi?b=3:d===di&&(b=4),a(s,".uniformMatrix",b,"fv(",g,",false,",y,");")}else{switch(d){case Kr:tt.commandType(m,"number","uniform "+f,i.commandStr),r="1f";break;case $r:tt.command(Mt(m)&&2===m.length,"uniform "+f,i.commandStr),r="2f";break;case ti:tt.command(Mt(m)&&3===m.length,"uniform "+f,i.commandStr),r="3f";break;case ei:tt.command(Mt(m)&&4===m.length,"uniform "+f,i.commandStr),r="4f";break;case oi:tt.commandType(m,"boolean","uniform "+f,i.commandStr),r="1i";break;case ni:tt.commandType(m,"number","uniform "+f,i.commandStr),r="1i";break;case si:case ri:tt.command(Mt(m)&&2===m.length,"uniform "+f,i.commandStr),r="2i";break;case li:case ii:tt.command(Mt(m)&&3===m.length,"uniform "+f,i.commandStr),r="3i";break;case ci:case ai:tt.command(Mt(m)&&4===m.length,"uniform "+f,i.commandStr),r="4i"}a(s,".uniform",r,"(",g,",",Mt(m)?Array.prototype.slice.call(m):m,");")}continue}c=p.append(i,a)}else{if(!n(Ri))continue;c=a.def(o.uniforms,"[",E.id(f),"]")}d===pi?a("if(",c,"&&",c,'._reglType==="framebuffer"){',c,"=",c,".color[0];","}"):d===hi&&a("if(",c,"&&",c,'._reglType==="framebufferCube"){',c,"=",c,".color[0];","}"),tt.optional(function(){function n(t,e){i.assert(a,t,'bad data or missing for uniform "'+f+'".  '+e)}function t(t){n("typeof "+c+'==="'+t+'"',"invalid type, expected "+t)}function e(t,e){n(o.isArrayLike+"("+c+")&&"+c+".length==="+t,"invalid vector, should have length "+t,i.commandStr)}function r(t){n("typeof "+c+'==="function"&&'+c+'._reglType==="texture'+(t===Ur?"2d":"Cube")+'"',"invalid texture type",i.commandStr)}switch(d){case ni:t("number");break;case ri:e(2);break;case ii:e(3);break;case ai:e(4);break;case Kr:t("number");break;case $r:e(2);break;case ti:e(3);break;case ei:e(4);break;case oi:t("boolean");break;case si:e(2);break;case li:e(3);break;case ci:case ui:e(4);break;case fi:e(9);break;case di:e(16);break;case pi:r(Ur);break;case hi:r(Rr)}});var v=1;switch(d){case pi:case hi:var x=a.def(c,"._texture");a(s,".uniform1i(",g,",",x,".bind());"),a.exit(x,".unbind();");continue;case ni:case oi:r="1i";break;case ri:case si:r="2i",v=2;break;case ii:case li:r="3i",v=3;break;case ai:case ci:r="4i",v=4;break;case Kr:r="1f";break;case $r:r="2f",v=2;break;case ti:r="3f",v=3;break;case ei:r="4f",v=4;break;case ui:r="Matrix2fv";break;case fi:r="Matrix3fv";break;case di:r="Matrix4fv"}if(a(s,".uniform",r,"(",g,","),"M"===r.charAt(0)){var w=Math.pow(d-ui+2,2),M=i.global.def("new Float32Array(",w,")");a("false,(Array.isArray(",c,")||",c," instanceof Float32Array)?",c,":(",V(w,function(t){return M+"["+t+"]="+c+"["+t+"]"}),",",M,")")}else a(1<v?V(v,function(t){return c+"["+t+"]"}):c);a(");")}}function D(n,r,i,a){var t,e,o,s=n.shared,l=s.gl,c=s.draw,u=a.draw,f=(e=u.elements,o=r,(t=e?((e.contextDep&&a.contextDynamic||e.propDep)&&(o=i),e.append(n,o)):o.def(c,".",kr))&&o("if("+t+")"+l+".bindBuffer("+Br+","+t+".buffer.buffer);"),t);function d(t){var e=u[t];return e?e.contextDep&&a.contextDynamic||e.propDep?e.append(n,i):e.append(n,r):r.def(c,".",t)}var p,h,g,m,_,y=d(zr),b=d(Ar),v=(m=u.count,_=r,m?((m.contextDep&&a.contextDynamic||m.propDep)&&(_=i),g=m.append(n,_),tt.optional(function(){m.MISSING&&n.assert(r,"false","missing vertex count"),m.DYNAMIC&&n.assert(_,g+">=0","missing vertex count")})):(g=_.def(c,".",Nr),tt.optional(function(){n.assert(_,g+">=0","missing vertex count")})),g);if("number"==typeof v){if(0===v)return}else i("if(",v,"){"),i.exit("}");R&&(p=d(Dr),h=n.instancing);var x=f+".type",w=u.elements&&Fi(u.elements);function M(){function t(){i(h,".drawElementsInstancedANGLE(",[y,v,x,b+"<<(("+x+"-"+Bn+")>>1)",p],");")}function e(){i(h,".drawArraysInstancedANGLE(",[y,b,v,p],");")}f?w?t():(i("if(",f,"){"),t(),i("}else{"),e(),i("}")):e()}function j(){function t(){i(l+".drawElements("+[y,v,x,b+"<<(("+x+"-"+Bn+")>>1)"]+");")}function e(){i(l+".drawArrays("+[y,b,v]+");")}f?w?t():(i("if(",f,"){"),t(),i("}else{"),e(),i("}")):e()}R&&("number"!=typeof p||0<=p)?"string"==typeof p?(i("if(",p,">0){"),M(),i("}else if(",p,"<0){"),j(),i("}")):M():j()}function T(t,e,n,r,i){var a=y(),o=a.proc("body",i);return tt.optional(function(){a.commandStr=e.commandStr,a.command=a.link(e.commandStr)}),R&&(a.instancing=o.def(a.shared.extensions,".angle_instanced_arrays")),t(a,o,n,r),a.compile().body}function I(t,e,n,r){k(t,e),N(t,e,n,r.attributes,function(){return!0}),A(t,e,n,r.uniforms,function(){return!0}),D(t,e,e,n)}function L(e,n){var t=e.proc("draw",1);k(e,t),x(e,t,n.context),w(e,t,n.framebuffer),M(e,t,n),j(e,t,n.state),z(e,t,n,!1,!0);var r=n.shader.progVar.append(e,t);if(t(e.shared.gl,".useProgram(",r,".program);"),n.shader.program)I(e,t,n,n.shader.program);else{var i=e.global.def("{}"),a=t.def(r,".id"),o=t.def(i,"[",a,"]");t(e.cond(o).then(o,".call(this,a0);").else(o,"=",i,"[",a,"]=",e.link(function(t){return T(I,e,n,t,1)}),"(",r,");",o,".call(this,a0);"))}0<Object.keys(n.state).length&&t(e.shared.current,".dirty=true;")}function S(t,e,n,r){function i(){return!0}t.batchId="a1",k(t,e),N(t,e,n,r.attributes,i),A(t,e,n,r.uniforms,i),D(t,e,e,n)}function Q(e,t,n,r){k(e,t);var i=n.contextDep,a=t.def(),o=t.def();e.shared.props=o,e.batchId=a;var s=e.scope(),l=e.scope();function c(t){return t.contextDep&&i||t.propDep}function u(t){return!c(t)}if(t(s.entry,"for(",a,"=0;",a,"<","a1",";++",a,"){",o,"=","a0","[",a,"];",l,"}",s.exit),n.needsContext&&x(e,l,n.context),n.needsFramebuffer&&w(e,l,n.framebuffer),j(e,l,n.state,c),n.profile&&c(n.profile)&&z(e,l,n,!1,!0),r)N(e,s,n,r.attributes,u),N(e,l,n,r.attributes,c),A(e,s,n,r.uniforms,u),A(e,l,n,r.uniforms,c),D(e,s,l,n);else{var f=e.global.def("{}"),d=n.shader.progVar.append(e,l),p=l.def(d,".id"),h=l.def(f,"[",p,"]");l(e.shared.gl,".useProgram(",d,".program);","if(!",h,"){",h,"=",f,"[",p,"]=",e.link(function(t){return T(S,e,n,t,2)}),"(",d,");}",h,".call(this,a0[",a,"],",a,");")}}function G(e,n){var t=e.proc("batch",2);e.batchId="0",k(e,t);var r=!1,i=!0;Object.keys(n.context).forEach(function(t){r=r||n.context[t].propDep}),r||(x(e,t,n.context),i=!1);var a=n.framebuffer,o=!1;function s(t){return t.contextDep&&r||t.propDep}a?(a.propDep?r=o=!0:a.contextDep&&r&&(o=!0),o||w(e,t,a)):w(e,t,null),n.state.viewport&&n.state.viewport.propDep&&(r=!0),M(e,t,n),j(e,t,n.state,function(t){return!s(t)}),n.profile&&s(n.profile)||z(e,t,n,!1,"a1"),n.contextDep=r,n.needsContext=i,n.needsFramebuffer=o;var l=n.shader.progVar;if(l.contextDep&&r||l.propDep)Q(e,t,n,null);else{var c=l.append(e,t);if(t(e.shared.gl,".useProgram(",c,".program);"),n.shader.program)Q(e,t,n,n.shader.program);else{var u=e.global.def("{}"),f=t.def(c,".id"),d=t.def(u,"[",f,"]");t(e.cond(d).then(d,".call(this,a0,a1);").else(d,"=",u,"[",f,"]=",e.link(function(t){return T(Q,e,n,t,2)}),"(",c,");",d,".call(this,a0,a1);"))}}0<Object.keys(n.state).length&&t(e.shared.current,".dirty=true;")}function q(r,i){var a=r.proc("scope",3);r.batchId="a2";var o=r.shared,t=o.current;function e(t){var e=i.shader[t];e&&a.set(o.shader,"."+t,e.append(r,a))}x(r,a,i.context),i.framebuffer&&i.framebuffer.append(r,a),Pi(Object.keys(i.state)).forEach(function(n){var t=i.state[n],e=t.append(r,a);Mt(e)?e.forEach(function(t,e){a.set(r.next[n],"["+e+"]",t)}):a.set(o.next,"."+n,e)}),z(r,a,i,!0,!0),[kr,Ar,Nr,Dr,zr].forEach(function(t){var e=i.draw[t];e&&a.set(o.draw,"."+t,""+e.append(r,a))}),Object.keys(i.uniforms).forEach(function(t){a.set(o.uniforms,"["+E.id(t)+"]",i.uniforms[t].append(r,a))}),Object.keys(i.attributes).forEach(function(t){var e=i.attributes[t].append(r,a),n=r.scopeAttrib(t);Object.keys(new B).forEach(function(t){a.set(n,"."+t,e[t])})}),e(Mr),e(jr),0<Object.keys(i.state).length&&(a(t,".dirty=true;"),a.exit(t,".dirty=true;")),a("a1(",r.shared.context,",a0,",r.batchId,");")}function W(r,t,e){var a=t.static[e];if(a&&function(t){if("object"==typeof t&&!Mt(t)){for(var e=Object.keys(t),n=0;n<e.length;++n)if(et.isDynamic(t[e[n]]))return!0;return!1}}(a)){var i=r.global,n=Object.keys(a),o=!1,s=!1,l=!1,c=r.global.def("{}");n.forEach(function(t){var e=a[t];if(et.isDynamic(e)){"function"==typeof e&&(e=a[t]=et.unbox(e));var n=Ui(e,null);o=o||n.thisDep,l=l||n.propDep,s=s||n.contextDep}else{switch(i(c,".",t,"="),typeof e){case"number":i(e);break;case"string":i('"',e,'"');break;case"object":Array.isArray(e)&&i("[",e.join(),"]");break;default:i(r.link(e))}i(";")}}),t.dynamic[e]=new et.DynamicVariable(qn,{thisDep:o,contextDep:s,propDep:l,ref:c,append:function(r,i){n.forEach(function(t){var e=a[t];if(et.isDynamic(e)){var n=r.invoke(i,e);i(c,".",t,"=",n,";")}})}}),delete t.static[e]}}return{next:s,current:h,procs:function(){var s=y(),l=s.proc("poll"),c=s.proc("refresh"),u=s.block();l(u),c(u);var t,e=s.shared,f=e.gl,d=e.next,p=e.current;u(p,".dirty=false;"),w(s,l),w(s,c,null,!0),R&&(t=s.link(R));for(var n=0;n<C.maxAttributes;++n){var r=c.def(e.attributes,"[",n,"]"),i=s.cond(r,".buffer");i.then(f,".enableVertexAttribArray(",n,");",f,".bindBuffer(",Fr,",",r,".buffer.buffer);",f,".vertexAttribPointer(",n,",",r,".size,",r,".type,",r,".normalized,",r,".stride,",r,".offset);").else(f,".disableVertexAttribArray(",n,");",f,".vertexAttrib4f(",n,",",r,".x,",r,".y,",r,".z,",r,".w);",r,".buffer=null;"),c(i),R&&c(t,".vertexAttribDivisorANGLE(",n,",",r,".divisor);")}return Object.keys(g).forEach(function(t){var e=g[t],n=u.def(d,".",t),r=s.block();r("if(",n,"){",f,".enable(",e,")}else{",f,".disable(",e,")}",p,".",t,"=",n,";"),c(r),l("if(",n,"!==",p,".",t,"){",r,"}")}),Object.keys(m).forEach(function(t){var e,n,r=m[t],i=h[t],a=s.block();if(a(f,".",r,"("),Mt(i)){var o=i.length;e=s.global.def(d,".",t),n=s.global.def(p,".",t),a(V(o,function(t){return e+"["+t+"]"}),");",V(o,function(t){return n+"["+t+"]="+e+"["+t+"];"}).join("")),l("if(",V(o,function(t){return e+"["+t+"]!=="+n+"["+t+"]"}).join("||"),"){",a,"}")}else e=u.def(d,".",t),n=u.def(p,".",t),a(e,");",p,".",t,"=",e,";"),l("if(",e,"!==",n,"){",a,"}");c(a)}),s.compile()}(),compile:function(e,n,t,r,i){var a=y();a.stats=a.link(i),Object.keys(n.static).forEach(function(t){W(a,n,t)}),Yr.forEach(function(t){W(a,e,t)});var o=v(e,n,t,r,a);return L(a,o),q(a,o),G(a,o),a.compile()}}}var Zi=function(t,d){if(!d.ext_disjoint_timer_query)return null;var p=[],h=[];function i(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var g=[],m=[];function n(t,e,n){var r=g.pop()||new i;r.startQueryIndex=t,r.endQueryIndex=e,r.sum=0,r.stats=n,m.push(r)}var _=[],y=[];return{beginQuery:function(t){var e=p.pop()||d.ext_disjoint_timer_query.createQueryEXT();d.ext_disjoint_timer_query.beginQueryEXT(35007,e),h.push(e),n(h.length-1,h.length,t)},endQuery:function(){d.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:n,update:function(){var t,e,n=h.length;if(0!==n){y.length=Math.max(y.length,n+1),_.length=Math.max(_.length,n+1),_[0]=0;var r,i,a=y[0]=0;for(e=t=0;e<h.length;++e){var o=h[e];d.ext_disjoint_timer_query.getQueryObjectEXT(o,34919)?(a+=d.ext_disjoint_timer_query.getQueryObjectEXT(o,34918),r=o,p.push(r)):h[t++]=o,_[e+1]=a,y[e+1]=t}for(h.length=t,e=t=0;e<m.length;++e){var s=m[e],l=s.startQueryIndex,c=s.endQueryIndex;s.sum+=_[c]-_[l];var u=y[l],f=y[c];f===u?(s.stats.gpuTime+=s.sum/1e6,i=s,g.push(i)):(s.startQueryIndex=u,s.endQueryIndex=f,m[t++]=s)}m.length=t}},getNumPendingQueries:function(){return h.length},clear:function(){p.push.apply(p,h);for(var t=0;t<p.length;t++)d.ext_disjoint_timer_query.deleteQueryEXT(p[t]);h.length=0,p.length=0},restore:function(){h.length=0,p.length=0}}},Qi="webglcontextlost",Gi="webglcontextrestored";function qi(t,e){for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}return function(t){var e=it(t);if(!e)return null;var i=e.gl,n=i.getContextAttributes(),g=i.isContextLost(),r=at(i,e);if(!r)return null;var a,o,s=(a={"":0},o=[""],{id:function(t){var e=a[t];return e||(e=a[t]=o.length,o.push(t),e)},str:function(t){return o[t]}}),l={bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},c=r.extensions,u=Zi(0,c),f=rt(),d=i.drawingBufferWidth,p=i.drawingBufferHeight,h={tick:0,time:0,viewportWidth:d,viewportHeight:p,framebufferWidth:d,framebufferHeight:p,drawingBufferWidth:d,drawingBufferHeight:p,pixelRatio:e.pixelRatio},m={},_={elements:null,primitive:4,count:-1,offset:0,instances:-1},y=st(i,c),b=zn(0,0,y),v=ft(i,l,e,b),x=yt(i,c,v,l),w=In(i,s,l,e),M=$e(i,c,y,function(){z.procs.poll()},h,l,e),j=rn(i,c,y,l,e),k=Mn(i,c,y,M,j,l),z=Hi(i,s,c,y,v,x,0,k,m,b,w,_,h,u,e),N=On(i,k,z.procs.poll,h,n,c,y),A=z.next,D=i.canvas,T=[],I=[],L=[],S=[e.onDestroy],E=null;function C(){if(0===T.length)return u&&u.update(),void(E=null);E=nt.next(C),q();for(var t=T.length-1;0<=t;--t){var e=T[t];e&&e(h,null,0)}i.flush(),u&&u.update()}function O(){!E&&0<T.length&&(E=nt.next(C))}function P(){E&&(nt.cancel(C),E=null)}function Y(t){t.preventDefault(),g=!0,P(),I.forEach(function(t){t()})}function F(t){i.getError(),g=!1,r.restore(),w.restore(),v.restore(),M.restore(),j.restore(),k.restore(),u&&u.restore(),z.procs.refresh(),O(),L.forEach(function(t){t()})}function B(){T.length=0,P(),D&&(D.removeEventListener(Qi,Y),D.removeEventListener(Gi,F)),w.clear(),k.clear(),j.clear(),M.clear(),x.clear(),v.clear(),u&&u.clear(),S.forEach(function(t){t()})}function U(t){function e(t){var r=$({},t);function e(e){if(e in r){var n=r[e];delete r[e],Object.keys(n).forEach(function(t){r[e+"."+t]=n[t]})}}return delete r.uniforms,delete r.attributes,delete r.context,"stencil"in r&&r.stencil.op&&(r.stencil.opBack=r.stencil.opFront=r.stencil.op,delete r.stencil.op),e("blend"),e("depth"),e("cull"),e("stencil"),e("polygonOffset"),e("scissor"),e("sample"),r}function n(n){var r={},i={};return Object.keys(n).forEach(function(t){var e=n[t];et.isDynamic(e)?i[t]=et.unbox(e,t):r[t]=e}),{dynamic:i,static:r}}tt(!!t,"invalid args to regl({...})"),tt.type(t,"object","invalid args to regl({...})");var r=n(t.context||{}),i=n(t.uniforms||{}),a=n(t.attributes||{}),o=n(e(t)),s={gpuTime:0,cpuTime:0,count:0},l=z.compile(o,a,i,r,s),c=l.draw,u=l.batch,f=l.scope,d=[];function p(t){for(;d.length<t;)d.push(null);return d}function h(t,e){var n;if(g&&tt.raise("context lost"),"function"==typeof t)return f.call(this,null,t,0);if("function"==typeof e){if("number"==typeof t){for(n=0;n<t;++n)f.call(this,null,e,n);return}if(Array.isArray(t)){for(n=0;n<t.length;++n)f.call(this,t[n],e,n);return}return f.call(this,t,e,0)}if("number"==typeof t){if(0<t)return u.call(this,p(0|t),0|t)}else{if(!Array.isArray(t))return c.call(this,t);if(t.length)return u.call(this,t,t.length)}}return $(h,{stats:s})}D&&(D.addEventListener(Qi,Y,!1),D.addEventListener(Gi,F,!1));var R=k.setFBO=U({framebuffer:et.define.call(null,1,"framebuffer")});function H(t,e){var n=0;z.procs.poll();var r=e.color;r&&(i.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),n|=16384),"depth"in e&&(i.clearDepth(+e.depth),n|=256),"stencil"in e&&(i.clearStencil(0|e.stencil),n|=1024),tt(!!n,"called regl.clear with no buffer specified"),i.clear(n)}function Z(t){if(tt("object"==typeof t&&t,"regl.clear() takes an object as input"),"framebuffer"in t)if(t.framebuffer&&"framebufferCube"===t.framebuffer_reglType)for(var e=0;e<6;++e)R($({framebuffer:t.framebuffer.faces[e]},t),H);else R(t,H);else H(null,t)}function Q(n){function t(){var t=qi(T,n);function e(){var t=qi(T,e);T[t]=T[T.length-1],T.length-=1,T.length<=0&&P()}tt(0<=t,"cannot cancel a frame twice"),T[t]=e}return tt.type(n,"function","regl.frame() callback must be a function"),T.push(n),O(),{cancel:t}}function G(){var t=A.viewport,e=A.scissor_box;t[0]=t[1]=e[0]=e[1]=0,h.viewportWidth=h.framebufferWidth=h.drawingBufferWidth=t[2]=e[2]=i.drawingBufferWidth,h.viewportHeight=h.framebufferHeight=h.drawingBufferHeight=t[3]=e[3]=i.drawingBufferHeight}function q(){h.tick+=1,h.time=V(),G(),z.procs.poll()}function W(){G(),z.procs.refresh(),u&&u.update()}function V(){return(rt()-f)/1e3}function X(t,e){var n;switch(tt.type(e,"function","listener callback must be a function"),t){case"frame":return Q(e);case"lost":n=I;break;case"restore":n=L;break;case"destroy":n=S;break;default:tt.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(e),{cancel:function(){for(var t=0;t<n.length;++t)if(n[t]===e)return n[t]=n[n.length-1],void n.pop()}}}W();var J=$(U,{clear:Z,prop:et.define.bind(null,1),context:et.define.bind(null,2),this:et.define.bind(null,3),draw:U({}),buffer:function(t){return v.create(t,34962,!1,!1)},elements:function(t){return x.create(t,!1)},texture:M.create2D,cube:M.createCube,renderbuffer:j.create,framebuffer:k.create,framebufferCube:k.createCube,attributes:n,frame:Q,on:X,limits:y,hasExtension:function(t){return 0<=y.extensions.indexOf(t.toLowerCase())},read:N,destroy:B,_gl:i,_refresh:W,poll:function(){q(),u&&u.update()},now:V,stats:l});return e.onDone(null,J),J}}()}),Ep=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t};var Cp=function(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],f=e[8],d=e[9],p=e[10],h=e[11],g=e[12],m=e[13],_=e[14],y=e[15],b=n[0],v=n[1],x=n[2],w=n[3];return t[0]=b*r+v*s+x*f+w*g,t[1]=b*i+v*l+x*d+w*m,t[2]=b*a+v*c+x*p+w*_,t[3]=b*o+v*u+x*h+w*y,b=n[4],v=n[5],x=n[6],w=n[7],t[4]=b*r+v*s+x*f+w*g,t[5]=b*i+v*l+x*d+w*m,t[6]=b*a+v*c+x*p+w*_,t[7]=b*o+v*u+x*h+w*y,b=n[8],v=n[9],x=n[10],w=n[11],t[8]=b*r+v*s+x*f+w*g,t[9]=b*i+v*l+x*d+w*m,t[10]=b*a+v*c+x*p+w*_,t[11]=b*o+v*u+x*h+w*y,b=n[12],v=n[13],x=n[14],w=n[15],t[12]=b*r+v*s+x*f+w*g,t[13]=b*i+v*l+x*d+w*m,t[14]=b*a+v*c+x*p+w*_,t[15]=b*o+v*u+x*h+w*y,t};var Op=function(t,e,n,r,i,a,o){var s=1/(e-n),l=1/(r-i),c=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*l,t[14]=(o+a)*c,t[15]=1,t};var Pp=["manifest","onDone","onProgress","onError"],Yp=["type","src","stream","credentials","parser"],Fp=["onData","onDone"],Bp=0;function Up(t){throw new Error("resl: "+t)}function Rp(t,e,n){Object.keys(t).forEach(function(t){e.indexOf(t)<0&&Up('invalid parameter "'+t+'" in '+n)})}function Hp(t,e){this.state=Bp,this.ready=!1,this.progress=0,this.name=t,this.cancel=e}var Zp,Qp=function(r){"object"==typeof r&&r||Up("invalid or missing configuration"),Rp(r,Pp,"config");var d=r.manifest;function t(t,e){if(t in r){var n=r[t];return"function"!=typeof n&&Up('invalid callback "'+t+'"'),n}return null}"object"==typeof d&&d||Up("missing manifest");var i=t("onDone");i||Up("missing onDone() callback");var a=t("onProgress"),e=t("onError"),p={},o=Bp;function n(e){var n=e.name,t=e.stream,r="binary"===e.type,i=e.parser,a=new XMLHttpRequest,o=null,s=new Hp(n,function(){if(1===s.state||-1===s.state)return;a.onreadystatechange=null,a.abort(),s.state=-1});function l(){if(!(a.readyState<2||1===s.state||-1===s.state)){if(200!==a.status)return g('error loading resource "'+e.name+'"');var t;if(2<a.readyState&&s.state===Bp)if(t="binary"===e.type?a.response:a.responseText,i.data)try{o=i.data(t)}catch(t){return g(t)}else o=t;if(3<a.readyState&&s.state===Bp){if(i.done)try{o=i.done()}catch(t){return g(t)}s.state=1}p[n]=o,s.progress=.75*s.progress+.25,s.ready=e.stream&&!!o||1===s.state,m()}}return a.onreadystatechange=t?l:function(){4===a.readyState&&l()},r&&(a.responseType="arraybuffer"),e.credentials&&(a.withCredentials=!0),a.open("GET",e.src,!0),a.send(),s}function s(t,e){var n=t.name,r=t.parser,i=new Hp(n,function(){if(1===i.state||-1===i.state)return;i.state=-1,d(),e.src=""}),a=e;function o(){if(i.state===Bp)if(r.data)try{a=r.data(e)}catch(t){return g(t)}else a=e}function s(t){o(),p[n]=a,t.lengthComputable?i.progress=Math.max(i.progress,t.loaded/t.total):i.progress=.75*i.progress+.25,m(n)}function l(){if(o(),i.state===Bp){if(r.done)try{a=r.done()}catch(t){return g(t)}i.state=1}i.progress=1,i.ready=!0,p[n]=a,d(),m("finish "+n)}function c(){g('error loading asset "'+n+'"')}if(t.stream&&e.addEventListener("progress",s),"image"===t.type)e.addEventListener("load",l);else{var u=!1,f=!1;e.addEventListener("loadedmetadata",function(){f=!0,u&&l()}),e.addEventListener("canplay",function(){u=!0,f&&l()})}function d(){t.stream&&e.removeEventListener("progress",s),"image"===t.type?e.addEventListener("load",l):e.addEventListener("canplay",l),e.removeEventListener("error",c)}return e.addEventListener("error",c),t.credentials?e.crossOrigin="use-credentials":e.crossOrigin="anonymous",e.src=t.src,i}var h={text:n,binary:function(t){return n(t)},image:function(t){return s(t,document.createElement("img"))},video:function(t){return s(t,document.createElement("video"))},audio:function(t){return s(t,document.createElement("audio"))}},l=Object.keys(d).map(function(t){var r=d[t];function e(t,e){if(t in r.parser){var n=r.parser[t];return"function"!=typeof n&&Up("invalid parser callback "+t+' for asset "'+t+'"'),n}return e}"string"==typeof r?r={src:r}:"object"==typeof r&&r||Up('invalid asset definition "'+t+'"'),Rp(r,Yp,'asset "'+t+'"');var n,i,a,o,s,l,c,u,f={};return"parser"in r&&("function"==typeof r.parser?f={data:r.parser}:"object"==typeof r.parser&&r.parser?(Rp(f,Fp,'parser for asset "'+t+'"'),"onData"in f||Up('missing onData callback for parser in asset "'+t+'"'),f={data:e("onData"),done:e("onDone")}):Up('invalid parser for asset "'+t+'"')),{name:t,type:(s="type",l=Object.keys(h),c="text",u=c,s in r&&(u=r[s]),l.indexOf(u)<0&&Up("invalid "+s+' "'+u+'" for asset "'+t+'", possible values: '+l),u),stream:!!r.stream,credentials:!!r.credentials,src:(n="src",i=!0,a="",o=a,n in r?o=r[n]:i&&Up("missing "+n+' for asset "'+t+'"'),"string"!=typeof o&&Up("invalid "+n+' for asset "'+t+'", must be a string'),o),parser:f}}).map(function(t){return h[t.type](t)});function g(t){-1!==o&&1!==o&&(o=-1,l.forEach(function(t){t.cancel()}),e?e("string"==typeof t?new Error("resl: "+t):t):console.error("resl error:",t))}function m(t){if(-1!==o&&1!==o){var e=0,n=0;l.forEach(function(t){t.ready&&(n+=1),e+=t.progress}),n===l.length?(o=1,i(p)):a&&a(e/l.length,t)}}0===l.length&&setTimeout(function(){m("done")},1)},Gp=!1;function qp(e){Gp||(Gp=!0,Qp({onDone:function(t){(Zp=t).spritesheet=e.texture({data:Zp.spritesheet,mag:"linear",min:"mipmap",mipmap:!0})},manifest:{spritesheet:{type:"image",src:window.Flourish.static_prefix+"/shapes/spritesheet.png"}}}))}var Wp={symbolCircle:{scale:.7991119226506982,sprite_min:[.07505550483433136,.07505550483433136],sprite_max:[.17494449516566862,.17494449516566862],centroid:[.125,.125]},symbolCross:{scale:.9999999999999999,sprite_min:[.3125,.0625],sprite_max:[.4375,.1875],centroid:[.375,.125]},symbolDiamond:{scale:1.3160740129524926,sprite_min:[.5427453741904692,.04274537419046921],sprite_max:[.7072546258095308,.2072546258095308],centroid:[.625,.125]},symbolSquare:{scale:1,sprite_min:[.8125,.0625],sprite_max:[.9375,.1875],centroid:[.875,.125]},symbolStar:{scale:1.3347757051499591,sprite_min:[.041576518428127554,.29157651842812754],sprite_max:[.20842348157187246,.45842348157187246],centroid:[.125,.375]},symbolTriangle:{scale:1.2408064788027995,sprite_min:[.29744959507482505,.29744959507482505],sprite_max:[.45255040492517495,.45255040492517495],centroid:[.375,.375]},symbolWye:{scale:1.0550466939622536,sprite_min:[.5590595816273591,.30905958162735914],sprite_max:[.6909404183726409,.44094041837264086],centroid:[.625,.375]}};function Vp(t,e,n){var r=2*e;t[r]=e,t[r+1]=n}function Xp(t,e,n){var r=4*e,i=Wp[n];t[r++]=i.sprite_min[0],t[r++]=i.sprite_max[1],t[r++]=i.sprite_max[0],t[r]=i.sprite_min[1]}var Jp=Object.create(null);function Kp(t,e,n){var r=3*e,i=Jp[n];i?(t[r++]=i[0],t[r++]=i[1],t[r++]=i[2]):(i=Jp[n]=[0,0,0],n.indexOf("rgb(")?(t[r++]=i[0]=parseInt(n.slice(1,3),16)/255,t[r++]=i[1]=parseInt(n.slice(3,5),16)/255,t[r++]=i[2]=parseInt(n.slice(5,7),16)/255):(n=n.split(","),t[r++]=i[0]=parseInt(n[0].slice(4),10)/255,t[r++]=i[1]=parseInt(n[1],10)/255,t[r++]=i[2]=parseInt(n[2],10)/255))}var $p=["stroke_width","curr_color","prev_color","curr_x","curr_y","curr_r","prev_x","prev_y","prev_r","curr_uv","prev_uv","id"],th=function(t){this.buffers={},this.storage={},this.regl=t,this.joiner=function(){var f=Object.create(null),d=Object.create(null);return t.source=function(t){return d[t]||f[t]},t;function t(t,e){d=Object.assign(Object.create(null),f);var n=Object.create(null),r=Object.create(null);for(var i in f)r[i]=!0;for(var a=0;a<t.length;a++){var o=e(t[a],a);r[o]=!1,f[o]?f[o]=t[a]:n[o]=t[a]}var s=[];for(var l in r)r[l]&&(s.push(f[l]),delete f[l]);var c=Object.values(n),u=Object.values(f);return Object.assign(f,n),{enter:c,update:u,exit:s}}}(),this.count_total=0;for(var e=this.count_remaining=0;e<$p.length;e++){var n=$p[e];this.storage[n]=new Float32Array(0),this.buffers[n]=t.buffer()}};th.prototype.upload=function(){for(var t in this.storage)t in this.storage&&this.buffers[t](this.storage[t])},th.prototype.destroy=function(){for(var t=$p;t<$p.length;t++)this.buffers[$p[t]].destroy();this.buffers={},this.storage={}},th.facets=Object.create(null),th.allocate=function(t,e){if(!e)throw new Error("Unexpected: next_facet_keys were not passed to allocateFacets()");for(var n=0;n<e.length;n++){var r=e[n];th.facets[r]||(th.facets[r]=new th(t))}for(var n=0;n<th.keys.length;n++){var i=th.keys[n];-1===e.indexOf(i)&&(th.facets[i].destroy(),delete th.facets[i])}th.keys=e},th.keys=[];var eh=function(t,e,n){var r,i,a,o,s,l,c,u,f,d,p,h,g=n[0],m=n[1],_=n[2];t[15]=e===t?(t[12]=e[0]*g+e[4]*m+e[8]*_+e[12],t[13]=e[1]*g+e[5]*m+e[9]*_+e[13],t[14]=e[2]*g+e[6]*m+e[10]*_+e[14],e[3]*g+e[7]*m+e[11]*_+e[15]):(r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],f=e[8],d=e[9],p=e[10],h=e[11],t[0]=r,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=l,t[6]=c,t[7]=u,t[8]=f,t[9]=d,t[10]=p,t[11]=h,t[12]=r*g+s*m+f*_+e[12],t[13]=i*g+l*m+d*_+e[13],t[14]=a*g+c*m+p*_+e[14],o*g+u*m+h*_+e[15]);return t};var nh=function(t,e,n){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t};var rh=function(t){return t<.5?4*t*t*t:.5*Math.pow(2*t-2,3)+1};function ih(){return Math.min(2,window.devicePixelRatio||1)}var ah=0,oh=1,sh=2,lh=new Float32Array(16),ch=new Float32Array(2),uh=Object.create(null);function fh(t,e){var n=uh[e.facet]=uh[e.facet]||{matrix:new Float32Array(16),aspect:1,scale_pixel:new Float32Array(3),translate:new Float32Array(3),scale:new Float32Array(3),top:new Float32Array(3),left:new Float32Array(3),bottom:new Float32Array(3),right:new Float32Array(3),scale_responsive:new Float32Array(3),initialized:!1};Ep(n.matrix);var r=t.viewportWidth/ih(),i=t.viewportHeight/ih(),a=uf.facets[th.keys.indexOf(e.facet)||0],o=a.layout.y/i,s=(a.layout.y+a.layout.plot_h)/i,l=a.layout.x/r,c=(a.layout.x+a.layout.plot_w)/r,u=ju.responsive_dots?Math.min(a.scales.w,a.scales.h)/300:1;n.initialized||(hh(n.top,o),hh(n.left,l),hh(n.right,c),hh(n.bottom,s),hh(n.scale_responsive,u),n.initialized=!0),t.transition_init&&(ph(n.top,o),ph(n.left,l),ph(n.right,c),ph(n.bottom,s),ph(n.scale_responsive,u));var f=t.transition_progress;f<0&&(f=0),1<f&&(f=1),f=rh(f),gh(n.top,f),gh(n.left,f),gh(n.right,f),gh(n.bottom,f),gh(n.scale_responsive,f);var d=n.top[oh],p=n.left[oh],h=n.right[oh],g=n.bottom[oh],m=g-d,_=h-p,y=r/i,b=(h-p)/(g-d);return n.scale[0]=_,n.scale[1]=m,n.scale[2]=1,n.translate[0]=_-1+2*p,n.translate[1]=1-m-2*d,eh(n.matrix,n.matrix,n.translate),nh(n.matrix,n.matrix,n.scale),n.aspect=y*b,n.scale_pixel[0]=1/(h-p)/r,n.scale_pixel[1]=1/(g-d)/i,n.scale_pixel[2]=n.scale_responsive[oh],n}var dh={u_proj:function(t){return t.proj},u_view:function(t){return t.view},u_proj_view:function(t){return Cp(lh,t.proj,t.facet.matrix)},u_scale_aspect:function(t){var e=t.facet.aspect;return ch[0]=Math.max(1,1/e),ch[1]=Math.max(1,e),ch},u_scale_pixel:function(t){return t.facet.scale_pixel},u_transition_stagger:function(t,e){return t.transition_stagger?t.transition_stagger*dg()/fg(t,e):0}};function ph(t,e){t[sh]=e,t[ah]=t[oh]}function hh(t,e){t[ah]=t[oh]=t[sh]=e}function gh(t,e){t[oh]=t[ah]+(t[sh]-t[ah])*e}var mh,_h,yh=25,bh={};function vh(t,e,n,r,i,a,o){var s=n-t/2-10,l=n+t/2+10,c=t/2+Math.min(0,s-i.left)+Math.max(0,l-i.right);return{pos:[c,o],shape:c-10<5?[-c,-15*a,Math.max(10,5-c),-10*a]:t-5<c+10?[Math.min(-10,t-c-5),-10*a,Math.min(10,t-c),-15*a]:[-10,-10*a,10,-10*a]}}function xh(t,e,n,r,i,a,o){var s=r-e/2-10,l=r+e/2+10,c=e/2+Math.min(0,s-i.top)+Math.max(0,l-i.bottom);return{pos:[o,c],shape:c-10<5?[-15*a,-c,-10*a,Math.max(10,5-c)]:e-5<c+10?[-10*a,Math.min(-10,e-c-5),-15*a,Math.min(10,e-c)]:[-10*a,-10,-10*a,10]}}function wh(t,e,n){var r,i=document.createElementNS("http://www.w3.org/2000/svg",t);if(e)for(r in e)i.setAttribute(r,e[r]);var a=i.style;if(n)for(r in n)a[r]=n[r];return i}bh.bottom=function(t,e){return{shape:[-10,-10,10,-10],pos:[t/2,e+10]}},bh.top=function(t,e){return{shape:[-10,10,10,10],pos:[t/2,-10]}},bh.left=function(t,e){return{shape:[10,10,10,-10],pos:[-10,e/2]}},bh.right=function(t,e){return{shape:[-10,10,-10,-10],pos:[t+10,e/2]}},bh.topLeft=function(t,e){return{shape:[15,10,10,15],pos:[-10,-10]}},bh.bottomLeft=function(t,e){return{shape:[15,-10,10,-15],pos:[-10,e+10]}},bh.topRight=function(t,e){return{shape:[-15,10,-10,15],pos:[t+10,-10]}},bh.bottomRight=function(t,e){return{shape:[-15,-10,-10,-15],pos:[t+10,e+10]}},bh.bottomFlexible=function(t,e,n,r,i){return vh(t,0,n,0,i,1,e+10)},bh.topFlexible=function(t,e,n,r,i){return vh(t,0,n,0,i,-1,-10)},bh.rightFlexible=function(t,e,n,r,i){return xh(0,e,0,r,i,1,t+10)},bh.leftFlexible=function(t,e,n,r,i){return xh(0,e,0,r,i,-1,-10)};var Mh=1,jh={container:document.body,maxWidth:"70%",point:null,html:null,directions:["bottom","top","left","right","topLeft","bottomLeft","topRight","bottomRight","bottomFlexible","topFlexible","leftFlexible","rightFlexible"],fallbackFit:"horizontal"};function kh(){for(var t in this.unique_id=Mh++,jh)this["_"+t]=jh[t];this.handlers={click:[]}}function zh(e){kh.prototype[e]=function(t){return void 0===t?this["_"+e]:(this["_"+e]=t,this)}}for(var Nh in jh)zh(Nh);function Ah(){return new kh}kh.prototype.point=function(t,e){if(void 0===t)return this._point;if(Array.isArray(t))this._point=[t[0],t[1]];else if(void 0!==e)this._point=[t,e];else if(t instanceof HTMLElement||t instanceof SVGElement){var n=t.getBoundingClientRect();this._point=[Math.floor(n.left+n.width/2),Math.floor(n.top+n.height/2)]}else console.error("Popup: could not understand argument");return this},kh.prototype.directions=function(t){return void 0===t?this._directions:("string"==typeof t&&(t=[t]),this._directions=t.slice(),this)},kh.prototype.text=function(t){return this._html=t.replace(/[&<>]/g,function(t){return{"&":"&amp;","<":"&lt;",">":"&gt;"}[t]}),this},kh.prototype.on=function(t,e){if(!(t in this.handlers))throw new Error("Popup.on: No such event: "+t);return this.handlers[t].push(e),this},kh.prototype.fire=function(t,e){if(!(t in this.handlers))throw new Error("Popup.fire: No such event: "+t);for(var n=this.handlers[t],r=0;r<n.length;r++)n[r].call(this,e);return this},kh.prototype._getElement=function(){var e=this,t="flourish-popup-"+e.unique_id,n=document.getElementById(t);if(!n){(n=document.createElement("div")).className="flourish-popup",n.id=t;var r=n.style;r.display="none",r.margin=r.padding=0,r.position="absolute",r.width="80px",r.height="40px",r.boxSizing="border-box",n.addEventListener("click",function(t){e.fire("click",t)},!1);var i=wh("svg",{class:"flourish-popup-svg"},{position:"absolute",top:0,left:0,bottom:0,right:0}),a=wh("filter",{id:"dropshadow-"+e.unique_id,height:"130%"});a.appendChild(wh("feGaussianBlur",{in:"SourceAlpha",stdDeviation:5})),a.appendChild(wh("feOffset",{dx:0,dy:2,result:"offsetblur"}));var o=wh("feComponentTransfer");o.appendChild(wh("feFuncA",{type:"linear",slope:.2})),a.appendChild(o);var s=wh("feMerge");a.appendChild(s),s.appendChild(wh("feMergeNode")),s.appendChild(wh("feMergeNode",{in:"SourceGraphic"})),i.appendChild(a);var l=wh("g",{filter:"url(#dropshadow-"+e.unique_id+")",fill:"white",stroke:"none"});l.appendChild(wh("rect",{x:yh,y:yh,rx:5})),l.appendChild(wh("path")),i.appendChild(l),n.appendChild(i);var c=document.createElement("div");c.className="flourish-popup-content",(r=c.style).position="absolute",r.top=r.left=yh+"px",r.padding="10px",n.appendChild(c),e._getConstrainer().appendChild(n)}return e._resizeConstrainer(),n},kh.prototype._getConstrainer=function(){return mh||((mh=document.createElement("div")).id="flourish-popup-constrainer",(_h=mh.style).overflow="hidden",_h.pointerEvents="none",_h.position="absolute",_h.left="0",_h.top="0",_h.margin="0",_h.padding="0",document.body.appendChild(mh),this._resizeConstrainer(),mh)},kh.prototype._resizeConstrainer=function(){var t=_h.display;_h.display="none",_h.width=document.documentElement.scrollWidth+"px",_h.height=document.documentElement.scrollHeight+"px",_h.display=t},kh.prototype.draw=function(){var t=this;if(t._point){var e=document.documentElement.getBoundingClientRect(),n=t._point[0],r=t._point[1],i=t._container.getBoundingClientRect();n<i.left?n=i.left:n>i.right&&(n=i.right),r<i.top?r=i.top:r>i.bottom&&(r=i.bottom);var a,o=n-e.left,s=r-e.top,l=t._getElement(),c=l.style,u=l.querySelector(".flourish-popup-svg"),f=u.querySelector("g"),d=f.querySelector("rect"),p=f.querySelector("path"),h=l.querySelector(".flourish-popup-content");c.display="block",h.style.maxWidth=(a=i,(t._maxWidth.match(/^\d+(?:\.\d+)?%$/)?a.width*parseFloat(t._maxWidth)/100:t._maxWidth.match(/^\d+(?:\.\d+)?(?:px)?$/)?parseFloat(t._maxWidth):(null!=t._maxWidth&&console.error("Popup: Unknown value for maxWidth: "+t._maxWidth),a.width))+"px"),t._inner_html!=t._html&&(h.innerHTML=t._inner_html=t._html);for(var g,m,_=h.getBoundingClientRect();g=Math.ceil(_.width),m=Math.ceil(_.height),c.width=g+2*yh+"px",c.height=m+2*yh+"px",_=h.getBoundingClientRect(),g!=Math.ceil(_.width)||m!=Math.ceil(_.height););d.setAttribute("width",g),d.setAttribute("height",m),u.setAttribute("width",g+2*yh),u.setAttribute("height",m+2*yh);for(var y,b,v,x,w,M,j,k,z,N,A,D,T,I,L,S,E,C,O,P,Y=yh-10,F=null,B=null,U=null,R=1/0,H=1/0,Z=0;Z<t._directions.length;Z++){var Q=t._directions[Z],G=(v=g,x=m,w=n,M=r,j=i,k=bh[Q](v,x,w,M,j),z=w-yh-k.pos[0],N=M-yh-k.pos[1],{left:z,top:N,right:z+v+2*yh,bottom:N+x+2*yh}),q=Math.max(0,Math.floor(i.left)-G.left-Y)+Math.max(0,G.right-Math.ceil(i.right)-Y),W=Math.max(0,Math.floor(i.top)-G.top-Y)+Math.max(0,G.bottom-Math.ceil(i.bottom)-Y);if(0==q&&0==W){F=Q;break}(q<R||q==R&&W<y)&&(R=q,y=W,B=Q),(W<H||W==H&&q<b)&&(H=W,b=q,U=Q)}return Q=F||("horizontal"==t._fallbackFit?B:"vertical"==t._fallbackFit?U:(console.warn("Popup: failed to point box of size ("+g+", "+m+") at ("+n+", "+r+") within ("+i.left+", "+i.top+", "+i.right+", "+i.bottom+")"),t._directions[0])),A=c,D=p,T=g,I=m,L=o,S=s,E=n,C=r,O=i,P=bh[Q](T,I,E,C,O),A.left=L-yh-P.pos[0]+"px",A.top=S-yh-P.pos[1]+"px",D.setAttribute("d","M0,0L"+P.shape.join(",")+"Z"),D.setAttribute("transform","translate("+(P.pos[0]+yh)+","+(P.pos[1]+yh)+")"),t}console.error("Popup: cannot draw popup till point() has been specified")},kh.prototype.hide=function(){return this._getElement().style.display="none",this};var Dh,Th={show_popups:!0,text_color:"#333333",align:"left",font_size:12,fill_color:"#ffffff",opacity:1,padding:10,border_radius:3,show_pointer:!0,show_shadow:!0,is_custom:!(Ah.version="2.1.2"),style_popups:!1};function Ih(t){if("number"!=typeof t)return t;var e=Math.round(t*Math.pow(10,2))/100;return 4==Math.round(t).toString().length?e:Jr(",")(e)}function Lh(t,e,n,r){for(var i in this._state=e,this._default_template=n,this._first_load=!0,this._title_binding=r||"id",Th)null==e[i]&&(e[i]=Th[i]);!function(){if(!document.querySelector("#popup-styles")){var t=document.createElement("style");t.id="popup-styles",t.type="text/css",t.innerHTML=".flourish-popup { pointer-events: none; }.flourish-popup .flourish-popup-content { pointer-events: auto; }.flourish-popup h1 { margin: 0; font-size: inherit; }.flourish-popup h2 { font-weight: normal; font-size: inherit; margin: 0; }.flourish-popup h2 .name { font-weight: bold; }.flourish-popup ul { padding: 0; margin: 0; }.flourish-popup li { font-size: inherit; list-style: none; }",document.head.appendChild(t)}}(),this.popup=Ah().container(t).point(0,0).draw().hide()}function Sh(t,e,n,r){return new Lh(t,e,n,r)}function Eh(t){if("number"!=typeof t)return t;var e=Math.round(t*Math.pow(10,2))/100;return 4==Math.round(t).toString().length?e:Jr(",")(e)}Lh.prototype.addColumnNames=function(t){if(this._column_names=t,!this._state.custom_template&&this._first_load){for(var e in this._column_names)if(!Array.isArray(this._column_names[e])){var n=this._column_names[e];this._state.custom_template=n+": {{"+n+"}}";break}this._first_load=!1}return this},Lh.prototype.hide=function(){return this.popup.hide(),this},Lh.prototype.point=function(t,e){if(1==arguments.length){var n=t.getBoundingClientRect();t=n.left+n.width/2,e=n.top}return this.popup.point(t,e),this},Lh.prototype.html=function(t){return this.popup.html(t),this},Lh.prototype.updateStyle=function(){var t=this.popup._getElement(),e=t.querySelector(".flourish-popup-content");e.style.padding=this._state.padding+"px",e.style.textAlign=this._state.align;var n=t.querySelector(".flourish-popup-svg g");return n.style.fill=this._state.fill_color,n.style.opacity=this._state.opacity,0==this._state.show_shadow?n.removeAttribute("filter"):n.setAttribute("filter","url(#dropshadow-"+this.popup.unique_id+")"),n.querySelector("rect").setAttribute("rx",this._state.border_radius),n.querySelector("path").style.display=this._state.show_pointer?"block":"none",this},Lh.prototype.draw=function(i,t){if(this._state.show_popups){var a=this;if(this.updateStyle(),!arguments.length)return this.popup.draw(),t&&t(this.popup._getElement()),this;var n="<div style='color: "+this._state.text_color+"; font-size: "+this._state.font_size+"px; text-align:"+this._state.align+";'>";if(this._state.is_custom||this._default_template)!this._state.is_custom&&this._default_template?n+=this._default_template.replace(/\{\{((?:[^}]|\}[^}])*)\}\}/g,function(t,n){var r;if(Array.isArray(a._column_names[n])){var e=a._column_names[n];if(0==e.length)return"";r="<ul>",e.forEach(function(t,e){r+="<li>"+t+": "+i[n][e]+"</li>"}),r+="</ul>"}else r=i[n];return void 0!==r?Ih(r):""}):n+=this._state.custom_template.replace(/\{\{((?:[^}]|\}[^}])*)\}\}/g,function(t,n){var r;return Object.keys(a._column_names).some(function(t){if(Array.isArray(a._column_names[t])){var e=a._column_names[t].indexOf(n);if(0<=e)return r=i[t][e],!0}else if(a._column_names[t]==n)return r=i[t],!0}),void 0!==r?Ih(r):""});else{console.log("title_binding",this._title_binding,i[this._title_binding]),i[this._title_binding]&&(n+="<h1>"+i[this._title_binding]+"</h1>");var e={};for(var r in this._column_names){var o;if(console.log("binding",r),r!=this._title_binding)if("metadata"==r){if(!Array.isArray(i.metadata))return;for(var s=0;s<i.metadata.length;s++)e[o=this._column_names.metadata[s]]||(e[o]=!0,n+="<h2><span class='name' data-binding='metadata'>"+o+"</span>: "+Ih(i.metadata[s])+"</h2>")}else{if(o=this._column_names[r],Array.isArray(o)){o.forEach(function(t,e){n+="<h2><span class='name' data-binding='"+r+"'>"+t+"</span>: "+Ih(i[r][e])+"</h2>"});continue}if(e[o])continue;e[o]=!0,n+="<h2><span class='name' data-binding='"+r+"'>"+o+"</span>: "+Ih(i[r])+"</h2>"}}n+="</div>"}return this.popup.html(n).draw(),t&&t(this.popup._getElement()),this}},Lh.prototype.directions=function(t){return this.popup.directions(t),this},Lh.prototype.container=function(t){return this.popup.container(t),this};var Ch=["bottom","top","left","right","topLeft","bottomLeft","topRight","bottomRight","bottomFlexible","topFlexible","leftFlexible","rightFlexible"];function Oh(t){if(ju.popup.show_popups){var e="<div style='font-size: "+(ju.popup.font_size||12)+"px;'>";e+="<h1 style='color: "+Pd(t.category,"#000")+"'>"+t.category+"</h1>",e+="<h2>Third quartile: <strong>"+Eh(t.top)+"</strong><br>",e+="Median: <strong>"+Eh(t.mid)+"</strong><br>",e+="First quartile: <strong>"+Eh(t.bottom)+"</strong></h2>",e+="</div>",Dh.point(this).html(e).draw()}}function Ph(n){var t={};for(var e in n){var r=n[e];"x"==e&&(r=Cb(r)),"y"==e&&(r=Ob(r)),"size"==e&&(r=Pb(r)),"facet"==e&&(r=n.facet.key),"id"!=e&&(t[e]=r)}Dh.draw(t,function(t){if(ju.popup_color_headings){var e=t.querySelector("h1");e&&(e.style.color=Pd(n.color))}})}function Yh(){if(ju.highlighted&&ju.popup_sticky){var t=ju.highlighted.split("-")[0],n=ju.highlighted.split("-")[1];if("box"==t){var e=uf.boxes.filter(function(t,e){return e==n})[0];if(!e)return void Bh();var r=ce(".box#box-"+n);Oh.call(r.node(),e)}else if("dot"==t){var i=uf.data_points.filter(function(t){return t.row==n})[0];if(!i)return void Bh();var a=ce(".data-point#dot-"+n);Fh.call(a.node(),i)}}else Bh()}function Fh(t){ju.popup.show_popups&&(Dh.point(this),Ph(t))}function Bh(){Dh.hide()}var Uh,Rh,Hh,Zh,Qh,Gh,qh={x:0,y:0,width:1,height:1,data:new Uint8Array(4),framebuffer:null},Wh=!1,Vh=!1,Xh=(Hh=Rh=!(Uh=function(n,r,s){!function(t){if(!Eg())return;if(!Zp)return qp(xg);Ag(xg,t)}(function(t){if(t.transition_progress<1)return s(!1,!1,-1);var i=ng(xg,t);if(void 0===i)return s(!1,!1,-1);var a=Math.floor(n*ih()),o=t.drawingBufferHeight-Math.floor(r*ih());if(a<0)return s(!1,!1,-1);if(o<0)return s(!1,!1,-1);if(a>=t.drawingBufferWidth)return s(!1,!1,-1);if(o>=t.drawingBufferHeight)return s(!1,!1,-1);function e(){qh.x=a,qh.y=o,qh.framebuffer=i,xg.read(qh);var t=qh.data,e=t[3],n=t[2]|t[1]<<8|t[0]<<16,r=e&&uf.data_points[n];s(!!r,r,r?n:-1)}$h.framebuffer=i,xg.clear($h),og.pickPass(xg),window.requestAnimationFrame(e)})}),Qh=Zh=0,Gh=null,function t(e,n,r){if(Rh)return Hh=!0,Zh=e,Qh=n,void(Gh=r);Rh=!0,Uh(e,n,function(){Rh=!1,r.apply(this,arguments),Hh&&(Hh=!1,t(Zh,Qh,Gh,Gh=null))})});function Jh(l){return function(t){var o=t.offsetX,s=t.offsetY;Xh(o,s,function(t,e){if(Vh)return;if(t&&e){var n=l.getBoundingClientRect();r=o+n.left,i=s+n.top,a=e,ju.popup.show_popups&&(Dh.point(r,i),Ph(a)),Wh=!0}else Bh(),Wh=!1;var r,i,a})}}function Kh(){Wh&&!Vh?Vh=!0:(Vh=!1,Bh())}var $h={color:[0,0,0,0],depth:1};var tg=null,eg=[-1,-1];function ng(t,e){var n=e.drawingBufferWidth,r=e.drawingBufferHeight;if(tg)eg[0]===n&&eg[1]===r||tg.resize(n,r);else try{tg=tg||t.framebuffer({width:n,height:r,depth:!1,stencil:!1})}catch(t){return}return eg[0]=n,eg[1]=r,tg}var rg,ig,ag,og=(rg="plotter-points",ag=!(ig=function(n,t,e){return function(t){var e=uf.facets,n=function(t,e){for(var n=Object.create(null),r=0;r<t.length;r++)n[t[r][e]]=r;return n}(e,"key");for(var r in Jp=Object.create(null),th.allocate(t,e.map(function(t){return t.key})),th.facets){var i=n[r];if(void 0===i)throw new Error("Unexpected: referenced unallocated facet "+JSON.stringify(r));var a=e[i],o=th.facets[r],s=o.storage,l=uf.data_points.filter(hg(i)),c=lg(df.data.column_names.name),u=o.joiner(l,c),f=u.update.concat(u.enter).concat(u.exit);gg(f),s.id=new Float32Array(2*f.length),s.prev_x=new Float32Array(f.length),s.curr_x=new Float32Array(f.length),s.curr_y=new Float32Array(f.length),s.prev_y=new Float32Array(f.length),s.curr_r=new Float32Array(f.length),s.prev_r=new Float32Array(f.length),s.curr_uv=new Float32Array(4*f.length),s.prev_uv=new Float32Array(4*f.length),s.stroke_width=new Float32Array(f.length),s.curr_color=new Float32Array(3*f.length),s.prev_color=new Float32Array(3*f.length);var d=u.update.length,p=d+u.enter.length;o.count_total=f.length,o.count_remaining=p;for(var h=a.scales.x.range(),g=h[0]/a.layout.plot_w,m=h[1]/a.layout.plot_w,_=a.scales.y.range(),y=1-_[0]/a.layout.plot_h,b=1-_[1]/a.layout.plot_h,v=a.scales.x.copy().range([g,m]),x=a.scales.y.copy().range([y,b]),w=function(t){return v(t.x)+(t.offset_x||0)/a.layout.w},M=function(t){return x(t.y)+(t.offset_y||0)/a.layout.h},j=0;j<d;j++){var k=f[j],z=o.joiner.source(c(f[j]))||k,N=k._shape_webgl_curr,A=z===k?z._shape_webgl_prev:z._shape_webgl_curr;s.prev_x[j]="_pwx"in z?z._pwx:w(z),s.curr_x[j]=k._pwx=w(k),s.prev_y[j]="_pwy"in z?z._pwy:M(z),s.curr_y[j]=k._pwy=M(k),s.curr_r[j]=4.5*kp(k)/Math.PI*ug(N),s.prev_r[j]=4.5*kp(z)/Math.PI*ug(A),s.stroke_width[j]=ug(N),Vp(s.id,j,k.row_filtered),Xp(s.curr_uv,j,N),Xp(s.prev_uv,j,A),Kp(s.curr_color,j,k._color_webgl_curr),Kp(s.prev_color,j,z===k?z._color_webgl_prev:z._color_webgl_curr)}for(var j=d;j<p;j++){var D=f[j];s.curr_x[j]=s.prev_x[j]=D._pwx=w(D),s.curr_y[j]=s.prev_y[j]=D._pwy=M(D),s.curr_r[j]=4.5*kp(D)/Math.PI*ug(D._shape_webgl_curr),s.prev_r[j]=0,s.stroke_width[j]=ug(D._shape_webgl_curr),Vp(s.id,j,D.row_filtered),Xp(s.curr_uv,j,D._shape_webgl_curr),Xp(s.prev_uv,j,D._shape_webgl_curr),Kp(s.curr_color,j,D._color_webgl_curr),Kp(s.prev_color,j,D._color_webgl_curr)}for(var j=p;j<f.length;j++){var T=f[j];s.curr_x[j]=s.prev_x[j]="_pwx"in T?T._pwx:w(T),s.curr_y[j]=s.prev_y[j]="_pwy"in T?T._pwy:M(T),s.curr_r[j]=0,s.prev_r[j]=4.5*kp(T)/Math.PI*ug(T._shape_webgl_prev),s.stroke_width[j]=ug(T._shape_webgl_prev),Vp(s.id,j,T.row_filtered),Xp(s.curr_uv,j,T._shape_webgl_prev),Xp(s.prev_uv,j,T._shape_webgl_prev),Kp(s.curr_color,j,T._color_webgl_prev),Kp(s.prev_color,j,T._color_webgl_prev)}o.upload()}}(n),{instances:fg,vert:"precision highp float;\n#define GLSLIFY 1\nuniform float u_pixel_ratio;uniform mat4 u_proj_view;uniform vec2 u_scale_aspect;uniform vec3 u_scale_pixel;uniform float state_stroke_width;attribute vec2 a_coord;attribute highp vec2 instance_id;attribute float instance_stroke_width;attribute float instance_scale_x_curr;attribute float instance_scale_y_curr;attribute float instance_scale_r_curr;attribute vec3 instance_color_curr;\n#if IS_TRANSITION\nuniform float u_transition_progress;uniform float u_transition_stagger;attribute float instance_scale_x_prev;attribute float instance_scale_y_prev;attribute float instance_scale_r_prev;attribute vec3 instance_color_prev;varying float v_transition_progress;\n#endif\n#if !IS_ALL_CIRCLES\nvarying vec2 v_uv1;varying vec2 v_uv2;attribute vec4 instance_uv_prev;attribute vec4 instance_uv_curr;\n#endif\nvarying float v_coord_pixel;varying vec2 v_coord;varying vec3 v_color;float cubicInOut(float t){return t<0.5? 4.0*t*t*t: 0.5*pow(2.0*t-2.0,3.0)+1.0;}vec3 packUInt24IntoVec3(highp float i){return vec3(floor(i/65536.0),mod(floor(i/256.0),256.0),mod(i,256.0))/255.0;}void main(){v_coord=a_coord;\n#if IS_PICKING\nv_color=packUInt24IntoVec3(instance_id.y);\n#else\nv_color=instance_color_curr;\n#endif\n#if IS_TRANSITION\nfloat t=u_transition_progress;t=clamp(t-instance_id.x*u_transition_stagger,0.0,1.0);t=cubicInOut(t);v_color=mix(instance_color_prev,v_color,t);v_transition_progress=t;float radius=mix(instance_scale_r_prev,instance_scale_r_curr,t);vec2 p_prev=vec2(instance_scale_x_prev,instance_scale_y_prev);vec2 p_curr=vec2(instance_scale_x_curr,instance_scale_y_curr);vec2 P=mix(p_prev,p_curr,t);\n#if !IS_ALL_CIRCLES\nv_uv1=mix(instance_uv_prev.xy,instance_uv_prev.zw,a_coord.xy*0.5+0.5);v_uv2=mix(instance_uv_curr.xy,instance_uv_curr.zw,a_coord.xy*0.5+0.5);\n#endif\n#else\nfloat radius=instance_scale_r_curr;vec2 P=vec2(instance_scale_x_curr,instance_scale_y_curr);\n#if !IS_ALL_CIRCLES\nv_uv1=mix(instance_uv_curr.xy,instance_uv_curr.zw,a_coord.xy*0.5+0.5);\n#endif\n#endif\nP=P*2.0-1.0;P+=u_scale_pixel.xy*u_scale_pixel.z*a_coord*(radius+state_stroke_width/u_scale_pixel.z);\n#if !IS_PICKING\nv_coord_pixel=u_pixel_ratio/radius/u_scale_pixel.z;\n#if !IS_ALL_CIRCLES\nv_coord_pixel*=instance_stroke_width;\n#endif\n#endif\ngl_Position=u_proj_view*vec4(P,0,1);}",frag:"precision highp float;\n#define GLSLIFY 1\n#define DEBUG_SHOW_TRANSITIONS 0\nuniform vec3 state_stroke_color;uniform float state_fill_opacity;uniform float state_stroke_width;uniform float state_stroke_opacity;uniform sampler2D t_spritesheet;varying vec2 v_uv1;varying vec2 v_uv2;varying float v_coord_pixel;\n#if IS_TRANSITION\nvarying float v_transition_progress;\n#endif\nvarying vec3 v_color;varying vec2 v_coord;float aastep(float threshold,float value){\n#ifdef GL_OES_standard_derivatives\nfloat afwidth=length(vec2(dFdx(value),dFdy(value)))*0.70710678118654757;return smoothstep(threshold-afwidth,threshold+afwidth,value);\n#else\nreturn step(threshold,value);\n#endif\n}float getPointDistance(){\n#if IS_TRANSITION\nfloat dist1=texture2D(t_spritesheet,v_uv1).r;float dist2=texture2D(t_spritesheet,v_uv2).r;return mix(dist1,dist2,v_transition_progress);\n#else\nreturn texture2D(t_spritesheet,v_uv1).r;\n#endif\n}float getDiffuseAlpha(out float alpha_stroke){\n#if IS_ALL_CIRCLES\nfloat alpha_outer=1.0-aastep(1.0,length(v_coord));float alpha_inner=1.0-aastep(1.0-v_coord_pixel*state_stroke_width,length(v_coord));\n#else\nfloat dist=getPointDistance();float alpha_outer=aastep(0.5,dist);float alpha_inner=aastep(0.5,dist-v_coord_pixel*state_stroke_width);\n#endif\nalpha_stroke=alpha_outer-alpha_inner;return alpha_stroke*state_stroke_opacity+alpha_inner*state_fill_opacity;}float getPickingAlpha(){\n#if IS_ALL_CIRCLES\nreturn step(length(v_coord),1.0);\n#else\nreturn step(0.5,getPointDistance());\n#endif\n}void main(){\n#if IS_PICKING\nfloat alpha=getPickingAlpha();vec3 color=v_color;\n#else\nfloat alpha_stroke;float alpha=getDiffuseAlpha(alpha_stroke);\n#if IS_STROKE_FIXED\nvec3 color=mix(v_color,state_stroke_color,alpha_stroke);\n#else\nvec3 color=v_color;\n#endif\n#endif\ngl_FragColor=vec4(color,clamp(alpha,0.0,1.0));\n#if !IS_PICKING && DEBUG_SHOW_TRANSITIONS && IS_TRANSITION\ngl_FragColor.rgb=vec3(1,0,0);\n#endif\n}",count:6,depth:{enable:!0,mask:!1},blend:{enable:!0,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:"one minus src alpha"},equation:{rgb:"add",alpha:"add"}},context:{facet:fh},uniforms:dh,attributes:{instance_id:pg("id"),instance_uv_curr:pg("curr_uv"),instance_uv_prev:pg("prev_uv"),instance_stroke_width:pg("stroke_width"),instance_scale_x_curr:pg("curr_x"),instance_scale_y_curr:pg("curr_y"),instance_scale_x_prev:pg("prev_x"),instance_scale_y_prev:pg("prev_y"),instance_scale_r_curr:pg("curr_r"),instance_scale_r_prev:pg("prev_r"),instance_color_curr:pg("curr_color"),instance_color_prev:pg("prev_color"),a_coord:[-1,-1,1,-1,1,1,1,1,-1,1,-1,-1]},framebuffer:function(t,e){return e.picking?ng(n,t):void 0}}}),function(t,e){if(!ag)try{if(!_g[rg]||yg[rg]){var n=ig(t,ju,df);Object.assign(n,{vert:vg(n.vert,bg),frag:vg(n.frag,bg,["GL_OES_standard_derivatives"]),profile:!0}),_g[rg]=t(n),_g[rg](e),yg[rg]=!1}else _g[rg](e)}catch(t){throw ag=!0,t}});function sg(n){var r=[];return function(t){for(var e=r.length;e<uf.facets.length;e++)r[e]=Object.assign({facet:uf.facets[e].key},n);r.length=uf.facets.length;for(e=0;e<r.length;e++)r[e].facet=uf.facets[e].key;og(t,r)}}function lg(t){var n=Object.create(null);return t&&t.length?1===t.length?function(t){return e(t,t.name[0])}:function(t){return e(t,t.name.join("ÿ"))}:function(t){return t.row};function e(t,e){return t._id_key?t._id_key:(n[e]?n[e]++:n[e]=1,t._id_key=e+n[e])}}function cg(t){return bp(t.shape)||ju.default_shape||"circle"}function ug(t){return Wp[t].scale}function fg(t,e){return bg.IS_TRANSITION(t,e)?th.facets[e.facet||""].count_total:th.facets[e.facet||""].count_remaining}function dg(){for(var t=0,e=0;e<th.keys.length;e++){var n=th.facets[th.keys[e]].storage.curr_x.length;t<n&&(t=n)}return t}function pg(n){var r={divisor:1,buffer:null};return function(t,e){return r.buffer=th.facets[e.facet||""].buffers[n],r}}function hg(e){var t=!("slider"in uf.data_points.column_names)||null==Bb.value(),n="x"in uf.data_points.column_names,r="y"in uf.data_points.column_names,i="size"in uf.data_points.column_names;return t?function(t){return a(t)&&t.facet_index===e}:function(t){return a(t)&&t.facet_index===e&&t.slider==Bb.value()};function a(t){return!(n&&"string"!=typeof t.x&&isNaN(t.x)||r&&"string"!=typeof t.y&&isNaN(t.y)||i&&"string"!=typeof t.size&&isNaN(t.size))}}function gg(t){for(var e=0;e<t.length;e++){var n=t[e];n._color_webgl_curr?(n._color_webgl_prev=n._color_webgl_curr,n._color_webgl_curr=Pd(n.color),n._shape_webgl_prev=n._shape_webgl_curr,n._shape_webgl_curr=cg(n)):(n._color_webgl_prev=n._color_webgl_curr=Pd(n.color),n._shape_webgl_prev=n._shape_webgl_curr=cg(n))}}og.mainPass=sg({picking:!1}),og.pickPass=sg({picking:!0});var mg,_g=Object.create(null),yg=Object.create(null),bg={IS_PICKING:"picking",IS_ALL_CIRCLES:function(){return!1},IS_STROKE_FIXED:function(){return"fixed"===ju.stroke_mode},IS_TRANSITION:function(t,e){var n=t.time_current-t.time_last_update<ju.animation_duration+ju.animation_stagger*dg();return n&&(Ig=!0),n}};function vg(a,t,e){if(!a)return a;for(var o=Object.keys(t),s=Object.values(t),l=Object.create(null),c=[],u=[],n=0;e&&n<e.length;n++){var r=e[n];c.push("#ifdef "+r),c.push("#extension "+r+" : enable"),c.push("#endif")}var f=c.length;if(24<o.length)throw new Error("Too many dynamic shader flags: no more than 24 may be used.");return function(t,e){for(var n=0,r=0;r<o.length;r++){var i="function"==typeof s[r]?s[r](t,e):e[s[r]];(u[r]=!!i)&&(n|=1<<r)}if(l[n])return l[n];c.length=f;for(var r=0;r<o.length;r++)c.push("#define "+o[r]+(u[r]?" 1":" 0"));return c.push(a),l[n]=c.join("\n")}}var xg,wg=Date.now(),Mg=0,jg=0,kg=0,zg=0,Ng=!1;function Ag(t,e){jg=(Date.now()-wg)/1e3,kg=jg-zg,zg=jg,e&&(mg=mg||function(t){var e=new Float32Array(16),n=new Float32Array(16),r=new Float32Array(16),i=new Float32Array(2),a=new Float32Array(3);return t({context:{time_last_update:function(){return Mg},time_current:function(){return jg},time_delta:function(){return kg},transition_progress:function(){return(jg-Mg)/ju.animation_duration},transition_init:function(){return Ng},transition_stagger:function(){return ju.animation_stagger?ju.animation_stagger/ju.animation_duration:0},view:function(){return Ep(n)},proj:function(){return Op(e,-1,1,-1,1,-1,1)},aspect_ratio:function(t){return t.viewportWidth/t.viewportHeight},assets:Zp},uniforms:{u_time:function(){return jg},u_time_since_update:function(){return jg-Mg},u_transition_progress:t.context("transition_progress"),u_transition_stagger:t.context("transition_stagger"),u_pixel_ratio:function(){return ih()},u_view:t.context("view"),u_proj:t.context("proj"),u_proj_view:function(t){return Cp(r,t.proj,t.view)},u_scale_aspect:function(t){var e=t.aspect_ratio;return i[0]=Math.max(1,1/e),i[1]=Math.max(1,e),i},t_spritesheet:t.context("assets.spritesheet"),state_fill_opacity:o("fill_opacity"),state_stroke_opacity:o("stroke_opacity"),state_stroke_color:function(){return Kp(a,0,ju.stroke_color),a},state_stroke_width:function(t,e){return bg.IS_ALL_CIRCLES(t,e)?ju.stroke_width:ju.stroke_width*Math.PI/4}}});function o(t){return function(){return ju[t]}}}(t))(e),Ng=!1}Ag.update=function(t){Ng=!0,t||(Mg=jg)};var Dg,Tg,Ig=!0;function Lg(t){if(xg)throw new Error("createScatterGL should only be called once");try{Tg=(Dg=t).appendChild(document.createElement("canvas")),Pg(),xg=Sp({canvas:Tg,extensions:["ANGLE_instanced_arrays"],optionalExtensions:["OES_standard_derivatives"],attributes:{premultipliedAlpha:!0,preserveDrawingBuffer:!0}})}catch(t){return console.log("WebGL disabled"),!1}Dg.addEventListener("mousemove",Jh(Dg),!1),Dg.addEventListener("click",Kh),xg.frame(function(t){if(!xg)return;Ig&&xg.clear(Cg);if(!Eg())return;if(!Zp)return qp(xg);var e=Ig;Ig=!1,Ag(xg,e&&t)}.bind(null,Og)),window.addEventListener("resize",Pg,!1),Sg(!0)}function Sg(t){Ig=!0,Eg()?(Dg.style.display="block",function(){for(var t in _g)yg[t]=!0}(),Ag.update(t),Pg()):Dg.style.display="none"}function Eg(){return xg&&"webgl"===ju.render_mode}var Cg={color:[0,0,0,0],depth:1};function Og(){xg&&og.mainPass(xg)}function Pg(){var t=ih(),e=Math.min(4096/t,sv.getPrimaryHeight()),n=sv.getPrimaryWidth();Dg.style.position="absolute",Dg.style.top=0,Dg.style.left=0,Dg.style.width=n+"px",Dg.style.height=e+"px",Tg.style.width=n+"px",Tg.style.height=e+"px",Tg.width=n*t,Tg.height=e*t}"classList"in SVGElement.prototype||Object.defineProperty(SVGElement.prototype,"classList",{get:function(){var n=this;return{contains:function(t){return-1!==n.className.baseVal.split(" ").indexOf(t)},add:function(t){return n.setAttribute("class",(n.getAttribute("class")||"")+" "+t)},remove:function(t){var e=n.getAttribute("class").replace(new RegExp("(\\s|^)".concat(t,"(\\s|$)"),"g"),"$2");n.classList.contains(t)&&n.setAttribute("class",e)},toggle:function(t){this.contains(t)?this.remove(t):this.add(t)}}}});var Yg=function(t,e){"string"==typeof e&&(n=e,n=String(n).toUpperCase(),e=function(t){return n===t.nodeName});var n;"function"!=typeof e&&(r=e,e=function(t){return r===t});var r;for(;t&&!e(t);)t=t.parentNode;return t||null};function Fg(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}var Bg=Fg;function Ug(t){return"function"==typeof t}function Rg(t){return"object"==typeof t&&null!==t}function Hg(t){return void 0===t}(Fg.EventEmitter=Fg).prototype._events=void 0,Fg.prototype._maxListeners=void 0,Fg.defaultMaxListeners=10,Fg.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},Fg.prototype.emit=function(t){var e,n,r,i,a,o;if(this._events||(this._events={}),"error"===t&&(!this._events.error||Rg(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var s=new Error('Uncaught, unspecified "error" event. ('+e+")");throw s.context=e,s}if(Hg(n=this._events[t]))return!1;if(Ug(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),n.apply(this,i)}else if(Rg(n))for(i=Array.prototype.slice.call(arguments,1),r=(o=n.slice()).length,a=0;a<r;a++)o[a].apply(this,i);return!0},Fg.prototype.on=Fg.prototype.addListener=function(t,e){var n;if(!Ug(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,Ug(e.listener)?e.listener:e),this._events[t]?Rg(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,Rg(this._events[t])&&!this._events[t].warned&&(n=Hg(this._maxListeners)?Fg.defaultMaxListeners:this._maxListeners)&&0<n&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},Fg.prototype.once=function(t,e){if(!Ug(e))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(t,r),n||(n=!0,e.apply(this,arguments))}return r.listener=e,this.on(t,r),this},Fg.prototype.removeListener=function(t,e){var n,r,i,a;if(!Ug(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(i=(n=this._events[t]).length,r=-1,n===e||Ug(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(Rg(n)){for(a=i;0<a--;)if(n[a]===e||n[a].listener&&n[a].listener===e){r=a;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},Fg.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(Ug(n=this._events[t]))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},Fg.prototype.listeners=function(t){return this._events&&this._events[t]?Ug(this._events[t])?[this._events[t]]:this._events[t].slice():[]},Fg.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(Ug(e))return 1;if(e)return e.length}return 0},Fg.listenerCount=function(t,e){return t.listenerCount(e)};var Zg,Qg=["touchstart","touchmove","touchend","touchcancel","mousedown","mousemove","mouseup"],Gg={left:0,top:0},qg=function(t,h){h=h||{},t=t||window;var g=new Bg;g.target=h.target||t;var m=null,_=h.filtered,e=Qg;"string"==typeof h.type&&(e=Qg.filter(function(t){return 0===t.indexOf(h.type)}));var n=e.map(function(d){var p=d.replace(/^(touch|mouse)/,"").replace(/up$/,"end").replace(/down$/,"start");return{type:d,listener:function(t){var e=t;if(/^touch/.test(d)&&(/^touchend$/.test(d)&&!1!==h.preventSimulated&&t.preventDefault(),e=_?(c=t,u=d,m&&/^touch(end|cancel)/.test(u)?(f=Vg(c.changedTouches,m.identifier||0))&&(m=null):!m&&/^touchstart/.test(u)?m=f=Wg(c.changedTouches,g.target):m&&(f=Vg(c.changedTouches,m.identifier||0)),f):Wg(t.changedTouches,g.target)),e){var n,r,i,a,o,s,l=(n=e,r=g.target,i=n.clientX||0,a=n.clientY||0,o=(s=r)===window||s===document||s===document.body?Gg:s.getBoundingClientRect(),[i-o.left,a-o.top]);g.emit(p,t,l)}var c,u,f}}});return g.enable=function(){return n.forEach(Xg(t,!0)),g},g.disable=function(){return m=null,n.forEach(Xg(t,!1)),g},g.enable(),g};function Wg(t,e){return Array.prototype.slice.call(t).filter(function(t){return t.target===e})[0]||t[0]}function Vg(t,e){for(var n=0;n<t.length;n++)if(t[n].identifier===e)return t[n];return null}function Xg(e,n){return function(t){n?e.addEventListener(t.type,t.listener,{passive:!1}):e.removeEventListener(t.type,t.listener,{passive:!1})}}var Jg=void 0!==Ip&&(Ip.crypto||Ip.msCrypto);if(Jg&&Jg.getRandomValues){var Kg=new Uint8Array(16);Zg=function(){return Jg.getRandomValues(Kg),Kg}}if(!Zg){var $g=new Array(16);Zg=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),$g[e]=t>>>((3&e)<<3)&255;return $g}}for(var tm=Zg,em=[],nm=0;nm<256;++nm)em[nm]=(nm+256).toString(16).substr(1);var rm=function(t,e){var n=e||0,r=em;return r[t[n++]]+r[t[n++]]+r[t[n++]]+r[t[n++]]+"-"+r[t[n++]]+r[t[n++]]+"-"+r[t[n++]]+r[t[n++]]+"-"+r[t[n++]]+r[t[n++]]+"-"+r[t[n++]]+r[t[n++]]+r[t[n++]]+r[t[n++]]+r[t[n++]]+r[t[n++]]};var im=function(t,e,n){var r=e&&n||0;"string"==typeof t&&(e="binary"==t?new Array(16):null,t=null);var i=(t=t||{}).random||(t.rng||tm)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e)for(var a=0;a<16;++a)e[r+a]=i[a];return e||rm(i)},am=document.createElement("style");am.innerHTML='body.fl-cursor-custom,body.fl-cursor-custom *{cursor:none!important}body.fl-cursor-pointer,body.fl-cursor-pointer *{cursor:pointer!important}body.fl-cursor-default .fl-annotations .fl-annotations-cursor,body.fl-cursor-pointer .fl-annotations .fl-annotations-cursor{visibility:hidden}.fl-annotations{position:absolute;top:0;left:0;width:100%;height:100%;background:hsla(0,0%,100%,0);cursor:pointer;z-index:99999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-transition:opacity .25s;transition:opacity .25s}.fl-annotations,.fl-annotations.is-dragging,.fl-annotations.is-dragging *{pointer-events:none}svg.fl-annotations{z-index:99998}.flourish-popup{z-index:100000}.fl-project-editor{font-family:Source Sans Pro,sans-serif;color:#333;margin:0;font-size:16px;height:100%;-webkit-font-smoothing:antialiased}.fl-project-editor *{box-sizing:border-box}.fl-project-editor .no-select{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.fl-project-editor h1,.fl-project-editor h2,.fl-project-editor h3,.fl-project-editor h4,.fl-project-editor p{margin:0;font-weight:400}.fl-project-editor input,.fl-project-editor select,.fl-project-editor textarea{font-family:Source Sans Pro,sans-serif}.fl-project-editor a:link,.fl-project-editor a:visited{color:inherit;text-decoration:none}.fl-project-editor a:active,.fl-project-editor a:hover{opacity:.75}.fl-project-editor header{display:block;position:absolute;top:0;left:0;width:100%}.fl-project-editor main{display:block;position:absolute;top:80px;left:0;width:100%;height:calc(100vh - 80px);overflow-y:auto;-webkit-transition:height .5s ease,top .5s ease;transition:height .5s ease,top .5s ease}@media(min-width:420px){.fl-project-editor main{top:92px;height:calc(100vh - 92px)}}.fl-project-editor .hide-editor-bar main{top:50px;height:calc(100vh - 50px)}@media(min-width:420px){.fl-project-editor .hide-editor-bar main{top:62px;height:calc(100vh - 62px)}}.fl-project-editor .user-nav{float:right;padding-top:0;display:none}@media(min-width:820px){.fl-project-editor .user-nav{display:block;margin-top:13px;height:36px}.fl-project-editor .user-nav .dropdown-head #current-picture{height:36px;width:36px;border-radius:9999px;margin-left:10px}.fl-project-editor .user-nav .dropdown-list{left:auto;right:-5px;margin-top:-5px}}.fl-project-editor .visualisation-editor{overflow-x:hidden}.fl-project-editor .visualisation-editor .template-chooser.visible+.tab-panes{display:none}.fl-project-editor .visualisation-editor .tab-panes{height:100%;width:100%}.fl-project-editor .visualisation-editor .tab-panes #visualisation,.fl-project-editor .visualisation-editor .tab-panes .row-inner,.fl-project-editor .visualisation-editor .tab-panes .row.editor,.fl-project-editor .visualisation-editor .tab-panes .tab-pane{height:100%}.fl-project-editor .visualisation-editor .tab-panes #visualisation .editor-core,.fl-project-editor .visualisation-editor .tab-panes .row-inner .editor-core,.fl-project-editor .visualisation-editor .tab-panes .row.editor .editor-core,.fl-project-editor .visualisation-editor .tab-panes .tab-pane .editor-core{position:relative}@media (min-width:820px){.fl-project-editor .visualisation-editor .tab-panes #visualisation .editor-core,.fl-project-editor .visualisation-editor .tab-panes .row-inner .editor-core,.fl-project-editor .visualisation-editor .tab-panes .row.editor .editor-core,.fl-project-editor .visualisation-editor .tab-panes .tab-pane .editor-core{min-height:100%;padding-bottom:40px}}.fl-project-editor .visualisation-editor .tab-panes .tab-pane .side-panel{display:none}.fl-project-editor .visualisation-editor .tab-panes .tab-pane.active .side-panel{display:block}.fl-project-editor .visualisation-editor .tab-panes .tab-pane:not(.active) #spreadsheet-container input{display:none}.fl-project-editor .story-editor,.fl-project-editor .visualisation-editor{background:#f9f9f9}.fl-project-editor .row.editor{padding:0}.no-template .fl-project-editor .row.editor{display:none}.fl-project-editor .row.editor .row-inner{max-width:none;padding:0 10px}.fl-project-editor .row.editor #visibility-status .label,.fl-project-editor .row.editor .blueprint-tag{display:inline-block;margin-left:2px}.fl-project-editor .row.editor #story,.fl-project-editor .row.editor #visualisation{height:100%;width:100%;-webkit-transition:height .5s ease;transition:height .5s ease;position:relative}.fl-project-editor .row.editor #story .editor-core,.fl-project-editor .row.editor #visualisation .editor-core{width:100%;height:auto;overflow:visible;-webkit-transition:width .5s ease;transition:width .5s ease;position:relative;text-align:center}.fl-project-editor .row.editor #story .editor-core .preview-holder,.fl-project-editor .row.editor #visualisation .editor-core .preview-holder{width:100%;height:100%;padding-right:4px;min-width:100px;min-height:100px;-webkit-transition:margin-left .5s ease,width .5s ease,opacity 1s;transition:margin-left .5s ease,width .5s ease,opacity 1s;position:relative;background:#fff;display:inline-block;box-shadow:0 0 2px rgba(0,0,0,.2)}.fl-project-editor .row.editor #story .editor-core .preview-holder #preview,.fl-project-editor .row.editor #visualisation .editor-core .preview-holder #preview{max-height:100%;overflow-y:auto;min-width:100px;text-align:right;border:none;background:#fff;display:block;width:100%;height:100%}.fl-project-editor .row.editor #story .editor-core .preview-holder #preview iframe,.fl-project-editor .row.editor #visualisation .editor-core .preview-holder #preview iframe{width:100vw;border:none;position:relative}.fl-project-editor .row.editor #story .editor-core .preview-holder #preview #blank-slide,.fl-project-editor .row.editor #story .editor-core .preview-holder #preview iframe,.fl-project-editor .row.editor #visualisation .editor-core .preview-holder #preview #blank-slide,.fl-project-editor .row.editor #visualisation .editor-core .preview-holder #preview iframe{height:100%;width:100%;min-width:100px;border:none;-webkit-box-flex:1;flex:1}.fl-project-editor .row.editor #story .editor-core .preview-holder .loading-spinner,.fl-project-editor .row.editor #visualisation .editor-core .preview-holder .loading-spinner{position:absolute;left:50%;top:50%;width:27px;height:27px;opacity:0;pointer-events:none;z-index:5;margin-top:-13.5px;margin-left:-13.5px}.fl-project-editor .row.editor #story .editor-core .preview-holder .unsupported-notice,.fl-project-editor .row.editor #visualisation .editor-core .preview-holder .unsupported-notice{position:absolute;top:0;left:0;right:0;bottom:0;background-color:#f9f9f9;padding:20px;z-index:10}.fl-project-editor .row.editor #story .editor-core #resize-overlay,.fl-project-editor .row.editor #visualisation .editor-core #resize-overlay{position:absolute;top:0;left:0;width:100%;height:100%;display:none}.fl-project-editor .row.editor #story .editor-core #resize-overlay.dragging,.fl-project-editor .row.editor #visualisation .editor-core #resize-overlay.dragging{display:block}.fl-project-editor .row.editor #story .editor-core #resize-handle-container,.fl-project-editor .row.editor #visualisation .editor-core #resize-handle-container{position:absolute;width:4px;bottom:0;top:0;right:0;margin-bottom:0;display:none;z-index:100;-webkit-transition:width .2s;transition:width .2s}.fl-project-editor .row.editor #story .editor-core #resize-handle-container #resize-handle,.fl-project-editor .row.editor #visualisation .editor-core #resize-handle-container #resize-handle{cursor:ew-resize;position:absolute;width:4px;bottom:0;top:0;right:0;background:#eee;-webkit-transition:width .1s,background .1s;transition:width .1s,background .1s}.fl-project-editor .row.editor #story .editor-core #resize-handle-container #resize-handle:after,.fl-project-editor .row.editor #visualisation .editor-core #resize-handle-container #resize-handle:after{display:block;content:"";position:absolute;top:0;bottom:0;left:-4px;background:transparent;right:0;width:auto}.fl-project-editor .row.editor #story .editor-core #resize-handle-container .resize-handle-icon,.fl-project-editor .row.editor #visualisation .editor-core #resize-handle-container .resize-handle-icon{position:absolute;right:3px;top:50%;margin-top:-15px;opacity:.8;pointer-events:none;-webkit-transition:right .1s;transition:right .1s;display:none}.fl-project-editor .row.editor #story .editor-core #resize-handle-container>i,.fl-project-editor .row.editor #visualisation .editor-core #resize-handle-container>i{position:absolute;top:5px;left:5px}.fl-project-editor .row.editor #story .editor-core #resize-handle-container:hover,.fl-project-editor .row.editor #visualisation .editor-core #resize-handle-container:hover{width:6px}.fl-project-editor .row.editor #story .editor-core #resize-handle-container:hover #resize-handle,.fl-project-editor .row.editor #visualisation .editor-core #resize-handle-container:hover #resize-handle{width:6px;background:#ddd}.fl-project-editor .row.editor #story .editor-core #resize-handle-container:hover #resize-handle:after,.fl-project-editor .row.editor #visualisation .editor-core #resize-handle-container:hover #resize-handle:after{left:-10px}.fl-project-editor .row.editor #story .editor-core #resize-handle-container:hover .resize-handle-icon,.fl-project-editor .row.editor #visualisation .editor-core #resize-handle-container:hover .resize-handle-icon{right:2px;display:block}.fl-project-editor .row.editor #story .editor-core #resize-handle-container.dragging #resize-handle:after,.fl-project-editor .row.editor #visualisation .editor-core #resize-handle-container.dragging #resize-handle:after{left:-200px;right:0}@media(min-width:770px){.fl-project-editor .row.editor #story .editor-core,.fl-project-editor .row.editor #visualisation .editor-core{padding:0}.fl-project-editor .row.editor #story .editor-core #resize-handle-container,.fl-project-editor .row.editor #visualisation .editor-core #resize-handle-container{display:block}}@media(min-width:820px){.fl-project-editor .row.editor #story .editor-core,.fl-project-editor .row.editor #visualisation .editor-core{padding:0 10px 0 0}}.fl-project-editor .row.editor #visualisation{padding:10px 0 0}.fl-project-editor .row.editor #visualisation .editor-core .preview-holder iframe#preview{-webkit-transform-origin:left top;transform-origin:left top}.fl-project-editor .row.editor #visualisation .editor-core .preview-holder iframe#preview.mini-preview{z-index:1000;opacity:1;box-shadow:none;-webkit-animation:fadeIn .5s;animation:fadeIn .5s;overflow:hidden;pointer-events:none}@-webkit-keyframes fadeIn{0%{opacity:0}1%{opacity:0}to{opacity:1}}@keyframes fadeIn{0%{opacity:0}1%{opacity:0}to{opacity:1}}@media(min-width:820px){.fl-project-editor .row.editor #visualisation .editor-core .preview-holder iframe#preview{width:100%}}.fl-project-editor .row.editor #story .editor-core .preview-holder #preview iframe{height:calc(100% - 64px)}.fl-project-editor .row.editor #story .editor-core .preview-holder #preview.nav-style-none iframe{height:100%}@media(min-width:820px){.fl-project-editor .row.editor #story .editor-core{max-width:calc(100% - 220px);margin-left:220px;min-height:calc(100vh - 94px)}}.fl-project-editor .row.editor.mobile #story .editor-core .preview-holder,.fl-project-editor .row.editor.mobile #story .editor-core .preview-holder iframe,.fl-project-editor .row.editor.mobile #visualisation .editor-core .preview-holder,.fl-project-editor .row.editor.mobile #visualisation .editor-core .preview-holder iframe{width:320px}.fl-project-editor .row.editor.mobile.landscape #story .editor-core .preview-holder,.fl-project-editor .row.editor.mobile.landscape #story .editor-core .preview-holder iframe,.fl-project-editor .row.editor.mobile.landscape #visualisation .editor-core .preview-holder,.fl-project-editor .row.editor.mobile.landscape #visualisation .editor-core .preview-holder iframe{width:500px}.fl-project-editor .row.editor.tablet #story .editor-core .preview-holder,.fl-project-editor .row.editor.tablet #story .editor-core .preview-holder iframe,.fl-project-editor .row.editor.tablet #visualisation .editor-core .preview-holder,.fl-project-editor .row.editor.tablet #visualisation .editor-core .preview-holder iframe{width:768px}.fl-project-editor .row.editor.tablet.landscape #story .editor-core .preview-holder,.fl-project-editor .row.editor.tablet.landscape #story .editor-core .preview-holder iframe,.fl-project-editor .row.editor.tablet.landscape #visualisation .editor-core .preview-holder,.fl-project-editor .row.editor.tablet.landscape #visualisation .editor-core .preview-holder iframe{width:1024px}@media(min-width:820px){.fl-project-editor .row.editor #visualisation .editor-core{max-width:calc(100% - 350px)}}.fl-project-editor .project-header{padding:0 10px;position:absolute;top:2px;left:48px;right:0;width:auto}@media(min-width:420px){.fl-project-editor .project-header{left:60px}.fl-project-editor .project-header:after{clear:both;display:block;content:""}}@media(min-width:620px){.fl-project-editor .project-header{height:60px;z-index:110}}.fl-project-editor .project-header #visibility-status,.fl-project-editor .project-header .blueprint-tag,.fl-project-editor .project-header .read-only{text-align:left;margin:-1px 0 0 3px;height:auto;line-height:1em;display:inline-block;border-radius:3px;vertical-align:top}@media(min-width:420px){.fl-project-editor .project-header #visibility-status,.fl-project-editor .project-header .blueprint-tag,.fl-project-editor .project-header .read-only{font-size:11px;padding:2px 3px 1px}}.fl-project-editor .project-header #visibility-status{cursor:pointer}.fl-project-editor .project-header #visibility-status:hover{color:#333}.fl-project-editor .project-header #visibility-status,.fl-project-editor .project-header .read-only{color:#aaa;font-weight:400;padding:1px 3px 2px;background:#eee}.fl-project-editor .project-header #visibility-status.public,.fl-project-editor .project-header .read-only.public{background:#ffdc98;color:#000}.fl-project-editor .project-header #visibility-status.public:hover,.fl-project-editor .project-header .read-only.public:hover{background:#eec26d;color:#000}.fl-project-editor .project-header .blueprint-tag{font-size:9px;font-weight:700;background:#2886b2;color:#fff;text-transform:uppercase;padding:1px 5px 2px;cursor:default}.fl-project-editor .project-header .project-settings{margin-left:10px;font-size:14px;font-weight:400;line-height:0;vertical-align:top;margin-bottom:-3px;display:inline-block;margin-top:-2px;z-index:110;height:auto}.fl-project-editor .project-header .project-settings .dropdown-head{padding-right:5px;padding-left:5px;padding-bottom:10px;font-size:16px}.fl-project-editor .project-header .project-settings .dropdown-list{margin-right:0}@media(min-width:420px){.fl-project-editor .project-header .project-settings{top:0;margin-top:-4px;padding-top:19px}}@media(min-width:620px){.fl-project-editor .project-header .project-settings{padding-top:18px}}.fl-project-editor .project-header .has-name+.project-settings{margin-left:0}.fl-project-editor .project-header .name{position:relative;vertical-align:top;font-weight:400;font-style:italic;height:23px;margin-left:0;width:auto;display:inline-block;font-size:16px;z-index:110;margin-top:3px}@media(min-width:420px){.fl-project-editor .project-header .name{margin-top:5px;height:26px}}@media(min-width:620px){.fl-project-editor .project-header .name{font-size:18px}}@media(min-width:820px){.fl-project-editor .project-header .name{font-size:18px}}.fl-project-editor .project-header .name input{font-size:1em;font-size:inherit;border:none;border-bottom:1px solid #ccc;border-radius:0;background:#fff;font-style:italic;padding:0;display:inline-block;color:#aaa;position:absolute;left:0;top:0;box-sizing:content-box;outline:none;height:23px}@media(min-width:420px){.fl-project-editor .project-header .name input{height:26px}}.fl-project-editor .project-header .name .name-width-setter{font-size:inherit;padding:0;display:inline-block;opacity:0;pointer-events:none;max-width:140px;min-width:40px;white-space:pre}@media(min-width:420px){.fl-project-editor .project-header .name .name-width-setter{max-width:240px}}@media(min-width:620px){.fl-project-editor .project-header .name .name-width-setter{max-width:340px}}@media(min-width:820px){.fl-project-editor .project-header .name .name-width-setter{max-width:340px}}.fl-project-editor .project-header .name.not-editable input{border-color:transparent;color:#333;top:0;background:transparent;font-style:normal}.fl-project-editor .project-header .name.has-name .name-width-setter,.fl-project-editor .project-header .name.has-name input{font-style:normal;background:none}.fl-project-editor .project-header .name.has-name input{color:#333;border-color:#ccc;top:0;font-style:normal}.fl-project-editor .project-header .name.has-name .name-overlay{display:block;top:0}.fl-project-editor .project-header .name .name-overlay{display:none;content:"";position:absolute;left:125px;top:0;width:20px;height:100%;background:-webkit-gradient(linear,left top,right top,from(hsla(0,0%,100%,0)),color-stop(80%,#fff));background:linear-gradient(90deg,hsla(0,0%,100%,0) 0,#fff 80%)}@media(min-width:420px){.fl-project-editor .project-header .name .name-overlay{left:225px}}@media(min-width:620px){.fl-project-editor .project-header .name .name-overlay{left:325px}}@media(min-width:820px){.fl-project-editor .project-header .name .name-overlay{left:325px}}.fl-project-editor .project-header .project-author{color:#aaa;font-weight:400;top:30px;font-size:11px;line-height:1em;position:absolute}@media(min-width:420px){.fl-project-editor .project-header .project-author{top:38px;font-size:12px}}@media(min-width:820px){.fl-project-editor .project-header .project-author{font-size:12px}}.fl-project-editor .project-header .project-author+.dropdown .dropdown-head{display:inline-block}.fl-project-editor .project-header .project-author+.dropdown .badge{top:-14px}.fl-project-editor .project-header .project-author+.dropdown .dropdown-list .badge{position:absolute;right:10px;top:12px;pointer-events:none}.fl-project-editor .project-header #export-btn-group{float:right;margin-bottom:0;margin-right:0;margin-top:9px}.fl-project-editor .project-header #export-btn-group #story-btn,.fl-project-editor .project-header #export-btn-group .export-btn{width:30px;height:30px;padding:0;text-align:center}.fl-project-editor .project-header #export-btn-group #story-btn span,.fl-project-editor .project-header #export-btn-group .export-btn span{display:none}.fl-project-editor .project-header #export-btn-group #story-btn i,.fl-project-editor .project-header #export-btn-group .export-btn i{margin-right:0}@media(min-width:420px){.fl-project-editor .project-header #export-btn-group #story-btn,.fl-project-editor .project-header #export-btn-group .export-btn{width:30px;height:30px}}@media(min-width:820px){.fl-project-editor .project-header #export-btn-group #story-btn,.fl-project-editor .project-header #export-btn-group .export-btn{padding:0 8px;height:36px;width:auto}.fl-project-editor .project-header #export-btn-group #story-btn span,.fl-project-editor .project-header #export-btn-group .export-btn span{display:inline}.fl-project-editor .project-header #export-btn-group #story-btn i,.fl-project-editor .project-header #export-btn-group .export-btn i{margin-right:3px}}.fl-project-editor .project-header #export-btn-group #create-btn{height:36px;line-height:34px}.visualisation-editor.no-template .fl-project-editor .project-header #export-btn-group{display:none}.fl-project-editor .project-header #export-btn-group #story-btn-form{display:inline-block}.fl-project-editor .project-header #export-btn-group #story-btn{border:1px solid #ddd;background-color:#eee;color:#333;font-family:Source Sans Pro;margin-right:8px;overflow:visible}@media(min-width:420px){.fl-project-editor .project-header #export-btn-group{margin-top:15px}}@media(min-width:820px){.fl-project-editor .project-header #export-btn-group{margin-top:12px}}.fl-project-editor .row.editor-bar{background:#e3e3e3;height:30px;font-size:12px;padding:0 10px}.fl-project-editor .row.editor-bar #visualisation-tabs{z-index:110;width:calc(100% - 120px);margin-left:60px;text-align:center}.fl-project-editor .row.editor-bar #visualisation-tabs button{font-size:12px;line-height:1em}.fl-project-editor .row.editor-bar #visualisation-tabs button i{margin-right:3px;font-size:11px}.fl-project-editor .row.editor-bar #visibility-status,.fl-project-editor .row.editor-bar .read-only{display:inline-block;float:left;font-weight:700;color:#aaa;margin-top:7px}.fl-project-editor .row.editor-bar .confirm-saved{float:right;margin-top:8px;margin-left:0;width:60px}@media(min-width:820px){.fl-project-editor .row.editor-bar #visualisation-tabs{width:calc(100% - 380px);margin-left:0}}.fl-project-editor .tab-data .tab-preview{position:fixed;z-index:2}.fl-project-editor .tab-data #preview-menu{opacity:0;pointer-events:none}.fl-project-editor .side-panel{text-align:left;position:relative;background:#f9f9f9;line-height:1.1;margin-left:0;padding:10px 0 1px;width:100%}.fl-project-editor .side-panel.closed{margin-left:-300px}.fl-project-editor .side-panel .side-panel-inner{margin-bottom:87px;background:#fff}@media(min-width:820px){.fl-project-editor .side-panel .side-panel-inner{border:none;background:transparent}}.fl-project-editor .side-panel .side-panel-close{position:absolute;top:15px;right:10px;font-size:1.25em;width:1.5em;height:1.5em;padding:.1em;text-align:center;border:1px solid rgba(0,0,0,.4);border-radius:3px;background:#eaeaea;-webkit-transition:right .5s ease;transition:right .5s ease;z-index:1}.fl-project-editor .side-panel .side-panel-close.opener{right:calc(-1.5em + 1px);border-bottom-left-radius:0;border-top-left-radius:0}.fl-project-editor .side-panel .side-panel-close:hover{opacity:1}.fl-project-editor .side-panel .side-panel-close:hover i{opacity:.7}.fl-project-editor .side-panel#slides-panel{height:100%;padding:0;background:#fff;margin-top:20px}.fl-project-editor .side-panel#slides-panel .side-panel-scrollbox{padding:0 15px 10px}@media(min-width:820px){.fl-project-editor .side-panel#slides-panel{max-width:200px;right:auto;position:absolute;top:0;margin-top:0;border-right:1px solid #ddd}}.fl-project-editor .side-panel .side-panel-scrollbox{width:100%;height:100%;padding:10px 10px 20px;overflow-y:scroll}.fl-project-editor .side-panel .side-panel-scrollbox .side-panel-inner{width:100%}@media(min-width:1220px){.fl-project-editor .side-panel .side-panel-scrollbox{padding:20px}}.fl-project-editor .side-panel h1{margin:1em 0 .5em;font-size:.9em;opacity:.5;cursor:default}.fl-project-editor .side-panel h2{font-size:13px;letter-spacing:0;font-weight:500;margin:0 0 .6em;position:relative;color:#333;word-wrap:break-word}.fl-project-editor .side-panel .toplevel-settings-block{padding:0 5px 20px}.fl-project-editor .side-panel .toplevel-settings-block .settings-option{display:inline-block}.fl-project-editor .side-panel .toplevel-settings-block .settings-option:first-child{margin-top:9px}.fl-project-editor .side-panel .settings-divider{margin:1rem -10px 0;clear:both;width:calc(100% + 20px);height:1px;background:#eee}.fl-project-editor .side-panel .settings-subhead{text-transform:uppercase;font-size:.7rem;font-weight:700;color:#999;padding:.5rem 5px .25rem;margin:0;width:100%}.fl-project-editor .side-panel .settings-block{margin:0;display:inline-block;width:100%;background-color:#fff;padding:0 10px;min-height:24px}.fl-project-editor .side-panel .settings-block h2{margin:0 -10px;font-size:.8rem;padding:.75em 30px;font-weight:700;background-color:#f5f5f5;border-top:1px solid #ddd;cursor:pointer;color:#535e65}.fl-project-editor .side-panel .settings-block h2:focus{outline:none}.fl-project-editor .side-panel .settings-block h2:focus,.fl-project-editor .side-panel .settings-block h2:hover{background:#e8e8e8}.fl-project-editor .side-panel .settings-block h2:after{font-family:FontAwesome,Font Awesome\\ 5 Free;content:"";position:absolute;left:15px}.fl-project-editor .side-panel .settings-block .settings-divider,.fl-project-editor .side-panel .settings-block .settings-option,.fl-project-editor .side-panel .settings-block .settings-subhead{display:none}.fl-project-editor .side-panel .settings-block input::-webkit-contacts-auto-fill-button{visibility:hidden;display:none!important;pointer-events:none;position:absolute;right:0}.fl-project-editor .side-panel .settings-block.open{padding-bottom:1rem}.fl-project-editor .side-panel .settings-block.open h2:after{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fl-project-editor .side-panel .settings-block.open .settings-option{display:inline-block}.fl-project-editor .side-panel .settings-block.open .settings-option.hidden{display:none}.fl-project-editor .side-panel .settings-block.open .settings-divider,.fl-project-editor .side-panel .settings-block.open .settings-subhead{display:block}.fl-project-editor .side-panel .settings-block.open h2+.settings-divider{background:transparent;margin-top:.25rem}.fl-project-editor .side-panel .settings-block.hidden{display:none}.fl-project-editor .side-panel h3{font-size:.8rem;line-height:1.2em;font-weight:400;margin-top:0;margin-bottom:3px;color:#333;display:inline-block;cursor:default;overflow:hidden;vertical-align:top;background:#fff;text-overflow:ellipsis}.fl-project-editor .side-panel p{font-size:12px;margin-top:0;font-weight:300}.fl-project-editor .side-panel .settings-option{position:relative;margin-top:.75rem;display:none;vertical-align:bottom;width:100%;padding:0 5px}.fl-project-editor .side-panel .settings-option label{font-size:13px;display:inline-block;vertical-align:top;width:100%}.fl-project-editor .side-panel .settings-option label .help-tip{margin-left:3px;color:#d0d0d0;font-style:normal}.fl-project-editor .side-panel .settings-option label .help-tip:hover{color:#aaa}.fl-project-editor .side-panel .settings-option label:hover{z-index:2;position:relative}.fl-project-editor .side-panel .settings-option label:hover h3{padding-right:1px}.fl-project-editor .side-panel .settings-option button,.fl-project-editor .side-panel .settings-option input,.fl-project-editor .side-panel .settings-option select,.fl-project-editor .side-panel .settings-option textarea{border-radius:3px;border:1px solid #ddd;padding:.2em .1em .2em .3em;min-height:30px;font-size:13px;display:block;outline:none;-webkit-transition:border .2s linear;transition:border .2s linear;max-width:100%}.fl-project-editor .side-panel .settings-option button:focus,.fl-project-editor .side-panel .settings-option input:focus,.fl-project-editor .side-panel .settings-option select:focus,.fl-project-editor .side-panel .settings-option textarea:focus{border:1px solid #777}.fl-project-editor .side-panel .settings-option ::-webkit-input-placeholder{color:#ddd}.fl-project-editor .side-panel .settings-option :-ms-input-placeholder{color:#ddd}.fl-project-editor .side-panel .settings-option ::-ms-input-placeholder{color:#ddd}.fl-project-editor .side-panel .settings-option .autocomplete .dropdown-list .dropdown-item{font-size:13px;padding:10px 10px 10px 6px}.fl-project-editor .side-panel .settings-option .color-wrapper{width:30px;height:30px;overflow:hidden;border-radius:3px;border:1px solid #fff;position:relative;font-size:14px;min-height:30px}.fl-project-editor .side-panel .settings-option .color-wrapper input{-webkit-transform:scale(10);transform:scale(10);position:absolute}.fl-project-editor .side-panel .settings-option .color-wrapper:after{display:block;position:absolute;content:"";border:1px solid rgba(0,0,0,.1);left:0;right:0;top:0;bottom:0;pointer-events:none}.fl-project-editor .side-panel .settings-option .color-wrapper:invalid{box-shadow:none}.fl-project-editor .side-panel .settings-option .single-button{background:#eee;color:#333;width:100%;border:none;padding:0;cursor:pointer;-webkit-transition:background-color .2s linear;transition:background-color .2s linear}.fl-project-editor .side-panel .settings-option .single-button:hover{background-color:#e0e0e0}.fl-project-editor .side-panel .settings-option .single-button:focus{border:none}.fl-project-editor .side-panel .settings-option .buttons-container input[type=radio]{width:0;height:0;opacity:0;margin:0;display:inline-block;display:none}.fl-project-editor .side-panel .settings-option .buttons-container input[type=radio]+label{font-size:13px;background:#eee;color:#333;display:inline-block;height:30px;cursor:pointer;text-align:center;padding-top:8px;border-right:1px solid #fff;border-bottom:1px solid #fff;background-size:cover;background-position:50% 50%;-webkit-transition:background-color .2s linear;transition:background-color .2s linear}.fl-project-editor .side-panel .settings-option .buttons-container input[type=radio]+label i{color:#555}.fl-project-editor .side-panel .settings-option .buttons-container input[type=radio]+label img{margin-top:-8px}.fl-project-editor .side-panel .settings-option .buttons-container.large input[type=radio]+label{height:60px}.fl-project-editor .side-panel .settings-option .buttons-container input[type=radio]:not([disabled])+label:hover{background-color:#e0e0e0}.fl-project-editor .side-panel .settings-option .buttons-container input[type=radio]:disabled+label{cursor:default}.fl-project-editor .side-panel .settings-option .buttons-container input[type=radio]:checked+label{background-color:#ccdee6;cursor:default;position:relative}.fl-project-editor .side-panel .settings-option .buttons-container input[type=radio]:checked+label:hover{background-color:#ccdee6}.fl-project-editor .side-panel .settings-option .buttons-container input[type=radio]:checked+label:after{width:100%;height:2px;background:#2886b2;bottom:0;position:absolute;content:"";left:0}.fl-project-editor .side-panel .settings-option input[data-autocomplete]+.fa{position:absolute;right:10px;margin-top:-21px;font-size:12px;pointer-events:none}.fl-project-editor .side-panel .settings-option select{width:100%;height:30px}.fl-project-editor .side-panel .settings-option.option-type-color input{padding:0;background:#fff}.fl-project-editor .side-panel .settings-option.option-type-color,.fl-project-editor .side-panel .settings-option.option-type-number,.fl-project-editor .side-panel .settings-option.option-type-rows{width:50%}.fl-project-editor .side-panel .settings-option.option-type-color.width-quarter input,.fl-project-editor .side-panel .settings-option.option-type-number.width-quarter input,.fl-project-editor .side-panel .settings-option.option-type-rows.width-quarter input{width:100%}.fl-project-editor .side-panel .settings-option.option-type-color input,.fl-project-editor .side-panel .settings-option.option-type-number input,.fl-project-editor .side-panel .settings-option.option-type-rows input{width:calc((100% - 10px)/2);min-width:40px}.fl-project-editor .side-panel .settings-option.option-type-boolean:not(.settings-buttons).settings-buttons>label{height:auto}.fl-project-editor .side-panel .settings-option.option-type-boolean:not(.settings-buttons) input{display:none}.fl-project-editor .side-panel .settings-option.option-type-boolean:not(.settings-buttons)>label:first-child{position:absolute;padding-left:37px;padding-top:7px;width:auto;right:5px;left:5px}.fl-project-editor .side-panel .settings-option.option-type-boolean:not(.settings-buttons) .slider{position:relative;cursor:pointer;width:33px;height:30px;background:transparent;padding-left:0;padding-top:0}.fl-project-editor .side-panel .settings-option.option-type-boolean:not(.settings-buttons) .slider:hover:after{border-color:#bbb}.fl-project-editor .side-panel .settings-option.option-type-boolean:not(.settings-buttons) .slider:before{position:absolute;content:"";height:12px;width:33px;top:9px;left:0;border-radius:6px;background-color:#ddd;-webkit-transition:.1s;transition:.1s}.fl-project-editor .side-panel .settings-option.option-type-boolean:not(.settings-buttons) .slider:after{position:absolute;content:"";height:24px;width:24px;left:0;bottom:3px;border-radius:50%;background-color:#fff;border:1px solid #ddd;box-sizing:border-box;-webkit-transition:.1s;transition:.1s}.fl-project-editor .side-panel .settings-option.option-type-boolean:not(.settings-buttons) input:checked+.slider:before{background:#ccdee6}.fl-project-editor .side-panel .settings-option.option-type-boolean:not(.settings-buttons) input:checked+.slider:after{left:9px;background:#2886b2;border-color:#2886b2}.fl-project-editor .side-panel .settings-option.option-type-boolean:not(.settings-buttons) input:checked+.slider:hover:after{background-color:#2886b2;border-color:#2886b2}.fl-project-editor .side-panel .settings-option.option-type-code textarea,.fl-project-editor .side-panel .settings-option.option-type-string input,.fl-project-editor .side-panel .settings-option.option-type-text textarea,.fl-project-editor .side-panel .settings-option.option-type-url input{width:100%}.fl-project-editor .side-panel .settings-option.option-type-code textarea.size-large,.fl-project-editor .side-panel .settings-option.option-type-text textarea.size-large{height:50vh}.fl-project-editor .side-panel .settings-option.option-type-code label{width:calc(100% - 18px)}.fl-project-editor .side-panel .settings-option.option-type-code .wrap-control{font-size:.7em;color:#999;-webkit-transform:scaleY(-1);transform:scaleY(-1);margin-bottom:.3em;display:inline-block;vertical-align:bottom;-webkit-transition:-webkit-transform .1s ease;transition:-webkit-transform .1s ease;transition:transform .1s ease;transition:transform .1s ease,-webkit-transform .1s ease}.fl-project-editor .side-panel .settings-option.option-type-code .wrap-control.selected{-webkit-transform:scale(-1);transform:scale(-1);cursor:pointer}.fl-project-editor .side-panel .settings-option.option-type-code textarea{font-family:monospace;font-size:13px}.fl-project-editor .side-panel .settings-option.option-type-font input.font-menu{width:100%;outline:none}.fl-project-editor .side-panel .settings-option.option-type-colors input{width:100%;margin:0;z-index:1;cursor:pointer}.fl-project-editor .side-panel .settings-option.option-type-colors .color-swatches,.fl-project-editor .side-panel .settings-option.option-type-colors .dropdown-item{display:-webkit-box;display:flex;-webkit-box-align:stretch;align-items:stretch;min-height:30px;overflow:hidden}.fl-project-editor .side-panel .settings-option.option-type-colors .color-swatches em,.fl-project-editor .side-panel .settings-option.option-type-colors .dropdown-item em{font-style:normal;color:#777;display:block;padding:8px;pointer-events:none}.fl-project-editor .side-panel .settings-option.option-type-colors .color-swatches span,.fl-project-editor .side-panel .settings-option.option-type-colors .dropdown-item span{display:inline-block;height:30px;-webkit-box-flex:1;flex:1}.fl-project-editor .side-panel .settings-option.option-type-colors .color-swatches span:nth-child(n+13):nth-child(-n+99),.fl-project-editor .side-panel .settings-option.option-type-colors .dropdown-item span:nth-child(n+13):nth-child(-n+99){display:none}.fl-project-editor .side-panel .settings-option.option-type-colors .color-swatches{padding:0;position:absolute;left:4px;right:26px;z-index:0;pointer-events:none}.fl-project-editor .side-panel .settings-option.option-type-colors .dropdown-item{padding:2px 0!important;width:100%}.fl-project-editor .side-panel .settings-option.option-type-colors .dropdown-item label{position:absolute;top:6px;left:8px;color:hsla(0,0%,98%,.9);pointer-events:none}.fl-project-editor .side-panel .settings-option.option-type-colors .dropdown-item span{pointer-events:none}.fl-project-editor .side-panel .settings-option.option-type-colors.custom input{opacity:0}.fl-project-editor .side-panel .settings-option.option-type-colors.custom .color-swatches{-webkit-box-align:start;align-items:flex-start}.fl-project-editor .side-panel .settings-option.option-type-colors.custom .color-swatches span{max-width:28px;pointer-events:auto;-webkit-transition:-webkit-transform .1s;transition:-webkit-transform .1s;transition:transform .1s;transition:transform .1s,-webkit-transform .1s;-webkit-transform-origin:center center;transform-origin:center center}.fl-project-editor .side-panel .settings-option.option-type-colors.custom .color-swatches span:hover{-webkit-transform:scale(1.2);transform:scale(1.2)}.fl-project-editor .side-panel .settings-option.option-type-colors.custom .color-swatches span.fa{font-size:24px;color:#ccc;margin-left:4px}.fl-project-editor .side-panel .settings-option.option-type-colors.custom .color-swatches span.fa:before{position:relative;top:2px}.fl-project-editor .side-panel .settings-option.hidden{display:none}.fl-project-editor .side-panel .settings-option.width-full{width:100%!important}.fl-project-editor .side-panel .settings-option.width-half{width:50%!important}.fl-project-editor .side-panel .settings-option.width-quarter{width:25%!important}.fl-project-editor .side-panel .settings-option.width-three-quarters{width:75%!important}.fl-project-editor .side-panel .settings-option .description-link{cursor:pointer;color:#dd4141}.fl-project-editor .side-panel .detailed-settings h2{margin-bottom:.75rem}.fl-project-editor .side-panel .detailed-settings h2:after{content:""}.fl-project-editor .side-panel .palette{max-height:calc(100vh - 210px);overflow-y:auto;padding:1px}.fl-project-editor .side-panel .palette .swatch-color,.fl-project-editor .side-panel .palette button,.fl-project-editor .side-panel .palette input[type=color]{-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;display:inline-block;width:28px;height:28px;padding:0;margin:1px;border:none;outline:none;background:transparent}.fl-project-editor .side-panel .palette .swatch-color.fa-plus-square:before,.fl-project-editor .side-panel .palette button.fa-plus-square:before,.fl-project-editor .side-panel .palette input[type=color].fa-plus-square:before{font-size:32px;color:#ddd;margin-left:1px}.fl-project-editor .side-panel .palette .swatch-color.fa-times,.fl-project-editor .side-panel .palette button.fa-times,.fl-project-editor .side-panel .palette input[type=color].fa-times{position:absolute;right:0;opacity:0;color:#aaa}.fl-project-editor .side-panel .palette .swatch-color.fa-times:hover,.fl-project-editor .side-panel .palette button.fa-times:hover,.fl-project-editor .side-panel .palette input[type=color].fa-times:hover{color:#888}.fl-project-editor .side-panel .palette .swatch-color::-webkit-color-swatch-wrapper,.fl-project-editor .side-panel .palette button::-webkit-color-swatch-wrapper,.fl-project-editor .side-panel .palette input[type=color]::-webkit-color-swatch-wrapper{padding:0}.fl-project-editor .side-panel .palette .swatch-color::-webkit-color-swatch,.fl-project-editor .side-panel .palette button::-webkit-color-swatch,.fl-project-editor .side-panel .palette input[type=color]::-webkit-color-swatch{border:none}.fl-project-editor .side-panel .palette [draggable]{cursor:move;cursor:grab;cursor:-webkit-grab}.fl-project-editor .side-panel .palette [draggable]:active{cursor:grabbing;cursor:-webkit-grabbing}.fl-project-editor .side-panel .palette .swatch-handle{display:block;width:15px;height:28px;color:#ddd;position:absolute;left:1px;top:7px;text-align:center;font-size:18px;font-weight:700;line-height:5.5px;pointer-events:none}.fl-project-editor .side-panel .palette input[type=text]{width:120px;width:calc(100% - 52px);background:transparent;padding:5px 8px;border-width:0;margin:0}.fl-project-editor .side-panel .palette p{position:relative;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;margin:0;padding:5px 5px 5px 20px;border-bottom:1px solid #eee}.fl-project-editor .side-panel .palette p:first-child{border-top:1px solid #eee}.fl-project-editor .side-panel .palette p:hover button.fa-times{opacity:.5}.fl-project-editor .side-panel .palette p:hover [draggable]:before{opacity:1}.fl-project-editor .side-panel .side-panel-top{border-top:none;border-bottom:1px solid rgba(0,0,0,.1);margin-top:0;padding:17px 10px 20px;font-size:1em}.fl-project-editor .side-panel .side-panel-top.shadow{box-shadow:3px 3px 5px rgba(0,0,0,.1)}.fl-project-editor .side-panel .side-panel-top .side-panel-top-menu .side-panel-icon-btn{color:#fff;background:#9a9a9a;padding:7px 0 0;border-radius:9999px;width:30px;height:30px;text-align:center;margin:0}.fl-project-editor .side-panel .side-panel-top .side-panel-top-menu .separator{margin:0 .4em;height:1em;border-left:1px solid rgba(0,0,0,.25);display:inline-block;vertical-align:middle}#story .fl-project-editor .side-panel .side-panel-top .side-panel-top-menu .separator{margin:0 .25em}.fl-project-editor .side-panel .current-template{margin:0;opacity:0;-webkit-transition:opacity .2s;transition:opacity .2s;position:relative;padding:10px 10px 0;min-height:56px;border-bottom:1px solid #ddd}.fl-project-editor .side-panel .current-template h1{padding-right:76px;opacity:1;font-size:12px;font-weight:400;min-height:36px;margin:0;padding-top:3px}.fl-project-editor .side-panel .current-template h1>span{display:block;font-weight:700;font-size:16px}.fl-project-editor .side-panel .current-template h3{margin-top:.7em}.fl-project-editor .side-panel .current-template h3 i{margin-left:.2em;color:rgba(0,0,0,.5)}.fl-project-editor .side-panel .current-template .current-template-title{position:relative}.fl-project-editor .side-panel .current-template .current-template-title .current-template-version{margin-left:4px;font-size:12px}.fl-project-editor .side-panel .current-template .current-template-thumbnail{position:absolute;right:-10px;top:-10px;width:76px;height:calc(100% + 19px);background-size:cover;background-position:50%;background-repeat:no-repeat}.fl-project-editor .side-panel .current-template .current-template-thumbnail:after{width:20px;height:100%;position:absolute;left:0;right:0;background:-webkit-gradient(linear,left top,right top,from(#fff),to(hsla(0,0%,100%,0)));background:linear-gradient(90deg,#fff,hsla(0,0%,100%,0));content:"";display:block}.fl-project-editor .side-panel .template-theme button#reset-to-theme:disabled{color:#d3d3d3}@media (min-width:620px) and (max-width:819px){.fl-project-editor .side-panel .side-panel-inner{max-width:500px;margin:20px auto}}@media(min-width:820px){.fl-project-editor .side-panel{max-width:size(3.5);position:fixed;right:0;top:93px;background:#fff;overflow-y:auto;height:calc(100vh - 93px);border-left:1px solid #ddd}.fl-project-editor .side-panel .current-template{padding-top:0;min-height:46px}}.fl-project-editor .tab-preview #visualisation .editor-core{overflow:visible!important}.fl-project-editor .tab-preview.active #visualisation .editor-core{overflow:auto!important}.fl-project-editor body.full-screen .row.editor #story,.fl-project-editor body.full-screen .row.editor #visualisation{position:fixed!important;top:0!important;left:0!important;width:100%!important;height:100%!important}.fl-project-editor body.full-screen .row.editor #story .editor-core #preview,.fl-project-editor body.full-screen .row.editor #visualisation .editor-core #preview{width:100%!important}.fl-project-editor body.full-screen .row.editor #story #exit-full-screen,.fl-project-editor body.full-screen .row.editor #visualisation #exit-full-screen{display:block}.fl-project-editor body.loading .loading-spinner{opacity:1!important;-webkit-animation-name:spin;animation-name:spin;-webkit-animation-duration:1.2s;animation-duration:1.2s;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-timing-function:linear;animation-timing-function:linear;-webkit-transform-origin:center center;transform-origin:center center}.fl-project-editor body.loading .content{min-height:100vh}.fl-project-editor body.loading .preview-holder{pointer-events:none;background-color:#f3f3f3}.fl-project-editor body.loading .preview-holder #preview{background:transparent!important}.fl-project-editor body.loading .preview-holder iframe{opacity:.1}.fl-project-editor body.loading #blank-slide,.fl-project-editor body.loading .row.data{opacity:0;pointer-events:none}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.fl-project-editor #private-publishing{display:inline-block;padding-right:15px;margin-top:10px;width:100%}.fl-project-editor #private-publishing+input{width:100%;padding:5px}.fl-project-editor #private-publishing+input.hidden{display:none}.fl-project-editor #private-publishing+input.error{border-color:#dd4141}.fl-project-editor #private-publishing.upgrade-btn{width:auto;color:#999}.fl-project-editor #private-publishing.upgrade-btn:after{top:4px}.fl-annotations-source-element{position:absolute;cursor:pointer;top:.25rem;left:-3rem;width:3rem;height:3rem;z-index:999999999;background:#333;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg data-prefix=\'fas\' data-icon=\'pencil-alt\' xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 512 512\'%3E%3Cpath fill=\'%23fff\' d=\'M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z\'/%3E%3C/svg%3E");background-position:50%;background-size:40%;background-repeat:no-repeat;border:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;pointer-events:all;border-radius:100% 0 0 100%}.fl-annotations .fl-annotations-node{pointer-events:none}.fl-annotations .fl-annotations-node.fl-connector-popup,.fl-annotations.is-editing .fl-annotations-node{pointer-events:all}.fl-annotations .fl-annotations-node.fl-marker text,.fl-annotations .fl-annotations-node.fl-point text{fill:#fff;text-anchor:middle;dominant-baseline:middle;alignment-baseline:middle;font-size:.8rem;font-weight:800}.fl-annotations .fl-annotations-node.fl-marker.selected circle{fill:#333}.fl-annotations .fl-notch{fill:none;stroke-dasharray:4,4;pointer-events:none}.fl-annotations.is-editing .fl-notch{pointer-events:all}.fl-annotations .fl-annotations-node .fl-connector,.fl-annotations .fl-annotations-node text,.fl-annotations.is-editing.is-dragging .fl-notch{pointer-events:none}.fl-annotations .fl-annotations-inline a,.fl-annotations.is-editing .fl-annotations-inline{pointer-events:all}.fl-annotations .fl-annotations-cursor{visibility:hidden;pointer-events:none}.fl-annotations.is-editing .fl-annotations-cursor{visibility:visible}.fl-annotations .fl-annotations-cursor circle{fill:none;stroke:#eee;stroke-width:2px;stroke-dasharray:4,4;-webkit-transition:stroke .25s;transition:stroke .25s}.fl-annotations .fl-annotations-cursor.is-valid circle{stroke:#333;-webkit-animation:cursorRotate 5s linear 0s infinite normal;animation:cursorRotate 5s linear 0s infinite normal}.fl-annotations .fl-annotations-cursor line{stroke:#eee;stroke-width:2px;-webkit-transition:stroke .25s;transition:stroke .25s}.fl-annotations .fl-annotations-cursor.is-valid line{stroke:#333}@-webkit-keyframes cursorRotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes cursorRotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.fl-project-editor .fl-annotation-list{background:#fff;margin:0;padding:1rem;font-size:.8rem;max-height:10rem;overflow:auto;position:relative}.fl-project-editor .fl-annotation-list:empty{padding:0}.fl-project-editor .fl-annotation-list:after{content:"";display:block;position:absolute;bottom:0;left:0;right:0;height:1rem;background:-webkit-gradient(linear,left bottom,left top,from(#fff),to(hsla(0,0%,100%,0)));background:linear-gradient(0deg,#fff,hsla(0,0%,100%,0))}.fl-project-editor .fl-annotation-list>li{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-align:center;align-items:center;-webkit-box-pack:justify;justify-content:space-between;list-style-type:none;line-height:1.35rem;color:#b1b1b1;cursor:pointer}.fl-project-editor .fl-annotation-list>li .text{display:block;overflow:hidden;text-overflow:ellipsis;-webkit-box-flex:1;flex-grow:1;white-space:nowrap}.fl-project-editor .fl-annotation-list>li .icon{display:none;margin-left:.5rem;color:#333;opacity:0}.fl-project-editor .fl-annotation-list>li:hover .icon{display:inline-block;margin-left:.5rem;opacity:.5}.fl-project-editor .fl-annotation-list>li .icon:hover{opacity:1}.fl-project-editor .fl-annotation-list>li:hover{color:#000}.fl-project-editor .fl-annotation-list>li:before{content:"";width:.75rem;height:.75rem;display:inline-block;background:#b1b1b1;vertical-align:middle;margin-right:.5rem;border-radius:100%;flex-shrink:0}.fl-project-editor .fl-annotation-list>li.selected{cursor:default}.fl-project-editor .fl-annotation-list>li.selected:before{background:#333}.fl-project-editor .fl-annotation-list>li.selected .text{color:#333}.icon-pencil{width:10px;height:10px;background-image:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAiIGhlaWdodD0iMTAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTguNjYgNC4wODZMOS43NTYgMi45OUEuODA5LjgwOSAwIDAwMTAgMi4zOTZhLjg0NS44NDUgMCAwMC0uMjQ0LS42TDguMjA1LjI1QS44Mi44MiAwIDAwNy42MDQgMGEuNzg0Ljc4NCAwIDAwLS41OTQuMjVMNS45MTQgMS4zNCA4LjY2IDQuMDg2ek0yLjc0NiAxMGw1LjQ5Mi01LjQ5Mi0yLjc0Ni0yLjc0NkwwIDcuMjU0VjEwaDIuNzQ2em0tLjYzNC0zLjIzNGMtLjA5NyAwLS4xNDUtLjA0OS0uMTQ1LS4xNDYgMC0uMDQ0LjAxNS0uMDguMDQ2LS4xMTJsMy41NzgtMy41NzdhLjE1My4xNTMgMCAwMS4xMTItLjA0N2MuMDk3IDAgLjE0NS4wNDkuMTQ1LjE0NmEuMTUzLjE1MyAwIDAxLS4wNDYuMTEyTDIuMjI0IDYuNzE5YS4xNTMuMTUzIDAgMDEtLjExMi4wNDd6bS4yODQgMi4zOUgxLjY5VjguMzFILjg0NXYtLjcwNmwuNi0uNiAxLjU1MiAxLjU1LS42MDEuNjAxeiIgZmlsbD0iIzMzMyIgZmlsbC1ydWxlPSJub256ZXJvIi8+PC9zdmc+")}.icon-trash{width:10px;height:10px;background-image:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTEiIGhlaWdodD0iMTEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTguMjg2IDEwLjg1N2MuMjk0IDAgLjU0Ny0uMTM1Ljc1Ni0uNDA1LjIxLS4yNy4zMTUtLjU5LjMxNS0uOTZ2LTYuMzVIMTBjLjA2MyAwIC4xMTQtLjAyLjE1NC0uMDYuMDQtLjA0LjA2LS4wOS4wNi0uMTUzVjIuNWEuMjA5LjIwOSAwIDAwLS4wNi0uMTU0LjIwOS4yMDkgMCAwMC0uMTU0LS4wNkg3LjkzbC0uNDY4LTEuMTE5QS45MjguOTI4IDAgMDA3LjEuNzQ2Ljk0NS45NDUgMCAwMDYuNTcxLjU3SDQuNDNhLjk0NS45NDUgMCAwMC0uNTMuMTc1LjkyOC45MjggMCAwMC0uMzYxLjQyMWwtLjQ2OSAxLjExOUgxYS4yMDkuMjA5IDAgMDAtLjE1NC4wNi4yMDkuMjA5IDAgMDAtLjA2LjE1NHYuNDI5YzAgLjA2Mi4wMi4xMTMuMDYuMTU0LjA0LjA0LjA5Mi4wNi4xNTQuMDZoLjY0M3Y2LjM3NWMwIC4zNy4xMDUuNjg2LjMxNS45NDcuMjEuMjYyLjQ2Mi4zOTIuNzU2LjM5Mmg1LjU3MnpNNyAyLjI4Nkg0bC4zMjgtLjc4NGEuMTg5LjE4OSAwIDAxLjExNC0uMDczaDIuMTIzYS4xODkuMTg5IDAgMDEuMTE0LjA3M0w3IDIuMjg2ek00IDkuMTQzaC0uNDI5YS4yMDkuMjA5IDAgMDEtLjE1NC0uMDYuMjA5LjIwOSAwIDAxLS4wNi0uMTU0VjQuMjE0YzAtLjA2Mi4wMi0uMTE0LjA2LS4xNTQuMDQtLjA0LjA5Mi0uMDYuMTU0LS4wNkg0Yy4wNjMgMCAuMTE0LjAyLjE1NC4wNi4wNC4wNC4wNi4wOTIuMDYuMTU0VjguOTNjMCAuMDYyLS4wMi4xMTMtLjA2LjE1NGEuMjA5LjIwOSAwIDAxLS4xNTQuMDZ6bTEuNzE0IDBoLS40MjhhLjIwOS4yMDkgMCAwMS0uMTU0LS4wNi4yMDkuMjA5IDAgMDEtLjA2LS4xNTRWNC4yMTRjMC0uMDYyLjAyLS4xMTQuMDYtLjE1NC4wNC0uMDQuMDkxLS4wNi4xNTQtLjA2aC40MjhjLjA2MyAwIC4xMTQuMDIuMTU0LjA2LjA0LjA0LjA2LjA5Mi4wNi4xNTRWOC45M2MwIC4wNjItLjAyLjExMy0uMDYuMTU0YS4yMDkuMjA5IDAgMDEtLjE1NC4wNnptMS43MTUgMEg3YS4yMDkuMjA5IDAgMDEtLjE1NC0uMDYuMjA5LjIwOSAwIDAxLS4wNi0uMTU0VjQuMjE0YzAtLjA2Mi4wMi0uMTE0LjA2LS4xNTQuMDQtLjA0LjA5MS0uMDYuMTU0LS4wNmguNDI5Yy4wNjIgMCAuMTEzLjAyLjE1NC4wNi4wNC4wNC4wNi4wOTIuMDYuMTU0VjguOTNjMCAuMDYyLS4wMi4xMTMtLjA2LjE1NGEuMjA5LjIwOSAwIDAxLS4xNTQuMDZ6IiBmaWxsPSIjMzMzIiBmaWxsLXJ1bGU9Im5vbnplcm8iLz48L3N2Zz4=")}.fl-project-editor{z-index:100000;overflow-y:auto;width:18rem;background:#fff;box-shadow:0 -2px 5px 0 rgba(0,0,0,.2);height:100vh;overflow:auto}.fl-project-editor .side-panel .side-panel-inner{margin:0;max-width:none}.fl-project-editor .side-panel{padding:0;background:transparent;height:auto;position:static;overflow:none}.fl-annotation-settings{border-top:1px solid #eee}.empty-annotation-message{padding:1rem;font-size:1rem;text-align:center;color:#aaa}.fl-project-editor .fl-annotation-settings .settings-block,.fl-project-editor .fl-annotation-settings .toplevel-settings-block{display:none}.fl-project-editor.active-annotation .fl-annotation-settings .settings-block,.fl-project-editor.active-annotation .fl-annotation-settings .toplevel-settings-block{display:block}.fl-project-editor.active-annotation .fl-annotation-settings .empty-annotation-message{display:none}',document.head.appendChild(am);var om={dropdown:function(t,e){for(var n=0;n<e.choices.length;n++){var r=e.choices[n][0],i=e.choices[n][1];if("buttons"==e.style){t.classed("buttons-container",!0),t.append("input").attr("type","radio").attr("name",e.property).attr("id",e.property+"-"+n).attr("value",i).on("change",function(){t.node().value=te.target.value});var a=t.append("label").attr("for",e.property+"-"+n).style("width",100/e.choices.length+"%"),o=r.match(/fa-(\S*)/g),s=r.match(/^data:image\/(svg|svg\+xml|png|jpg);base64,[A-Z-a-z0-9+/=]*$/);o?a.append("i").attr("class","fa "+o[0]):s?a.append("img").attr("src",r):a.text(r)}else t.append("option").attr("value",i).text(r)}},color:function(t){t.attr("type","color"),ce(t.node().parentNode).insert("div",function(){return t.node()}).classed("color-wrapper",!0).append(function(){return t.node()})},number:function(t,e){t.attr("type","number"),null!=e.min&&t.attr("min",e.min),null!=e.max&&t.attr("max",e.max),e.step&&t.attr("step",e.step)},boolean:function(t,e){t.attr("type","checkbox"),ce(t.node().parentNode).append("label").classed("slide",!0).attr("for","setting-"+e.property)},code:function(t){t.attr("type","text"),t.attr("wrap","off"),t.on("keydown.tab",function(t){if(9===t.keyCode&&!(t.altKey||t.metaKey||t.ctrlKey||t.shiftKey)){t.preventDefault();var e=this.selectionStart;this.value=this.value.substring(0,e)+"\t"+this.value.substring(this.selectionEnd),this.selectionEnd=e+1}})}};function sm(t,e){var n=e.choices&&("buttons"===e.style||"boolean"===e.type);t.classed("settings-option",!0).classed("option-type-"+e.type,!0).classed("settings-buttons",n);var r=t.append("label").attr("for","setting-"+e.property).classed("hidden",null===e.name).append("h3").text(e.name).classed("no-select",!0);e.description&&r.append("i").attr("class","popup fa fa-question-circle help-tip").style("font-family","FontAwesome, 'Font Awesome 5 Free'").attr("data-popup-body",e.description.replace(/\[\[/g,"").replace(/\]\]/g,"")).attr("data-popup-position","top"),e.width&&t.classed("width-"+e.width.replace(/ /g,"-"),!0);var i="input";if(e.choices?i=n?"div":"select":"text"!==e.type&&"code"!==e.type||(i="textarea"),"code"===e.type){var a=!1;t.append("i").attr("class","popup fa fa-reply clickable wrap-control").attr("data-popup-body","Wrap/unwrap text").attr("data-popup-position","top").on("click",function(){a=!a,ce(this.parentNode).select("textarea").attr("wrap",a?null:"off"),ce(this).classed("selected",a)})}var o=t.append(i).attr("id","setting-"+e.property).attr("name",e.property),s=e.choices?om.dropdown:om[e.type];return s?s(o,e):o.attr("type","text"),e.placeholder&&o.attr("placeholder",e.placeholder),e.size&&o.classed("size-"+e.size),o.node()}var lm,cm,um=function(t){this.id="",this.device_visibility="all",this.position=t,this.text_size=1,this.text_color="#333333",this.text_bg="#ffffff",this.text_weight="bold",this.label_width=10,this.popup_position="center",this.popup_bg="#ffffff",this.line_marker="none",this.stroke_color="#333333",this.stroke_opacity=1,this.stroke_width=2,this.subject_fill="#333333",this.point_radius=.5,this.point_text="",this.point_text_color="#FFFFFF",this.subject_fill_opacity=0,this.subject_type="point",this.connector_type="polyline",this.contents="Type your annotation...",this.view={}},fm=520;function dm(){return window.innerWidth!==lm&&(lm=window.innerWidth,cm=lm<fm),cm}var pm=Object.create?Object.create(null):{},hm={origin:[0,0],device_visibility:"all",content_text:"Hello world",text_size:1,text_color:"#333333",text_bg:"#ffffff",text_weight:"bold",label_width:10,popup_position:"center",popup_bg:"#ffffff",stroke_color:"#ffffff",stroke_opacity:1,subject_fill:"#000",subject_fill_opacity:0,point_radius:.5,point_text:"",point_text_color:"#ffffff",connector_type:"polyline",line_marker:"none",stroke_width:2},gm=function(t,e,n,r,i){this.id=t,this.state=e,this.parent=n,this.parent_svg=r,this.settings=Object.assign(i,Object.assign({},hm,i)),this.settings.origin=this.settings.origin.slice(),this.selected=!1,this.editable=!1,this.active=!0,this.element=ce(r).append("g").attr("data-annotation-id",this.id).attr("data-annotation-interactive",!0).classed("fl-annotations-node",!0).node(),this.el_content=ce(n).append("aside").attr("data-annotation-content","true").style("position","absolute").classed("fl-annotations-inline",!0),this.el_content_bg=this.el_content.append("span").style("position","absolute").classed("fl-label-bg",!0),this.el_content_fg=this.el_content.append("span").style("position","absolute").classed("fl-label-fg",!0),this.id&&(pm[this.id]=this)},mm={type:{configurable:!0}};gm.prototype.ofType=function(t){if(t===this.constructor)return this;var e=this.id,n=this.state,r=this.settings,i=this.parent,a=this.parent_svg;return this.destroy(),new t(e,n,i,a,r)},mm.type.get=function(){return String(this.constructor.name)},gm.prototype.onDragStart=function(t,e){return!0},gm.prototype.onDragMove=function(t,e){return!0},gm.prototype.onDragEnd=function(t,e){return!0},gm.prototype.update=function(){var t=this.getConnectorType();ce(this.element).classed("fl-connector-popup","popup"==t).classed("fl-connector-line","polyline"==t)},gm.prototype.getPopupPosition=function(t){return[0,0]},gm.prototype.getConnectorType=function(){return"popup"==this.settings.device_visibility&&dm()?"popup":this.settings.connector_type},gm.prototype.destroy=function(t){t&&t.stayInDOM||!this.element.parentNode||this.element.parentNode.removeChild(this.element),this.state=null,this.element=null,this.settings=null,delete pm[this.id]},gm.prototype.setSelected=function(t){return t=!!t,this.selected!==t&&((this.selected=t)?this.element.classList.add("selected"):this.element.classList.remove("selected"),!0)},gm.prototype.setActive=function(t){return this.active!==(t=!!t)&&(this.active=t,this.element.style.visibility=t?"visible":"hidden",!0)},Object.defineProperties(gm.prototype,mm),gm.getByID=function(t){return pm[t]||null};var _m,ym,bm,vm,xm,wm=function(t){return null!=t},Mm=Object.keys,jm=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}()?Object.keys:function(t){return Mm(wm(t)?Object(t):t)},km=Math.max,zm="function"==typeof(ym=Object.assign)&&(ym(_m={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),_m.foo+_m.bar+_m.trzy==="razdwatrzy")?Object.assign:function(e,n){var r,t,i,a=arguments,o=km(arguments.length,2);for(e=Object(function(t){if(!wm(t))throw new TypeError("Cannot use null or undefined");return t}(e)),i=function(t){try{e[t]=n[t]}catch(t){r||(r=t)}},t=1;t<o;++t)n=a[t],jm(n).forEach(i);if(void 0!==r)throw r;return e},Nm=Array.prototype.forEach,Am=Object.create,Dm=function(t){var e=Am(null);return Nm.call(arguments,function(t){wm(t)&&function(t,e){var n;for(n in t)e[n]=t[n]}(Object(t),e)}),e},Tm=function(t){return"function"==typeof t},Im="razdwatrzy",Lm=String.prototype.indexOf,Sm="function"==typeof Im.contains&&!0===Im.contains("dwa")&&!1===Im.contains("foo")?String.prototype.contains:function(t){return-1<Lm.call(this,t,arguments[1])},Em=Lp(function(t){(t.exports=function(t,e){var n,r,i,a,o;return arguments.length<2||"string"!=typeof t?(a=e,e=t,t=null):a=arguments[2],null==t?(n=i=!0,r=!1):(n=Sm.call(t,"c"),r=Sm.call(t,"e"),i=Sm.call(t,"w")),o={value:e,configurable:n,enumerable:r,writable:i},a?zm(Dm(a),o):o}).gs=function(t,e,n){var r,i,a,o;return"string"!=typeof t?(a=n,n=e,e=t,t=null):a=arguments[3],null==e?e=void 0:Tm(e)?null==n?n=void 0:Tm(n)||(a=n,n=void 0):(a=e,e=n=void 0),i=null==t?!(r=!0):(r=Sm.call(t,"c"),Sm.call(t,"e")),o={get:e,set:n,configurable:r,enumerable:i},a?zm(Dm(a),o):o}}),Cm=function(t){if(!(e=t)||"symbol"!=typeof e&&"Symbol"!==e["@@toStringTag"])throw new TypeError(t+" is not a symbol");var e;return t},Om=Object.create,Pm=Object.defineProperties,Ym=Object.defineProperty,Fm=Object.prototype,Bm=Om(null),Um=(xm=Om(null),function(t){for(var e,n=0;xm[t+(n||"")];)++n;return xm[t+=n||""]=!0,Ym(Fm,e="@@"+t,Em.gs(null,function(t){Ym(this,e,Em(t))})),e});vm=function t(e){if(this instanceof vm)throw new TypeError("TypeError: Symbol is not a constructor");return t()};var Rm=bm=function t(e){var n;if(this instanceof t)throw new TypeError("TypeError: Symbol is not a constructor");return n=Om(vm.prototype),e=void 0===e?"":String(e),Pm(n,{__description__:Em("",e),__name__:Em("",Um(e))})};Pm(bm,{for:Em(function(t){return Bm[t]?Bm[t]:Bm[t]=bm(String(t))}),keyFor:Em(function(t){var e;for(e in Cm(t),Bm)if(Bm[e]===t)return e}),hasInstance:Em("",bm("hasInstance")),isConcatSpreadable:Em("",bm("isConcatSpreadable")),iterator:Em("",bm("iterator")),match:Em("",bm("match")),replace:Em("",bm("replace")),search:Em("",bm("search")),species:Em("",bm("species")),split:Em("",bm("split")),toPrimitive:Em("",bm("toPrimitive")),toStringTag:Em("",bm("toStringTag")),unscopables:Em("",bm("unscopables"))}),Pm(vm.prototype,{constructor:Em(bm),toString:Em("",function(){return this.__name__})}),Pm(bm.prototype,{toString:Em(function(){return"Symbol ("+Cm(this).__description__+")"}),valueOf:Em(function(){return Cm(this)})}),Ym(bm.prototype,bm.toPrimitive,Em("",function(){return Cm(this)})),Ym(bm.prototype,bm.toStringTag,Em("c","Symbol")),Ym(vm.prototype,bm.toPrimitive,Em("c",bm.prototype[bm.toPrimitive])),Ym(vm.prototype,bm.toStringTag,Em("c",bm.prototype[bm.toStringTag]));var Hm=function(){var t;if("function"!=typeof Symbol)return!1;t=Symbol("test symbol");try{String(t)}catch(t){return!1}return"symbol"==typeof Symbol.iterator||"object"==typeof Symbol.isConcatSpreadable&&"object"==typeof Symbol.iterator&&"object"==typeof Symbol.toPrimitive&&"object"==typeof Symbol.toStringTag&&"object"==typeof Symbol.unscopables}()?Symbol:Rm,Zm=qm,Qm=function(n){var r,t=n.length;return i(),e[Gm]=!0,e;function e(){return n.length!==t?(t=n.length,i(),!0):r()}function i(){for(var e=[],t=0;t<n.length;t++)!function(t){e[t]=function(){return n[t]}}(t);r=qm(e)}},Gm=Hm("see-change-array");function qm(a){for(var o=[],t=0;t<a.length;t++)o[t]=a[t]();return function(){for(var t=!1,e=0;e<a.length;e++){var n=a[e],r=n();if(n[Gm])r&&(t=!0,o[e]=r);else{var i=o[e];r!==i&&(t=!0,o[e]=r)}}return t}}function Wm(t){for(var e=[],n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++){var i=0===r?"M":"L",a=t[n][r][0],o=t[n][r][1];e.push(i+a+","+o)}return e.join(" ")}Zm.array=Qm;var Vm,Xm={polyline:function(t,e,n,r){var i=e[0],a=n[0],o=e[1],s=n[1],l=n[2],c=n[3],u=a-i,f=s-o;if("rect"===t){var d=r.radius_x,p=r.radius_y;u=a,f=s,(0<d&&-d<u||d<0&&u<+d)&&(i=Math.abs(d)>Math.abs(u)?0:d),(0<p&&-p<f||p<0&&f<+p)&&(o=Math.abs(p)>Math.abs(f)?0:p)}s<0&&(s+=c),i===l/2&&o===c/2&&(i=a,o=s),u=a-i,f=s-o;var h=a,g=s,m=s<o&&i<a||a<i&&o<s?-1:1;if(Math.abs(u)<Math.abs(f)?(h=a,g=o+u*m):(g=s,h=i+f*m),"circle"!==t&&"point"!==t||!r.radius)return Wm([[[i,o],[h,g],[a,s]],[[a,s],[a+l,s]]]);var _=r.radius,y=Math.sqrt(u*u+f*f);y<_-r.radius_pad?_-=r.radius_pad:y>_+r.radius_pad&&(_+=r.radius_pad);var b=_/Math.sqrt(2);if(Math.abs(u)>b&&Math.abs(f)>b)return Wm([[[i=b*(a<0?-1:1),o=b*(s<0?-1:1)],[h,g],[a,s]],[[a,s],[a+l,s]]]);if(Math.abs(u)>Math.abs(f)){var v=Math.asin(-s/_);return Wm([[[i=Math.abs(Math.cos(v)*_)*(a<0?-1:1),s],[a,s]],[[a,s],[a+l,s]]])}var x=Math.acos(a/_);return Wm([[[a,o=Math.abs(Math.sin(x)*_)*(s<0?-1:1)],[a,s]],[[a,s],[a+l,s]]])},none:function(){return""},popup:function(){return""}};var Jm,Km,$m={},t_={arrowhead:function(t,e,n){return t.append("marker").attr("id",e).attr("viewBox","0 0 10 10").attr("refX","7.5").attr("refY","5").attr("markerWidth","5").attr("markerHeight","5").attr("orient","auto-start-reverse").attr("fill",n).append("path").attr("d","M 0 0 L 10 5 L 0 10 z")}};function e_(t,e){var n=$m[t];if(!n)return null;var r="marker-"+t+"-"+e.replace(/[^a-f0-9]/gi,"-").toLowerCase();return n[e]=n[e]||t_[t](Vm,r,e),"url(#"+r+")"}function n_(){var t=window.innerWidth,e=window.innerHeight;return Math.sqrt(t*t+e*e)}function r_(t){return window.innerWidth!==Jm&&(Jm=window.innerWidth,Km=parseFloat(getComputedStyle(document.documentElement).fontSize)),t*Km}function i_(){var t=window.innerWidth,e=window.innerHeight;return Math.sqrt(t*t+e*e)}Object.keys(t_).forEach(function(t){return $m[t]={}});var a_={circle:function(s){function t(t,e,n,r,i){var a=this;s.call(this,t,e,n,r,i);var o=n_();this.state.content_offset=this.state.content_offset||[32,32],this.state.radius="radius"in this.state?this.state.radius:.05,this.group=ce(this.element).classed("fl-circle",!0),this.el_path=this.group.append("path").style("stroke",this.settings.stroke_color).style("stroke-width",this.settings.stroke_width).style("fill","none").classed("fl-connector",!0),this.el_circle=this.group.append("circle").classed("main-circle",!0).attr("fill","none").attr("stroke",this.settings.stroke_color).attr("stroke-width",this.settings.stroke_width).attr("cx",0).attr("cy",0).style("opacity",0).attr("r",this.state.radius*o+10),this.el_circle.transition().style("opacity",1).attr("r",this.state.radius*o),this.el_outline_radius=this.group.append("circle").classed("fl-notch",!0).attr("r",8).attr("cx",this.state.radius*o),this.el_outline_origin=this.group.append("circle").classed("fl-notch",!0).attr("r",8),this.el_content.attr("data-annotation-id",this.id),this.el_content_bg.html(this.settings.contents),this.el_content_fg.html(this.settings.contents),this.svg=r,this._is_drag_custom=!1,this._drag_mode_offset=!1,this._drag_mode_radius=!1,this._drag_start=[0,0],this._drag_base_position=[0,0],this._has_run=!1,this.shouldUpdatePath=Zm([function(){return a.state.content_offset[0]},function(){return a.state.content_offset[1]},function(){return a.state.radius},function(){return a.settings.contents},function(){return a.settings.stroke_color},function(){return a.settings.connector_type},function(){return a.settings.subject_type},function(){return a.settings.text_size},function(){return a.settings.label_width},function(){return window.innerWidth},function(){return window.innerHeight}]),this.updatePath(this.state.content_offset[0],this.state.content_offset[1])}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.setActive=function(t){return!!s.prototype.setActive.call(this,t)&&(this.el_content.style("visibility",this.active&&"popup"!==this.getConnectorType()?"visible":"hidden"),this.updateNotchVisibility(),!0)},t.prototype.onDragStart=function(t,e){return this._drag_mode_offset=!!Yg(t.target,function(t){return t.hasAttribute&&t.hasAttribute("data-annotation-content")}),this._drag_mode_radius=t.target===this.el_outline_radius.node(),this._drag_start[0]=e[0],this._drag_start[1]=e[1],this._drag_base_position[0]=this.state.content_offset[0],this._drag_base_position[1]=this.state.content_offset[1],this._is_drag_custom=this._drag_mode_offset||this._drag_mode_radius,!this._is_drag_custom},t.prototype.onDragMove=function(t,e){if(!this._is_drag_custom)return!0;if(this._drag_mode_radius){var n=e[0]-this.settings.origin[0],r=e[1]-this.settings.origin[1],i=Math.sqrt(n*n+r*r);this.state.radius=i/n_()}else{var a=e[0]-this._drag_start[0],o=e[1]-this._drag_start[1];this.state.content_offset[0]=a+this._drag_base_position[0],this.state.content_offset[1]=o+this._drag_base_position[1]}return this.update(),!1},t.prototype.onDragEnd=function(t,e){return this.onDragMove(t,e)},t.prototype.update=function(){s.prototype.update.call(this);var t=this.state.content_offset[0],e=this.state.content_offset[1],n=this.settings.origin[0],r=this.settings.origin[1],i=n_()*this.state.radius,a=this.settings.stroke_color;ce(this.element).attr("transform","translate("+n+" "+r+")"),this.el_circle.style("opacity",1).attr("stroke",a).attr("stroke-opacity",this.settings.stroke_opacity).attr("stroke-width",this.settings.stroke_width).attr("fill",this.settings.subject_fill).attr("fill-opacity",this.settings.subject_fill_opacity).attr("r",i).interrupt(),this.el_outline_origin.attr("stroke",a),this.el_outline_radius.attr("stroke",a).attr("cx",i),this.el_content.style("left",n+t+"px").style("top",r+e+"px").style("width","100%").style("color",this.settings.text_color).style("visibility",this.active&&"popup"!==this.getConnectorType()?"visible":"hidden").style("font-size",this.settings.text_size+"rem").style("font-weight",this.settings.text_weight),this.el_content_bg.style("-webkit-text-stroke-width",.15*this.settings.text_size+"rem").style("-webkit-text-stroke-color",this.settings.text_bg).style("max-width",this.settings.label_width+"rem").html(this.settings.contents),this.el_content_fg.style("max-width",this.settings.label_width+"rem").html(this.settings.contents),this.updateNotchVisibility(),this.el_path.style("stroke",a).style("stroke-opacity",this.settings.stroke_opacity).style("stroke-width",this.settings.stroke_width).style("stroke-linecap","square").attr("marker-start",e_(this.settings.line_marker,a)),this.shouldUpdatePath()&&this.updatePath(t,e)},t.prototype.updateNotchVisibility=function(){this.el_outline_origin.style("visibility",this.editable&&this.active?"visible":"hidden"),this.el_outline_radius.style("visibility",this.editable&&this.active?"visible":"hidden")},t.prototype.updatePath=function(t,e){var n=this.el_content_fg.node().getBoundingClientRect(),r=[t,e,n.width,n.height],i={radius:this.state.radius*n_(),radius_pad:5},a=Xm[this.getConnectorType()]("circle",[0,0],r,i);this.el_path.attr("d",a)},t.prototype.getPopupPosition=function(t){var e=this.state.radius*n_();switch(t){case"left":return[-e,0];case"right":return[+e,0];case"top":return[0,-e];case"bottom":return[0,+e];default:return[0,0]}},t.prototype.destroy=function(){var t=this.element,e=this.state.radius;s.prototype.destroy.call(this,{stayInDOM:!0}),this.el_circle.transition().attr("r",e*n_()+10),this.el_content.remove(),this.group.transition().style("opacity",0).on("end",function(){return ce(t).remove()})},t}(gm),point:function(s){function t(t,e,n,r,i){s.call(this,t,e,n,r,i),this.state.content_offset=this.state.content_offset||[32,32],this.group=ce(this.element).classed("fl-point",!0),this.el_path=this.group.append("path").style("stroke","#000").style("stroke-width",this.settings.stroke_width).style("fill","none").classed("fl-connector",!0),this.el_circle=this.group.append("circle").attr("cx",0).attr("cy",0).attr("r",0),this.el_circle.transition().attr("r",r_(this.settings.point_radius)),this.el_outline_circle=this.group.append("circle").attr("cx",0).attr("cy",0).classed("fl-notch",!0).attr("r",0),this.el_outline_circle.transition().attr("r",r_(this.settings.point_radius)+3),this.el_label=this.group.append("text"),this.el_content.attr("data-annotation-id",this.id),this.el_content_bg.html(this.settings.contents),this.el_content_fg.html(this.settings.contents),this.svg=r,this._drag_offset=!1,this._drag_offset_start=[0,0],this._drag_offset_base_position=[0,0]}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.setActive=function(t){return!!s.prototype.setActive.call(this,t)&&(this.el_content.style("visibility",this.active&&"popup"!==this.getConnectorType()&&!this.popup_mobile_mode?"visible":"hidden"),this.el_outline_circle.attr("visibility",this.editable&&this.active?"visible":"hidden"),!0)},t.prototype.onDragStart=function(t,e){return this._drag_offset=!!Yg(t.target,function(t){return t.hasAttribute&&t.hasAttribute("data-annotation-content")}),this._drag_offset_start[0]=e[0],this._drag_offset_start[1]=e[1],this._drag_offset_base_position[0]=this.state.content_offset[0],this._drag_offset_base_position[1]=this.state.content_offset[1],!this._drag_offset},t.prototype.onDragMove=function(t,e){if(!this._drag_offset)return!0;var n=e[0]-this._drag_offset_start[0],r=e[1]-this._drag_offset_start[1];return this.state.content_offset[0]=n+this._drag_offset_base_position[0],this.state.content_offset[1]=r+this._drag_offset_base_position[1],this.update(),!1},t.prototype.onDragEnd=function(t,e){return this.onDragMove(t,e)},t.prototype.update=function(){s.prototype.update.call(this);var t=this.state.content_offset[0],e=this.state.content_offset[1],n=this.settings.origin[0],r=this.settings.origin[1];ce(this.element).attr("transform","translate("+n+" "+r+")"),this.el_circle.style("opacity",1).style("fill",this.settings.subject_fill).transition().attr("r",r_(this.settings.point_radius)),this.el_label.text(this.settings.point_text).style("font-size",Math.min(r_(this.settings.text_size),1.15*r_(this.settings.point_radius))).style("fill",this.settings.point_text_color),this.el_outline_circle.attr("visibility",this.editable&&this.active?"visible":"hidden").attr("stroke",this.settings.stroke_color).attr("r",r_(this.settings.point_radius)+3),this.el_content.style("left",n+t+"px").style("top",r+e+"px").style("width","100%").style("color",this.settings.text_color).style("visibility",this.active&&"popup"!==this.getConnectorType()?"visible":"hidden").style("font-size",this.settings.text_size+"rem").style("font-weight",this.settings.text_weight),this.el_content_bg.style("-webkit-text-stroke-width",.15*this.settings.text_size+"rem").style("-webkit-text-stroke-color",this.settings.text_bg).style("max-width",this.settings.label_width+"rem").html(this.settings.contents),this.el_content_fg.style("max-width",this.settings.label_width+"rem").html(this.settings.contents);var i=this.el_content_fg.node().getBoundingClientRect(),a={radius:r_(this.settings.point_radius),radius_pad:5},o=[t,e,Math.max(i.width,1),Math.max(i.height,1)];this.el_path.style("stroke",this.settings.stroke_color).style("stroke-width",this.settings.stroke_width).style("opacity",this.settings.stroke_opacity).style("stroke-linecap","square").attr("d",Xm[this.getConnectorType()]("point",[0,0],o,a)).attr("marker-start",e_(this.settings.line_marker,this.settings.stroke_color))},t.prototype.getPopupPosition=function(t){var e=r_(this.settings.point_radius);switch(t){case"left":return[-e,0];case"right":return[+e,0];case"top":return[0,-e];case"bottom":return[0,+e];default:return[0,0]}},t.prototype.destroy=function(){var t=this.element;s.prototype.destroy.call(this,{stayInDOM:!0}),this.el_circle.transition().attr("r",0),this.el_outline_circle.transition().attr("r",0),this.el_content.style("opacity",1).transition().style("opacity",0).remove(),this.group.style("opacity",1).transition().style("opacity",0).on("end",function(){return ce(t).remove()})},t}(gm),box:function(l){function t(t,e,n,r,i){var a=this;l.call(this,t,e,n,r,i);var o=i_();this.state.content_offset=this.state.content_offset||[32,32],this.state.radius_x="radius_x"in this.state?this.state.radius_x:.05,this.state.radius_y="radius_y"in this.state?this.state.radius_y:.05,this.group=ce(this.element).classed("fl-circle",!0),this.el_path=this.group.append("path").style("stroke","#000").style("stroke-width",this.settings.stroke_width).style("fill","none").classed("fl-connector",!0),this.el_box=this.group.append("rect").classed("main-circle",!0).attr("fill","none").attr("stroke","#000").attr("stroke-opacity",this.settings.stroke_color_opacity).attr("stroke-width",this.settings.stroke_width).attr("x",-this.state.radius_x*o+10).attr("y",-this.state.radius_y*o+10).style("opacity",0).attr("width",2*(this.state.radius_x*o+10)).attr("height",2*(this.state.radius_y*o+10)),this.el_box.transition().style("opacity",1).attr("width",this.state.radius_x*o).attr("height",this.state.radius_y*o),this.el_outline_radius_x=this.group.append("circle").classed("fl-notch",!0).attr("r",8).attr("cx",this.state.radius_x*o),this.el_outline_radius_y=this.group.append("circle").classed("fl-notch",!0).attr("r",8).attr("cy",this.state.radius_y*o),this.el_outline_origin=this.group.append("circle").classed("fl-notch",!0).attr("r",8),this.el_content.attr("data-annotation-id",this.id),this.el_content_bg.html(this.settings.contents),this.el_content_fg.html(this.settings.contents),this.svg=r,this._is_drag_custom=!1,this._drag_mode_offset=!1,this._drag_mode_radius_x=!1,this._drag_mode_radius_y=!1,this._drag_start=[0,0],this._drag_base_position=[0,0],this._has_run=!1,this.shouldUpdatePath=Zm([function(){return a.state.content_offset[0]},function(){return a.state.content_offset[1]},function(){return a.state.radius_x},function(){return a.state.radius_y},function(){return a.settings.contents},function(){return a.settings.text_size},function(){return a.settings.label_width},function(){return a.settings.stroke_color},function(){return a.settings.connector_type},function(){return a.settings.subject_type},function(){return window.innerWidth},function(){return window.innerHeight}]),this.updatePath(this.state.content_offset[0],this.state.content_offset[1])}return l&&(t.__proto__=l),((t.prototype=Object.create(l&&l.prototype)).constructor=t).prototype.setActive=function(t){return!!l.prototype.setActive.call(this,t)&&(this.el_content.style("visibility",this.active&&"popup"!==this.getConnectorType()?"visible":"hidden"),this.updateNotchVisibility(),!0)},t.prototype.onDragStart=function(t,e){return this._drag_mode_offset=!!Yg(t.target,function(t){return t.hasAttribute&&t.hasAttribute("data-annotation-content")}),this._drag_mode_radius_x=t.target===this.el_outline_radius_x.node(),this._drag_mode_radius_y=t.target===this.el_outline_radius_y.node(),this._drag_start[0]=e[0],this._drag_start[1]=e[1],this._drag_base_position[0]=this.state.content_offset[0],this._drag_base_position[1]=this.state.content_offset[1],this._is_drag_custom=this._drag_mode_offset||this._drag_mode_radius_x||this._drag_mode_radius_y,!this._is_drag_custom},t.prototype.onDragMove=function(t,e){if(!this._is_drag_custom)return!0;if(this._drag_mode_radius_x){var n=e[0]-this.settings.origin[0];this.state.radius_x=Math.abs(n/i_())}else if(this._drag_mode_radius_y){var r=e[1]-this.settings.origin[1];this.state.radius_y=Math.abs(r/i_())}else{var i=e[0]-this._drag_start[0],a=e[1]-this._drag_start[1];this.state.content_offset[0]=i+this._drag_base_position[0],this.state.content_offset[1]=a+this._drag_base_position[1]}return this.update(),!1},t.prototype.onDragEnd=function(t,e){return this.onDragMove(t,e)},t.prototype.updateNotchVisibility=function(){this.el_outline_origin.style("visibility",this.editable&&this.active?"visible":"hidden"),this.el_outline_radius_x.style("visibility",this.editable&&this.active?"visible":"hidden"),this.el_outline_radius_y.style("visibility",this.editable&&this.active?"visible":"hidden")},t.prototype.update=function(){l.prototype.update.call(this);var t=this.state.content_offset[0],e=this.state.content_offset[1],n=this.settings.origin[0],r=this.settings.origin[1],i=i_(),a=i*this.state.radius_x,o=i*this.state.radius_y,s=this.settings.stroke_color;ce(this.element).attr("transform","translate("+n+" "+r+")"),this.el_box.style("opacity",1).attr("stroke",s).attr("stroke-opacity",this.settings.stroke_opacity).attr("stroke-width",this.settings.stroke_width).attr("fill",this.settings.subject_fill).attr("fill-opacity",this.settings.subject_fill_opacity).attr("x",-a).attr("y",-o).attr("width",2*a).attr("height",2*o).interrupt(),this.el_outline_origin.attr("stroke",s),this.el_outline_radius_x.attr("stroke",s).attr("cx",a),this.el_outline_radius_y.attr("stroke",s).attr("cy",o),this.el_content.style("left",n+t+"px").style("top",r+e+"px").style("width","100%").style("color",this.settings.text_color).style("visibility",this.active&&"popup"!==this.getConnectorType()?"visible":"hidden").style("font-size",this.settings.text_size+"rem").style("font-weight",this.settings.text_weight),this.el_content_bg.style("-webkit-text-stroke-width",.15*this.settings.text_size+"rem").style("-webkit-text-stroke-color",this.settings.text_bg).style("max-width",this.settings.label_width+"rem").html(this.settings.contents),this.el_content_fg.html(this.settings.contents).style("max-width",this.settings.label_width+"rem"),this.updateNotchVisibility(),this.el_path.style("color",s).style("stroke",s).style("stroke-width",this.settings.stroke_width).style("stroke-linecap","square").attr("marker-start",e_(this.settings.line_marker,s)),this.shouldUpdatePath()&&this.updatePath(t,e)},t.prototype.updatePath=function(t,e){var n=i_()*this.state.radius_x,r=i_()*this.state.radius_y,i=this.el_content_fg.node().getBoundingClientRect(),a=[-n,-r],o=[t,e,i.width,i.height],s={radius_x:n,radius_y:r,radius_pad:5},l=Xm[this.getConnectorType()]("rect",a,o,s);this.el_path.attr("d",l)},t.prototype.getPopupPosition=function(t){var e=this.state.radius_x*i_(),n=this.state.radius_y*i_();switch(t){case"left":return[-e,0];case"right":return[+e,0];case"top":return[0,-n];case"bottom":return[0,+n];default:return[0,0]}},t.prototype.destroy=function(){var t=this.element,e=this.state,n=e.radius_x,r=e.radius_y;l.prototype.destroy.call(this,{stayInDOM:!0}),this.el_box.transition().attr("width",n*i_()+10).attr("height",r*i_()+10),this.el_content.remove(),this.group.transition().style("opacity",0).on("end",function(){return ce(t).remove()})},t}(gm)};var o_,s_="{{text}}",l_={};var c_=!window.Flourish||("sdk"===window.Flourish.environment||"story_editor"===window.Flourish.environment),u_=function(t){var e;this.mode="DEFAULT",this.pos=[0,0],this.flag_editing=!1,this.flag_inside_settings_panel=!1,this.flag_inside_add_button=!1,this.flag_over_annotation_node=!1,this.flag_can_place=!1,this.cursor_element=((e=ce(t).append("g").classed("fl-annotations-cursor",!0)).append("circle").attr("r",16),e.append("line").attr("x1",-6).attr("x2",6),e.append("line").attr("y1",-6).attr("y2",6),e),this.body=ce(document.body)};u_.prototype.update=function(){var t=this.getMode(),e=this.mode;this.mode=t;var n="CUSTOM_ADD"===this.mode,r="CUSTOM_DISABLED"===this.mode,i=n||r;i&&this.cursor_element.style("transform","translate("+this.pos[0]+"px, "+this.pos[1]+"px)"),t!==e&&(this.cursor_element.classed("is-valid",n),this.body.classed("fl-cursor-custom",i),this.body.classed("fl-cursor-pointer","POINTER"===this.mode),this.body.classed("fl-cursor-default","DEFAULT"===this.mode))},u_.prototype.getMode=function(){return this.flag_inside_settings_panel||this.flag_inside_add_button?"DEFAULT":this.flag_editing?this.flag_over_annotation_node?"POINTER":this.flag_can_place?"CUSTOM_ADD":"CUSTOM_DISABLED":"DEFAULT"};var f_,d_,p_,h_=[{property:"contents",type:"text",name:"Annotation text"},{property:"device_visibility",type:"text",name:"Show",description:"Choose between Always, Desktop, Mobile or Popup on mobile",style:"buttons",choices:[["Always","all"],["data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTlweCIgaGVpZ2h0PSIzMHB4IiB2aWV3Qm94PSIwIDAgMTkgMzAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDYzLjEgKDkyNDUyKSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5BcnRib2FyZDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJBcnRib2FyZCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTEyLjAzMzMzMzMsMjMgQzEyLjIwNDg2MTEsMjMgMTIuMzUzMjk4NiwyMi45MzUyOTY1IDEyLjQ3ODY0NTgsMjIuODA1ODg5NCBDMTIuNjAzOTkzMSwyMi42NzY0ODI0IDEyLjY2NjY2NjcsMjIuNTIzMjM3MiAxMi42NjY2NjY3LDIyLjM0NjE1MzggQzEyLjY2NjY2NjcsMjIuMjU3NjEyMiAxMi42MTM4ODg5LDIyLjEwOTQ3NTIgMTIuNTA4MzMzMywyMS45MDE3NDI4IEMxMi40MDI3Nzc4LDIxLjY5NDAxMDQgMTIuMjk3MjIyMiwyMS40NTIyMjM2IDEyLjE5MTY2NjcsMjEuMTc2MzgyMiBDMTIuMDg2MTExMSwyMC45MDA1NDA5IDEyLjAzMzMzMzMsMjAuNjM2NjE4NiAxMi4wMzMzMzMzLDIwLjM4NDYxNTQgTDEyLjAzMzMzMzMsMjAuMzg0NjE1NCBMMTcuNDE2NjY2NywyMC4zODQ2MTU0IEMxNy44NTIwODMzLDIwLjM4NDYxNTQgMTguMjI0ODI2NCwyMC4yMjQ1NTkzIDE4LjUzNDg5NTgsMTkuOTA0NDQ3MSBDMTguODQ0OTY1MywxOS41ODQzMzQ5IDE5LDE5LjE5OTUxOTIgMTksMTguNzUgTDE5LDE4Ljc1IEwxOSw3LjYzNDYxNTM4IEMxOSw3LjE4NTA5NjE1IDE4Ljg0NDk2NTMsNi44MDAyODA0NSAxOC41MzQ4OTU4LDYuNDgwMTY4MjcgQzE4LjIyNDgyNjQsNi4xNjAwNTYwOSAxNy44NTIwODMzLDYgMTcuNDE2NjY2Nyw2IEwxNy40MTY2NjY3LDYgTDEuNTgzMzMzMzMsNiBDMS4xNDc5MTY2Nyw2IDAuNzc1MTczNjExLDYuMTYwMDU2MDkgMC40NjUxMDQxNjcsNi40ODAxNjgyNyBDMC4xNTUwMzQ3MjIsNi44MDAyODA0NSAwLDcuMTg1MDk2MTUgMCw3LjYzNDYxNTM4IEwwLDcuNjM0NjE1MzggTDAsMTguNzUgQzAsMTkuMTk5NTE5MiAwLjE1NTAzNDcyMiwxOS41ODQzMzQ5IDAuNDY1MTA0MTY3LDE5LjkwNDQ0NzEgQzAuNzc1MTczNjExLDIwLjIyNDU1OTMgMS4xNDc5MTY2NywyMC4zODQ2MTU0IDEuNTgzMzMzMzMsMjAuMzg0NjE1NCBMMS41ODMzMzMzMywyMC4zODQ2MTU0IEw2Ljk2NjY2NjY3LDIwLjM4NDYxNTQgQzYuOTY2NjY2NjcsMjAuNjQzNDI5NSA2LjkxMzg4ODg5LDIwLjkwOTA1NDUgNi44MDgzMzMzMywyMS4xODE0OTA0IEM2LjcwMjc3Nzc4LDIxLjQ1MzkyNjMgNi41OTcyMjIyMiwyMS42OTIzMDc3IDYuNDkxNjY2NjcsMjEuODk2NjM0NiBDNi4zODYxMTExMSwyMi4xMDA5NjE1IDYuMzMzMzMzMzMsMjIuMjUwODAxMyA2LjMzMzMzMzMzLDIyLjM0NjE1MzggQzYuMzMzMzMzMzMsMjIuNTIzMjM3MiA2LjM5NjAwNjk0LDIyLjY3NjQ4MjQgNi41MjEzNTQxNywyMi44MDU4ODk0IEM2LjY0NjcwMTM5LDIyLjkzNTI5NjUgNi43OTUxMzg4OSwyMyA2Ljk2NjY2NjY3LDIzIEw2Ljk2NjY2NjY3LDIzIEwxMi4wMzMzMzMzLDIzIFogTTE3LjQxNjY2NjcsMTYuNDYxNTM4NSBMMS41ODMzMzMzMywxNi40NjE1Mzg1IEMxLjQ5NzU2OTQ0LDE2LjQ2MTUzODUgMS40MjMzNTA2OSwxNi40MjkxODY3IDEuMzYwNjc3MDgsMTYuMzY0NDgzMiBDMS4yOTgwMDM0NywxNi4yOTk3Nzk2IDEuMjY2NjY2NjcsMTYuMjIzMTU3MSAxLjI2NjY2NjY3LDE2LjEzNDYxNTQgTDEuMjY2NjY2NjcsMTYuMTM0NjE1NCBMMS4yNjY2NjY2Nyw3LjYzNDYxNTM4IEMxLjI2NjY2NjY3LDcuNTQ2MDczNzIgMS4yOTgwMDM0Nyw3LjQ2OTQ1MTEyIDEuMzYwNjc3MDgsNy40MDQ3NDc2IEMxLjQyMzM1MDY5LDcuMzQwMDQ0MDcgMS40OTc1Njk0NCw3LjMwNzY5MjMxIDEuNTgzMzMzMzMsNy4zMDc2OTIzMSBMMS41ODMzMzMzMyw3LjMwNzY5MjMxIEwxNy40MTY2NjY3LDcuMzA3NjkyMzEgQzE3LjUwMjQzMDYsNy4zMDc2OTIzMSAxNy41NzY2NDkzLDcuMzQwMDQ0MDcgMTcuNjM5MzIyOSw3LjQwNDc0NzYgQzE3LjcwMTk5NjUsNy40Njk0NTExMiAxNy43MzMzMzMzLDcuNTQ2MDczNzIgMTcuNzMzMzMzMyw3LjYzNDYxNTM4IEwxNy43MzMzMzMzLDcuNjM0NjE1MzggTDE3LjczMzMzMzMsMTYuMTM0NjE1NCBDMTcuNzMzMzMzMywxNi4yMjMxNTcxIDE3LjcwMTk5NjUsMTYuMjk5Nzc5NiAxNy42MzkzMjI5LDE2LjM2NDQ4MzIgQzE3LjU3NjY0OTMsMTYuNDI5MTg2NyAxNy41MDI0MzA2LDE2LjQ2MTUzODUgMTcuNDE2NjY2NywxNi40NjE1Mzg1IEwxNy40MTY2NjY3LDE2LjQ2MTUzODUgWiIgaWQ9Iu+EiCIgZmlsbD0iIzMzMzMzMyIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==","desktop"],["data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iOHB4IiBoZWlnaHQ9IjMwcHgiIHZpZXdCb3g9IjAgMCA4IDMwIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA2My4xICg5MjQ1MikgLSBodHRwczovL3NrZXRjaC5jb20gLS0+CiAgICA8dGl0bGU+QXJ0Ym9hcmQgQ29weTwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJBcnRib2FyZC1Db3B5IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi42NjY2NjY2NywyMSBDNy4wMjc3Nzc3OCwyMSA3LjM0MDI3Nzc4LDIwLjg3MTM1NDIgNy42MDQxNjY2NywyMC42MTQwNjI1IEM3Ljg2ODA1NTU2LDIwLjM1Njc3MDggOCwyMC4wNTIwODMzIDgsMTkuNyBMOCwxOS43IEw4LDkuMyBDOCw4Ljk0NzkxNjY3IDcuODY4MDU1NTYsOC42NDMyMjkxNyA3LjYwNDE2NjY3LDguMzg1OTM3NSBDNy4zNDAyNzc3OCw4LjEyODY0NTgzIDcuMDI3Nzc3NzgsOCA2LjY2NjY2NjY3LDggTDYuNjY2NjY2NjcsOCBMMS4zMzMzMzMzMyw4IEMwLjk3MjIyMjIyMiw4IDAuNjU5NzIyMjIyLDguMTI4NjQ1ODMgMC4zOTU4MzMzMzMsOC4zODU5Mzc1IEMwLjEzMTk0NDQ0NCw4LjY0MzIyOTE3IDAsOC45NDc5MTY2NyAwLDkuMyBMMCw5LjMgTDAsMTkuNyBDMCwyMC4wNTIwODMzIDAuMTMxOTQ0NDQ0LDIwLjM1Njc3MDggMC4zOTU4MzMzMzMsMjAuNjE0MDYyNSBDMC42NTk3MjIyMjIsMjAuODcxMzU0MiAwLjk3MjIyMjIyMiwyMSAxLjMzMzMzMzMzLDIxIEwxLjMzMzMzMzMzLDIxIEw2LjY2NjY2NjY3LDIxIFogTTQuODMzMzMzMzMsOS42MjUgTDMuMTY2NjY2NjcsOS42MjUgQzMuMDU1NTU1NTYsOS42MjUgMyw5LjU3MDgzMzMzIDMsOS40NjI1IEMzLDkuMzU0MTY2NjcgMy4wNTU1NTU1Niw5LjMgMy4xNjY2NjY2Nyw5LjMgTDMuMTY2NjY2NjcsOS4zIEw0LjgzMzMzMzMzLDkuMyBDNC45NDQ0NDQ0NCw5LjMgNSw5LjM1NDE2NjY3IDUsOS40NjI1IEM1LDkuNTcwODMzMzMgNC45NDQ0NDQ0NCw5LjYyNSA0LjgzMzMzMzMzLDkuNjI1IEw0LjgzMzMzMzMzLDkuNjI1IFogTTYuNjY2NjY2NjcsMTguNCBMMS4zMzMzMzMzMywxOC40IEMxLjI0MzA1NTU2LDE4LjQgMS4xNjQ5MzA1NiwxOC4zNjc4Mzg1IDEuMDk4OTU4MzMsMTguMzAzNTE1NiBDMS4wMzI5ODYxMSwxOC4yMzkxOTI3IDEsMTguMTYzMDIwOCAxLDE4LjA3NSBMMSwxOC4wNzUgTDEsMTAuOTI1IEMxLDEwLjgzNjk3OTIgMS4wMzI5ODYxMSwxMC43NjA4MDczIDEuMDk4OTU4MzMsMTAuNjk2NDg0NCBDMS4xNjQ5MzA1NiwxMC42MzIxNjE1IDEuMjQzMDU1NTYsMTAuNiAxLjMzMzMzMzMzLDEwLjYgTDEuMzMzMzMzMzMsMTAuNiBMNi42NjY2NjY2NywxMC42IEM2Ljc1Njk0NDQ0LDEwLjYgNi44MzUwNjk0NCwxMC42MzIxNjE1IDYuOTAxMDQxNjcsMTAuNjk2NDg0NCBDNi45NjcwMTM4OSwxMC43NjA4MDczIDcsMTAuODM2OTc5MiA3LDEwLjkyNSBMNywxMC45MjUgTDcsMTguMDc1IEM3LDE4LjE2MzAyMDggNi45NjcwMTM4OSwxOC4yMzkxOTI3IDYuOTAxMDQxNjcsMTguMzAzNTE1NiBDNi44MzUwNjk0NCwxOC4zNjc4Mzg1IDYuNzU2OTQ0NDQsMTguNCA2LjY2NjY2NjY3LDE4LjQgTDYuNjY2NjY2NjcsMTguNCBaIE00LDIwLjUxMjUgQzMuNzcwODMzMzMsMjAuNTEyNSAzLjU3NDY1Mjc4LDIwLjQzMjk0MjcgMy40MTE0NTgzMywyMC4yNzM4MjgxIEMzLjI0ODI2Mzg5LDIwLjExNDcxMzUgMy4xNjY2NjY2NywxOS45MjM0Mzc1IDMuMTY2NjY2NjcsMTkuNyBDMy4xNjY2NjY2NywxOS40NzY1NjI1IDMuMjQ4MjYzODksMTkuMjg1Mjg2NSAzLjQxMTQ1ODMzLDE5LjEyNjE3MTkgQzMuNTc0NjUyNzgsMTguOTY3MDU3MyAzLjc3MDgzMzMzLDE4Ljg4NzUgNCwxOC44ODc1IEM0LjIyOTE2NjY3LDE4Ljg4NzUgNC40MjUzNDcyMiwxOC45NjcwNTczIDQuNTg4NTQxNjcsMTkuMTI2MTcxOSBDNC43NTE3MzYxMSwxOS4yODUyODY1IDQuODMzMzMzMzMsMTkuNDc2NTYyNSA0LjgzMzMzMzMzLDE5LjcgQzQuODMzMzMzMzMsMTkuOTIzNDM3NSA0Ljc1LDIwLjExNjQwNjIgNC41ODMzMzMzMywyMC4yNzg5MDYyIEM0LjQyMzYxMTExLDIwLjQzNDYzNTQgNC4yMjkxNjY2NywyMC41MTI1IDQsMjAuNTEyNSBaIiBpZD0i74SLIiBmaWxsPSIjMzMzMzMzIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+","mobile"],["data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTBweCIgaGVpZ2h0PSIzMHB4IiB2aWV3Qm94PSIwIDAgMTAgMzAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDYzLjEgKDkyNDUyKSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5BcnRib2FyZCBDb3B5IDI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iQXJ0Ym9hcmQtQ29weS0yIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMS4wMDAxODYwMSw4IEwxLDEwLjg4NSBMMSwxMC44OTQwMDI5IEwxLDE4LjA2NjAwMDggTDEuMDA2MTg0OSwxOC4xMjk5OTEgQzEuMDE4NTU0NjksMTguMTkxNzUyNyAxLjA0OTQ3OTE3LDE4LjI0NjgyODkgMS4wOTg5NTgzMywxOC4yOTUyMTk1IEMxLjE2NDkzMDU2LDE4LjM1OTc0MDMgMS4yNDMwNTU1NiwxOC4zOTIwMDA3IDEuMzMzMzMzMzMsMTguMzkyMDAwNyBMMS4zMzMzMzMzMywxOC4zOTIwMDA3IEw2LjY2NjY2NjY3LDE4LjM5MjAwMDcgQzYuNzU2OTQ0NDQsMTguMzkyMDAwNyA2LjgzNTA2OTQ0LDE4LjM1OTc0MDMgNi45MDEwNDE2NywxOC4yOTUyMTk1IEM2Ljk2NzAxMzg5LDE4LjIzMDY5ODcgNywxOC4xNTQyOTI1IDcsMTguMDY2MDAwOCBMNywxOC4wNjYwMDA4IEw3LDEzLjY2OCBMNy41LDEzLjAxMjM3OTggTDgsMTMuMDEyIEw4LDE5LjY5NjAwMDQgTDcuOTkxOTIxNzcsMTkuODQ0NDQ2OCBDNy45NTk2MDg4NCwyMC4xMzU1MTgxIDcuODMwMzU3MTQsMjAuMzkxNjYwOSA3LjYwNDE2NjY3LDIwLjYxMjg3NTEgQzcuMzQwMjc3NzgsMjAuODcwOTU4NCA3LjAyNzc3Nzc4LDIxIDYuNjY2NjY2NjcsMjEgTDYuNjY2NjY2NjcsMjEgTDEuMzMzMzMzMzMsMjEgTDEuMTgxNTQ3NjIsMjAuOTkyMDk5NSBDMC44ODM5Mjg1NzEsMjAuOTYwNDk3NSAwLjYyMjAyMzgxLDIwLjgzNDA4OTMgMC4zOTU4MzMzMzMsMjAuNjEyODc1MSBDMC4xMzE5NDQ0NDQsMjAuMzU0NzkxOCAwLDIwLjA0OTE2NjkgMCwxOS42OTYwMDA0IEwwLDE5LjY5NjAwMDQgTDAsOS4yNjQwMDMzMSBMMC4wMDgwNzgyMzEyOSw5LjExNTU1NjkyIEMwLjA0MDM5MTE1NjUsOC44MjQ0ODU1OCAwLjE2OTY0Mjg1Nyw4LjU2ODM0Mjc5IDAuMzk1ODMzMzMzLDguMzQ3MTI4NTcgQzAuNTc0OTAwNzk0LDguMTcyMDAwNjQgMC43NzYzNTE2ODcsOC4wNTYyOTExMiAxLjAwMDE4NjAxLDggWiBNNCwxOC44ODEwMDA2IEMzLjc3MDgzMzMzLDE4Ljg4MTAwMDYgMy41NzQ2NTI3OCwxOC45NjA4MDI3IDMuNDExNDU4MzMsMTkuMTIwNDA2OCBDMy4yNDgyNjM4OSwxOS4yODAwMTA5IDMuMTY2NjY2NjcsMTkuNDcxODc1NCAzLjE2NjY2NjY3LDE5LjY5NjAwMDQgQzMuMTY2NjY2NjcsMTkuOTIwMTI1MyAzLjI0ODI2Mzg5LDIwLjExMTk4OTggMy40MTE0NTgzMywyMC4yNzE1OTQgQzMuNTc0NjUyNzgsMjAuNDMxMTk4MSAzLjc3MDgzMzMzLDIwLjUxMTAwMDEgNCwyMC41MTEwMDAxIEM0LjIyOTE2NjY3LDIwLjUxMTAwMDEgNC40MjM2MTExMSwyMC40MzI4OTYgNC41ODMzMzMzMywyMC4yNzY2ODc3IEM0Ljc1LDIwLjExMzY4NzggNC44MzMzMzMzMywxOS45MjAxMjUzIDQuODMzMzMzMzMsMTkuNjk2MDAwNCBDNC44MzMzMzMzMywxOS40NzE4NzU0IDQuNzUxNzM2MTEsMTkuMjgwMDEwOSA0LjU4ODU0MTY3LDE5LjEyMDQwNjggQzQuNDI1MzQ3MjIsMTguOTYwODAyNyA0LjIyOTE2NjY3LDE4Ljg4MTAwMDYgNCwxOC44ODEwMDA2IFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzMzMzMzMyIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICAgICAgPHBhdGggZD0iTTMsNiBMOSw2IEM5LjU1MjI4NDc1LDYgMTAsNi40NDc3MTUyNSAxMCw3IEwxMCwxMS4wMzY4Nzk0IEMxMCwxMS41ODkxNjQyIDkuNTUyMjg0NzUsMTIuMDM2ODc5NCA5LDEyLjAzNjg3OTQgTDcuNSwxMi4wMzY4Nzk0IEw3LjUsMTIuMDM2ODc5NCBMNiwxNCBMNC41LDEyLjAzNjg3OTQgTDMsMTIuMDM2ODc5NCBDMi40NDc3MTUyNSwxMi4wMzY4Nzk0IDIsMTEuNTg5MTY0MiAyLDExLjAzNjg3OTQgTDIsNyBDMiw2LjQ0NzcxNTI1IDIuNDQ3NzE1MjUsNiAzLDYgWiIgaWQ9IlJlY3RhbmdsZSIgZmlsbD0iIzMzMzMzMyI+PC9wYXRoPgogICAgPC9nPgo8L3N2Zz4=","popup"]]},{property:"text_size",type:"number",name:"Text size",width:"quarter",step:"0.1"},{property:"text_color",type:"color",name:"Text color",width:"quarter"},{property:"text_bg",type:"color",name:"Outline",width:"quarter",show_if:function(t){return"popup"!==t.connector_type}},{property:"text_weight",type:"string",name:"Weight",width:"quarter",style:"buttons",choices:[["data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iN3B4IiBoZWlnaHQ9IjMwcHgiIHZpZXdCb3g9IjAgMCA3IDMwIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA2My4xICg5MjQ1MikgLSBodHRwczovL3NrZXRjaC5jb20gLS0+CiAgICA8dGl0bGU+bm9ybWFsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9Im5vcm1hbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTEuMTA1OTQ3OTYsMTkgTDEuOTI1NjUwNTYsMTYuNTYwOTc1NiBMNS4wMzUzMTU5OSwxNi41NjA5NzU2IEw1Ljg0MjAwNzQzLDE5IEw3LDE5IEw0LjExMTUyNDE2LDExIEwyLjg4ODQ3NTg0LDExIEwwLDE5IEwxLjEwNTk0Nzk2LDE5IFogTTQuNzYyMDgxNzgsMTUuNzQzOTAyNCBMMi4xOTg4ODQ3NiwxNS43NDM5MDI0IEwyLjYwMjIzMDQ4LDE0LjUyNDM5MDIgQzIuNzU4MzY0MzEsMTQuMDc3MjM1OCAyLjkwNTgyNDA0LDEzLjYzMjExMzggMy4wNDQ2MDk2NywxMy4xODkwMjQ0IEMzLjE4MzM5NTI5LDEyLjc0NTkzNSAzLjMxNzg0Mzg3LDEyLjI5MjY4MjkgMy40NDc5NTUzOSwxMS44MjkyNjgzIEwzLjQ0Nzk1NTM5LDExLjgyOTI2ODMgTDMuNSwxMS44MjkyNjgzIEMzLjYzODc4NTYzLDEyLjI5MjY4MjkgMy43Nzc1NzEyNSwxMi43NDU5MzUgMy45MTYzNTY4OCwxMy4xODkwMjQ0IEM0LjA1NTE0MjUsMTMuNjMyMTEzOCA0LjIwMjYwMjIzLDE0LjA3NzIzNTggNC4zNTg3MzYwNiwxNC41MjQzOTAyIEw0LjM1ODczNjA2LDE0LjUyNDM5MDIgTDQuNzYyMDgxNzgsMTUuNzQzOTAyNCBaIiBpZD0iQSIgZmlsbD0iIzMzMzMzMyIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==","normal"],["data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iOHB4IiBoZWlnaHQ9IjMwcHgiIHZpZXdCb3g9IjAgMCA4IDMwIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA2My4xICg5MjQ1MikgLSBodHRwczovL3NrZXRjaC5jb20gLS0+CiAgICA8dGl0bGU+Ym9sZDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJib2xkIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMi4zMzExMjU4MywxOSBMMi43NTQ5NjY4OSwxNy4wODkyMzA4IEw1LjE2NTU2MjkxLDE3LjA4OTIzMDggTDUuNTg5NDAzOTcsMTkgTDgsMTkgTDUuMzc3NDgzNDQsMTAgTDIuNjIyNTE2NTYsMTAgTDAsMTkgTDIuMzMxMTI1ODMsMTkgWiBNNC43NTQ5NjY4OSwxNS4yNDc2OTIzIEwzLjE2NTU2MjkxLDE1LjI0NzY5MjMgTDMuMzExMjU4MjgsMTQuNjI0NjE1NCBDMy40MTcyMTg1NCwxNC4xOTA3NjkyIDMuNTIwOTcxMywxMy43MjIzMDc3IDMuNjIyNTE2NTYsMTMuMjE5MjMwOCBDMy43MjQwNjE4MSwxMi43MTYxNTM4IDMuODIzMzk5NTYsMTIuMjMzODQ2MiAzLjkyMDUyOTgsMTEuNzcyMzA3NyBMMy45MjA1Mjk4LDExLjc3MjMwNzcgTDMuOTczNTA5OTMsMTEuNzcyMzA3NyBDNC4wNzk0NzAyLDEyLjIyNDYxNTQgNC4xODU0MzA0NiwxMi43MDQ2MTU0IDQuMjkxMzkwNzMsMTMuMjEyMzA3NyBDNC4zOTczNTA5OSwxMy43MiA0LjUwMzMxMTI2LDE0LjE5MDc2OTIgNC42MDkyNzE1MiwxNC42MjQ2MTU0IEw0LjYwOTI3MTUyLDE0LjYyNDYxNTQgTDQuNzU0OTY2ODksMTUuMjQ3NjkyMyBaIiBpZD0iQSIgZmlsbD0iIzMzMzMzMyIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==","bold"]]},"Marker settings",{property:"subject_type",type:"text",name:"Marker type",style:"buttons",width:"full",choices:[["data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNnB4IiBoZWlnaHQ9IjMwcHgiIHZpZXdCb3g9IjAgMCA2IDMwIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA2My4xICg5MjQ1MikgLSBodHRwczovL3NrZXRjaC5jb20gLS0+CiAgICA8dGl0bGU+cG9pbnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icG9pbnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxjaXJjbGUgaWQ9Ik92YWwiIGZpbGw9IiMzMzMzMzMiIGN4PSIzIiBjeT0iMTUiIHI9IjMiPjwvY2lyY2xlPgogICAgPC9nPgo8L3N2Zz4=","point"],["data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIzMHB4IiB2aWV3Qm94PSIwIDAgMTYgMzAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDYzLjEgKDkyNDUyKSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5jaXJjbGU8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2lyY2xlIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8Y2lyY2xlIGlkPSJPdmFsLUNvcHkiIHN0cm9rZT0iIzMzMzMzMyIgY3g9IjgiIGN5PSIxNSIgcj0iNy41Ij48L2NpcmNsZT4KICAgIDwvZz4KPC9zdmc+","circle"],["data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIzMHB4IiB2aWV3Qm94PSIwIDAgMTYgMzAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDYzLjEgKDkyNDUyKSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5zcXVhcmU8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3F1YXJlIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cmVjdCBpZD0iUmVjdGFuZ2xlIiBzdHJva2U9IiMzMzMzMzMiIHg9IjAuNSIgeT0iNy41IiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+","box"]]},{property:"subject_fill",type:"color",name:"Fill color"},{property:"subject_fill_opacity",step:.01,min:0,max:1,type:"number",name:"Fill opacity",show_if:function(t){return"point"!==t.subject_type}},{property:"point_radius",type:"number",width:"half",name:"Radius",step:.25,show_if:function(t){return"point"===t.subject_type}},{property:"point_text",type:"quarter",width:"half",name:"Label",show_if:function(t){return"point"===t.subject_type}},{property:"point_text_color",type:"color",name:"Label color",show_if:function(t){return"point"===t.subject_type}},"Connector settings",{property:"connector_type",type:"text",width:"full",name:"Connector type",style:"buttons",choices:[["None","none"],["data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMzNweCIgaGVpZ2h0PSIzMHB4IiB2aWV3Qm94PSIwIDAgMzMgMzAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDYzLjEgKDkyNDUyKSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5jaXJjbGUgY29weTwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJjaXJjbGUtY29weSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlLWxpbmVjYXA9InNxdWFyZSI+CiAgICAgICAgPHBvbHlsaW5lIGlkPSJQYXRoLTIiIHN0cm9rZT0iIzMzMzMzMyIgc3Ryb2tlLXdpZHRoPSIyIiBwb2ludHM9IjUgOSAxMi4xNDIxODIxIDE2IDI4IDE2Ij48L3BvbHlsaW5lPgogICAgPC9nPgo8L3N2Zz4=","polyline"],["data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMzNweCIgaGVpZ2h0PSIzMHB4IiB2aWV3Qm94PSIwIDAgMzMgMzAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDYzLjEgKDkyNDUyKSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5jaXJjbGUgY29weSAyPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNpcmNsZS1jb3B5LTIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik03LDUgTDI2LDUgQzI2LjU1MjI4NDcsNSAyNyw1LjQ0NzcxNTI1IDI3LDYgTDI3LDE4LjAzNjg3OTQgQzI3LDE4LjU4OTE2NDIgMjYuNTUyMjg0NywxOS4wMzY4Nzk0IDI2LDE5LjAzNjg3OTQgTDE5LjE4NzUsMTkuMDM2ODc5NCBMMTkuMTg3NSwxOS4wMzY4Nzk0IEwxNi41LDIyIEwxMy44MTI1LDE5LjAzNjg3OTQgTDcsMTkuMDM2ODc5NCBDNi40NDc3MTUyNSwxOS4wMzY4Nzk0IDYsMTguNTg5MTY0MiA2LDE4LjAzNjg3OTQgTDYsNiBDNiw1LjQ0NzcxNTI1IDYuNDQ3NzE1MjUsNSA3LDUgWiIgaWQ9IlJlY3RhbmdsZSIgZmlsbD0iIzMzMzMzMyI+PC9wYXRoPgogICAgPC9nPgo8L3N2Zz4=","popup"]]},{property:"popup_position",type:"string",width:"three quarters",name:"Popup position",show_if:function(t){return"popup"===t.connector_type},choices:[["Center","center"],["Left","left"],["Right","right"],["Top","top"],["Bottom","bottom"]]},{property:"popup_bg",type:"color",width:"quarter",name:"Background",show_if:function(t){return"popup"===t.connector_type}},{property:"stroke_color",type:"color",name:"Color",width:"quarter",show_if:function(t){return"polyline"===t.connector_type||"point"!=t.subject_type}},{property:"stroke_width",step:.25,min:0,max:4,type:"number",width:"quarter",name:"Width",show_if:function(t){return"polyline"===t.connector_type||"point"!=t.subject_type}},{property:"line_marker",type:"string",width:"half",name:"Line marker",style:"buttons",show_if:function(t){return"polyline"===t.connector_type},choices:[["None","none"],["data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIzMHB4IiB2aWV3Qm94PSIwIDAgMTIgMzAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDYzLjEgKDkyNDUyKSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5jaXJjbGUgY29weSAzPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNpcmNsZS1jb3B5LTMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJHcm91cCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNS4wMDAwMDAsIDEzLjAwMDAwMCkgcm90YXRlKC00NS4wMDAwMDApIHRyYW5zbGF0ZSgtNS4wMDAwMDAsIC0xMy4wMDAwMDApIHRyYW5zbGF0ZSgxLjAwMDAwMCwgNi4wMDAwMDApIj4KICAgICAgICAgICAgPHBvbHlnb24gaWQ9IlRyaWFuZ2xlIiBmaWxsPSIjMzMzMzMzIiBwb2ludHM9IjQgMCA4IDggMCA4Ij48L3BvbHlnb24+CiAgICAgICAgICAgIDxsaW5lIHgxPSI0IiB5MT0iOCIgeDI9IjQiIHkyPSIxNCIgaWQ9IlBhdGgtMiIgc3Ryb2tlPSIjMzMzMzMzIiBvcGFjaXR5PSIwLjIwMDAwMDAwMyIgc3Ryb2tlLWxpbmVjYXA9InNxdWFyZSI+PC9saW5lPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+","arrowhead"]]},{property:"label_width",step:1,min:2,max:20,type:"number",name:"Max text width",show_if:function(t){return"popup"!==t.connector_type}}],g_={annotations:{},popup:{},annotation_selected_id:""},m_={left:v_("right"),right:v_("left"),top:v_("bottom"),bottom:v_("top"),center:v_("center")},__=function(o){function t(t,e,n,r){var i,a=this;o.call(this),this.target=t,this.settings_container=e,this.state=Object.assign(n,g_,Object.assign({},n)),this.rendering=!1,this.prev_annotation_ids=[],this.is_user_editable=!!c_,this.source_element=c_&&function(t,e){var n=t.appendChild(document.createElement("button"));n.classList.add("fl-annotations-source-element"),e&&(n.style.marginRight=e[0],n.style.marginTop=e[1]);return n}(e,r.source_offset),this.settings=c_&&function(t,l,e,s){var c=null,u={},f={},n=null,r=null,d=l.reduce(function(t,e){return t[e.property]=e,t},{}),i=ce(t).append("div").classed("fl-project-editor",!0),p=i.append("div").classed("side-panel",!0).append("div").classed("side-panel-inner",!0);return a(),p.node().addEventListener("change",function(){if(c){for(var t in f)c[t]=f[t].value;o()}},!1),{container:p.node(),root:i.node(),update:a,render:o,setActive:function(t){n!==(t=!!t)&&(n=t,i.classed("active-annotation",n))},setVisible:function(t){if(r!==(t=!!t)){r=t,i.style("display",r?"block":"none");var e=window.document.createEvent("UIEvents");e.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(e)}}};function a(){f={},u={},p.html("");var t=p.append("div").attr("class","fl-annotation-settings");t.append("p").attr("class","empty-annotation-message").text("Select an annotation or create a new annotation by clicking anywhere in the visualisation");for(var e=null,n=null,r=0,i=0;i<l.length;i++){var a=l[i];if("string"!=typeof a){if("object"!=typeof a||e||n||(r++,n=t.append("div").classed("toplevel-settings-block",!0)),"hidden"!==a.type){var o=e||n;a.new_section&&(o.append("div").classed("settings-divider",!0),"string"==typeof a.new_section&&o.append("h3").classed("settings-subhead",!0).text(a.new_section));var s=sm(o.append("div"),a);f[a.property]=s,u[a.property]=Yg(s,function(t){return t.classList.contains("settings-option")})}}else n=null,(e=t.append("div").classed("settings-block",!0).classed("open",r<1)).append("h2").classed("no-select",!0).attr("tabindex","0").text(a).on("click",h).on("keyup",function(){13===te.keyCode&&h.call(this)}),"State documentation"===a&&e.style("display","none"),r++}}function h(){this.parentNode.classList.toggle("open")}function o(t){if(t!==c){for(var e in t&&(c=t),f){var n=f[e],r=d[e];if("buttons"==r.style&&c[e])for(var i=n.querySelectorAll("input[type=radio]"),a=0;a<i.length;a++){var o=i[a];o.checked=o.value==c[e]}n.value=c[e],r.show_if&&(r.show_if(c)?u[e].classList.remove("hidden"):u[e].classList.add("hidden"))}s()}}}(e,h_,0,function(){a.rendering||a.update()}),this.updateAnnotationList=this.settings?function(e,t){var n=[],r=ce(t).insert("ul",":first-child").classed("fl-annotation-list",!0);return e.on("change",i),i;function i(t){for(var e in n.length=0,t)Object.hasOwnProperty.call(t,e)&&t[e]&&n.push(t[e]);n.length&&r.selectAll("li").data(n,a).join(s).classed("selected",l).on("click",c).select(".text").text(o)}function a(t){return t.id}function o(t){return t.contents||"(empty annotation)"}function s(t){var e=t.append("li");return e.append("span").classed("text",!0),e.append("span").attr("class","icon-pencil icon"),e.append("span").attr("class","icon-trash icon").attr("data-action","delete"),e}function l(t){return gm.getByID(t.id).selected}function c(t){"delete"===(te.target.getAttribute("data-action")||"edit")?(gm.getByID(t.id).destroy(),delete e.state.annotations[t.id],e.update(),e.emit("change",e.state.annotations)):e.select(t.id)}}(this,this.settings.container):function(){},this.getDefaultData=r.getDefaultData,this.getDataFromCursor=r.getDataFromCursor,this.getPositionFromData=r.getPositionFromData,this.filterByData=r.filterByData||function(){return!0},this.filterByPosition=r.filterByPosition||function(){return!0},this.container=t.appendChild(document.createElement("div")),this.container.classList.add("fl-annotations"),this.container_svg=t.appendChild(document.createElementNS("http://www.w3.org/2000/svg","svg")),this.container_svg.classList.add("fl-annotations"),i=this.container_svg,Vm=ce(i).append("defs"),(o_=Sh(document.body,l_,s_)).addColumnNames({text:""}),this.touches=qg(window,{preventSimulated:!1,filtered:!0,target:this.target}),this.touches.on("start",this._onCursorStart=this._onCursorStart.bind(this)),this.touches.on("move",this._onCursorMove=this._onCursorMove.bind(this)),this.touches.on("end",this._onCursorEnd=this._onCursorEnd.bind(this)),this.cursor=new u_(this.container_svg),y_(this,"_is_editing",[this.container_svg,this.container],"is-editing",!1),y_(this,"_is_dragging",[this.container_svg,this.container],"is-dragging",!1),y_(this,"_is_creating",[this.container_svg,this.container],"is-creating",!1),this._is_dragging_beneath=!1,this._drag_start_time=Date.now(),this._drag_start_position=[0,0],this._is_cursor_down=!1,this._dragging_id="",this._clicking_id="",this._prev_dragging_id="",this._prev_selected_id="",this.update()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype._onCursorStart=function(t,e){var n=this,r=this._findupAnnotation(t.target);if(!this._findupEditor(t.target)&&!this._findupLink(t.target)){var i=!!Yg(t.target,function(t){return t===n.source_element}),a=!!r;if(this._is_dragging=!1,this._is_dragging_beneath=!1,this._dragging_id="",this._drag_start_time=Date.now(),this._drag_start_position[0]=e[0],this._drag_start_position[1]=e[1],i)this._is_editing=!this._is_editing,this._is_editing||this.select(null),this.render(),t.preventDefault();else if(a){var o=r.getAttribute("data-annotation-id");this._dragging_id=o,this._is_editing&&gm.getByID(o).onDragStart(t,e),this.render(),this.emit("update",this.state.annotations[this._dragging_id]),this.emit("change",this.state.annotations)}}},t.prototype._onCursorMove=function(t,e){var n=this._is_editing&&!this._dragging_id,r=this._is_editing&&!this._is_dragging_beneath,i=this._dragging_id&&this._is_dragging;if(n&&this._setCursorPosition(t,e),r){var a=e[0]-this._drag_start_position[0],o=e[1]-this._drag_start_position[1],s=Math.sqrt(a*a+o*o),l=Date.now()-this._drag_start_time,c=!c_||300<l,u=25<s;this._is_dragging_beneath=c||u,this._is_dragging=this._is_dragging_beneath&&!n}else if(i){var f=gm.getByID(this._dragging_id);this._is_editing&&!1!==f.onDragMove(t,e)&&(this.state.annotations[this._dragging_id].position=this.getDataFromCursor(t,e)||null),this.render(),this.emit("update",this.state.annotations[this._dragging_id]),this.emit("change",this.state.annotations)}},t.prototype._onCursorEnd=function(t,e){if(this._findupEditor(t.target)||this._findupEditorButton(t.target))return this._dragging_id="",this._is_dragging=!1,this._is_dragging_beneath=!1,this.render(),void this._setCursorPosition(t,e);if(this._dragging_id){if(this._is_dragging&&this._is_editing){var n=gm.getByID(this._dragging_id);if(this._is_editing&&!1!==n.onDragMove(t,e)){var r=this.getDataFromCursor(t,e)||null;null!==(this.state.annotations[this._dragging_id].position=r)&&this.getPositionFromData(r)?this.emit("update",this.state.annotations[this._dragging_id]):(this.emit("delete",this.state.annotations[this._dragging_id]),gm.getByID(this._dragging_id).destroy(),delete this.state.annotations[this._dragging_id]),this.emit("change",this.state.annotations)}}else this._is_dragging||this.select(this._dragging_id);this._dragging_id="",this._is_dragging=!1,this._is_dragging_beneath=!1,this.render(),this._setCursorPosition(t,e)}else if(!this._is_dragging_beneath&&this._is_editing){var i=this.getDataFromCursor(t,e);if(!i)return;var a=this._findupAnnotation(t.target);if(a)return this.select(a.getAttribute("data-annotation-id"));var o=this._createAnnotation(i);this.select(o),this.emit("create",this.state.annotations[o]),this.emit("change",this.state.annotations)}else this._is_dragging_beneath||this.select(null)},t.prototype.select=function(t){this.state.annotation_selected_id=t,this._prev_selected_id!==t&&(this._prev_selected_id=t,this.state.annotations[t]&&(this.emit("select",this.state.annotations[t]),this.emit("change",this.state.annotations))),this.render()},t.prototype.update=function(){this.clearRemovedAnnotations(),this.render(),this.updateAnnotationList(this.state.annotations)},t.prototype.clearRemovedAnnotations=function(){for(var t=0;t<this.prev_annotation_ids.length;t++){var e=this.prev_annotation_ids[t];if(!(e in this.state.annotations)){var n=gm.getByID(e);n&&n.destroy()}}this.prev_annotation_ids=Object.keys(this.state.annotations)},t.prototype.render=function(){this.rendering=!0,c_&&(this.settings.setVisible(this._is_editing),this.settings.setActive(this._is_editing&&this.state.annotation_selected_id)),this._renderMarkers(),this.rendering=!1},t.prototype._renderMarkers=function(){for(var t in this.state.annotations){var e=gm.getByID(t);e||(e=new a_.point(this.state.annotations[t].id,this.state.annotations[t].view,this.container,this.container_svg,{}));var n=this.state.annotations[t].position,r=!!n;(r=(r=(r=(r=r&&this.filterByData(n))&&this.filterByPosition(n=this.getPositionFromData(n)))&&!!n)&&(i=this.state.annotations[t],void 0,"all"==(a=i.device_visibility)||("mobile"==a?dm():"desktop"!=a||!dm())))?(b_((e=e.ofType(a_[this.state.annotations[t].subject_type])).settings,this.state.annotations[t]),e.settings.origin[0]=n[0],e.settings.origin[1]=n[1],e.editable=this._is_editing,e.update(),e.setActive(!0)):e.setActive(!1),t!==this.state.annotation_selected_id&&e.setSelected(!1)}var i,a,o=gm.getByID(this.state.annotation_selected_id);if(o){o_.container(this.target),o.setSelected(!0),this.emit("update",this.state.annotations[this.state.annotation_selected_id]),this.emit("change",this.state.annotations),c_&&this.settings.render(this.state.annotations[this.state.annotation_selected_id]);var s=o.settings,l=o.element;if("popup"===o.getConnectorType()){l_.font_size=r_(s.text_size),l_.text_color=s.text_color,l_.fill_color=s.popup_bg;var c=s.contents;"bold"==this.settings.font_weight&&(c="<strong>"+c+"</strong>");var u=l.parentNode.getBoundingClientRect(),f={text:c},d=o.getPopupPosition(s.popup_position);o_.directions(m_[s.popup_position]),o_.point(s.origin[0]+d[0]+u.left,s.origin[1]+d[1]+u.top),o_.draw(f)}else o_.hide()}else o_.hide()},t.prototype._setCursorPosition=function(t,e){var n=this.getDataFromCursor(t,e)||null,r=n&&this.getPositionFromData(n),i=this._findupAnnotation(t.target);this.cursor.pos[0]=r?r[0]:e[0],this.cursor.pos[1]=r?r[1]:e[1],this.cursor.flag_editing=this._is_editing,this.cursor.flag_over_annotation_node=!!i,this.cursor.flag_inside_add_button=!!this._findupEditorButton(t.target),this.cursor.flag_inside_settings_panel=!!this._findupEditor(t.target),this.cursor.flag_can_place=!!r,this.cursor.update()},t.prototype._createAnnotation=function(t){var e=im(),n=this.state.annotations[e]=new um(t);return n.id=e,new a_.point(e,n.view,this.container,this.container_svg,{}),this.render(),e},t.prototype._findupAnnotation=function(t){return Yg(t,function(t){return t.hasAttribute&&t.hasAttribute("data-annotation-id")})},t.prototype._findupEditor=function(t){return c_&&Yg(t,this.settings.root)},t.prototype._findupEditorButton=function(t){return c_&&Yg(t,this.source_element)},t.prototype._findupLink=function(t){return!this._is_editing&&Yg(t,function(t){return t&&"A"===(t.nodeName||"").toUpperCase()})},t}(Bg);function y_(t,e,n,r,i){function a(){if(i)for(var t=0;t<n.length;t++)n[t].classList.add(r);else for(t=0;t<n.length;t++)n[t].classList.remove(r)}n=Array.isArray(n)?n:[n],a(),Object.defineProperty(t,e,{get:function(){return i},set:function(t){if(i===(t=!!t))return;i=t,a()}})}function b_(t,e){for(var n in e)if(Array.isArray(e[n]))if(Array.isArray(t[n])){t[n].length=Math.min(t[n].length,e[n].length);for(var r=0;r<e[n].length;r++)t[n][r]=e[n][r]}else t[n]=e[n].slice();else"object"==typeof e[n]?"object"==typeof t[n]?b_(t[n],e[n]):t[n]=Object.assign({},e[n]):t[n]=e[n]}function v_(t){var e=["bottom","top","left","right","topLeft","bottomLeft","topRight","bottomRight","bottomFlexible","topFlexible","leftFlexible","rightFlexible"];return"center"!==t&&(e.splice(e.indexOf(t),1),e.unshift(t)),e}function x_(t){return t*parseFloat(getComputedStyle(document.documentElement).fontSize)}function w_(t){return t.replace(/\s*::\s*/,"::").split("::")}function M_(t){return t.replace(/\s*>>\s*/,">>").split(">>")}function j_(t,e){d_=e?0:1e3*ju.animation_duration,f_=new RegExp("[^-0-9eE"+ju.decimal_separator+"]","g");var n=t.scales,r=t.chart_layout.chart;!function(t,e){var n=t.h,r=t.x,i=t.y,a=ju.anno_x_label_align,o=df.data.x_type,s=[];ju.anno_x_enabled&&ju.anno_x_lines&&ju.anno_x_lines.split("\n").forEach(function(t){var e=w_(t),n=e[0],r=e[1];if(void 0!==r){var i="number"===o?parseFloat(r.replace(f_,"")):NaN;s.push({label:n,x:isNaN(i)?r:i})}});var l=e.select(".axis-highlights").selectAll("g.line.x").data(s),c=l.enter().append("g").attr("class","line x").attr("transform",function(t){return"translate("+(r(t.x)||0)+", "+i.range()[1]+")"});c.append("line").attr("width",0),c.append("text").attr("transform","rotate(-90)");var u=l.merge(c);u.transition().duration(d_).attr("transform",function(t){return"translate("+(r(t.x)||0)+", "+i.range()[1]+")"}),u.select("line").attr("stroke-dasharray",ju.anno_x_line_dash+" "+ju.anno_x_line_dash).attr("stroke",ju.anno_x_line_color).attr("stroke-width",ju.anno_x_line_width).attr("y2",n),u.select("text").text(function(t){return t.label}).attr("fill",ju.anno_x_line_color).attr("transform",function(){return"translate(0, "+("left"==a?n-6:"right"==a?6:n/2)+") rotate(-90)"}).attr("text-anchor","left"==a?"start":"right"==a?"end":"middle").attr("dy",function(t){return(r(t.x)||0)<x_(ju.anno_x_label_font_size)?"1.25em":"-0.5em"}).attr("font-size",x_(ju.anno_x_label_font_size)),l.exit().remove()}(n,r),function(t,e){var n=t.h,r=t.x,i=t.y,a=ju.anno_x_label_align,o=df.data.x_type,s=[];ju.anno_x_enabled&&ju.anno_x_areas&&ju.anno_x_areas.split("\n").map(function(t){var e=w_(t);if(!(e.length<2)){var n=e[0],r=M_(e[1]).map(function(t){var e="number"===o?parseFloat(t.replace(f_,"")):NaN;return isNaN(e)?t:e});1<r.length&&s.push({label:n,range:r})}});var l=e.select(".axis-highlights").selectAll("g.area.x").data(s),c=l.enter().append("g").attr("class","area x").attr("transform",function(t){return"translate("+(Math.min(r(t.range[0]),r(t.range[1]))||0)+", "+i.range()[1]+")"});c.append("rect").attr("height",n).attr("width",function(t){return Math.abs(r(t.range[1])-r(t.range[0]))||0}),c.append("text").attr("transform","rotate(-90)");var u=l.merge(c);u.transition().duration(d_).attr("transform",function(t){return"translate("+(Math.min(r(t.range[0]),r(t.range[1]))||0)+", "+i.range()[1]+")"}),u.select("rect").attr("width",function(t){return Math.abs(r(t.range[1])-r(t.range[0]))||0}).attr("fill",ju.anno_x_fill_color).attr("opacity",ju.anno_x_fill_opacity).attr("height",n),u.select("text").text(function(t){return t.label}).attr("fill",ju.anno_x_label_color).attr("transform",function(){return"translate(0, "+("left"==a?n-6:"right"==a?6:n/2)+") rotate(-90)"}).attr("text-anchor","left"==a?"start":"right"==a?"end":"middle").attr("dominant-baseline","hanging").attr("dy","0.33em").attr("font-size",x_(ju.anno_x_label_font_size)),l.exit().remove()}(n,r),function(t,e){var n=t.w,r=t.x,i=t.y,a=ju.anno_y_label_align,o=df.data.y_type,s=[];ju.anno_y_enabled&&ju.anno_y_lines&&ju.anno_y_lines.split("\n").forEach(function(t){var e=w_(t),n=e[0],r=e[1];if(void 0!==r){var i="number"===o?parseFloat(r.replace(f_,"")):NaN;s.push({label:n,y:isNaN(i)?r:i})}});var l=e.select(".axis-highlights").selectAll("g.line.y").data(s),c=l.enter().append("g").attr("class","line y").attr("transform",function(t){return"translate("+r.range()[0]+","+i(t.y)+")"});c.append("line").attr("width",0),c.append("text");var u=l.merge(c);u.transition().duration(d_).attr("transform",function(t){return"translate("+r.range()[0]+", "+i(t.y)+")"}),u.select("line").attr("stroke-dasharray",ju.anno_y_line_dash+" "+ju.anno_y_line_dash).attr("stroke",ju.anno_y_line_color).attr("stroke-width",ju.anno_y_line_width).attr("x2",n),u.select("text").text(function(t){return t.label}).attr("fill",ju.anno_y_line_color).attr("x","left"==a?10:"right"==a?n-6:n/2).attr("text-anchor","left"==a?"start":"right"==a?"end":"middle").attr("dy","-0.5em").attr("font-size",x_(ju.anno_y_label_font_size)),l.exit().remove()}(n,r),function(t,e){var n=t.w,r=t.x,i=t.y,a=ju.anno_y_label_align,o=df.data.y_type,s=[];ju.anno_y_enabled&&ju.anno_y_areas&&ju.anno_y_areas.split("\n").map(function(t){var e=w_(t);if(!(e.length<2)){var n=e[0],r=M_(e[1]).map(function(t){var e="number"===o?parseFloat(t.replace(f_,"")):NaN;return isNaN(e)?t:e});1<r.length&&s.push({label:n,range:r})}});var l=e.select(".axis-highlights").selectAll("g.area.y").data(s),c=l.enter().append("g").attr("class","area y").attr("transform",function(t){return"translate("+r.range()[0]+", "+Math.min(i(t.range[0]),i(t.range[1]))+")"});c.append("rect").attr("width",n).attr("height",function(t){return Math.abs(i(t.range[1])-i(t.range[0]))}),c.append("text");var u=l.merge(c);u.transition().duration(d_).attr("transform",function(t){return"translate("+r.range()[0]+", "+Math.min(i(t.range[0]),i(t.range[1]))+")"}),u.select("rect").attr("height",function(t){return Math.abs(i(t.range[1])-i(t.range[0]))}).attr("fill",ju.anno_y_fill_color).attr("opacity",ju.anno_y_fill_opacity).attr("width",n),u.select("text").text(function(t){return t.label}).attr("fill",ju.anno_y_label_color).attr("x","left"==a?10:"right"==a?n-6:n/2).attr("text-anchor","left"==a?"start":"right"==a?"end":"middle").attr("dominant-baseline","hanging").attr("dy","0.33em").attr("font-size",x_(ju.anno_y_label_font_size)),l.exit().remove()}(n,r)}function k_(t){var e=t.facet.scales.x(t.x)+t.facet.layout.x;return isFinite(e)||(e=1e9),e}function z_(t){var e=t.facet.scales.y(t.y)+t.facet.layout.y;return isFinite(e)||(e=1e9),e}function N_(t){return ju.responsive_dots?Math.min(t.facet.scales.w,t.facet.scales.h)/300:1}function A_(t,e){var n,r,i;r=(n=t).chart_layout.chart.select(".axis-highlights").selectAll(".time-label").data(null!=Bb.value()&&ju.time_label_show?[Bb.value()]:[]),i=r.enter().append("text").attr("class","time-label").attr("text-anchor","middle").attr("alignment-baseline","middle").style("pointer-events","none"),r.merge(i).text(function(t){return t}).attr("transform",function(){return"translate("+n.scales.w/2+","+n.scales.h/2+") scale("+n.scales.w/400+")"}).attr("font-weight","bold").attr("font-size",ju.time_label_font_size).attr("fill",ju.time_label_color).attr("opacity",ju.time_label_opacity),r.exit().remove(),j_(t,e)}function D_(){return ju.labels_responsive?Math.max(ju.label_font_size_min,Math.min(ju.label_font_size_max,ju.label_font_size*window.innerWidth/500)):ju.label_font_size}function T_(i,n){var t;t=ju.labels_show?i.data_points.filter(function(t){return!("slider"in i.data_points.column_names)||(null==Bb.value()||t.slider==Bb.value())}):[],ju.labels_selective&&(t=t.filter(function(t){return-1<ju.labels_selected.indexOf(t.row)}));var e=t[0]&&t[0].id&&!(!t[0].slider&&!t[0].filter),r=(p_=p_||ce("#overlay .data-labels")).selectAll(".data-label").data(t,function(t){return e?t.id:t.row}),a=r.enter().append("g").attr("class","data-label").attr("transform",l).attr("pointer-events","none");a.append("text").attr("dominant-baseline","middle").attr("dy","0.1em").attr("class","label-bg"),a.append("text").attr("dominant-baseline","middle").attr("dy","0.1em").attr("class","label-main");var o=r.merge(a).attr("text-anchor",function(e){if("auto"!=ju.label_align)return ju.label_align;var t=i.facets.filter(function(t){return e.facet==t.name})[0]||i.facets[0];return t.scales.x(e.x)>t.layout.w/2?"end":"start"});function s(t,e){return n?0:e*ju.animation_stagger*1e3}function l(e){var t=i.facets.filter(function(t){return e.facet.name==t.name})[0]||i.facets[0],n=t.scales.x(e.x)+t.layout.x,r=t.scales.y(e.y)+t.layout.y;return isFinite(n)||(n=1e9),isFinite(r)||(r=1e9),"translate("+n+","+r+")"}o.select(".label-bg").text(function(t){return t.id||""}).attr("fill",function(t){return"fixed"==ju.label_color_type?ju.label_color:Pd(t.color)}).attr("stroke",ju.chart_bg.background_color_enabled?ju.chart_bg.background_color:ju.layout.background_color).attr("stroke-width",ju.label_font_size*ju.label_bg_size/100).attr("font-size",D_),o.select(".label-main").text(function(t){return t.id||""}).attr("fill",function(t){return"fixed"==ju.label_color_type?ju.label_color:Pd(t.color)}).attr("font-size",D_),t.length<500?o.transition().duration(n?0:1e3*ju.animation_duration).delay(s).attr("transform",l):o.transition().duration(n||2500<t.length?0:1e3*ju.animation_duration).delay(s).attr("transform",l),r.exit().remove()}var I_={curveNatural:yp,curveLinear:Wd};function L_(t){return"translate("+t.layout.x+","+t.layout.y+")"}function S_(l,c,n){var t=l.facets.length&&"number"===l.facets[0].x_type&&"number"===l.facets[0].y_type,e="none"!=ju.fit_type&&t,r=ce(".fits").selectAll(".fit").data(e?l.facets:[],function(t){return t.key});r.enter().append("g").attr("class","fit").attr("transform",L_).merge(r).each(function(t){var e,d=t.scales.x,p=t.scales.y,h=Oe(d.range()),g=Ce(d.range()),m=Oe(p.range()),_=Ce(p.range()),y=Jd().x(function(t){return d(t.x)}).y(function(t){return p(t.y)}),n=ju.fit_type,r="all"===n||"color"===n?l.data_points:t.values;if("all"!==n&&"chart"!==n&&t.color_domain.length&&"discrete"===l.data_points.color_type){e=l.data_points.color_domain.map(function(){return[]});var i=l.data_points.color_domain.reduce(function(t,e,n){return t[e]=n,t},{});r.forEach(function(t){e[i[t.color]].push(t)})}else e=[r];var a=ce(this).selectAll("path").data(e),o=a.enter().append("path").style("fill","none").attr("d",function(t){return s(t,!0)});function s(t,e){var n=function(t,e){var n,r,i,a,o,s=t.filter(function(t){return!isNaN(t.x)&&!isNaN(t.y)}),l=s.length;if(l<(e?1:2))return null;if(e){var c=0,u=0;s.forEach(function(t){c+=t.x*t.x,u+=t.x*t.y}),n=u/c,r=0}else{var f,d,p=0,h=0,g=0,m=0;s.forEach(function(t){p+=t.x,h+=t.y}),f=p/l,d=h/l,s.forEach(function(t){var e=t.x-f,n=t.y-d;g+=e*n,m+=e*e}),r=d-(n=g/m)*f}return a=r,(o=function(t){return i*t+a}).m=i=n,o.c=a,o}(t,ju.fit_force_origin);if(n&&Math.abs(n.c)!==1/0){var r,i,a,o,s=[];if("log"!=ju.x.numeric_scale_type&&"log"!=ju.y.numeric_scale_type)return o=isFinite(n.m)?(r=h,i=p(n(d.domain()[0])),a=g,p(n(d.domain()[1]))):(r=a=d(t[0].x),i=m,_),e?"M "+r+","+i+" L "+r+","+i:"M "+r+","+i+" L "+a+","+o;for(var l=d.domain(),c=(l[1]-l[0])/1e3,u=l[0];u<=l[1];){var f=n(u);(0<f||"log"!=ju.y.numeric_scale_type)&&s.push({x:u,y:f}),u+=c}return y(e?s.slice(0,1):s)}}a.merge(o).transition().duration(c?0:1e3*ju.animation_duration).style("stroke-width",ju.fit_line_width).attr("stroke-dasharray",0<ju.fit_line_dash?ju.fit_line_dash+" "+ju.fit_line_dash:null).attr("stroke",function(t){var e="all"===n||"chart"===n||"discrete"!==l.data_points.color_type;return!e&&t[0]?Pd(t[0].color):ju.fit_line_color}).attr("d",function(t){return s(t)}),a.exit().remove()}).attr("clip-path",function(t,e){return"url(#facet-clip-"+e+"-plot-"+n+")"}).transition().duration(c?0:ju.animation_duration).attr("transform",L_),r.exit().transition().duration(c?0:1e3*ju.animation_duration/2).attr("opacity",0).remove()}function E_(t){var e=[],n=[];return t.forEach(function(t){n[t]||(e.push(t),n[t]=!0)}),e}var C_=Array.isArray;function O_(t){return t}function P_(n){return{prop:function(t,e){Object.defineProperty(n,t,{value:e,enumerable:!0})},getter:function(t,e){Object.defineProperty(n,t,{get:e,enumerable:!0})},method:function(t,e){Object.defineProperty(n,t,{value:e})}}}function Y_(t,e){var n=1;return t[e?"reduce":"reduceRight"](function(t,e){return t[e]||(t[e]=n),n+=1,t},{})}function F_(t,e){var n=1;return t[e?"reduce":"reduceRight"](function(t,e){return t[e]=n++,t},{})}function B_(t,e,n,r){var i,a,o,s,l,c;i="dense"===r?(c=1,e[n?"reduce":"reduceRight"](function(t,e){return t[e]||(t[e]=c++),t},{})):"fractional"===r?(s=Y_(a=e,o=n),l=F_(a,o),Object.keys(s).reduce(function(t,e){return t[e]=(s[e]+l[e])/2,t},{})):"worst"===r?F_(e,n):Y_(e,n);var u=function(t){return i[t]};return"ordinal"===r&&(u=function(t){return i[t]++}),t.map(u)}function U_(r){return r=r||Math.random,function(t,e){var n=e-t+1;return Math.floor(r()*n)+t}}function R_(t,e){return t[U_(e)(0,t.length-1)]}function H_(t,e,n,r){var i,a=t.length;if(n=void 0!==e&&n,e=void 0!==e?Math.floor(e):a,!a||e<1)return[];var o=U_(r);if(n||1===e){i=[];for(var s=0;s<e;s++)i.push(t[o(0,a-1)]);return i}i=t.slice();var l=Math.min(a,e);for(s=0;s<l;s++){var c=o(s,a-1);if(c!==s){var u=i[c],f=i[s];i[s]=u,i[c]=f}}return i.length=l,i}function Z_(t,n,r){if(!n.length)return t.slice();for(var i=0,e=t.reduce(function(t,e){for(;t.length===n[i];)t.push(r),i++;return t.push(e),t},[]);n[i++];)e.push(r);return e}function Q_(e,t){return C_(t)?t.map(function(t){return Ee(e,t)}):Ee(e,t)}var G_,q_,W_,V_,X_,J_,K_=(J_=P_(X_={}),q_=function(){return E_(this.sorted_values)},(G_=J_).method("unsorted",function(){return this.values.slice()}),G_.method("ascending",function(){return this.sorted_values.slice()}),G_.method("descending",function(){return this.sorted_values.slice().reverse()}),G_.method("unique",function(){return E_(this.values)}),G_.method("uniqueAscending",q_),G_.method("uniqueDescending",function(){return q_().reverse()}),(W_=J_).getter("variance",function(){return ke(this.values)}),W_.getter("sd",function(){return Math.sqrt(this.variance)}),W_.getter("median",function(){return Q_(this.sorted_values,.5)}),W_.getter("iqr",function(){var t=Q_(this.sorted_values,[.25,.75]);return t[1]-t[0]}),W_.method("quantiles",function(t){return Q_(this.sorted_values,t)}),W_.method("quartiles",function(){return Q_(this.sorted_values,[.25,.5,.75])}),(V_=J_).method("random",function(t){return R_(this.values,t)}),V_.method("sample",function(t,e,n){return H_(this.values,t,e,n)}),J_.method("rank",function(t,e){return B_(this.values,this.sorted_values,t,e)}),J_.method("unclean",function(t){if(t&&t.length<this.values.length)throw new RangeError("dataset is too short");if(t&&t.length>this.values.length)throw new RangeError("dataset is too long");return Z_(t=t||this.values,this.dropped_indexes,NaN)}),X_);function $_(t,e){var n=Object.create(K_);return function(t,e,i){i=i||O_;var a=1/0,o=-1/0,r=null,s=0,l=[],c=Object.freeze(e.reduce(function(t,e,n){var r=i(e);return"number"!=typeof r||isNaN(r)?l.push(n):(t.push(r),a=Math.min(a,r),o=Math.max(o,r),s+=r),t},[])),n=P_(t);n.prop("enhanced_array",!0),n.prop("numeric_array",!0),n.prop("values",c),n.prop("min",c.length?a:null),n.prop("max",c.length?o:null),n.prop("sum",s),n.prop("mean",c.length?s/c.length:null),n.prop("range",c.length?o-a:null),n.prop("length",c.length),n.prop("dropped_indexes",Object.freeze(l)),n.method("extent",function(){return[this.min,this.max]}),n.getter("sorted_values",function(){var e,n;return r||(n=-1/0,c.every(function(t){if(n<=t)return n=t,!0})&&(r=c),e=1/0,r=c.every(function(t){if(t<=e)return e=t,!0})?Object.freeze(c.slice().reverse()):Object.freeze(c.slice().sort(be))),r})}(n,t,e),n}var ty,ey,ny,ry,iy;iy=P_(ry={}),ey=function(){return E_(this.sorted_values)},(ty=iy).method("unsorted",function(){return this.values.slice()}),ty.method("ascending",function(){return this.sorted_values.slice()}),ty.method("descending",function(){return this.sorted_values.slice().reverse()}),ty.method("unique",function(){return E_(this.values)}),ty.method("uniqueAscending",ey),ty.method("uniqueDescending",function(){return ey().reverse()}),(ny=iy).method("random",function(t){return R_(this.values,t)}),ny.method("sample",function(t,e,n){return H_(this.values,t,e,n)}),iy.method("rank",function(t,e){return B_(this.values,this.sorted_values,t,e)}),iy.method("unclean",function(t){if(t&&t.length<this.values.length)throw new RangeError("dataset is too short");if(t&&t.length>this.values.length)throw new RangeError("dataset is too long");return Z_(t=t||this.values,this.dropped_indexes)});function ay(t){return t}var oy={name:"biweight",kernel:function(t){return Math.abs(t)<1?.9375*Math.pow(1-t*t,2):0},delta:Math.pow(35,.2)},sy=Math.pow(Math.PI,2),ly=Math.pow(1/6-1/sy,2);var cy={name:"cosine",kernel:function(t){return Math.abs(t)<.5?1+Math.cos(2*Math.PI*t):0},delta:Math.pow(6/ly,.2)};var uy={name:"epanechnikov",kernel:function(t){return Math.abs(t)<1?.75*(1-t*t):0},delta:Math.pow(15,.2)},fy=1/Math.sqrt(2*Math.PI);var dy={name:"gaussian",kernel:function(t){return fy*Math.exp(-.5*t*t)},delta:Math.pow(1/(4*Math.PI),.1)};var py={name:"parzen",kernel:function(t){var e=Math.abs(t);return 1<=e?0:.5<e?8/3*Math.pow(1-e,3):8*(1/6-Math.pow(e,2)+Math.pow(e,3))},delta:2*Math.pow(151/35,.2)};var hy={name:"triangular",kernel:function(t){var e=Math.abs(t);return e<1?1-e:0},delta:Math.pow(24,.2)};var gy={biweight:oy,cosine:cy,epanechnikov:uy,gaussian:dy,parzen:py,triangular:hy,triweight:{name:"triweight",kernel:function(t){return Math.abs(t)<1?35/32*Math.pow(1-t*t,3):0},delta:Math.pow(9450/143,.2)},uniform:{name:"uniform",kernel:function(t){return Math.abs(t)<1?.5:0},delta:Math.pow(4.5,.2)}},my=Math.pow(8*Math.sqrt(Math.PI)/3,.2);function _y(t,e){return e.delta*my*Math.min(t.sd,t.iqr/1.34)*Math.pow(t.length,-.2)}function yy(t,e){var n,r,h=(n=t,r=e,Array.isArray(n)?$_(n,r=r||ay):n),g=gy.gaussian,m=null,_=2500,y=null,b=!1;function i(){for(var t=m||_y(h,g),e=y?y[0]:h.min,n=y?y[1]:h.max,r=(n-e)/_,i=h.length,a=[],o=0,s=e;s<=n;s+=r){for(var l=h.values,c=-1,u=0;++c<i;)u+=g.kernel((s-l[c])/t);var f=u/t/i;o=Math.max(o,f),a.push({input:s,density:f})}if(b||0===b){var d=h.min,p=h.max;a=a.filter(function(t){return t.input>=d&&t.input<=p||t.density>b})}return a.max_density=o,a}return i.bandwidth=function(t){return void 0===t?m:(m=t,i)},i.domain=function(t){return void 0===t?y?y.slice():y:(y=t,i)},i.filter=function(t){return void 0===t?b:(b=!0===t?0:t,i)},i.kernel=function(t){return void 0===t?g.name:(g=gy[t],i)},i.steps=function(t){return void 0===t?_:(_=t,i)},i.defaultBandwidth=function(){return _y(h,g)},i}function by(t){return t.facet_index+"-"+t.category}var vy,xy=function(t){var e=Math.pow(10,3);return Math.round(t*e)/e};function wy(t,e){var n=e.facets[t.facet_index];return"translate("+n.layout.x+","+n.layout.y+")"}function My(e,t,n,r,i){var a=e.facets[r.facet_index],o="vertical"==t?a.scales[r.category_col]:a.scales[r.value_col],s="vertical"==t?a.scales[r.value_col]:a.scales[r.category_col],l=ce(n),c=void 0===i;if(o||s){l.transition("style").duration(i||0).style("opacity",1).attr("fill",ju.box_color).attr("fill-opacity",ju.box_opacity).attr("stroke",ju.box_line_color).attr("stroke-width",ju.box_line_width).attr("transform",function(t){return wy(t,e)});var u=("vertical"==t?o.step():s.step())*(ju.violin_plot?.1:.5);ju.violin_plot||(u=Math.min(u,30)),"vertical"==t?l.transition().duration(i||0).attr("x",function(t){return o(t.category)-(c?0:u/2)}).attr("y",function(t){return s(t.top)}).attr("height",function(t){return s(t.bottom)-s(t.top)}).attr("width",c?0:u):l.transition().duration(i||0).attr("x",function(t){return o(t.bottom)}).attr("y",function(t){return s(t.category)-(c?0:u/2)}).attr("height",c?0:u).attr("width",function(t){return o(t.top)-o(t.bottom)})}}function jy(e,o,t,n,r){var i=e.facets[n.facet_index],s="vertical"==o?i.scales[n.category_col]:i.scales[n.value_col],l="vertical"==o?i.scales[n.value_col]:i.scales[n.category_col],a=ce(t),c=void 0===r;a.transition("style").duration(r||0).style("opacity",1).attr("stroke",ju.box_line_color).attr("stroke-width",ju.box_line_width).attr("transform",function(t){return wy(t,e)}),a.transition().duration(r||0).attr("d",function(t){if(s||l){var e,n="";e=c?0:("vertical"==o?s.step():l.step())*(ju.violin_plot?.05:.25),ju.violin_plot||(e=Math.min(e,15));var r=ju.violin_plot?0:e,i="tukey"==ju.box_whisker_type?t.whisker_tukey_bottom:t.whisker_bottom,a="tukey"==ju.box_whisker_type?t.whisker_tukey_top:t.whisker_top;return"vertical"==o?(n+="M "+(s(t.category)-r)+","+l(a),n+=" L "+(s(t.category)+r)+","+l(a),n+=" M "+s(t.category)+","+l(a),n+=" L "+s(t.category)+","+l(t.top),n+=" M "+(s(t.category)-r)+","+l(i),n+=" L "+(s(t.category)+r)+","+l(i),n+=" M "+s(t.category)+","+l(i),n+=" L "+s(t.category)+","+l(t.bottom),n+=" M "+(s(t.category)-e)+","+l(t.mid),n+=" L "+(s(t.category)+e)+","+l(t.mid)):(n+="M "+s(a)+","+(l(t.category)-r),n+=" L "+s(a)+","+(l(t.category)+r),n+=" M "+s(a)+","+l(t.category),n+=" L "+s(t.top)+","+l(t.category),n+=" M "+s(i)+","+(l(t.category)-r),n+=" L "+s(i)+","+(l(t.category)+r),n+=" M "+s(i)+","+l(t.category),n+=" L "+s(t.bottom)+","+l(t.category),n+=" M "+s(t.mid)+","+(l(t.category)-e),n+=" L "+s(t.mid)+","+(l(t.category)+e)),n}})}function ky(e,i,t,n,a,r){var o=e.facets[n.facet_index],s="vertical"==i?o.scales[n.category_col]:o.scales[n.value_col],l="vertical"==i?o.scales[n.value_col]:o.scales[n.category_col],c=void 0===r;if(s||l){var u,f=a.max_density||1;u="vertical"==i?Kd().x0(function(t){var e=c?0:o.scales.w/o.scales.x.domain().length;return xy(t.density*e*.25/f+t.x_offset)}).x1(function(t){var e=c?0:o.scales.w/o.scales.x.domain().length;return xy(-t.density*e*.25/f+t.x_offset)}).y(function(t){return xy(o.scales.y(t.input))}).curve(yp):Kd().y0(function(t){var e=c?0:o.scales.h/o.scales.y.domain().length;return xy(t.density*e*.25/f+t.y_offset)}).y1(function(t){var e=c?0:o.scales.h/o.scales.y.domain().length;return xy(-t.density*e*.25/f+t.y_offset)}).x(function(t){return xy(o.scales.x(t.input))}).curve(yp),ce(t).transition().duration(r||0).attr("transform",function(t){return wy(t,e)}).attr("opacity",ju.violin_opacity).attr("fill",ju.violin_color).attr("d",function(t){for(var e="vertical"==i?"x_offset":"y_offset",n="vertical"==i?s:l,r=0;r<a.length;r++)a[r][e]=n(t.category);return u(a)})}}function zy(n,r,t){var e=ju.violin_plot?n.boxes:[],i=ce("#graphic .violins").selectAll(".violin").data(e,by),a=e.map(function(t){return yy(t.values).steps(ju.violin_samples-1).domain(n.facets[t.facet_index].scales[t.value_col].domain())}),o=1;e.length&&(o=ju.violin_bandwidth?ju.violin_bandwidth:function(t,e){var n,r=t.length,i=-1,a=[];if(null==e)for(;++i<r;)isNaN(n=je(t[i]))||a.push(n);else for(;++i<r;)isNaN(n=je(e(t[i],i,t)))||a.push(n);return Ee(a.sort(be),.5)}(a.map(function(t){return t.defaultBandwidth()})));var s=a.map(function(t){return t.bandwidth(o)()}),l=s.map(function(t){return t.reduce(function(t,e){return Math.max(t,e.density)},0)});if("area"===ju.violin_sizing){var c=Math.max.apply(null,l);s.forEach(function(t){t.max_density=c})}else s.forEach(function(t,e){t.max_density=l[e]});var u=i.enter().append("path").attr("class","violin").attr("pointer-events","none").each(function(t,e){ky(n,r,this,t,s[e])}),f=i.merge(u),d=t?0:1e3*ju.animation_duration;f.each(function(t,e){ky(n,r,this,t,s[e],d)}),i.exit().transition().duration(d).style("opacity",0).remove()}function Ny(t,e){var n,r,i,a,o,s,l,c,u,f,d,p,h,g,m,_,y="x"==t.boxes.category_col?"vertical":"horizontal";n=t,r=y,i=e,a=ju.box_plot?n.boxes:[],o=ce("#overlay .boxes").selectAll(".box").data(a,by),s=o.enter().append("rect").attr("class","box").each(function(t){My(n,r,this,t)}).on("mouseover",function(t){ju.highlighted&&ju.popup_sticky||Oh.call(this,t)}).on("mouseout",function(){ju.highlighted&&ju.popup_sticky||Bh()}),l=o.merge(s),c=i?0:1e3*ju.animation_duration,l.attr("id",function(t,e){return"box-"+e}).on("click",function(t,e){ju.popup_sticky&&(ju.highlighted="box-"+e,Yh())}).each(function(t){My(n,r,this,t,c)}),o.exit().transition().duration(c).style("opacity",0).remove(),u=t,f=y,d=e,p=ju.box_plot?u.boxes:[],h=ce("#overlay .boxes").selectAll(".whisker").data(p,by),g=h.enter().append("path").attr("class","whisker").attr("pointer-events","none").each(function(t){jy(u,f,this,t)}),m=h.merge(g),_=d?0:1e3*ju.animation_duration,m.each(function(t){jy(u,f,this,t,_)}),h.exit().transition().duration(_).style("opacity",0).remove(),zy(t,y,e)}function Ay(){this._valueAccessor=function(t){return t.value},this._idAccessor=function(t){return t.id},this._min=null,this._max=null,this._closestTo0=null,this.size=0,this._idToNode={}}function Dy(){var o,u,a,f,d,t,p,h,g,m,_,y,e=[],n=4,r="horizontal",i="symetric",s=function(t){return t.x};function l(){}function b(t,e,n){return null===e?null:("prev"===n?t.value-e.value>o:e.value-t.value>o)?null:isFinite(e.datum.free)?e.datum:b(t,e[n],n)}function v(t,e,n,r){null!==e&&(("prev"===n?t.value-e.value>o:e.value-t.value>o)||(r.push(e.datum),v(t,e[n],n,r)))}function x(t){return"symetric"===i||("positive"===i?0<=t.free:t.free<=0)}function w(t,e){return Math.abs(t.free)<Math.abs(e)}function c(t,e,n,r){return null!==e&&(!("prev"===n?t.free-e.datum.free>o:e.datum.free-t.free>o)&&(i=t,a=e.datum,m++,Math.pow(a.free-i.free,2)+Math.pow(a.fixed-i.fixed,2)<u||c(t,e[n],n)));var i,a}function M(t,e){return!!c(t,e,"prev")||c(t,e,"next")}return l.data=function(t){return arguments.length?(e=t,l):e},l.radius=function(t){return arguments.length?(n=t,l):n},l.orientation=function(t){return arguments.length?("horizontal"!==t&&"vertical"!==t||(r=t),l):r},l.side=function(t){return arguments.length?("symetric"!==t&&"positive"!==t&&"negative"!==t||(i=t),l):i},l.distributeOn=function(t){return arguments.length?(s=t,l):s},l.arrange=function(){return t=e.map(function(t,e){return{datum:t,id:e,fixed:s(t),free:-1/0}}),o=2*n,u=Math.pow(o,2),a=(new Ay).valueAccessor(function(t){return t.fixed}).addMany(t),f=(new Ay).valueAccessor(function(t){return t.fixed}),d=(new Ay).valueAccessor(function(t){return t.free}),p=h=0,m=_=y=g=0,t.forEach(function(s){var l,c=-1/0,t=function(t){var e=[],n=a.dln(t),r=b(n,n.prev,"prev"),i=b(n,n.next,"next");null!=r&&v(n=f.dln(r),n,"prev",e);null!=i&&v(n=f.dln(i),n,"next",e);p+=e.length,h<e.length&&(h=e.length);return e}(s);0===t.length?c=0:(d.empty(),d.addMany(t),s.free=0,M(s,d.closestTo0())?t.forEach(function(t){var e,n,r,i,a,o;e=t,n=s,l=Math.sqrt(u-Math.pow(n.fixed-e.fixed,2))+1e-6,r=t,i=l,s.free=r.free-i,x(s)&&w(s,c)&&!M(s,d.dln(t))&&(c=s.free),_+=m,y<m&&(y=m),m=0,g+=1,a=t,o=l,s.free=a.free+o,x(s)&&w(s,c)&&!M(s,d.dln(t))&&(c=s.free),_+=m,y<m&&(y=m),m=0,g+=1}):(_+=m,y<m&&(y=m),m=c=0,g+=1)),s.free=c,s.y="horizontal"===r?(s.x=s.fixed,c):(s.x=c,s.fixed),f.add(s)}),t},l.metrics=function(){return{totalPossibleColliders:p,maxPossibleColliders:h,totalTestedPlacements:g,visitedColliderCount:m,totalVisitedColliders:_,maxVisitedColliders:y}},l}Ay.prototype.valueAccessor=function(t){return arguments.length?(this._valueAccessor=t,this):this._valueAccessor},Ay.prototype.idAccessor=function(t){return arguments.length?(this._idAccessor=t,this):this._idAccessor},Ay.prototype.min=function(){return this._min},Ay.prototype.max=function(){return this._max},Ay.prototype.closestTo0=function(){return this._closestTo0},Ay.prototype.dln=function(t){return this._idToNode[this._idAccessor(t)]},Ay.prototype.empty=function(){return this._min=null,this._max=null,this._closestTo0=null,this.size=0,this._idToNode={},this},Ay.prototype.add=function(t){var e={datum:t,value:this._valueAccessor(t),prev:null,next:null};if(0===this.size)this._min=this._max=this._closestTo0=e;else{if(e.value<=this._min.value)e.next=this._min,e.next.prev=e,this._min=e;else if(e.value>=this._max.value)e.prev=this._max,e.prev.next=e,this._max=e;else{for(var n=this._max;n.value>e.value;)n=n.prev;e.prev=n,e.next=n.next,(e.next.prev=e).prev.next=e}Math.abs(e.value)<Math.abs(this._closestTo0.value)&&(this._closestTo0=e)}return this._idToNode[this._idAccessor(t)]=e,this.size++,this},Ay.prototype.addMany=function(t){return t.forEach(function(t,e){this.add(t)},this),this},Ay.prototype.remove=function(t){var e=this.dln(t);if(1===this.size)this._min=this._max=this._closestTo0=null;else{if(e===this._closestTo0)if(null===this._closestTo0.next)this._closestTo0=e.prev;else if(null===this._closestTo0.prev)this._closestTo0=e.prev;else{var n=Math.abs(this._closestTo0.prev.value),r=Math.abs(this._closestTo0.next.value);this._closestTo0=n<r?this._closestTo0.prev:this._closestTo0.next}e===this._min?(this._min=this._min.next,this._min.prev=null):e===this._max?(this._max=this._max.prev,this._max.next=null):(e.next.prev=e.prev,e.prev.next=e.next)}return delete this._idToNode[this._idAccessor(t)],e=null,this.size--,this};var Ty={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},Iy=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function Ly(t){return 48<=t&&t<=57}function Sy(t){this.index=0,this.path=t,this.max=t.length,this.result=[],this.param=0,this.err="",this.segmentStart=0,this.data=[]}function Ey(t){for(;t.index<t.max&&(10===(e=t.path.charCodeAt(t.index))||13===e||8232===e||8233===e||32===e||9===e||11===e||12===e||160===e||5760<=e&&0<=Iy.indexOf(e));)t.index++;var e}function Cy(t){var e,n=t.index,r=n,i=t.max,a=!1,o=!1,s=!1,l=!1;if(i<=r)t.err="SvgPath: missed param (at pos "+r+")";else if(43!==(e=t.path.charCodeAt(r))&&45!==e||(e=++r<i?t.path.charCodeAt(r):0),Ly(e)||46===e){if(46!==e){if(a=48===e,e=++r<i?t.path.charCodeAt(r):0,a&&r<i&&e&&Ly(e))return void(t.err="SvgPath: numbers started with `0` such as `09` are ilegal (at pos "+n+")");for(;r<i&&Ly(t.path.charCodeAt(r));)r++,o=!0;e=r<i?t.path.charCodeAt(r):0}if(46===e){for(l=!0,r++;Ly(t.path.charCodeAt(r));)r++,s=!0;e=r<i?t.path.charCodeAt(r):0}if(101===e||69===e){if(l&&!o&&!s)return void(t.err="SvgPath: invalid float exponent (at pos "+r+")");if(43!==(e=++r<i?t.path.charCodeAt(r):0)&&45!==e||r++,!(r<i&&Ly(t.path.charCodeAt(r))))return void(t.err="SvgPath: invalid float exponent (at pos "+r+")");for(;r<i&&Ly(t.path.charCodeAt(r));)r++}t.index=r,t.param=parseFloat(t.path.slice(n,r))+0}else t.err="SvgPath: param should start with 0..9 or `.` (at pos "+r+")"}function Oy(t){var e,n;n=(e=t.path[t.segmentStart]).toLowerCase();var r=t.data;if("m"===n&&2<r.length&&(t.result.push([e,r[0],r[1]]),r=r.slice(2),n="l",e="m"===e?"l":"L"),"r"===n)t.result.push([e].concat(r));else for(;r.length>=Ty[n]&&(t.result.push([e].concat(r.splice(0,Ty[n]))),Ty[n]););}function Py(t){var e,n,r,i=t.max;if(t.segmentStart=t.index,function(t){switch(32|t){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return!0}return!1}(t.path.charCodeAt(t.index)))if(n=Ty[t.path[t.index].toLowerCase()],t.index++,Ey(t),t.data=[],n){for(e=!1;;){for(r=n;0<r;r--){if(Cy(t),t.err.length)return;t.data.push(t.param),Ey(t),e=!1,t.index<i&&44===t.path.charCodeAt(t.index)&&(t.index++,Ey(t),e=!0)}if(!e){if(t.index>=t.max)break;if(!(48<=(a=t.path.charCodeAt(t.index))&&a<=57||43===a||45===a||46===a))break}}var a;Oy(t)}else Oy(t);else t.err="SvgPath: bad command "+t.path[t.index]+" (at pos "+t.index+")"}var Yy=function(t){var e=new Sy(t),n=e.max;for(Ey(e);e.index<n&&!e.err.length;)Py(e);return e.err.length?e.result=[]:e.result.length&&("mM".indexOf(e.result[0][0])<0?(e.err="SvgPath: string should start with `M` or `m`",e.result=[]):e.result[0][0]="M"),{err:e.err,segments:e.result}};function Fy(){if(!(this instanceof Fy))return new Fy;this.queue=[],this.cache=null}Fy.prototype.matrix=function(t){return 1===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&0===t[4]&&0===t[5]||(this.cache=null,this.queue.push(t)),this},Fy.prototype.translate=function(t,e){return 0===t&&0===e||(this.cache=null,this.queue.push([1,0,0,1,t,e])),this},Fy.prototype.scale=function(t,e){return 1===t&&1===e||(this.cache=null,this.queue.push([t,0,0,e,0,0])),this},Fy.prototype.rotate=function(t,e,n){var r,i,a;return 0!==t&&(this.translate(e,n),r=t*Math.PI/180,i=Math.cos(r),a=Math.sin(r),this.queue.push([i,a,-a,i,0,0]),this.cache=null,this.translate(-e,-n)),this},Fy.prototype.skewX=function(t){return 0!==t&&(this.cache=null,this.queue.push([1,0,Math.tan(t*Math.PI/180),1,0,0])),this},Fy.prototype.skewY=function(t){return 0!==t&&(this.cache=null,this.queue.push([1,Math.tan(t*Math.PI/180),0,1,0,0])),this},Fy.prototype.toArray=function(){if(this.cache)return this.cache;if(!this.queue.length)return this.cache=[1,0,0,1,0,0],this.cache;if(this.cache=this.queue[0],1===this.queue.length)return this.cache;for(var t=1;t<this.queue.length;t++)this.cache=(e=this.cache,n=this.queue[t],[e[0]*n[0]+e[2]*n[1],e[1]*n[0]+e[3]*n[1],e[0]*n[2]+e[2]*n[3],e[1]*n[2]+e[3]*n[3],e[0]*n[4]+e[2]*n[5]+e[4],e[1]*n[4]+e[3]*n[5]+e[5]]);var e,n;return this.cache},Fy.prototype.calc=function(t,e,n){var r;return this.queue.length?(this.cache||(this.cache=this.toArray()),[t*(r=this.cache)[0]+e*r[2]+(n?0:r[4]),t*r[1]+e*r[3]+(n?0:r[5])]):[t,e]};var By=Fy,Uy={matrix:!0,scale:!0,rotate:!0,translate:!0,skewX:!0,skewY:!0},Ry=/\s*(matrix|translate|scale|rotate|skewX|skewY)\s*\(\s*(.+?)\s*\)[\s,]*/,Hy=/[\s,]+/,Zy=2*Math.PI;function Qy(t,e,n,r){var i=t*n+e*r;return 1<i&&(i=1),i<-1&&(i=-1),(t*r-e*n<0?-1:1)*Math.acos(i)}var Gy=function(t,e,n,r,i,a,o,s,l){var c=Math.sin(l*Zy/360),u=Math.cos(l*Zy/360),f=u*(t-n)/2+c*(e-r)/2,d=-c*(t-n)/2+u*(e-r)/2;if(0===f&&0===d)return[];if(0===o||0===s)return[];o=Math.abs(o),s=Math.abs(s);var p=f*f/(o*o)+d*d/(s*s);1<p&&(o*=Math.sqrt(p),s*=Math.sqrt(p));var h,g,m,_,y,b,v,x=function(t,e,n,r,i,a,o,s,l,c){var u=c*(t-n)/2+l*(e-r)/2,f=-l*(t-n)/2+c*(e-r)/2,d=o*o,p=s*s,h=u*u,g=f*f,m=d*p-d*g-p*h;m<0&&(m=0),m/=d*g+p*h;var _=(m=Math.sqrt(m)*(i===a?-1:1))*o/s*f,y=m*-s/o*u,b=c*_-l*y+(t+n)/2,v=l*_+c*y+(e+r)/2,x=(u-_)/o,w=(f-y)/s,M=(-u-_)/o,j=(-f-y)/s,k=Qy(1,0,x,w),z=Qy(x,w,M,j);return 0===a&&0<z&&(z-=Zy),1===a&&z<0&&(z+=Zy),[b,v,k,z]}(t,e,n,r,i,a,o,s,c,u),w=[],M=x[2],j=x[3],k=Math.max(Math.ceil(Math.abs(j)/(Zy/4)),1);j/=k;for(var z=0;z<k;z++)w.push((h=M,g=j,void 0,m=4/3*Math.tan(g/4),_=Math.cos(h),y=Math.sin(h),b=Math.cos(h+g),v=Math.sin(h+g),[_,y,_-y*m,y+_*m,b+v*m,v-b*m,b,v])),M+=j;return w.map(function(t){for(var e=0;e<t.length;e+=2){var n=t[e+0],r=t[e+1],i=u*(n*=o)-c*(r*=s),a=c*n+u*r;t[e+0]=i+x[0],t[e+1]=a+x[1]}return t})},qy=1e-10,Wy=Math.PI/180;function Vy(t,e,n){if(!(this instanceof Vy))return new Vy(t,e,n);this.rx=t,this.ry=e,this.ax=n}Vy.prototype.transform=function(t){var e=Math.cos(this.ax*Wy),n=Math.sin(this.ax*Wy),r=[this.rx*(t[0]*e+t[2]*n),this.rx*(t[1]*e+t[3]*n),this.ry*(-t[0]*n+t[2]*e),this.ry*(-t[1]*n+t[3]*e)],i=r[0]*r[0]+r[2]*r[2],a=r[1]*r[1]+r[3]*r[3],o=((r[0]-r[3])*(r[0]-r[3])+(r[2]+r[1])*(r[2]+r[1]))*((r[0]+r[3])*(r[0]+r[3])+(r[2]-r[1])*(r[2]-r[1])),s=(i+a)/2;if(o<qy*s)return this.rx=this.ry=Math.sqrt(s),this.ax=0,this;var l=r[0]*r[1]+r[2]*r[3],c=s+(o=Math.sqrt(o))/2,u=s-o/2;return this.ax=Math.abs(l)<qy&&Math.abs(c-a)<qy?90:180*Math.atan(Math.abs(l)>Math.abs(c-a)?(c-i)/l:l/(c-a))/Math.PI,0<=this.ax?(this.rx=Math.sqrt(c),this.ry=Math.sqrt(u)):(this.ax+=90,this.rx=Math.sqrt(u),this.ry=Math.sqrt(c)),this},Vy.prototype.isDegenerate=function(){return this.rx<qy*this.ry||this.ry<qy*this.rx};var Xy=Vy;function Jy(t){if(!(this instanceof Jy))return new Jy(t);var e=Yy(t);this.segments=e.segments,this.err=e.err,this.__stack=[]}Jy.prototype.__matrix=function(u){var f,d=this;u.queue.length&&this.iterate(function(t,e,n,r){var i,a,o,s;switch(t[0]){case"v":a=0===(i=u.calc(0,t[1],!0))[0]?["v",i[1]]:["l",i[0],i[1]];break;case"V":a=(i=u.calc(n,t[1],!1))[0]===u.calc(n,r,!1)[0]?["V",i[1]]:["L",i[0],i[1]];break;case"h":a=0===(i=u.calc(t[1],0,!0))[1]?["h",i[0]]:["l",i[0],i[1]];break;case"H":a=(i=u.calc(t[1],r,!1))[1]===u.calc(n,r,!1)[1]?["H",i[0]]:["L",i[0],i[1]];break;case"a":case"A":var l=u.toArray(),c=Xy(t[1],t[2],t[3]).transform(l);if(l[0]*l[3]-l[1]*l[2]<0&&(t[5]=t[5]?"0":"1"),i=u.calc(t[6],t[7],"a"===t[0]),"A"===t[0]&&t[6]===n&&t[7]===r||"a"===t[0]&&0===t[6]&&0===t[7]){a=["a"===t[0]?"l":"L",i[0],i[1]];break}a=c.isDegenerate()?["a"===t[0]?"l":"L",i[0],i[1]]:[t[0],c.rx,c.ry,c.ax,t[4],t[5],i[0],i[1]];break;case"m":s=0<e,a=["m",(i=u.calc(t[1],t[2],s))[0],i[1]];break;default:for(a=[o=t[0]],s=o.toLowerCase()===o,f=1;f<t.length;f+=2)i=u.calc(t[f],t[f+1],s),a.push(i[0],i[1])}d.segments[e]=a},!0)},Jy.prototype.__evaluateStack=function(){var t,e;if(this.__stack.length){if(1===this.__stack.length)return this.__matrix(this.__stack[0]),void(this.__stack=[]);for(t=By(),e=this.__stack.length;0<=--e;)t.matrix(this.__stack[e].toArray());this.__matrix(t),this.__stack=[]}},Jy.prototype.toString=function(){var t,e,n=[];this.__evaluateStack();for(var r=0;r<this.segments.length;r++)e=this.segments[r][0],t=0<r&&"m"!==e&&"M"!==e&&e===this.segments[r-1][0],n=n.concat(t?this.segments[r].slice(1):this.segments[r]);return n.join(" ").replace(/ ?([achlmqrstvz]) ?/gi,"$1").replace(/ \-/g,"-").replace(/zm/g,"z m")},Jy.prototype.translate=function(t,e){return this.__stack.push(By().translate(t,e||0)),this},Jy.prototype.scale=function(t,e){return this.__stack.push(By().scale(t,e||0===e?e:t)),this},Jy.prototype.rotate=function(t,e,n){return this.__stack.push(By().rotate(t,e||0,n||0)),this},Jy.prototype.skewX=function(t){return this.__stack.push(By().skewX(t)),this},Jy.prototype.skewY=function(t){return this.__stack.push(By().skewY(t)),this},Jy.prototype.matrix=function(t){return this.__stack.push(By().matrix(t)),this},Jy.prototype.transform=function(t){return t.trim()&&this.__stack.push((e=t,i=new By,e.split(Ry).forEach(function(t){if(t.length)if(void 0===Uy[t])switch(r=t.split(Hy).map(function(t){return+t||0}),n){case"matrix":return void(6===r.length&&i.matrix(r));case"scale":return void(1===r.length?i.scale(r[0],r[0]):2===r.length&&i.scale(r[0],r[1]));case"rotate":return void(1===r.length?i.rotate(r[0],0,0):3===r.length&&i.rotate(r[0],r[1],r[2]));case"translate":return void(1===r.length?i.translate(r[0],0):2===r.length&&i.translate(r[0],r[1]));case"skewX":return void(1===r.length&&i.skewX(r[0]));case"skewY":return void(1===r.length&&i.skewY(r[0]))}else n=t}),i)),this;var e,n,r,i},Jy.prototype.round=function(r){var e,i=0,a=0,o=0,s=0;return r=r||0,this.__evaluateStack(),this.segments.forEach(function(n){var t=n[0].toLowerCase()===n[0];switch(n[0]){case"H":case"h":return t&&(n[1]+=o),o=n[1]-n[1].toFixed(r),void(n[1]=+n[1].toFixed(r));case"V":case"v":return t&&(n[1]+=s),s=n[1]-n[1].toFixed(r),void(n[1]=+n[1].toFixed(r));case"Z":case"z":return o=i,void(s=a);case"M":case"m":return t&&(n[1]+=o,n[2]+=s),o=n[1]-n[1].toFixed(r),s=n[2]-n[2].toFixed(r),i=o,a=s,n[1]=+n[1].toFixed(r),void(n[2]=+n[2].toFixed(r));case"A":case"a":return t&&(n[6]+=o,n[7]+=s),o=n[6]-n[6].toFixed(r),s=n[7]-n[7].toFixed(r),n[1]=+n[1].toFixed(r),n[2]=+n[2].toFixed(r),n[3]=+n[3].toFixed(r+2),n[6]=+n[6].toFixed(r),void(n[7]=+n[7].toFixed(r));default:return e=n.length,t&&(n[e-2]+=o,n[e-1]+=s),o=n[e-2]-n[e-2].toFixed(r),s=n[e-1]-n[e-1].toFixed(r),void n.forEach(function(t,e){e&&(n[e]=+n[e].toFixed(r))})}}),this},Jy.prototype.iterate=function(i,t){var e,n,r,a=this.segments,o={},s=!1,l=0,c=0,u=0,f=0;if(t||this.__evaluateStack(),a.forEach(function(t,e){var n=i(t,e,l,c);Array.isArray(n)&&(o[e]=n,s=!0);var r=t[0]===t[0].toLowerCase();switch(t[0]){case"m":case"M":return l=t[1]+(r?l:0),c=t[2]+(r?c:0),u=l,void(f=c);case"h":case"H":return void(l=t[1]+(r?l:0));case"v":case"V":return void(c=t[1]+(r?c:0));case"z":case"Z":return l=u,void(c=f);default:l=t[t.length-2]+(r?l:0),c=t[t.length-1]+(r?c:0)}}),!s)return this;for(r=[],e=0;e<a.length;e++)if(void 0!==o[e])for(n=0;n<o[e].length;n++)r.push(o[e][n]);else r.push(a[e]);return this.segments=r,this},Jy.prototype.abs=function(){return this.iterate(function(t,e,n,r){var i,a=t[0],o=a.toUpperCase();if(a!==o)switch(t[0]=o,a){case"v":return void(t[1]+=r);case"a":return t[6]+=n,void(t[7]+=r);default:for(i=1;i<t.length;i++)t[i]+=i%2?n:r}},!0),this},Jy.prototype.rel=function(){return this.iterate(function(t,e,n,r){var i,a=t[0],o=a.toLowerCase();if(a!==o&&(0!==e||"M"!==a))switch(t[0]=o,a){case"V":return void(t[1]-=r);case"A":return t[6]-=n,void(t[7]-=r);default:for(i=1;i<t.length;i++)t[i]-=i%2?n:r}},!0),this},Jy.prototype.unarc=function(){return this.iterate(function(t,e,n,r){var i,a,o,s=[],l=t[0];return"A"!==l&&"a"!==l?null:(o="a"===l?(a=n+t[6],r+t[7]):(a=t[6],t[7]),0===(i=Gy(n,r,a,o,t[4],t[5],t[1],t[2],t[3])).length?[["a"===t[0]?"l":"L",t[6],t[7]]]:(i.forEach(function(t){s.push(["C",t[2],t[3],t[4],t[5],t[6],t[7]])}),s))}),this},Jy.prototype.unshort=function(){var s,l,c,u,f,d=this.segments;return this.iterate(function(t,e,n,r){var i,a=t[0],o=a.toUpperCase();e&&("T"===o?(i="t"===a,c=d[e-1],l="Q"===c[0]?(s=c[1]-n,c[2]-r):"q"===c[0]?(s=c[1]-c[3],c[2]-c[4]):s=0,u=-s,f=-l,i||(u+=n,f+=r),d[e]=[i?"q":"Q",u,f,t[1],t[2]]):"S"===o&&(i="s"===a,c=d[e-1],l="C"===c[0]?(s=c[3]-n,c[4]-r):"c"===c[0]?(s=c[3]-c[5],c[4]-c[6]):s=0,u=-s,f=-l,i||(u+=n,f+=r),d[e]=[i?"c":"C",u,f,t[1],t[2],t[3],t[4]]))}),this};var Ky=Jy,$y={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},tb=/([astvzqmhlc])([^astvzqmhlc]*)/gi;function eb(t){var a=[];return t.replace(tb,function(t,e,n){var r,i=e.toLowerCase();for(n=(r=n.match(nb))?r.map(Number):[],"m"===i&&2<n.length&&(a.push([e].concat(n.splice(0,2))),i="l",e="m"===e?"l":"L");0<=n.length;){if(n.length===$y[i])return n.unshift(e),a.push(n);if(n.length<$y[i])throw new Error("malformed path data");a.push([e].concat(n.splice(0,$y[i])))}}),a}var nb=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function rb(t,e,n,r,i,a,o,s){return new ib(t,e,n,r,i,a,o,s)}function ib(t,e,n,r,i,a,o,s){this.a={x:t,y:e},this.b={x:n,y:r},this.c={x:i,y:a},this.d={x:o,y:s},this.getDerivative=null!=o&&null!=s?(this.getArcLength=gb,this.getPoint=cb,ob):(this.getArcLength=ub,this.getPoint=lb,ab),this.init()}function ab(t,e,n){return{x:2*(1-n)*(t[1]-t[0])+2*n*(t[2]-t[1]),y:2*(1-n)*(e[1]-e[0])+2*n*(e[2]-e[1])}}function ob(t,e,n){return lb([3*(t[1]-t[0]),3*(t[2]-t[1]),3*(t[3]-t[2])],[3*(e[1]-e[0]),3*(e[2]-e[1]),3*(e[3]-e[2])],n)}function sb(t,e,n,r,i){for(var a=1,o=t/e,s=(t-n(r,i,o))/e;.001<a;){var l=n(r,i,o+s),c=n(r,i,o-s),u=Math.abs(t-l)/e,f=Math.abs(t-c)/e;u<a?(a=u,o+=s):f<a?(a=f,o-=s):s/=2}return o}function lb(t,e,n){return{x:(1-n)*(1-n)*t[0]+2*(1-n)*n*t[1]+n*n*t[2],y:(1-n)*(1-n)*e[0]+2*(1-n)*n*e[1]+n*n*e[2]}}function cb(t,e,n){return{x:(1-n)*(1-n)*(1-n)*t[0]+3*(1-n)*(1-n)*n*t[1]+3*(1-n)*n*n*t[2]+n*n*n*t[3],y:(1-n)*(1-n)*(1-n)*e[0]+3*(1-n)*(1-n)*n*e[1]+3*(1-n)*n*n*e[2]+n*n*n*e[3]}}function ub(t,e,n){void 0===n&&(n=1);var r=t[0]-2*t[1]+t[2],i=e[0]-2*e[1]+e[2],a=2*t[1]-2*t[0],o=2*e[1]-2*e[0],s=4*(r*r+i*i),l=4*(r*a+i*o),c=a*a+o*o;if(0===s)return n*Math.sqrt(Math.pow(t[2]-t[0],2)+Math.pow(e[2]-e[0],2));var u=l/(2*s),f=n+u,d=c/s-u*u;return Math.sqrt(s)/2*(f*Math.sqrt(f*f+d)-u*Math.sqrt(u*u+d)+d*Math.log(Math.abs((f+Math.sqrt(f*f+d))/(u+Math.sqrt(u*u+d)))))}ib.prototype={constructor:ib,init:function(){this.length=this.getArcLength([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y])},getTotalLength:function(){return this.length},getPointAtLength:function(t){var e=sb(t,this.length,this.getArcLength,[this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y]);return this.getPoint([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],e)},getTangentAtLength:function(t){var e=sb(t,this.length,this.getArcLength,[this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y]),n=this.getDerivative([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],e),r=Math.sqrt(n.x*n.x+n.y*n.y);return 0<r?{x:n.x/r,y:n.y/r}:{x:0,y:0}},getPropertiesAtLength:function(t){var e,n=sb(t,this.length,this.getArcLength,[this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y]),r=this.getDerivative([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],n),i=Math.sqrt(r.x*r.x+r.y*r.y);e=0<i?{x:r.x/i,y:r.y/i}:{x:0,y:0};var a=this.getPoint([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],n);return{x:a.x,y:a.y,tangentX:e.x,tangentY:e.y}}};var fb=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],db=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],pb=[[1],[1,1],[1,2,1],[1,3,3,1]];function hb(t,e,n){var r,i,a,o,s=n.length-1;if(0===s)return 0;if(0===t){for(a=i=0;a<=s;a++)i+=(o=a,pb[s][o]*Math.pow(1-e,s-a)*Math.pow(e,a)*n[a]);return i}for(r=new Array(s),a=0;a<s;a++)r[a]=s*(n[a+1]-n[a]);return hb(t-1,e,r)}function gb(t,e,n){var r,i,a,o;void 0===n&&(n=1);var s,l,c,u,f;for(r=n/2,a=i=0;a<20;a++)o=r*fb[20][a]+r,i+=db[20][a]*(s=e,void 0,c=hb(1,l=o,t),u=hb(1,l,s),f=c*c+u*u,Math.sqrt(f));return r*i}var mb=2*Math.PI;function _b(t,e,n,r){var i=t*n+e*r;return 1<i&&(i=1),i<-1&&(i=-1),(t*r-e*n<0?-1:1)*Math.acos(i)}function yb(t,e,o,s,n,r,i,a,l){var c=Math.sin(n*mb/360),u=Math.cos(n*mb/360),f=u*(t-a)/2+c*(e-l)/2,d=-c*(t-a)/2+u*(e-l)/2;if(0===f&&0===d)return[];if(0===o||0===s)return[];o=Math.abs(o),s=Math.abs(s);var p=f*f/(o*o)+d*d/(s*s);1<p&&(o*=Math.sqrt(p),s*=Math.sqrt(p));var h,g,m,_,y,b,v,x=function(t,e,n,r,i,a,o,s,l,c){var u=c*(t-n)/2+l*(e-r)/2,f=-l*(t-n)/2+c*(e-r)/2,d=o*o,p=s*s,h=u*u,g=f*f,m=d*p-d*g-p*h;m<0&&(m=0),m/=d*g+p*h;var _=(m=Math.sqrt(m)*(i===a?-1:1))*o/s*f,y=m*-s/o*u,b=c*_-l*y+(t+n)/2,v=l*_+c*y+(e+r)/2,x=(u-_)/o,w=(f-y)/s,M=(-u-_)/o,j=(-f-y)/s,k=_b(1,0,x,w),z=_b(x,w,M,j);return 0===a&&0<z&&(z-=mb),1===a&&z<0&&(z+=mb),[b,v,k,z]}(t,e,a,l,r,i,o,s,c,u),w=[],M=x[2],j=x[3],k=Math.max(Math.ceil(Math.abs(j)/(mb/4)),1);j/=k;for(var z=0;z<k;z++)w.push((h=M,g=j,void 0,m=4/3*Math.tan(g/4),_=Math.cos(h),y=Math.sin(h),b=Math.cos(h+g),v=Math.sin(h+g),[_,y,_-y*m,y+_*m,b+v*m,v-b*m,b,v])),M+=j;return w.map(function(t){for(var e=0;e<t.length;e+=2){var n=t[e+0],r=t[e+1],i=u*(n*=o)-c*(r*=s),a=c*n+u*r;t[e+0]=i+x[0],t[e+1]=a+x[1]}return t})}function bb(t,e,n,r,i,a,o,s,l){return new vb(t,e,n,r,i,a,o,s,l)}function vb(t,e,n,r,i,a,o,s,l){var c=0,u=[],f=[];yb(t,e,n,r,i,a,o,s,l).forEach(function(t){var e=new rb(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]),n=e.getTotalLength();c+=n,u.push(n),f.push(e)}),this.length=c,this.partialLengths=u,this.curves=f}function xb(t,e,n,r){return new wb(t,e,n,r)}function wb(t,e,n,r){this.x0=t,this.x1=e,this.y0=n,this.y1=r}function Mb(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}function jb(t,e,n){return[t[0]+(e[0]-t[0])*n,t[1]+(e[1]-t[1])*n]}function kb(t){return"number"==typeof t&&isFinite(t)}vb.prototype={constructor:vb,init:function(){},getTotalLength:function(){return this.length},getPointAtLength:function(t){t<0?t=0:t>this.length&&(t=this.length);for(var e=this.partialLengths.length-1;this.partialLengths[e]>=t&&0<this.partialLengths[e];)e--;e<this.partialLengths.length-1&&e++;for(var n=0,r=0;r<e;r++)n+=this.partialLengths[r];return this.curves[e].getPointAtLength(t-n)},getTangentAtLength:function(t){t<0?t=0:t>this.length&&(t=this.length);for(var e=this.partialLengths.length-1;this.partialLengths[e]>=t&&0<this.partialLengths[e];)e--;e<this.partialLengths.length-1&&e++;for(var n=0,r=0;r<e;r++)n+=this.partialLengths[r];return this.curves[e].getTangentAtLength(t-n)},getPropertiesAtLength:function(t){var e=this.getTangentAtLength(t),n=this.getPointAtLength(t);return{x:n.x,y:n.y,tangentX:e.x,tangentY:e.y}}},wb.prototype.getTotalLength=function(){return Math.sqrt(Math.pow(this.x0-this.x1,2)+Math.pow(this.y0-this.y1,2))},wb.prototype.getPointAtLength=function(t){var e=t/Math.sqrt(Math.pow(this.x0-this.x1,2)+Math.pow(this.y0-this.y1,2)),n=(this.x1-this.x0)*e,r=(this.y1-this.y0)*e;return{x:this.x0+n,y:this.y0+r}},wb.prototype.getTangentAtLength=function(){var t=Math.sqrt((this.x1-this.x0)*(this.x1-this.x0)+(this.y1-this.y0)*(this.y1-this.y0));return{x:(this.x1-this.x0)/t,y:(this.y1-this.y0)/t}},wb.prototype.getPropertiesAtLength=function(t){var e=this.getPointAtLength(t),n=this.getTangentAtLength();return{x:e.x,y:e.y,tangentX:n.x,tangentY:n.y}};var zb,Nb='All shapes must be supplied as arrays of [x, y] points or an SVG path string (https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d).\nExample valid ways of supplying a shape would be:\n[[0, 0], [10, 0], [10, 10]]\n"M0,0 L10,0 L10,10Z"\n';function Ab(t,e){var n=new Ky(t).abs();return function(t){var e=t.segments||[],n=[];if(!e.length||"M"!==e[0][0])return!1;for(var r=0;r<e.length;r++){var i=e[r],a=i[0],o=i[1],s=i[2];if("M"===a&&r||"Z"===a)break;if("M"===a||"L"===a)n.push([o,s]);else if("H"===a)n.push([o,n[n.length-1][1]]);else{if("V"!==a)return!1;n.push([n[n.length-1][0],o])}}return!!n.length&&{ring:n}}(n)||function(t,e){var n,r,i=(s=t,s.toString().split("M").map(function(t,e){return t=t.trim(),e&&t?"M"+t:t}).filter(function(t){return t}))[0],a=[],o=3;var s;if(!i)throw new TypeError(Nb);r=function(t){if("undefined"!=typeof window&&window&&window.document)try{var e=window.document.createElementNS("http://www.w3.org/2000/svg","path");return e.setAttributeNS(null,"d",t),e}catch(t){}return function(t){var s=0,l=[],c=[];function u(t){if(!t)return null;for(var e,n,r=eb(t),i=[0,0],a=[0,0],o=0;o<r.length;o++)"M"===r[o][0]?(n=[(i=[r[o][1],r[o][2]])[0],i[1]],c.push(null)):"m"===r[o][0]?(n=[(i=[r[o][1]+i[0],r[o][2]+i[1]])[0],i[1]],c.push(null)):"L"===r[o][0]?(s+=Math.sqrt(Math.pow(i[0]-r[o][1],2)+Math.pow(i[1]-r[o][2],2)),c.push(new xb(i[0],r[o][1],i[1],r[o][2])),i=[r[o][1],r[o][2]]):"l"===r[o][0]?(s+=Math.sqrt(Math.pow(r[o][1],2)+Math.pow(r[o][2],2)),c.push(new xb(i[0],r[o][1]+i[0],i[1],r[o][2]+i[1])),i=[r[o][1]+i[0],r[o][2]+i[1]]):"H"===r[o][0]?(s+=Math.abs(i[0]-r[o][1]),c.push(new xb(i[0],r[o][1],i[1],i[1])),i[0]=r[o][1]):"h"===r[o][0]?(s+=Math.abs(r[o][1]),c.push(new xb(i[0],i[0]+r[o][1],i[1],i[1])),i[0]=r[o][1]+i[0]):"V"===r[o][0]?(s+=Math.abs(i[1]-r[o][1]),c.push(new xb(i[0],i[0],i[1],r[o][1])),i[1]=r[o][1]):"v"===r[o][0]?(s+=Math.abs(r[o][1]),c.push(new xb(i[0],i[0],i[1],i[1]+r[o][1])),i[1]=r[o][1]+i[1]):"z"===r[o][0]||"Z"===r[o][0]?(s+=Math.sqrt(Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2)),c.push(new xb(i[0],n[0],i[1],n[1])),i=[n[0],n[1]]):"C"===r[o][0]?(e=new rb(i[0],i[1],r[o][1],r[o][2],r[o][3],r[o][4],r[o][5],r[o][6]),s+=e.getTotalLength(),i=[r[o][5],r[o][6]],c.push(e)):"c"===r[o][0]?(e=new rb(i[0],i[1],i[0]+r[o][1],i[1]+r[o][2],i[0]+r[o][3],i[1]+r[o][4],i[0]+r[o][5],i[1]+r[o][6]),s+=e.getTotalLength(),i=[r[o][5]+i[0],r[o][6]+i[1]],c.push(e)):"S"===r[o][0]?(e=0<o&&-1<["C","c","S","s"].indexOf(r[o-1][0])?new rb(i[0],i[1],2*i[0]-r[o-1][r[o-1].length-4],2*i[1]-r[o-1][r[o-1].length-3],r[o][1],r[o][2],r[o][3],r[o][4]):new rb(i[0],i[1],i[0],i[1],r[o][1],r[o][2],r[o][3],r[o][4]),s+=e.getTotalLength(),i=[r[o][3],r[o][4]],c.push(e)):"s"===r[o][0]?(e=0<o&&-1<["C","c","S","s"].indexOf(r[o-1][0])?new rb(i[0],i[1],i[0]+e.d.x-e.c.x,i[1]+e.d.y-e.c.y,i[0]+r[o][1],i[1]+r[o][2],i[0]+r[o][3],i[1]+r[o][4]):new rb(i[0],i[1],i[0],i[1],i[0]+r[o][1],i[1]+r[o][2],i[0]+r[o][3],i[1]+r[o][4]),s+=e.getTotalLength(),i=[r[o][3]+i[0],r[o][4]+i[1]],c.push(e)):"Q"===r[o][0]?(e=i[0]!=r[o][1]&&i[1]!=r[o][2]?new rb(i[0],i[1],r[o][1],r[o][2],r[o][3],r[o][4]):new xb(r[o][1],r[o][3],r[o][2],r[o][4]),s+=e.getTotalLength(),c.push(e),i=[r[o][3],r[o][4]],a=[r[o][1],r[o][2]]):"q"===r[o][0]?(e=0!=r[o][1]||0!=r[o][2]?new rb(i[0],i[1],i[0]+r[o][1],i[1]+r[o][2],i[0]+r[o][3],i[1]+r[o][4]):new xb(i[0]+r[o][1],i[0]+r[o][3],i[1]+r[o][2],i[1]+r[o][4]),s+=e.getTotalLength(),a=[i[0]+r[o][1],i[1]+r[o][2]],i=[r[o][3]+i[0],r[o][4]+i[1]],c.push(e)):"T"===r[o][0]?(e=0<o&&-1<["Q","q","T","t"].indexOf(r[o-1][0])?new rb(i[0],i[1],2*i[0]-a[0],2*i[1]-a[1],r[o][1],r[o][2]):new xb(i[0],r[o][1],i[1],r[o][2]),c.push(e),s+=e.getTotalLength(),a=[2*i[0]-a[0],2*i[1]-a[1]],i=[r[o][1],r[o][2]]):"t"===r[o][0]?(e=0<o&&-1<["Q","q","T","t"].indexOf(r[o-1][0])?new rb(i[0],i[1],2*i[0]-a[0],2*i[1]-a[1],i[0]+r[o][1],i[1]+r[o][2]):new xb(i[0],i[0]+r[o][1],i[1],i[1]+r[o][2]),s+=e.getTotalLength(),a=[2*i[0]-a[0],2*i[1]-a[1]],i=[r[o][1]+i[0],r[o][2]+i[0]],c.push(e)):"A"===r[o][0]?(e=new bb(i[0],i[1],r[o][1],r[o][2],r[o][3],r[o][4],r[o][5],r[o][6],r[o][7]),s+=e.getTotalLength(),i=[r[o][6],r[o][7]],c.push(e)):"a"===r[o][0]&&(e=new bb(i[0],i[1],r[o][1],r[o][2],r[o][3],r[o][4],r[o][5],i[0]+r[o][6],i[1]+r[o][7]),s+=e.getTotalLength(),i=[i[0]+r[o][6],i[1]+r[o][7]],c.push(e)),l.push(s);return u}u.getTotalLength=function(){return s},u.getPointAtLength=function(t){var e=n(t);return c[e.i].getPointAtLength(e.fraction)},u.getTangentAtLength=function(t){var e=n(t);return c[e.i].getTangentAtLength(e.fraction)},u.getPropertiesAtLength=function(t){var e=n(t);return c[e.i].getPropertiesAtLength(e.fraction)};var n=function(t){t<0?t=0:s<t&&(t=s);for(var e=l.length-1;l[e]>=t&&0<l[e];)e--;return{fraction:t-l[++e-1],i:e}};return u(t)}(t)}(i),n=r.getTotalLength(),e&&kb(e)&&0<e&&(o=Math.max(o,Math.ceil(n/e)));for(var l=0;l<o;l++){var c=r.getPointAtLength(n*l/o);a.push([c.x,c.y])}return{ring:a,skipBisect:!0}}(n,e)}function Db(t,e){for(var n=t.length+e,r=function(t){for(var e,n,r=-1,i=t.length,a=t[i-1],o=a[0],s=a[1],l=0;++r<i;)e=o,n=s,e-=o=(a=t[r])[0],n-=s=a[1],l+=Math.sqrt(e*e+n*n);return l}(t)/e,i=0,a=0,o=r/2;t.length<n;){var s=t[i],l=t[(i+1)%t.length],c=Mb(s,l);o<=a+c?(t.splice(i+1,0,c?jb(s,l,(o-a)/c):s.slice(0)),o+=r):(a+=c,i++)}}function Tb(t,e){var n,r,i,a;if("string"==typeof t){var o=Ab(t,e);t=o.ring,r=o.skipBisect}else if(!Array.isArray(t))throw new TypeError(Nb);if(n=t.slice(0),!n.every(function(t){return Array.isArray(t)&&2<=t.length&&kb(t[0])&&kb(t[1])}))throw new TypeError(Nb);return 1<n.length&&(i=n[0],a=n[n.length-1],Mb(i,a)<1e-9)&&n.pop(),0<function(t){for(var e,n=-1,r=t.length,i=t[r-1],a=0;++n<r;)e=i,i=t[n],a+=e[1]*i[0]-e[0]*i[1];return a/2}(n)&&n.reverse(),!r&&e&&kb(e)&&0<e&&function(t,e){void 0===e&&(e=1/0);for(var n=0;n<t.length;n++)for(var r=t[n],i=n===t.length-1?t[0]:t[n+1];Mb(r,i)>e;)i=jb(r,i,.5),t.splice(n+1,0,i)}(n,e),n}function Ib(e,n,t){void 0===t&&(t={});var r=t.maxSegmentLength;void 0===r&&(r=10);var i=t.string;void 0===i&&(i=!0);var a,o,s,l,c,u,f,d=Tb(e,r),p=Tb(n,r),h=(o=p,s=i,l=(a=d).length-o.length,Db(a,l<0?-1*l:0),Db(o,0<l?l:0),function(i,t){for(var e,a,n,o=i.length,s=1/0,r=function(r){a=0,t.forEach(function(t,e){var n=Mb(i[(r+e)%o],t);a+=n*n}),a<s&&(s=a,e=r)},l=0;l<o;l++)r(l);e&&(n=i.splice(0,e),i.splice.apply(i,[i.length,0].concat(n)))}(a,o),c=o,u=s,f=a.map(function(t,e){return r=t,i=c[e],function(n){return r.map(function(t,e){return t+n*(i[e]-t)})};var r,i}),function(e){var t=f.map(function(t){return t(e)});return u?"M"+t.join("L")+"Z":t});return!i||"string"!=typeof e&&"string"!=typeof n?h:function(t){return t<1e-4&&"string"==typeof e?e:1-t<1e-4&&"string"==typeof n?n:h(t)}}var Lb={};function Sb(t){return t?"translate("+t.layout.x+","+t.layout.y+")":null}var Eb,Cb,Ob,Pb,Yb,Fb,Bb,Ub=0;function Rb(i,t,o){Bh(),Ub++;var e=i.facets,a=i.data_points,n=ce(".facets").selectAll(".facet").data(e,function(t){return t.key}),r=n.enter().append("g").attr("class","facet").each(function(){this._chart_layout=ku(this),this._chart_layout.data_foreground.append("g").attr("class","axis-highlights")}),s=n.merge(r),l=0,c=0,u=0,f=0;s.each(function(t){var e=ju.x_matching?a.x_domain:t.x_domain,n=ju.y_matching?a.y_domain:t.y_domain;t.chart_layout=this._chart_layout,t.chart_layout.xData(e).yData(n).xAutoTitle(i.data_points.column_names.x||"").yAutoTitle(i.data_points.column_names.y||"").y2Hide(!0).xFormat(Cb).yFormat(Ob).animationDuration(0).width(sv.getPrimaryWidth()).height(sv.getPrimaryHeight()).update({skip_rendering:!0}),t.chart_layout.margins.left>l&&(l=t.chart_layout.margins.left);var r="bottom"==ju.x.axis_position?t.chart_layout.margins.bottom:t.chart_layout.margins.top;c<r&&(c=r),u=Math.max(u,t.chart_layout.yTicks.autoLabelSpace().px),f=Math.max(f,t.chart_layout.xTicks.autoLabelSpace().px)});var d=4096/ih(),p=sv.getPrimaryWidth(),h=e.length,g=l,m=c,_=x_(ju.facet_gutter_w),y=ju.y_single_col&&ju.y_matching;y||(_+=g);var b,v,x=p-g-x_(ju.margin_right)-x_(ju.margin_left);if(ju.facet_fixed_cols&&i.has_facet_binding)b=Math.floor(ju.facet_cols),v=Math.ceil(h/b);else{var w=Math.floor((x+_)/(ju.facet_min_w+_));b=Math.max(1,Math.min(w,h)),v=Math.ceil(h/b);for(var M=b;0<M&&Math.ceil(h/(b-1))==v;M--)b--}var j=h%b!=0&&b<h,k=(x-_*(b-1))/b,z=x_(ju.facet_gutter_h),N=ju.x_single_row&&ju.x_matching&&!j&&("bottom"==ju.x.axis_position||"top"==ju.x.axis_position),A=N&&"top"==ju.x.axis_position,D=A?x_(.5):0;N||(z+=m);var T,I,L,S,E=e.length<2?0:1.5*x_(ju.facet_header_font_size),C=k*ju.facet_aspect/100,O=v*(C+E+z)+m+D-z+x_(ju.margin_top)+x_(ju.margin_bottom),P=Math.max(sv.getDefaultPrimaryHeight(),1),Y=(Math.max(P-x_(ju.margin_top)-x_(ju.margin_bottom),1)-m-D-v*E-(v-1)*z)/v,F=d,B=(Math.max(F-x_(ju.margin_top)-x_(ju.margin_bottom),1)-m-v*E-(v-1)*z)/v;function U(){Eg()&&d<P?R():(sv.setHeight(null),I=P,T=Y)}function R(){I=F,T=B,sv.setHeight(d)}function H(){Eg()&&d<O?R():(I=O,T=C,sv.setHeight(I))}if(Flourish.fixed_height||"fill_space"==ju.height_mode)U();else if("aspect"==ju.height_mode)H();else{(k<ju.facet_min_w||Y<100)&&P<O?H():U()}k=Math.max(k,0),T=Math.max(T,0),(L="#graphic, #overlay","string"==typeof L?new se([document.querySelectorAll(L)],[document.documentElement]):new se([null==L?[]:L],oe)).transition().duration(o?0:1e3*ju.animation_duration).attr("width",t).attr("height",I);for(M=0;M<h;M++){var Z=Math.ceil(M%b),Q=Math.floor(M/b),G=e[M].layout={};G.has_y_axis=0==Z||!y,G.has_x_axis=A&&0==Q||!A&&Q==v-1||!N,G.x=x_(ju.margin_left)+(G.has_y_axis?0:g)+Z*(k+_),G.y=x_(ju.margin_top)+(!G.has_x_axis&&A?m:0)+E+Q*(T+E+z),G.w=k+(G.has_y_axis?g:0),G.h=E+T+(G.has_x_axis?m:0),G.plot_h=T,G.plot_w=k}function q(t){var e=t.chart_layout.margins.left,n=!1;return"center"==ju.facet_title_align?n=!0:"auto"==ju.facet_title_align&&"donut"==ju.chart_type&&(n=!0),n&&(e=k/2-this.getBoundingClientRect().width/2),e}r.attr("transform",function(t){return Sb(t)}).attr("opacity",0),r.append("text").attr("class","facet-title").attr("y",-E/2).attr("font-size",ju.facet_header_font_size+"rem").attr("font-weight","bold").attr("dominant-baseline","middle").attr("x",q),s.each(function(t){var e=t.layout.has_y_axis,n=t.layout.has_x_axis,r=e?g:0,i=n&&!A?m:0,a=n&&A?m:0;t.chart_layout.width(t.layout.plot_w+r).height(t.layout.plot_h+i+a).animationDuration(o?0:1e3*ju.animation_duration).yTicks.autoLabelSpace(u,"px").xTicks.autoLabelSpace(f,"px").update({margins:{left:r,bottom:i,top:a}}),ce(this).selectAll(".fl-y-axis .fl-axis-ticks, .fl-y-axis .fl-axis-line, .fl-y-axis .fl-axis-title ").style("visibility",e?null:"hidden"),ce(this).selectAll(".fl-x-axis .fl-axis-ticks, .fl-x-axis .fl-axis-line, .fl-x-axis .fl-axis-title ").style("visibility",n?null:"hidden")}).transition().duration(o?0:1e3*ju.animation_duration).attr("transform",Sb).attr("opacity",1).on("end",Yh),s.select(".facet-title").text(function(t){return t.name}).transition().duration(o?0:1e3*ju.animation_duration).attr("font-size",ju.facet_header_font_size+"rem").attr("clip-path",function(t,e){return"url(#facet-clip-"+e+"-"+Ub+")"}).attr("fill",ju.facet_header_color).attr("opacity",e.length<2?0:1).attr("y",-E/2).attr("x",q),s.select(".fl-chart").each(function(t){t.scales={},t.scales.x=t.chart_layout.xScale({global:!0}),t.scales.y=t.chart_layout.yScale({global:!0}),t.scales.w=Math.max(0,t.chart_layout.plot_width),t.scales.h=Math.max(0,t.chart_layout.plot_height),t.x_type=a.x_type,t.y_type=a.y_type,A_(t,o)}),n.exit().transition().duration(o?0:1e3*ju.animation_duration).attr("transform",function(){return Sb(e[e.length-1])}).attr("opacity",0).remove(),(S=5e3<(vy=i).data_points.length)&&Flourish.warn("Beeswarm mode only works with fewer than 5000 points! Try using a violin plot to see the distributions."),ju.beeswarm_plot&&vy.boxes.category_col&&!S?vy.boxes.forEach(function(t){var n="x"==t.category_col,e=t.data_points[0],r=e.facet.scales,i=Math.sqrt(ju.data_point_default_size/Math.PI)*N_(e),a=Dy().data(t.data_points).distributeOn(function(t){return n?z_(t):k_(t)}).radius(i).orientation(n?"vertical":"horizontal").arrange(),o=n?r.x.step()/2-i:r.y.step()/2-i;t.data_points.forEach(function(t,e){t.offset_x=n?a[e].x%o:0,t.offset_y=n?0:a[e].y%o})}):vy.data_points.forEach(function(t){t.offset_x=0,t.offset_y=0}),s.select(".fl-chart-background").on("click",function(){ju.highlighted=null,Yh()}),Eg()?ce("#graphic .data-points").style("display","none"):(ce("#graphic .data-points").style("display",null),function(e,n){var t=e.data_points.filter(function(t){return!("slider"in e.data_points.column_names)||null==Bb.value()||t.slider==Bb.value()}),r=t[0]&&t[0].id&&!(!t[0].slider&&!t[0].filter),i=(zb=zb||ce("#graphic .data-points")).selectAll(".data-point").data(t,function(t){return r?t.id:t.row}),a=i.enter().append("path").attr("class","data-point").attr("d",jp).attr("vector-effect","non-scaling-stroke").attr("stroke",function(t){return Pd(t.color)}).attr("fill",function(t){return Pd(t.color)}).attr("fill-opacity",ju.fill_opacity).attr("stroke-opacity",ju.stroke_opacity).attr("stroke-width",ju.stroke_width).attr("transform",l),o=i.merge(a);function s(t,e){return n?0:e*ju.animation_stagger*1e3}function l(t){return"translate("+(k_(t)+(t.offset_x||0))+","+(z_(t)+(t.offset_y||0))+") scale("+N_(t)+")"}o.on("mouseover",function(t){ju.highlighted&&ju.popup_sticky||Fh.call(this,t)}).on("mouseout",function(){ju.highlighted&&ju.popup_sticky||Bh()}).on("click",function(t){if(ju.popup_sticky&&(ju.highlighted="dot-"+t.row),"story_editor"==Flourish.environment){var e=ju.labels_selected.indexOf(t.row);-1==e?ju.labels_selected.push(t.row):ju.labels_selected.splice(e,1)}Yh(),T_()}).attr("id",function(t){return"dot-"+t.row}).attr("fill",function(t){return Pd(t.color)}).attr("fill-opacity",ju.fill_opacity).attr("stroke-opacity",ju.stroke_opacity).attr("stroke-width",ju.stroke_width).attr("stroke",function(t){return"auto"==ju.stroke_mode?Pd(t.color):ju.stroke_color}),t.length<50?o.transition().duration(n?0:1e3*ju.animation_duration).delay(s).attrTween("d",function(t){var e=this.getAttribute("d"),n=jp(t);return e==n?null:Ib(e,n,{maxSegmentLength:.5})}).attr("transform",l):o.attr("d",function(t){return jp(t)}).attr("fill",function(t){return Pd(t.color)}).transition().duration(n||2500<t.length?0:1e3*ju.animation_duration).delay(s).attr("transform",l),i.exit().remove()}(i,o)),T_(i,o),function(n,t,e){var r=ce("svg .lines").node(),i=ce(ju.line_arrows?"#overlay":"#graphic").node(),a=ce(ju.line_arrows?".data-labels":".data-points").node();i.insertBefore(r,a);var o=t&&"lines_only"!=t?0:1e3*ju.animation_duration,s=n.facets.length?n.facets[0].layout.w:0,l=n.facets.length?n.facets[0].layout.h:0,c=ju.line_width_responsive?Math.max(ju.line_width_min,Math.min(ju.line_width_max,Math.min(s,l)/100)):ju.line_width,u=c/(c*ju.line_arrow_size/10),f=ju.lines_show?n.lines:[],d=ce(i).select(".lines").selectAll(".line").data(f,function(t){return t.id}),p=d.enter().append("path").attr("class","line").attr("d",b).attr("fill","none").attr("stroke",y).attr("opacity",ju.line_opacity).attr("stroke-width",c).attr("transform",_).each(function(){var t=this.getTotalLength();ce(this).attr("stroke-dasharray",t+","+t).attr("stroke-dashoffset",t).transition("dash").duration(o).attr("stroke-dashoffset",0).transition("dash").duration(0).attr("stroke-dasharray",null)});d.merge(p).attr("clip-path",function(t){return"url(#facet-clip-"+t.facet_index+"-"+e+")"}).attr("marker-end",function(t){var e=t[t.length-2],n=t[t.length-1];return e.x==n.x&&e.y==n.y?null:"url(#arrowhead-"+t.id+")"}).transition("update").duration(o).attr("stroke-dashoffset",0).attr("d",b).attr("stroke",y).attr("opacity",ju.line_opacity).attr("stroke-width",c).attr("transform",_),d.exit().each(function(){var t=this.getTotalLength();ce(this).attr("stroke-dasharray",t+","+t).attr("stroke-dashoffset",0).transition("dash").duration(o).attr("stroke-dashoffset",t).remove()});var h=ce(i).select(".lines").selectAll(".arrowhead").data(ju.lines_show&&ju.line_arrows?f:[],function(t){return t.id}),g=h.enter().append("marker").attr("class","arrowhead").attr("refX",10).attr("refY",0).attr("orient","auto").attr("viewBox","0 -5 10 10");g.append("path").attr("d","M 10,0 L 10,0 L 10,0").attr("opacity",0).attr("fill","none").attr("stroke-width",u).attr("stroke","auto"==ju.line_arrow_color_mode?y:ju.line_arrow_color),h.exit().attr("class","exiting-arrowhead").transition().delay(o/10).on("interrupt",function(){ce(this).remove()}).remove(),h.exit().select("path").transition().duration(o/10).attr("d","M 10,0 L 10,0 L 10,0");var m=h.merge(g);function _(t){var e=n.facets[t.facet_index];return"translate("+e.layout.x+","+e.layout.y+")"}function y(t){return"fixed"==ju.line_color_mode?ju.line_color:Pd(t[0].color)||"black"}function b(t){var e=n.facets[t.facet_index].scales;return Jd().x(function(t){return e.x(t.x)}).y(function(t){return e.y(t.y)}).curve(I_[ju.line_curve]||I_.curveLinear)(t)}m.attr("id",function(t){return"arrowhead-"+t.id}).transition().duration(o).delay(.5*o).attr("markerWidth",ju.line_arrow_size).attr("markerHeight",ju.line_arrow_size),m.select("path").transition().duration(.66*o).delay(.5*o).attr("d","M 0,-5 L 10,0 L 0,5").attr("opacity",1).attr("stroke-width",u).attr("stroke","auto"==ju.line_arrow_color_mode?y:ju.line_arrow_color)}(i,o,Ub),S_(i,o,Ub),Ny(i,o),Lb={},s.each(function(t){var e=this._chart_layout.xScale({global:!0}),n=this._chart_layout.yScale({global:!0});Lb[t.key]={id:t.key,x:t.layout.x,y:t.layout.y,chart_layout:this._chart_layout,x_scale:e,y_scale:n,x_domain:e.domain(),y_domain:n.domain(),x_range:e.range(),y_range:n.range()}})}function Hb(){Eb.update()}function Zb(t,e){for(var n in Lb){var r=Lb[n];if(!(e[0]<r.x_range[0]+r.x)&&!(e[0]>r.x_range[1]+r.x||e[1]>r.y_range[0]+r.y||e[1]<r.y_range[1]+r.y)){var i=e[0]-r.x,a=e[1]-r.y;return{facet_id:n,x:r.x_scale.invert?r.x_scale.invert(i):Gb(i,r.x_range,r.x_domain),y:r.y_scale.invert?r.y_scale.invert(a):Gb(a,r.y_range,r.y_domain)}}}}function Qb(t){var e=Lb[t.facet_id];if(e){var n=t.x.ordinal?e.x_scale(t.x.id)+e.x_scale.step()*t.x.offset:e.x_scale(t.x),r=t.y.ordinal?e.y_scale(t.y.id)+e.y_scale.step()*-t.y.offset:e.y_scale(t.y);return[e.x+n,e.y+r]}}function Gb(t,e,n){var r=e[e.length-1]-e[0],i=(t-=e[0])/r,a=n.length;return{id:n[Math.floor(i*a)],offset:i*a%1-.5,ordinal:!0}}function qb(){Od(),Jb(),Sg(),Hb()}function Wb(t,e){var n,r,i;n="number"==t&&e?[e]:[],cv.data(n[0],Pd).format(Yb).update(),i=Xb(r="discrete"==t&&e?e:[]),lv.data(r,Pd).filtered("off"==ju.legend_filtering_mode?[]:ju.legend_filter).on("click","off"==ju.legend_filtering_mode?null:i).update(),ce("#legend").style("display","off"!==ju.legend_position?"block":"none"),sv.setLegendPosition(ju.legend_position)}function Vb(t,e){!function(t,e){if("off"!=ju.text_legend){var n=ju.text_legend_bold?"bold":null;("auto"==ju.text_legend||ju.text_legend_title)&&Tp(ce("#fl-layout-header h1"),t,e,n),("auto"==ju.text_legend||ju.text_legend_subtitle)&&Tp(ce("#fl-layout-header h2"),t,e,n)}}("discrete"==t&&e?e:[],Pd)}function Xb(i){return function(t){var e=ju.legend_filter.indexOf(t),n=-1!=e;if("filter_out"==ju.legend_filtering_mode)n?ju.legend_filter.splice(e,1):ju.legend_filter.push(t);else if("filter_in"==ju.legend_filtering_mode){var r=i.indexOf(t);n||!ju.legend_filter.length?ju.legend_filter=i.filter(function(t,e){return e!=r}):ju.legend_filter=[]}qb()}}function Jb(t){var e,n;(function(t){var e=[];if("filter"in t.column_names){var n=t.map(function(t){return t.filter});e=Kb(n),ju.filter_show_all&&(e=[ju.filter_show_all_text].concat(e))}Fb.options(e).update()})(e=df.data),function(t){var e=[];if("slider"in t.column_names){var n=t.map(function(t){return t.slider});e=Kb(n)}Bb.options(e).update()}(e),Sf(["x","y","size","color","shape","facet"]),n=nv.getFormatterFunction(),Cb="discrete"===uf.data_points.x_type?function(t){return t}:rv(n),Ob="discrete"===uf.data_points.y_type?function(t){return t}:iv(n),Pb=av(n),Yb="discrete"===uf.data_points.color_type?function(t){return t}:ov(n),function(){var t={};for(var e in df.data.column_names)"series"!=e&&(t[e]=df.data.column_names[e]);Dh.addColumnNames(t)}();var r,i,a=uf.data_points;Od(a.color_type,a.color_domain),r=a.shape_type,(i=a.shape_domain)||(bp=function(){return ju.default_shape}),"number"==r&&(bp=si().domain(i).range(wp)),"discrete"==r&&(bp=$e().domain(i).range(wp)),function(t,e){var n=ju.data_point_min_size,r=ju.data_point_max_size;if(e||(vp=function(){return ju.data_point_default_size}),"number"==t&&(vp=oi().domain([0,e[1]]).range([0,r]).clamp(!0)),"discrete"==t){var i=(r-n)/(e.length-1);vp=$e().domain(e).range(Ne(n,r+i,i))}}(a.size_type,a.size_domain),Wb(a.color_type,a.color_domain),sv.update(),Vb(a.color_type,a.color_domain);var o=sv.getPrimaryWidth();Rb(uf,o,t)}function Kb(t){for(var e=[],n={},r=0;r<t.length;r++)t[r]in n||(n[t[r]]=!0,e.push(t[r]));return e}function $b(){Jb(),Sg()}var tv,ev,nv=function(s){for(var t in Ka)void 0===s[t]&&(s[t]=Ka[t]);return{getParser:function(){return e=s.input_decimal_separator,n=new RegExp("[^-0-9eE"+e+"]","g"),function(t){return"number"==typeof t?t:""===t||void 0===t?NaN:parseFloat(t.replace(n,"").replace(e,"."))};var e,n},getFormatterFunction:function(){return t=s.output_separators,r=1<t.length,i=r?t.charAt(1):t.charAt(0),a=r?t.charAt(0):"",(o=ei((e=i,n=a,{decimal:e,thousands:n,grouping:[3],currency:["",""]})).format).decimal=i,o.thousands=a,o;var t,e,n,r,i,a,o}}}(ju.localization),rv=eo(ju.x_formatting),iv=eo(ju.y_formatting),av=eo({}),ov=eo(ju.color_formatting),sv=function(t){for(var e in K=t,V)void 0===K[e]&&(K[e]=V[e]);return(o=document.createElement("style")).id="flourish-page-styles",o.type="text/css",document.head.appendChild(o),rt.wrapper=function(){var t=document.createElement("div");t.id="fl-layout-wrapper-outer",t.style.display="flex";var e=document.createElement("main");e.id="fl-layout-wrapper",e.style.display="flex",e.style.flexGrow="1",e.style.flexDirection="column",e.style.boxSizing="border-box",e.style.overflow="hidden";var n=document.createElement("aside");return n.id="fl-layout-sidebar",n.style.position="relative",rt.sidebar=n,t.appendChild(e),t.appendChild(n),document.body.appendChild(t),e}(),nt.forEach(function(t,e){rt[t]=function(t,e){var n="fl-layout-"+t,r=document.createElement("section");r.className="fl-layout-container",r.id=n+"-container",r.style.width="100%",r.style.position="relative",r.style.order=e;var i=document.createElement("div");return i.className="fl-layout-inner",i.id=n,i.style.width="100%",i.style.position="relative","primary"==t&&(r.style.display="flex"),r.appendChild(i),rt.wrapper.appendChild(r),{outer:r,inner:i}}(t,e)}),lt("header").appendChild(function(){(a=document.createElement("header")).className="flourish-header";var t=document.createElement("hgroup");return s=document.createElement("h1"),l=document.createElement("h2"),c=document.createElement("p"),u=document.createElement("img"),a.appendChild(u),a.appendChild(t),t.appendChild(s),t.appendChild(l),a.appendChild(c),a}()),lt("footer").appendChild(Z()),rt.primary.outer.style.overflow="hidden",function(){var t=rt.primary.outer;t.style.position="relative",(et=document.createElement("div")).id="fl-layout-overlay";var e=et.style;e.position="absolute",e.display="none",e.width="100%",e.height="100%",e.top=0,e.left=0,e.backgroundColor="rgb(200,200,200)",e.zIndex=999999,e.pointerEvents="none";var n=document.createElement("p");n.className="fl-layout-overlay-message",(e=n.style).color="#333333",e.fontSize="1.5rem",e.paddingLeft="15%",e.paddingRight="15%",e.width="100%",e.boxSizing="border-box",e.position="absolute",e.top="50%",e.transform="translate(0, -50%)",e.margin="0",e.textAlign="center",et.appendChild(n),t.appendChild(et)}(),W(),{update:W,getWrapper:ot,getSidebar:st,getSection:lt,getOuterWidth:ct,getInnerWidth:ut,getOuterHeight:ft,getInnerHeight:dt,getPrimaryHeight:pt,getPrimaryWidth:ht,getDefaultPrimaryHeight:mt,setHeight:bt,setLegendPosition:vt,showOverlay:xt,remToPx:tt,getOverlay:wt}}(ju.layout),lv=new ye(ju.categorical_legend),cv=new Xa(ju.continuous_legend);return ku(ce(sv.getSection("primary")).append("svg").attr("id","graphic").style("position","absolute").append("g").attr("class","facets").node()).chart.remove(),Fb=cf(ju.filter),Bb=cf(ju.slider),(Dh=Sh(sv.getSection("primary"),ju.popup,null,"name")).directions(Ch),tv=sv.getSection("primary"),ev=sv.getSidebar(),Eb=new __(tv,ev,ju.annotations,{getDataFromCursor:Zb,getPositionFromData:Qb}),t.data=df,t.draw=function(){var t;t=sv.getSection("controls"),Bb.appendTo(t).on("change",$b),Fb.appendTo(t).on("change",$b),ce(sv.getSection("legend")).append("div").attr("id","legend"),lv.appendTo(ce("#legend").node()),cv.appendTo(ce("#legend").node());var n,e,r=ce(sv.getSection("primary")),i=r.select("#graphic"),a=r.append("div").node(),o=r.append("svg").attr("id","overlay").attr("fill","currentColor").style("position","absolute");function s(){var t=sv.getInnerWidth(),e=n!=t;Jb(e),Sg(e),Hb(),n=t}i.append("g").attr("class","fits"),i.append("g").attr("class","violins"),i.append("g").attr("class","data-points"),o.append("g").attr("class","lines"),o.append("g").attr("class","data-labels"),o.append("g").attr("class","boxes"),Jb(!ju.line_animate_on_load||"lines_only"),Lg(a),Hb(),window.addEventListener("resize",function(){var t=0;ju.beeswarm_plot&&uf.boxes.category_col&&3e3<uf.data_points.length?t=200:!Eg()&&5e3<uf.data_points.length&&(t=200),clearTimeout(e),e=setTimeout(s,t)},!0)},t.state=ju,t.update=qb,t}({});
//# sourceMappingURL=template.js.map
</script><script>
var path = document.location.href.match(/\/visualisation\/(\d+)/);
if (path) {
	path = path[0];
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	ga("create", "UA-44635456-19", "auto", { storage: "none" });
	ga("set", "transport", "beacon");
	ga("set", "dimension1", path.substr(1));
	ga("set", "dimension2", new Date().toISOString());
	ga("send", "pageview", path);
}</script><script src="https://public.flourish.studio/resources/v3/embedded.js"></script><script>
window.addEventListener("message", function(event) {

	var a = document.createElement("a");
	a.href = event.origin;
	var origin_okay = (a.hostname == window.location.hostname)
		|| window.location.hostname === "localhost"
		|| (a.hostname.match(/\.flourish\.local$/) && window.location.hostname.match(/\.flourish\.local$/))
		|| (a.hostname.match(/\.flourish\.net$/) && window.location.hostname.match(/\.flourish\.net$/))
		|| (a.hostname.match(/\.flourish\.rocks$/) && window.location.hostname.match(/\.flourish\.rocks$/))
		|| (a.hostname.match(/\.flourish\.studio$/) && window.location.hostname.match(/\.flourish\.studio$/))
		|| (
			(a.hostname == "public.flourish.studio" && window.location.hostname == "flo.uri.sh")
			|| (a.hostname == "public.flourish.rocks" && window.location.hostname == "staging-flo.uri.sh")
			|| (a.hostname == "public.dev.flourish.rocks" && window.location.hostname == "dev-flo.uri.sh")
		);

	if (!origin_okay) return;

	var message = event.data;
	var port = event.ports[0];
	if (!port || typeof message !== "object" || message.sender !== "Flourish") return;
	var result = null;
	function assign(target, source) {
		for (var k in source) {
			if (source.hasOwnProperty(k)) target[k] = source[k];
		}
	}
	function deepAssign(target, source, is_destructive) {
		for (var k in source) {
			if (!source.hasOwnProperty(k)) continue;
			if (
				typeof target[k] === "object" && target[k] != null && !Array.isArray(target[k])
				&& typeof source[k] === "object" && source[k] != null && !Array.isArray(source[k])
			) {
				deepAssign(target[k], source[k], is_destructive);
			}
			else target[k] = source[k];
		}
		if (is_destructive) {
			for (var k in target) {
				if (target.hasOwnProperty(k) && !source.hasOwnProperty(k)) delete target[k];
			}
		}
	}
	try {
		var i, a;
		switch(message.method) {
			case "getState":
			result = window.template.state;
			if (message.argument) for (a = message.argument.split("."), i = 0; i < a.length; i++) {
				result = result[a[i]];
			}
			break;

			case "setState":
			deepAssign(window.template.state, message.argument);
			break;

			case "hasData":
			result = !!window.template.data;
			break;

			case "setData":
			assign(window.template.data, message.argument);
			break;

			case "getData":
			result = window.template.data;
			break;

			case "draw":
			window.template.draw();
			break;

			case "update":
			window.template.update();
			break;

			case "snapshot":
			result = window.snapshot(message.argument, port);
			break;

			case "setFixedHeight":
			if (window.Flourish) {
				window.Flourish.fixed_height = message.argument != null;
				window.Flourish.__container_height = message.argument;
				if (window.Flourish.checkHeight) window.Flourish.checkHeight();
			}
			break;

			case "sync":
			var spec = message.argument;
			if (spec.data) {
				assign(window.template.data, spec.data);
			}
			if (spec.state) {
				deepAssign(window.template.state, spec.state, spec.overwrite_state);
			}
			// only allow draw or update, not both
			if (spec.draw) {
				window.template.draw();
			}
			else if (spec.update) {
				window.template.update();
			}
			result = "success";
			break;
		}

		port.postMessage({result: result});
	}
	catch (e) {
		port.postMessage({error: e.message});
		throw e;
	}
}, false);
</script></body></html>